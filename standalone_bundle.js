(()=>{var W$=Object.create;var Dh=Object.defineProperty;var G$=Object.getOwnPropertyDescriptor;var j$=Object.getOwnPropertyNames;var HE=Object.getPrototypeOf,q$=Object.prototype.hasOwnProperty;var X$=Reflect.get;var Vb=Math.pow,K$=(i,t,e)=>t in i?Dh(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var He=(i,t)=>()=>(i&&(t=i(i=0)),t);var un=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports),Dr=(i,t)=>{for(var e in t)Dh(i,e,{get:t[e],enumerable:!0})},$E=(i,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of j$(t))!q$.call(i,r)&&r!==e&&Dh(i,r,{get:()=>t[r],enumerable:!(n=G$(t,r))||n.enumerable});return i};var zh=(i,t,e)=>(e=i!=null?W$(HE(i)):{},$E(t||!i||!i.__esModule?Dh(e,"default",{value:i,enumerable:!0}):e,i)),Hb=i=>$E(Dh({},"__esModule",{value:!0}),i);var UE=(i,t,e)=>(K$(i,typeof t!="symbol"?t+"":t,e),e),$b=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var cr=(i,t,e)=>($b(i,t,"read from private field"),e?e.call(i):t.get(i)),Ub=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},Mm=(i,t,e,n)=>($b(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e);var Wb=(i,t,e)=>($b(i,t,"access private method"),e),WE=(i,t,e)=>X$(HE(i),e,t);var $t=(i,t,e)=>new Promise((n,r)=>{var o=l=>{try{a(e.next(l))}catch(c){r(c)}},s=l=>{try{a(e.throw(l))}catch(c){r(c)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(o,s);a((e=e.apply(i,t)).next())});var I5=un((g1t,Pm)=>{var i5,r5,o5,s5,a5,l5,c5,u5,h5,p5,f5,d5,m5,km,Xb,g5,x5,y5,Gl,v5,b5,_5,w5,S5,C5,M5,E5,T5,Rm;(function(i){var t=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(n){i(e(t,e(n)))}):typeof Pm=="object"&&typeof Pm.exports=="object"?i(e(t,e(Pm.exports))):i(e(t));function e(n,r){return n!==t&&(typeof Object.create=="function"?Object.defineProperty(n,"__esModule",{value:!0}):n.__esModule=!0),function(o,s){return n[o]=r?r(o,s):s}}})(function(i){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])};i5=function(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(n,r);function o(){this.constructor=n}n.prototype=r===null?Object.create(r):(o.prototype=r.prototype,new o)},r5=Object.assign||function(n){for(var r,o=1,s=arguments.length;o<s;o++){r=arguments[o];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])}return n},o5=function(n,r){var o={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&r.indexOf(s)<0&&(o[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)r.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(o[s[a]]=n[s[a]]);return o},s5=function(n,r,o,s){var a=arguments.length,l=a<3?r:s===null?s=Object.getOwnPropertyDescriptor(r,o):s,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(n,r,o,s);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(l=(a<3?c(l):a>3?c(r,o,l):c(r,o))||l);return a>3&&l&&Object.defineProperty(r,o,l),l},a5=function(n,r){return function(o,s){r(o,s,n)}},l5=function(n,r,o,s,a,l){function c(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var u=s.kind,h=u==="getter"?"get":u==="setter"?"set":"value",p=!r&&n?s.static?n:n.prototype:null,f=r||(p?Object.getOwnPropertyDescriptor(p,s.name):{}),d,m=!1,x=o.length-1;x>=0;x--){var g={};for(var y in s)g[y]=y==="access"?{}:s[y];for(var y in s.access)g.access[y]=s.access[y];g.addInitializer=function(v){if(m)throw new TypeError("Cannot add initializers after decoration has completed");l.push(c(v||null))};var b=(0,o[x])(u==="accessor"?{get:f.get,set:f.set}:f[h],g);if(u==="accessor"){if(b===void 0)continue;if(b===null||typeof b!="object")throw new TypeError("Object expected");(d=c(b.get))&&(f.get=d),(d=c(b.set))&&(f.set=d),(d=c(b.init))&&a.push(d)}else(d=c(b))&&(u==="field"?a.push(d):f[h]=d)}p&&Object.defineProperty(p,s.name,f),m=!0},c5=function(n,r,o){for(var s=arguments.length>2,a=0;a<r.length;a++)o=s?r[a].call(n,o):r[a].call(n);return s?o:void 0},u5=function(n){return typeof n=="symbol"?n:"".concat(n)},h5=function(n,r,o){return typeof r=="symbol"&&(r=r.description?"[".concat(r.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:o?"".concat(o," ",r):r})},p5=function(n,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,r)},f5=function(n,r,o,s){function a(l){return l instanceof o?l:new o(function(c){c(l)})}return new(o||(o=Promise))(function(l,c){function u(f){try{p(s.next(f))}catch(d){c(d)}}function h(f){try{p(s.throw(f))}catch(d){c(d)}}function p(f){f.done?l(f.value):a(f.value).then(u,h)}p((s=s.apply(n,r||[])).next())})},d5=function(n,r){var o={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,a,l,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(p){return function(f){return h([p,f])}}function h(p){if(s)throw new TypeError("Generator is already executing.");for(;c&&(c=0,p[0]&&(o=0)),o;)try{if(s=1,a&&(l=p[0]&2?a.return:p[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,p[1])).done)return l;switch(a=0,l&&(p=[p[0]&2,l.value]),p[0]){case 0:case 1:l=p;break;case 4:return o.label++,{value:p[1],done:!1};case 5:o.label++,a=p[1],p=[0];continue;case 7:p=o.ops.pop(),o.trys.pop();continue;default:if(l=o.trys,!(l=l.length>0&&l[l.length-1])&&(p[0]===6||p[0]===2)){o=0;continue}if(p[0]===3&&(!l||p[1]>l[0]&&p[1]<l[3])){o.label=p[1];break}if(p[0]===6&&o.label<l[1]){o.label=l[1],l=p;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(p);break}l[2]&&o.ops.pop(),o.trys.pop();continue}p=r.call(n,o)}catch(f){p=[6,f],a=0}finally{s=l=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},m5=function(n,r){for(var o in n)o!=="default"&&!Object.prototype.hasOwnProperty.call(r,o)&&Rm(r,n,o)},Rm=Object.create?function(n,r,o,s){s===void 0&&(s=o);var a=Object.getOwnPropertyDescriptor(r,o);(!a||("get"in a?!r.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return r[o]}}),Object.defineProperty(n,s,a)}:function(n,r,o,s){s===void 0&&(s=o),n[s]=r[o]},km=function(n){var r=typeof Symbol=="function"&&Symbol.iterator,o=r&&n[r],s=0;if(o)return o.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},Xb=function(n,r){var o=typeof Symbol=="function"&&n[Symbol.iterator];if(!o)return n;var s=o.call(n),a,l=[],c;try{for(;(r===void 0||r-- >0)&&!(a=s.next()).done;)l.push(a.value)}catch(u){c={error:u}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(c)throw c.error}}return l},g5=function(){for(var n=[],r=0;r<arguments.length;r++)n=n.concat(Xb(arguments[r]));return n},x5=function(){for(var n=0,r=0,o=arguments.length;r<o;r++)n+=arguments[r].length;for(var s=Array(n),a=0,r=0;r<o;r++)for(var l=arguments[r],c=0,u=l.length;c<u;c++,a++)s[a]=l[c];return s},y5=function(n,r,o){if(o||arguments.length===2)for(var s=0,a=r.length,l;s<a;s++)(l||!(s in r))&&(l||(l=Array.prototype.slice.call(r,0,s)),l[s]=r[s]);return n.concat(l||Array.prototype.slice.call(r))},Gl=function(n){return this instanceof Gl?(this.v=n,this):new Gl(n)},v5=function(n,r,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=o.apply(n,r||[]),a,l=[];return a={},c("next"),c("throw"),c("return"),a[Symbol.asyncIterator]=function(){return this},a;function c(m){s[m]&&(a[m]=function(x){return new Promise(function(g,y){l.push([m,x,g,y])>1||u(m,x)})})}function u(m,x){try{h(s[m](x))}catch(g){d(l[0][3],g)}}function h(m){m.value instanceof Gl?Promise.resolve(m.value.v).then(p,f):d(l[0][2],m)}function p(m){u("next",m)}function f(m){u("throw",m)}function d(m,x){m(x),l.shift(),l.length&&u(l[0][0],l[0][1])}},b5=function(n){var r,o;return r={},s("next"),s("throw",function(a){throw a}),s("return"),r[Symbol.iterator]=function(){return this},r;function s(a,l){r[a]=n[a]?function(c){return(o=!o)?{value:Gl(n[a](c)),done:!1}:l?l(c):c}:l}},_5=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n[Symbol.asyncIterator],o;return r?r.call(n):(n=typeof km=="function"?km(n):n[Symbol.iterator](),o={},s("next"),s("throw"),s("return"),o[Symbol.asyncIterator]=function(){return this},o);function s(l){o[l]=n[l]&&function(c){return new Promise(function(u,h){c=n[l](c),a(u,h,c.done,c.value)})}}function a(l,c,u,h){Promise.resolve(h).then(function(p){l({value:p,done:u})},c)}},w5=function(n,r){return Object.defineProperty?Object.defineProperty(n,"raw",{value:r}):n.raw=r,n};var e=Object.create?function(n,r){Object.defineProperty(n,"default",{enumerable:!0,value:r})}:function(n,r){n.default=r};S5=function(n){if(n&&n.__esModule)return n;var r={};if(n!=null)for(var o in n)o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)&&Rm(r,n,o);return e(r,n),r},C5=function(n){return n&&n.__esModule?n:{default:n}},M5=function(n,r,o,s){if(o==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?n!==r||!s:!r.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return o==="m"?s:o==="a"?s.call(n):s?s.value:r.get(n)},E5=function(n,r,o,s,a){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?n!==r||!a:!r.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?a.call(n,o):a?a.value=o:r.set(n,o),o},T5=function(n,r){if(r===null||typeof r!="object"&&typeof r!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?r===n:n.has(r)},i("__extends",i5),i("__assign",r5),i("__rest",o5),i("__decorate",s5),i("__param",a5),i("__esDecorate",l5),i("__runInitializers",c5),i("__propKey",u5),i("__setFunctionName",h5),i("__metadata",p5),i("__awaiter",f5),i("__generator",d5),i("__exportStar",m5),i("__createBinding",Rm),i("__values",km),i("__read",Xb),i("__spread",g5),i("__spreadArrays",x5),i("__spreadArray",y5),i("__await",Gl),i("__asyncGenerator",v5),i("__asyncDelegator",b5),i("__asyncValues",_5),i("__makeTemplateObject",w5),i("__importStar",S5),i("__importDefault",C5),i("__classPrivateFieldGet",M5),i("__classPrivateFieldSet",E5),i("__classPrivateFieldIn",T5)})});var Mc=un(Sn=>{"use strict";var Kq=Sn&&Sn.__values||function(i){var t=typeof Symbol=="function"&&i[Symbol.iterator],e=0;return t?t.call(i):{next:function(){return i&&e>=i.length&&(i=void 0),{value:i&&i[e++],done:!i}}}};Object.defineProperty(Sn,"__esModule",{value:!0});function UA(i,t){return Math.floor(t()*i)}Sn.tauRandInt=UA;function Yq(i){return i()}Sn.tauRand=Yq;function Zq(i){var t,e,n=0;try{for(var r=Kq(i),o=r.next();!o.done;o=r.next()){var s=o.value;n+=Math.pow(s,2)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return Math.sqrt(n)}Sn.norm=Zq;function Wg(i){for(var t=[],e=0;e<i;e++)t.push(void 0);return t}Sn.empty=Wg;function Jq(i){return Wg(i).map(function(t,e){return e})}Sn.range=Jq;function kw(i,t){return Wg(i).map(function(){return t})}Sn.filled=kw;function WA(i){return kw(i,0)}Sn.zeros=WA;function Qq(i){return kw(i,1)}Sn.ones=Qq;function tX(i,t,e){return Wg(e).map(function(n,r){return i+r*((t-i)/(e-1))})}Sn.linear=tX;function GA(i){return i.reduce(function(t,e){return t+e})}Sn.sum=GA;function eX(i){return GA(i)/i.length}Sn.mean=eX;function nX(i){for(var t=0,e=0;e<i.length;e++)t=i[e]>t?i[e]:t;return t}Sn.max=nX;function iX(i){for(var t=0,e=0;e<i.length;e++)for(var n=0;n<i[e].length;n++)t=i[e][n]>t?i[e][n]:t;return t}Sn.max2d=iX;function rX(i,t,e){for(var n=WA(i),r=0;r<i;r++)for(var o=!0;o;){for(var s=UA(t,e),a=!1,l=0;l<r;l++)if(s===n[l]){a=!0;break}a||(o=!1),n[r]=s}return n}Sn.rejectionSample=rX;function oX(i,t,e){var n=[],r=0,o=0;if(i.length!==t*e)throw new Error("Array dimensions must match input length.");for(var s=0;s<t;s++){for(var a=[],l=0;l<e;l++)a.push(i[o]),o+=1;n.push(a),r+=1}return n}Sn.reshape2d=oX});var Pw=un(mr=>{"use strict";var sX=mr&&mr.__importStar||function(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)Object.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t.default=i,t};Object.defineProperty(mr,"__esModule",{value:!0});var gp=sX(Mc());function jA(i,t){var e=function(r){return gp.empty(i).map(function(){return gp.filled(t,r)})},n=[];return n.push(e(-1)),n.push(e(1/0)),n.push(e(0)),n}mr.makeHeap=jA;function aX(i,t,e){for(var n=gp.zeros(i),r=0;r<i;r++){for(var o=!0,s=0;o;){s=gp.tauRandInt(t,e);for(var a=!1,l=0;l<r;l++)if(s===n[l]){a=!0;break}a||(o=!1)}n[r]=s}return n}mr.rejectionSample=aX;function Rw(i,t,e,n,r){t=Math.floor(t);var o=i[0][t],s=i[1][t],a=i[2][t];if(e>=s[0])return 0;for(var l=0;l<o.length;l++)if(n===o[l])return 0;return qA(i,t,e,n,r)}mr.heapPush=Rw;function qA(i,t,e,n,r){var o=i[0][t],s=i[1][t],a=i[2][t];if(e>=s[0])return 0;s[0]=e,o[0]=n,a[0]=r;for(var l=0,c=0;;){var u=2*l+1,h=u+1,p=i[0][0].length;if(u>=p)break;if(h>=p)if(s[u]>e)c=u;else break;else if(s[u]>=s[h])if(e<s[u])c=u;else break;else if(e<s[h])c=h;else break;s[l]=s[c],o[l]=o[c],a[l]=a[c],l=c}return s[l]=e,o[l]=n,a[l]=r,1}mr.uncheckedHeapPush=qA;function lX(i,t,e,n,r){for(var o=jA(t,n),s=0;s<t;s++)for(var a=0;a<e;a++)if(!(i[0][s][a]<0)){var l=i[0][s][a],c=i[2][s][a],u=gp.tauRand(r);Rw(o,s,u,l,c),Rw(o,l,u,s,c),i[2][s][a]=0}return o}mr.buildCandidates=lX;function cX(i){for(var t=i[0],e=i[1],n=0;n<t.length;n++)for(var r=t[n],o=e[n],s=0;s<r.length-1;s++){var a=r.length-s-1,l=o.length-s-1,c=r[0];r[0]=r[a],r[a]=c;var u=o[0];o[0]=o[l],o[l]=u,uX(o,r,l,0)}return{indices:t,weights:e}}mr.deheapSort=cX;function uX(i,t,e,n){for(;n*2+1<e;){var r=n*2+1,o=r+1,s=n;if(i[s]<i[r]&&(s=r),o<e&&i[s]<i[o]&&(s=o),s===n)break;var a=i[n];i[n]=i[s],i[s]=a;var l=t[n];t[n]=t[s],t[s]=l,n=s}}function hX(i,t){for(var e=i[0][t],n=i[1][t],r=i[2][t],o=1/0,s=-1,a=0;a>e.length;a++)r[a]===1&&n[a]<o&&(o=n[a],s=a);return s>=0?(r[s]=0,Math.floor(e[s])):-1}mr.smallestFlagged=hX});var Nw=un(Cn=>{"use strict";var Gg=Cn&&Cn.__read||function(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var n=e.call(i),r,o=[],s;try{for(;(t===void 0||t-- >0)&&!(r=n.next()).done;)o.push(r.value)}catch(a){s={error:a}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(s)throw s.error}}return o},pX=Cn&&Cn.__values||function(i){var t=typeof Symbol=="function"&&i[Symbol.iterator],e=0;return t?t.call(i):{next:function(){return i&&e>=i.length&&(i=void 0),{value:i&&i[e++],done:!i}}}},fX=Cn&&Cn.__importStar||function(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)Object.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t.default=i,t};Object.defineProperty(Cn,"__esModule",{value:!0});var xp,XA=fX(Mc()),Ec=function(){function i(t,e,n,r){if(this.entries=new Map,this.nRows=0,this.nCols=0,t.length!==e.length||t.length!==n.length)throw new Error("rows, cols and values arrays must all have the same length");this.nRows=r[0],this.nCols=r[1];for(var o=0;o<n.length;o++){var s=t[o],a=e[o];this.checkDims(s,a);var l=this.makeKey(s,a);this.entries.set(l,{value:n[o],row:s,col:a})}}return i.prototype.makeKey=function(t,e){return t+":"+e},i.prototype.checkDims=function(t,e){var n=t<this.nRows&&e<this.nCols;if(!n)throw new Error("row and/or col specified outside of matrix dimensions")},i.prototype.set=function(t,e,n){this.checkDims(t,e);var r=this.makeKey(t,e);this.entries.has(r)?this.entries.get(r).value=n:this.entries.set(r,{value:n,row:t,col:e})},i.prototype.get=function(t,e,n){n===void 0&&(n=0),this.checkDims(t,e);var r=this.makeKey(t,e);return this.entries.has(r)?this.entries.get(r).value:n},i.prototype.getAll=function(t){t===void 0&&(t=!0);var e=[];return this.entries.forEach(function(n){e.push(n)}),t&&e.sort(function(n,r){return n.row===r.row?n.col-r.col:n.row-r.row}),e},i.prototype.getDims=function(){return[this.nRows,this.nCols]},i.prototype.getRows=function(){return Array.from(this.entries,function(t){var e=Gg(t,2),n=e[0],r=e[1];return r.row})},i.prototype.getCols=function(){return Array.from(this.entries,function(t){var e=Gg(t,2),n=e[0],r=e[1];return r.col})},i.prototype.getValues=function(){return Array.from(this.entries,function(t){var e=Gg(t,2),n=e[0],r=e[1];return r.value})},i.prototype.forEach=function(t){this.entries.forEach(function(e){return t(e.value,e.row,e.col)})},i.prototype.map=function(t){var e=[];this.entries.forEach(function(r){e.push(t(r.value,r.row,r.col))});var n=[this.nRows,this.nCols];return new i(this.getRows(),this.getCols(),e,n)},i.prototype.toArray=function(){var t=this,e=XA.empty(this.nRows),n=e.map(function(){return XA.zeros(t.nCols)});return this.entries.forEach(function(r){n[r.row][r.col]=r.value}),n},i}();Cn.SparseMatrix=Ec;function dX(i){var t=[],e=[],n=[];i.forEach(function(o,s,a){t.push(s),e.push(a),n.push(o)});var r=[i.nCols,i.nRows];return new Ec(e,t,n,r)}Cn.transpose=dX;function mX(i){for(var t=Gg(i,1),e=t[0],n=new Ec([],[],[],i),r=0;r<e;r++)n.set(r,r,1);return n}Cn.identity=mX;function gX(i,t){return jg(i,t,function(e,n){return e*n})}Cn.pairwiseMultiply=gX;function xX(i,t){return jg(i,t,function(e,n){return e+n})}Cn.add=xX;function yX(i,t){return jg(i,t,function(e,n){return e-n})}Cn.subtract=yX;function vX(i,t){return jg(i,t,function(e,n){return e>n?e:n})}Cn.maximum=vX;function bX(i,t){return i.map(function(e){return e*t})}Cn.multiplyScalar=bX;function _X(i){for(var t=new Set,e=i.getValues(),n=i.getRows(),r=i.getCols(),o=0;o<e.length;o++)e[o]===0&&t.add(o);var s=function(u,h){return!t.has(h)},a=e.filter(s),l=n.filter(s),c=r.filter(s);return new Ec(l,c,a,i.getDims())}Cn.eliminateZeros=_X;function wX(i,t){t===void 0&&(t="l2");var e,n,r=SX[t],o=new Map;i.forEach(function(h,p,f){var d=o.get(p)||[];d.push(f),o.set(p,d)});var s=new Ec([],[],[],i.getDims()),a=function(h){for(var p=o.get(h).sort(),f=p.map(function(x){return i.get(h,x)}),d=r(f),m=0;m<d.length;m++)s.set(h,p[m],d[m])};try{for(var l=pX(o.keys()),c=l.next();!c.done;c=l.next()){var u=c.value;a(u)}}catch(h){e={error:h}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return s}Cn.normalize=wX;var SX=(xp={},xp.max=function(i){for(var t=-1/0,e=0;e<i.length;e++)t=i[e]>t?i[e]:t;return i.map(function(n){return n/t})},xp.l1=function(i){for(var t=0,e=0;e<i.length;e++)t+=i[e];return i.map(function(n){return n/t})},xp.l2=function(i){for(var t=0,e=0;e<i.length;e++)t+=Math.pow(i[e],2);return i.map(function(n){return Math.sqrt(Math.pow(n,2)/t)})},xp);function jg(i,t,e){for(var n=new Set,r=[],o=[],s=[],a=function(b,v){r.push(b),o.push(v);var _=e(i.get(b,v),t.get(b,v));s.push(_)},l=i.getValues(),c=i.getRows(),u=i.getCols(),h=0;h<l.length;h++){var p=c[h],f=u[h],d=p+":"+f;n.add(d),a(p,f)}for(var m=t.getValues(),x=t.getRows(),g=t.getCols(),h=0;h<m.length;h++){var p=x[h],f=g[h],d=p+":"+f;n.has(d)||a(p,f)}var y=[i.nRows,i.nCols];return new Ec(r,o,s,y)}function CX(i){var t=[];i.forEach(function(h,p,f){t.push({value:h,row:p,col:f})}),t.sort(function(h,p){return h.row===p.row?h.col-p.col:h.row-p.row});for(var e=[],n=[],r=[],o=-1,s=0;s<t.length;s++){var a=t[s],l=a.row,c=a.col,u=a.value;l!==o&&(o=l,r.push(s)),e.push(c),n.push(u)}return{indices:e,values:n,indptr:r}}Cn.getCSR=CX});var Ow=un(yi=>{"use strict";var MX=yi&&yi.__read||function(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var n=e.call(i),r,o=[],s;try{for(;(t===void 0||t-- >0)&&!(r=n.next()).done;)o.push(r.value)}catch(a){s={error:a}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(s)throw s.error}}return o},KA=yi&&yi.__spread||function(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(MX(arguments[t]));return i},EX=yi&&yi.__values||function(i){var t=typeof Symbol=="function"&&i[Symbol.iterator],e=0;return t?t.call(i):{next:function(){return i&&e>=i.length&&(i=void 0),{value:i&&i[e++],done:!i}}}},TX=yi&&yi.__importStar||function(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)Object.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t.default=i,t};Object.defineProperty(yi,"__esModule",{value:!0});var Qn=TX(Mc()),YA=function(){function i(t,e,n,r){this.hyperplanes=t,this.offsets=e,this.children=n,this.indices=r}return i}();yi.FlatTree=YA;function IX(i,t,e,n){var r=Math.max(10,t),o=Qn.range(e).map(function(a,l){return AX(i,r,l,n)}),s=o.map(function(a){return RX(a,r)});return s}yi.makeForest=IX;function AX(i,t,e,n){t===void 0&&(t=30);var r=Qn.range(i.length),o=Lw(i,r,t,e,n);return o}function Lw(i,t,e,n,r){if(e===void 0&&(e=30),t.length>e){var o=kX(i,t,r),s=o.indicesLeft,a=o.indicesRight,l=o.hyperplane,c=o.offset,u=Lw(i,s,e,n+1,r),h=Lw(i,a,e,n+1,r),p={leftChild:u,rightChild:h,isLeaf:!1,hyperplane:l,offset:c};return p}else{var p={indices:t,isLeaf:!0};return p}}function kX(i,t,e){var n=i[0].length,r=Qn.tauRandInt(t.length,e),o=Qn.tauRandInt(t.length,e);o+=r===o?1:0,o=o%t.length;for(var s=t[r],a=t[o],l=0,c=Qn.zeros(n),u=0;u<c.length;u++)c[u]=i[s][u]-i[a][u],l-=c[u]*(i[s][u]+i[a][u])/2;for(var h=0,p=0,f=Qn.zeros(t.length),u=0;u<t.length;u++){for(var d=l,m=0;m<n;m++)d+=c[m]*i[t[u]][m];d===0?(f[u]=Qn.tauRandInt(2,e),f[u]===0?h+=1:p+=1):d>0?(f[u]=0,h+=1):(f[u]=1,p+=1)}var x=Qn.zeros(h),g=Qn.zeros(p);h=0,p=0;for(var u=0;u<f.length;u++)f[u]===0?(x[h]=t[u],h+=1):(g[p]=t[u],p+=1);return{indicesLeft:x,indicesRight:g,hyperplane:c,offset:l}}function RX(i,t){var e=zw(i),n=Fw(i),r=Qn.range(e).map(function(){return Qn.zeros(i.hyperplane?i.hyperplane.length:0)}),o=Qn.zeros(e),s=Qn.range(e).map(function(){return[-1,-1]}),a=Qn.range(n).map(function(){return Qn.range(t).map(function(){return-1})});return Dw(i,r,o,s,a,0,0),new YA(r,o,s,a)}function Dw(i,t,e,n,r,o,s){var a;if(i.isLeaf)return n[o][0]=-s,(a=r[s]).splice.apply(a,KA([0,i.indices.length],i.indices)),s+=1,{nodeNum:o,leafNum:s};t[o]=i.hyperplane,e[o]=i.offset,n[o][0]=o+1;var l=o,c=Dw(i.leftChild,t,e,n,r,o+1,s);return o=c.nodeNum,s=c.leafNum,n[l][1]=o+1,c=Dw(i.rightChild,t,e,n,r,o+1,s),{nodeNum:c.nodeNum,leafNum:c.leafNum}}function zw(i){return i.isLeaf?1:1+zw(i.leftChild)+zw(i.rightChild)}function Fw(i){return i.isLeaf?1:Fw(i.leftChild)+Fw(i.rightChild)}function PX(i){var t,e;if(i.length>0){var n=[];try{for(var r=EX(i),o=r.next();!o.done;o=r.next()){var s=o.value;n.push.apply(n,KA(s.indices))}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n}else return[[-1]]}yi.makeLeafArray=PX;function NX(i,t,e,n){for(var r=t,o=0;o<e.length;o++)r+=i[o]*e[o];if(r===0){var s=Qn.tauRandInt(2,n);return s}else return r>0?0:1}function LX(i,t,e){for(var n=0;t.children[n][0]>0;){var r=NX(t.hyperplanes[n],t.offsets[n],i,e);r===0?n=t.children[n][0]:n=t.children[n][1]}var o=-1*t.children[n][0];return t.indices[o]}yi.searchFlatTree=LX});var QA=un(jr=>{"use strict";var ZA=jr&&jr.__values||function(i){var t=typeof Symbol=="function"&&i[Symbol.iterator],e=0;return t?t.call(i):{next:function(){return i&&e>=i.length&&(i=void 0),{value:i&&i[e++],done:!i}}}},qg=jr&&jr.__importStar||function(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)Object.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t.default=i,t};Object.defineProperty(jr,"__esModule",{value:!0});var ci=qg(Pw()),DX=qg(Nw()),zX=qg(Ow()),JA=qg(Mc());function FX(i,t){return function(n,r,o,s,a,l,c,u){s===void 0&&(s=10),a===void 0&&(a=50),l===void 0&&(l=.001),c===void 0&&(c=.5),u===void 0&&(u=!0);for(var h=n.length,p=ci.makeHeap(n.length,o),f=0;f<n.length;f++)for(var d=ci.rejectionSample(o,n.length,t),m=0;m<d.length;m++){var x=i(n[f],n[d[m]]);ci.heapPush(p,f,x,d[m],1),ci.heapPush(p,d[m],x,f,1)}if(u)for(var g=0;g<r.length;g++)for(var f=0;f<r[g].length&&!(r[g][f]<0);f++)for(var m=f+1;m<r[g].length&&!(r[g][m]<0);m++){var x=i(n[r[g][f]],n[r[g][m]]);ci.heapPush(p,r[g][f],x,r[g][m],1),ci.heapPush(p,r[g][m],x,r[g][f],1)}for(var g=0;g<s;g++){for(var y=ci.buildCandidates(p,h,o,a,t),b=0,f=0;f<h;f++)for(var m=0;m<a;m++){var v=Math.floor(y[0][f][m]);if(!(v<0||JA.tauRand(t)<c))for(var _=0;_<a;_++){var S=Math.floor(y[0][f][_]),E=y[2][f][m],M=y[2][f][_];if(!(S<0||!E&&!M)){var x=i(n[v],n[S]);b+=ci.heapPush(p,v,x,S,1),b+=ci.heapPush(p,S,x,v,1)}}}if(b<=l*o*n.length)break}var N=ci.deheapSort(p);return N}}jr.makeNNDescent=FX;function OX(i){function t(n,r,o,s,a){for(var l=0;l<o.length;l++)for(var c=JA.rejectionSample(n,r.length,a),u=0;u<c.length;u++)if(!(c[u]<0)){var h=i(r[c[u]],o[l]);ci.heapPush(s,l,h,c[u],1)}}function e(n,r,o,s,a){for(var l=0;l<o.length;l++)for(var c=zX.searchFlatTree(o[l],n,a),u=0;u<c.length;u++){if(c[u]<0)return;var h=i(r[c[u]],o[l]);ci.heapPush(s,l,h,c[u],1)}}return{initFromRandom:t,initFromTree:e}}jr.makeInitializations=OX;function BX(i){return function(e,n,r,o){for(var s,a,l=DX.getCSR(n),c=l.indices,u=l.indptr,h=0;h<o.length;h++)for(var p=new Set(r[0][h]);;){var f=ci.smallestFlagged(r,h);if(f===-1)break;var d=c.slice(u[f],u[f+1]);try{for(var m=ZA(d),x=m.next();!x.done;x=m.next()){var g=x.value;if(!(g===f||g===-1||p.has(g))){var y=i(e[g],o[h]);ci.uncheckedHeapPush(r,h,y,g,1),p.add(g)}}}catch(b){s={error:b}}finally{try{x&&!x.done&&(a=m.return)&&a.call(m)}finally{if(s)throw s.error}}}return r}}jr.makeInitializedNNSearch=BX;function VX(i,t,e,n,r,o,s){var a,l,c=ci.makeHeap(e.length,n);if(r(n,t,e,c,s),i)try{for(var u=ZA(i),h=u.next();!h.done;h=u.next()){var p=h.value;o(p,t,e,c,s)}}catch(f){a={error:f}}finally{try{h&&!h.done&&(l=u.return)&&l.call(u)}finally{if(a)throw a.error}}return c}jr.initializeSearch=VX});function yp(i){return HX.call(i).endsWith("Array]")}var HX,tk=He(()=>{HX=Object.prototype.toString});function Xg(i,t,e){let n=0,r=e(t);for(let o=0;o<i.x.length;o++)n+=Math.abs(i.y[o]-r(i.x[o]));return n}var ek=He(()=>{});function Kg(i){return $X.call(i).endsWith("Array]")}var $X,nk=He(()=>{$X=Object.prototype.toString});function Bw(i){return UX.call(i).endsWith("Array]")}var UX,ik=He(()=>{UX=Object.prototype.toString});function WX(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Bw(i))throw new TypeError("input must be an array");if(i.length===0)throw new TypeError("input must not be empty");var e=t.fromIndex,n=e===void 0?0:e,r=t.toIndex,o=r===void 0?i.length:r;if(n<0||n>=i.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>i.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=i[n],a=n+1;a<o;a++)i[a]>s&&(s=i[a]);return s}var rk,ok=He(()=>{ik();rk=WX});function Vw(i){return GX.call(i).endsWith("Array]")}var GX,sk=He(()=>{GX=Object.prototype.toString});function jX(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Vw(i))throw new TypeError("input must be an array");if(i.length===0)throw new TypeError("input must not be empty");var e=t.fromIndex,n=e===void 0?0:e,r=t.toIndex,o=r===void 0?i.length:r;if(n<0||n>=i.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>i.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=i[n],a=n+1;a<o;a++)i[a]<s&&(s=i[a]);return s}var ak,lk=He(()=>{sk();ak=jX});function qX(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Kg(i)){if(i.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var e;if(t.output!==void 0){if(!Kg(t.output))throw new TypeError("output option must be an array if specified");e=t.output}else e=new Array(i.length);var n=ak(i),r=rk(i);if(n===r)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=t.min,s=o===void 0?t.autoMinMax?n:0:o,a=t.max,l=a===void 0?t.autoMinMax?r:1:a;if(s>=l)throw new RangeError("min option must be smaller than max option");for(var c=(l-s)/(r-n),u=0;u<i.length;u++)e[u]=(i[u]-n)*c+s;return e}var Hw,ck=He(()=>{nk();ok();lk();Hw=qX});function hk(){return $w(this)}function $w(i,t={}){let{maxRows:e=15,maxColumns:n=10,maxNumSize:r=8}=t;return`${i.constructor.name} {
${Yg}[
${uk}${XX(i,e,n,r)}
${Yg}]
${Yg}rows: ${i.rows}
${Yg}columns: ${i.columns}
}`}function XX(i,t,e,n){let{rows:r,columns:o}=i,s=Math.min(r,t),a=Math.min(o,e),l=[];for(let c=0;c<s;c++){let u=[];for(let h=0;h<a;h++)u.push(KX(i.get(c,h),n));l.push(`${u.join(" ")}`)}return a!==o&&(l[l.length-1]+=` ... ${o-e} more columns`),s!==r&&l.push(`... ${r-t} more rows`),l.join(`
${uk}`)}function KX(i,t){let e=String(i);if(e.length<=t)return e.padEnd(t," ");let n=i.toPrecision(t-2);if(n.length<=t)return n;let r=i.toExponential(t-2),o=r.indexOf("e"),s=r.slice(o);return r.slice(0,t-s.length)+s}var Yg,uk,pk=He(()=>{Yg=" ".repeat(2),uk=" ".repeat(4)});function fk(i,t){i.prototype.add=function(n){return typeof n=="number"?this.addS(n):this.addM(n)},i.prototype.addS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)+n);return this},i.prototype.addM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)+n.get(r,o));return this},i.add=function(n,r){return new t(n).add(r)},i.prototype.sub=function(n){return typeof n=="number"?this.subS(n):this.subM(n)},i.prototype.subS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)-n);return this},i.prototype.subM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)-n.get(r,o));return this},i.sub=function(n,r){return new t(n).sub(r)},i.prototype.subtract=i.prototype.sub,i.prototype.subtractS=i.prototype.subS,i.prototype.subtractM=i.prototype.subM,i.subtract=i.sub,i.prototype.mul=function(n){return typeof n=="number"?this.mulS(n):this.mulM(n)},i.prototype.mulS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)*n);return this},i.prototype.mulM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)*n.get(r,o));return this},i.mul=function(n,r){return new t(n).mul(r)},i.prototype.multiply=i.prototype.mul,i.prototype.multiplyS=i.prototype.mulS,i.prototype.multiplyM=i.prototype.mulM,i.multiply=i.mul,i.prototype.div=function(n){return typeof n=="number"?this.divS(n):this.divM(n)},i.prototype.divS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)/n);return this},i.prototype.divM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)/n.get(r,o));return this},i.div=function(n,r){return new t(n).div(r)},i.prototype.divide=i.prototype.div,i.prototype.divideS=i.prototype.divS,i.prototype.divideM=i.prototype.divM,i.divide=i.div,i.prototype.mod=function(n){return typeof n=="number"?this.modS(n):this.modM(n)},i.prototype.modS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)%n);return this},i.prototype.modM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)%n.get(r,o));return this},i.mod=function(n,r){return new t(n).mod(r)},i.prototype.modulus=i.prototype.mod,i.prototype.modulusS=i.prototype.modS,i.prototype.modulusM=i.prototype.modM,i.modulus=i.mod,i.prototype.and=function(n){return typeof n=="number"?this.andS(n):this.andM(n)},i.prototype.andS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)&n);return this},i.prototype.andM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)&n.get(r,o));return this},i.and=function(n,r){return new t(n).and(r)},i.prototype.or=function(n){return typeof n=="number"?this.orS(n):this.orM(n)},i.prototype.orS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)|n);return this},i.prototype.orM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)|n.get(r,o));return this},i.or=function(n,r){return new t(n).or(r)},i.prototype.xor=function(n){return typeof n=="number"?this.xorS(n):this.xorM(n)},i.prototype.xorS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)^n);return this},i.prototype.xorM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)^n.get(r,o));return this},i.xor=function(n,r){return new t(n).xor(r)},i.prototype.leftShift=function(n){return typeof n=="number"?this.leftShiftS(n):this.leftShiftM(n)},i.prototype.leftShiftS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)<<n);return this},i.prototype.leftShiftM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)<<n.get(r,o));return this},i.leftShift=function(n,r){return new t(n).leftShift(r)},i.prototype.signPropagatingRightShift=function(n){return typeof n=="number"?this.signPropagatingRightShiftS(n):this.signPropagatingRightShiftM(n)},i.prototype.signPropagatingRightShiftS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)>>n);return this},i.prototype.signPropagatingRightShiftM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)>>n.get(r,o));return this},i.signPropagatingRightShift=function(n,r){return new t(n).signPropagatingRightShift(r)},i.prototype.rightShift=function(n){return typeof n=="number"?this.rightShiftS(n):this.rightShiftM(n)},i.prototype.rightShiftS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)>>>n);return this},i.prototype.rightShiftM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)>>>n.get(r,o));return this},i.rightShift=function(n,r){return new t(n).rightShift(r)},i.prototype.zeroFillRightShift=i.prototype.rightShift,i.prototype.zeroFillRightShiftS=i.prototype.rightShiftS,i.prototype.zeroFillRightShiftM=i.prototype.rightShiftM,i.zeroFillRightShift=i.rightShift,i.prototype.not=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,~this.get(n,r));return this},i.not=function(n){return new t(n).not()},i.prototype.abs=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.abs(this.get(n,r)));return this},i.abs=function(n){return new t(n).abs()},i.prototype.acos=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.acos(this.get(n,r)));return this},i.acos=function(n){return new t(n).acos()},i.prototype.acosh=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.acosh(this.get(n,r)));return this},i.acosh=function(n){return new t(n).acosh()},i.prototype.asin=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.asin(this.get(n,r)));return this},i.asin=function(n){return new t(n).asin()},i.prototype.asinh=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.asinh(this.get(n,r)));return this},i.asinh=function(n){return new t(n).asinh()},i.prototype.atan=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.atan(this.get(n,r)));return this},i.atan=function(n){return new t(n).atan()},i.prototype.atanh=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.atanh(this.get(n,r)));return this},i.atanh=function(n){return new t(n).atanh()},i.prototype.cbrt=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.cbrt(this.get(n,r)));return this},i.cbrt=function(n){return new t(n).cbrt()},i.prototype.ceil=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.ceil(this.get(n,r)));return this},i.ceil=function(n){return new t(n).ceil()},i.prototype.clz32=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.clz32(this.get(n,r)));return this},i.clz32=function(n){return new t(n).clz32()},i.prototype.cos=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.cos(this.get(n,r)));return this},i.cos=function(n){return new t(n).cos()},i.prototype.cosh=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.cosh(this.get(n,r)));return this},i.cosh=function(n){return new t(n).cosh()},i.prototype.exp=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.exp(this.get(n,r)));return this},i.exp=function(n){return new t(n).exp()},i.prototype.expm1=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.expm1(this.get(n,r)));return this},i.expm1=function(n){return new t(n).expm1()},i.prototype.floor=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.floor(this.get(n,r)));return this},i.floor=function(n){return new t(n).floor()},i.prototype.fround=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.fround(this.get(n,r)));return this},i.fround=function(n){return new t(n).fround()},i.prototype.log=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.log(this.get(n,r)));return this},i.log=function(n){return new t(n).log()},i.prototype.log1p=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.log1p(this.get(n,r)));return this},i.log1p=function(n){return new t(n).log1p()},i.prototype.log10=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.log10(this.get(n,r)));return this},i.log10=function(n){return new t(n).log10()},i.prototype.log2=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.log2(this.get(n,r)));return this},i.log2=function(n){return new t(n).log2()},i.prototype.round=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.round(this.get(n,r)));return this},i.round=function(n){return new t(n).round()},i.prototype.sign=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.sign(this.get(n,r)));return this},i.sign=function(n){return new t(n).sign()},i.prototype.sin=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.sin(this.get(n,r)));return this},i.sin=function(n){return new t(n).sin()},i.prototype.sinh=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.sinh(this.get(n,r)));return this},i.sinh=function(n){return new t(n).sinh()},i.prototype.sqrt=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.sqrt(this.get(n,r)));return this},i.sqrt=function(n){return new t(n).sqrt()},i.prototype.tan=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.tan(this.get(n,r)));return this},i.tan=function(n){return new t(n).tan()},i.prototype.tanh=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.tanh(this.get(n,r)));return this},i.tanh=function(n){return new t(n).tanh()},i.prototype.trunc=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.trunc(this.get(n,r)));return this},i.trunc=function(n){return new t(n).trunc()},i.pow=function(n,r){return new t(n).pow(r)},i.prototype.pow=function(n){return typeof n=="number"?this.powS(n):this.powM(n)},i.prototype.powS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,Math.pow(this.get(r,o),n));return this},i.prototype.powM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,Math.pow(this.get(r,o),n.get(r,o)));return this}}var dk=He(()=>{});function Wi(i,t,e){let n=e?i.rows:i.rows-1;if(t<0||t>n)throw new RangeError("Row index out of range")}function Gi(i,t,e){let n=e?i.columns:i.columns-1;if(t<0||t>n)throw new RangeError("Column index out of range")}function Aa(i,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==i.columns)throw new RangeError("vector size must be the same as the number of columns");return t}function ka(i,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==i.rows)throw new RangeError("vector size must be the same as the number of rows");return t}function mk(i,t,e){return{row:YX(i,t),column:ZX(i,e)}}function YX(i,t){if(typeof t!="object")throw new TypeError("unexpected type for row indices");if(t.some(n=>n<0||n>=i.rows))throw new RangeError("row indices are out of range");return Array.isArray(t)||(t=Array.from(t)),t}function ZX(i,t){if(typeof t!="object")throw new TypeError("unexpected type for column indices");if(t.some(n=>n<0||n>=i.columns))throw new RangeError("column indices are out of range");return Array.isArray(t)||(t=Array.from(t)),t}function Uw(i,t,e,n,r){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Zg("startRow",t),Zg("endRow",e),Zg("startColumn",n),Zg("endColumn",r),t>e||n>r||t<0||t>=i.rows||e<0||e>=i.rows||n<0||n>=i.columns||r<0||r>=i.columns)throw new RangeError("Submatrix indices are out of range")}function vp(i,t=0){let e=[];for(let n=0;n<i;n++)e.push(t);return e}function Zg(i,t){if(typeof t!="number")throw new TypeError(`${i} must be a number`)}function Ra(i){if(i.isEmpty())throw new Error("Empty matrix has no elements to index")}var Ww=He(()=>{});function gk(i){let t=vp(i.rows);for(let e=0;e<i.rows;++e)for(let n=0;n<i.columns;++n)t[e]+=i.get(e,n);return t}function xk(i){let t=vp(i.columns);for(let e=0;e<i.rows;++e)for(let n=0;n<i.columns;++n)t[n]+=i.get(e,n);return t}function yk(i){let t=0;for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)t+=i.get(e,n);return t}function vk(i){let t=vp(i.rows,1);for(let e=0;e<i.rows;++e)for(let n=0;n<i.columns;++n)t[e]*=i.get(e,n);return t}function bk(i){let t=vp(i.columns,1);for(let e=0;e<i.rows;++e)for(let n=0;n<i.columns;++n)t[n]*=i.get(e,n);return t}function _k(i){let t=1;for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)t*=i.get(e,n);return t}function wk(i,t,e){let n=i.rows,r=i.columns,o=[];for(let s=0;s<n;s++){let a=0,l=0,c=0;for(let u=0;u<r;u++)c=i.get(s,u)-e[s],a+=c,l+=c*c;t?o.push((l-a*a/r)/(r-1)):o.push((l-a*a/r)/r)}return o}function Sk(i,t,e){let n=i.rows,r=i.columns,o=[];for(let s=0;s<r;s++){let a=0,l=0,c=0;for(let u=0;u<n;u++)c=i.get(u,s)-e[s],a+=c,l+=c*c;t?o.push((l-a*a/n)/(n-1)):o.push((l-a*a/n)/n)}return o}function Ck(i,t,e){let n=i.rows,r=i.columns,o=n*r,s=0,a=0,l=0;for(let c=0;c<n;c++)for(let u=0;u<r;u++)l=i.get(c,u)-e,s+=l,a+=l*l;return t?(a-s*s/o)/(o-1):(a-s*s/o)/o}function Mk(i,t){for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)i.set(e,n,i.get(e,n)-t[e])}function Ek(i,t){for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)i.set(e,n,i.get(e,n)-t[n])}function Tk(i,t){for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)i.set(e,n,i.get(e,n)-t)}function Ik(i){let t=[];for(let e=0;e<i.rows;e++){let n=0;for(let r=0;r<i.columns;r++)n+=Math.pow(i.get(e,r),2)/(i.columns-1);t.push(Math.sqrt(n))}return t}function Ak(i,t){for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)i.set(e,n,i.get(e,n)/t[e])}function kk(i){let t=[];for(let e=0;e<i.columns;e++){let n=0;for(let r=0;r<i.rows;r++)n+=Math.pow(i.get(r,e),2)/(i.rows-1);t.push(Math.sqrt(n))}return t}function Rk(i,t){for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)i.set(e,n,i.get(e,n)/t[n])}function Pk(i){let t=i.size-1,e=0;for(let n=0;n<i.columns;n++)for(let r=0;r<i.rows;r++)e+=Math.pow(i.get(r,n),2)/t;return Math.sqrt(e)}function Nk(i,t){for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)i.set(e,n,i.get(e,n)/t)}var Lk=He(()=>{Ww()});function Dk(i,t){return i-t}var le,Wt,Pa=He(()=>{ck();pk();dk();Lk();Ww();le=class{static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("data length does not match given dimensions");let o=new Wt(t,e);for(let s=0;s<t;s++)for(let a=0;a<e;a++)o.set(s,a,n[s*e+a]);return o}static rowVector(t){let e=new Wt(1,t.length);for(let n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){let e=new Wt(t.length,1);for(let n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static zeros(t,e){return new Wt(t,e)}static ones(t,e){return new Wt(t,e).fill(1)}static rand(t,e,n={}){if(typeof n!="object")throw new TypeError("options must be an object");let{random:r=Math.random}=n,o=new Wt(t,e);for(let s=0;s<t;s++)for(let a=0;a<e;a++)o.set(s,a,r());return o}static randInt(t,e,n={}){if(typeof n!="object")throw new TypeError("options must be an object");let{min:r=0,max:o=1e3,random:s=Math.random}=n;if(!Number.isInteger(r))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(r>=o)throw new RangeError("min must be smaller than max");let a=o-r,l=new Wt(t,e);for(let c=0;c<t;c++)for(let u=0;u<e;u++){let h=r+Math.round(s()*a);l.set(c,u,h)}return l}static eye(t,e,n){e===void 0&&(e=t),n===void 0&&(n=1);let r=Math.min(t,e),o=this.zeros(t,e);for(let s=0;s<r;s++)o.set(s,s,n);return o}static diag(t,e,n){let r=t.length;e===void 0&&(e=r),n===void 0&&(n=e);let o=Math.min(r,e,n),s=this.zeros(e,n);for(let a=0;a<o;a++)s.set(a,a,t[a]);return s}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,r=t.columns,o=new Wt(n,r);for(let s=0;s<n;s++)for(let a=0;a<r;a++)o.set(s,a,Math.min(t.get(s,a),e.get(s,a)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,r=t.columns,o=new this(n,r);for(let s=0;s<n;s++)for(let a=0;a<r;a++)o.set(s,a,Math.max(t.get(s,a),e.get(s,a)));return o}static checkMatrix(t){return le.isMatrix(t)?t:new Wt(t)}static isMatrix(t){return t!=null&&t.klass==="Matrix"}get size(){return this.rows*this.columns}apply(t){if(typeof t!="function")throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.call(this,e,n);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let n=0;n<this.columns;n++)t[e].push(this.get(e,n))}return t}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,n=-1,r=!0,o=!1;for(;t<this.rows&&r;){for(e=0,o=!1;e<this.columns&&o===!1;)this.get(t,e)===0?e++:this.get(t,e)===1&&e>n?(o=!0,n=e):(r=!1,o=!0);t++}return r}isReducedEchelonForm(){let t=0,e=0,n=-1,r=!0,o=!1;for(;t<this.rows&&r;){for(e=0,o=!1;e<this.columns&&o===!1;)this.get(t,e)===0?e++:this.get(t,e)===1&&e>n?(o=!0,n=e):(r=!1,o=!0);for(let s=e+1;s<this.rows;s++)this.get(t,s)!==0&&(r=!1);t++}return r}echelonForm(){let t=this.clone(),e=0,n=0;for(;e<t.rows&&n<t.columns;){let r=e;for(let o=e;o<t.rows;o++)t.get(o,n)>t.get(r,n)&&(r=o);if(t.get(r,n)===0)n++;else{t.swapRows(e,r);let o=t.get(e,n);for(let s=n;s<t.columns;s++)t.set(e,s,t.get(e,s)/o);for(let s=e+1;s<t.rows;s++){let a=t.get(s,n)/t.get(e,n);t.set(s,n,0);for(let l=n+1;l<t.columns;l++)t.set(s,l,t.get(s,l)-t.get(e,l)*a)}e++,n++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,n=t.rows,r=n-1;for(;r>=0;)if(t.maxRow(r)===0)r--;else{let o=0,s=!1;for(;o<n&&s===!1;)t.get(r,o)===1?s=!0:o++;for(let a=0;a<r;a++){let l=t.get(a,o);for(let c=o;c<e;c++){let u=t.get(a,c)-l*t.get(r,c);t.set(a,c,u)}}r--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if(typeof t!="object")throw new TypeError("options must be an object");let{rows:e=1,columns:n=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let r=new Wt(this.rows*e,this.columns*n);for(let o=0;o<e;o++)for(let s=0;s<n;s++)r.setSubMatrix(this,this.rows*o,this.columns*s);return r}fill(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){Wi(this,t);let e=[];for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}getRowVector(t){return Wt.rowVector(this.getRow(t))}setRow(t,e){Wi(this,t),e=Aa(this,e);for(let n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){Wi(this,t),Wi(this,e);for(let n=0;n<this.columns;n++){let r=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,r)}return this}getColumn(t){Gi(this,t);let e=[];for(let n=0;n<this.rows;n++)e.push(this.get(n,t));return e}getColumnVector(t){return Wt.columnVector(this.getColumn(t))}setColumn(t,e){Gi(this,t),e=ka(this,e);for(let n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){Gi(this,t),Gi(this,e);for(let n=0;n<this.rows;n++){let r=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,r)}return this}addRowVector(t){t=Aa(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=Aa(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=Aa(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=Aa(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=ka(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=ka(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=ka(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=ka(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){Wi(this,t);for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){Gi(this,t);for(let n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){if(this.isEmpty())return NaN;let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){Ra(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){if(this.isEmpty())return NaN;let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){Ra(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){if(Wi(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){Wi(this,t),Ra(this);let e=this.get(t,0),n=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){if(Wi(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){Wi(this,t),Ra(this);let e=this.get(t,0),n=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){if(Gi(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){Gi(this,t),Ra(this);let e=this.get(0,t),n=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){if(Gi(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){Gi(this,t),Ra(this);let e=this.get(0,t),n=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let n=0;n<t;n++)e.push(this.get(n,n));return e}norm(t="frobenius"){let e=0;if(t==="max")return this.max();if(t==="frobenius"){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)e=e+this.get(n,r)*this.get(n,r);return Math.sqrt(e)}else throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){le.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let n=0;for(let r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=Wt.checkMatrix(t);let e=this.rows,n=this.columns,r=t.columns,o=new Wt(e,r),s=new Float64Array(n);for(let a=0;a<r;a++){for(let l=0;l<n;l++)s[l]=t.get(l,a);for(let l=0;l<e;l++){let c=0;for(let u=0;u<n;u++)c+=this.get(l,u)*s[u];o.set(l,a,c)}}return o}strassen2x2(t){t=Wt.checkMatrix(t);let e=new Wt(2,2),n=this.get(0,0),r=t.get(0,0),o=this.get(0,1),s=t.get(0,1),a=this.get(1,0),l=t.get(1,0),c=this.get(1,1),u=t.get(1,1),h=(n+c)*(r+u),p=(a+c)*r,f=n*(s-u),d=c*(l-r),m=(n+o)*u,x=(a-n)*(r+s),g=(o-c)*(l+u),y=h+d-m+g,b=f+m,v=p+d,_=h-p+f+x;return e.set(0,0,y),e.set(0,1,b),e.set(1,0,v),e.set(1,1,_),e}strassen3x3(t){t=Wt.checkMatrix(t);let e=new Wt(3,3),n=this.get(0,0),r=this.get(0,1),o=this.get(0,2),s=this.get(1,0),a=this.get(1,1),l=this.get(1,2),c=this.get(2,0),u=this.get(2,1),h=this.get(2,2),p=t.get(0,0),f=t.get(0,1),d=t.get(0,2),m=t.get(1,0),x=t.get(1,1),g=t.get(1,2),y=t.get(2,0),b=t.get(2,1),v=t.get(2,2),_=(n+r+o-s-a-u-h)*x,S=(n-s)*(-f+x),E=a*(-p+f+m-x-g-y+v),M=(-n+s+a)*(p-f+x),N=(s+a)*(-p+f),I=n*p,w=(-n+c+u)*(p-d+g),R=(-n+c)*(d-g),P=(c+u)*(-p+d),D=(n+r+o-a-l-c-u)*g,F=u*(-p+d+m-x-g-y+b),z=(-o+u+h)*(x+y-b),V=(o-h)*(x-b),H=o*y,X=(u+h)*(-y+b),U=(-o+a+l)*(g+y-v),Y=(o-l)*(g-v),Z=(a+l)*(-y+v),K=r*m,J=l*b,G=s*d,nt=c*f,et=h*v,at=I+H+K,it=_+M+N+I+z+H+X,St=I+w+P+D+H+U+Z,yt=S+E+M+I+H+U+Y,rt=S+M+N+I+J,vt=H+U+Y+Z+G,ct=I+w+R+F+z+V+H,_t=z+V+H+X+nt,gt=I+w+R+P+et;return e.set(0,0,at),e.set(0,1,it),e.set(0,2,St),e.set(1,0,yt),e.set(1,1,rt),e.set(1,2,vt),e.set(2,0,ct),e.set(2,1,_t),e.set(2,2,gt),e}mmulStrassen(t){t=Wt.checkMatrix(t);let e=this.clone(),n=e.rows,r=e.columns,o=t.rows,s=t.columns;r!==o&&console.warn(`Multiplying ${n} x ${r} and ${o} x ${s} matrix: dimensions do not match.`);function a(h,p,f){let d=h.rows,m=h.columns;if(d===p&&m===f)return h;{let x=le.zeros(p,f);return x=x.setSubMatrix(h,0,0),x}}let l=Math.max(n,o),c=Math.max(r,s);e=a(e,l,c),t=a(t,l,c);function u(h,p,f,d){if(f<=512||d<=512)return h.mmul(p);f%2===1&&d%2===1?(h=a(h,f+1,d+1),p=a(p,f+1,d+1)):f%2===1?(h=a(h,f+1,d),p=a(p,f+1,d)):d%2===1&&(h=a(h,f,d+1),p=a(p,f,d+1));let m=parseInt(h.rows/2,10),x=parseInt(h.columns/2,10),g=h.subMatrix(0,m-1,0,x-1),y=p.subMatrix(0,m-1,0,x-1),b=h.subMatrix(0,m-1,x,h.columns-1),v=p.subMatrix(0,m-1,x,p.columns-1),_=h.subMatrix(m,h.rows-1,0,x-1),S=p.subMatrix(m,p.rows-1,0,x-1),E=h.subMatrix(m,h.rows-1,x,h.columns-1),M=p.subMatrix(m,p.rows-1,x,p.columns-1),N=u(le.add(g,E),le.add(y,M),m,x),I=u(le.add(_,E),y,m,x),w=u(g,le.sub(v,M),m,x),R=u(E,le.sub(S,y),m,x),P=u(le.add(g,b),M,m,x),D=u(le.sub(_,g),le.add(y,v),m,x),F=u(le.sub(b,E),le.add(S,M),m,x),z=le.add(N,R);z.sub(P),z.add(F);let V=le.add(w,P),H=le.add(I,R),X=le.sub(N,I);X.add(w),X.add(D);let U=le.zeros(2*z.rows,2*z.columns);return U=U.setSubMatrix(z,0,0),U=U.setSubMatrix(V,z.rows,0),U=U.setSubMatrix(H,0,z.columns),U=U.setSubMatrix(X,z.rows,z.columns),U.subMatrix(0,f-1,0,d-1)}return u(e,t,l,c)}scaleRows(t={}){if(typeof t!="object")throw new TypeError("options must be an object");let{min:e=0,max:n=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let r=new Wt(this.rows,this.columns);for(let o=0;o<this.rows;o++){let s=this.getRow(o);s.length>0&&Hw(s,{min:e,max:n,output:s}),r.setRow(o,s)}return r}scaleColumns(t={}){if(typeof t!="object")throw new TypeError("options must be an object");let{min:e=0,max:n=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let r=new Wt(this.rows,this.columns);for(let o=0;o<this.columns;o++){let s=this.getColumn(o);s.length&&Hw(s,{min:e,max:n,output:s}),r.setColumn(o,s)}return r}flipRows(){let t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let n=0;n<t;n++){let r=this.get(e,n),o=this.get(e,this.columns-1-n);this.set(e,n,o),this.set(e,this.columns-1-n,r)}return this}flipColumns(){let t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let n=0;n<t;n++){let r=this.get(n,e),o=this.get(this.rows-1-n,e);this.set(n,e,o),this.set(this.rows-1-n,e,r)}return this}kroneckerProduct(t){t=Wt.checkMatrix(t);let e=this.rows,n=this.columns,r=t.rows,o=t.columns,s=new Wt(e*r,n*o);for(let a=0;a<e;a++)for(let l=0;l<n;l++)for(let c=0;c<r;c++)for(let u=0;u<o;u++)s.set(r*a+c,o*l+u,this.get(a,l)*t.get(c,u));return s}kroneckerSum(t){if(t=Wt.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,n=t.rows,r=this.kroneckerProduct(Wt.eye(n,n)),o=Wt.eye(e,e).kroneckerProduct(t);return r.add(o)}transpose(){let t=new Wt(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t=Dk){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=Dk){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){Uw(this,t,e,n,r);let o=new Wt(e-t+1,r-n+1);for(let s=t;s<=e;s++)for(let a=n;a<=r;a++)o.set(s-t,a-n,this.get(s,a));return o}subMatrixRow(t,e,n){if(e===void 0&&(e=0),n===void 0&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let r=new Wt(t.length,n-e+1);for(let o=0;o<t.length;o++)for(let s=e;s<=n;s++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);r.set(o,s-e,this.get(t[o],s))}return r}subMatrixColumn(t,e,n){if(e===void 0&&(e=0),n===void 0&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let r=new Wt(n-e+1,t.length);for(let o=0;o<t.length;o++)for(let s=e;s<=n;s++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);r.set(s-e,o,this.get(s,t[o]))}return r}setSubMatrix(t,e,n){if(t=Wt.checkMatrix(t),t.isEmpty())return this;let r=e+t.rows-1,o=n+t.columns-1;Uw(this,e,r,n,o);for(let s=0;s<t.rows;s++)for(let a=0;a<t.columns;a++)this.set(e+s,n+a,t.get(s,a));return this}selection(t,e){let n=mk(this,t,e),r=new Wt(t.length,e.length);for(let o=0;o<n.row.length;o++){let s=n.row[o];for(let a=0;a<n.column.length;a++){let l=n.column[a];r.set(o,a,this.get(s,l))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let n=0;n<t;n++)e+=this.get(n,n);return e}clone(){let t=new Wt(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}sum(t){switch(t){case"row":return gk(this);case"column":return xk(this);case void 0:return yk(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return vk(this);case"column":return bk(this);case void 0:return _k(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){let e=this.sum(t);switch(t){case"row":{for(let n=0;n<this.rows;n++)e[n]/=this.columns;return e}case"column":{for(let n=0;n<this.columns;n++)e[n]/=this.rows;return e}case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if(typeof t=="object"&&(e=t,t=void 0),typeof e!="object")throw new TypeError("options must be an object");let{unbiased:n=!0,mean:r=this.mean(t)}=e;if(typeof n!="boolean")throw new TypeError("unbiased must be a boolean");switch(t){case"row":{if(!Array.isArray(r))throw new TypeError("mean must be an array");return wk(this,n,r)}case"column":{if(!Array.isArray(r))throw new TypeError("mean must be an array");return Sk(this,n,r)}case void 0:{if(typeof r!="number")throw new TypeError("mean must be a number");return Ck(this,n,r)}default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){typeof t=="object"&&(e=t,t=void 0);let n=this.variance(t,e);if(t===void 0)return Math.sqrt(n);for(let r=0;r<n.length;r++)n[r]=Math.sqrt(n[r]);return n}center(t,e={}){if(typeof t=="object"&&(e=t,t=void 0),typeof e!="object")throw new TypeError("options must be an object");let{center:n=this.mean(t)}=e;switch(t){case"row":{if(!Array.isArray(n))throw new TypeError("center must be an array");return Mk(this,n),this}case"column":{if(!Array.isArray(n))throw new TypeError("center must be an array");return Ek(this,n),this}case void 0:{if(typeof n!="number")throw new TypeError("center must be a number");return Tk(this,n),this}default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if(typeof t=="object"&&(e=t,t=void 0),typeof e!="object")throw new TypeError("options must be an object");let n=e.scale;switch(t){case"row":{if(n===void 0)n=Ik(this);else if(!Array.isArray(n))throw new TypeError("scale must be an array");return Ak(this,n),this}case"column":{if(n===void 0)n=kk(this);else if(!Array.isArray(n))throw new TypeError("scale must be an array");return Rk(this,n),this}case void 0:{if(n===void 0)n=Pk(this);else if(typeof n!="number")throw new TypeError("scale must be a number");return Nk(this,n),this}default:throw new Error(`invalid option: ${t}`)}}toString(t){return $w(this,t)}};le.prototype.klass="Matrix";typeof Symbol!="undefined"&&(le.prototype[Symbol.for("nodejs.util.inspect.custom")]=hk);le.random=le.rand;le.randomInt=le.randInt;le.diagonal=le.diag;le.prototype.diagonal=le.prototype.diag;le.identity=le.eye;le.prototype.negate=le.prototype.neg;le.prototype.tensorProduct=le.prototype.kroneckerProduct;Wt=class extends le{constructor(t,e){if(super(),Wt.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0)if(this.data=[],Number.isInteger(e)&&e>=0)for(let n=0;n<t;n++)this.data.push(new Float64Array(e));else throw new TypeError("nColumns must be a positive integer");else if(Array.isArray(t)){let n=t;if(t=n.length,e=t?n[0].length:0,typeof e!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let r=0;r<t;r++){if(n[r].length!==e)throw new RangeError("Inconsistent array dimensions");this.data.push(Float64Array.from(n[r]))}}else throw new TypeError("First argument must be a positive number or an array");this.rows=t,this.columns=e}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}removeRow(t){return Wi(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return e===void 0&&(e=t,t=this.rows),Wi(this,t,!0),e=Float64Array.from(Aa(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){Gi(this,t);for(let e=0;e<this.rows;e++){let n=new Float64Array(this.columns-1);for(let r=0;r<t;r++)n[r]=this.data[e][r];for(let r=t+1;r<this.columns;r++)n[r-1]=this.data[e][r];this.data[e]=n}return this.columns-=1,this}addColumn(t,e){typeof e=="undefined"&&(e=t,t=this.columns),Gi(this,t,!0),e=ka(this,e);for(let n=0;n<this.rows;n++){let r=new Float64Array(this.columns+1),o=0;for(;o<t;o++)r[o]=this.data[n][o];for(r[o++]=e[n];o<this.columns+1;o++)r[o]=this.data[n][o-1];this.data[n]=r}return this.columns+=1,this}};fk(le,Wt)});var zk=He(()=>{});var Ii,bp=He(()=>{Pa();Ii=class extends le{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}}});var _p,Fk=He(()=>{Pa();bp();_p=class{constructor(t){t=Ii.checkMatrix(t);let e=t.clone(),n=e.rows,r=e.columns,o=new Float64Array(n),s=1,a,l,c,u,h,p,f,d,m;for(a=0;a<n;a++)o[a]=a;for(d=new Float64Array(n),l=0;l<r;l++){for(a=0;a<n;a++)d[a]=e.get(a,l);for(a=0;a<n;a++){for(m=Math.min(a,l),h=0,c=0;c<m;c++)h+=e.get(a,c)*d[c];d[a]-=h,e.set(a,l,d[a])}for(u=l,a=l+1;a<n;a++)Math.abs(d[a])>Math.abs(d[u])&&(u=a);if(u!==l){for(c=0;c<r;c++)p=e.get(u,c),e.set(u,c,e.get(l,c)),e.set(l,c,p);f=o[u],o[u]=o[l],o[l]=f,s=-s}if(l<n&&e.get(l,l)!==0)for(a=l+1;a<n;a++)e.set(a,l,e.get(a,l)/e.get(l,l))}this.LU=e,this.pivotVector=o,this.pivotSign=s}isSingular(){let t=this.LU,e=t.columns;for(let n=0;n<e;n++)if(t.get(n,n)===0)return!0;return!1}solve(t){t=Wt.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r=t.columns,o=t.subMatrixRow(this.pivotVector,0,r-1),s=e.columns,a,l,c;for(c=0;c<s;c++)for(a=c+1;a<s;a++)for(l=0;l<r;l++)o.set(a,l,o.get(a,l)-o.get(c,l)*e.get(a,c));for(c=s-1;c>=0;c--){for(l=0;l<r;l++)o.set(c,l,o.get(c,l)/e.get(c,c));for(a=0;a<c;a++)for(l=0;l<r;l++)o.set(a,l,o.get(a,l)-o.get(c,l)*e.get(a,c))}return o}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,n=t.columns;for(let r=0;r<n;r++)e*=t.get(r,r);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,r=new Wt(e,n);for(let o=0;o<e;o++)for(let s=0;s<n;s++)o>s?r.set(o,s,t.get(o,s)):o===s?r.set(o,s,1):r.set(o,s,0);return r}get upperTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,r=new Wt(e,n);for(let o=0;o<e;o++)for(let s=0;s<n;s++)o<=s?r.set(o,s,t.get(o,s)):r.set(o,s,0);return r}get pivotPermutationVector(){return Array.from(this.pivotVector)}}});function Io(i,t){let e=0;return Math.abs(i)>Math.abs(t)?(e=t/i,Math.abs(i)*Math.sqrt(1+e*e)):t!==0?(e=i/t,Math.abs(t)*Math.sqrt(1+e*e)):0}var Gw=He(()=>{});var wp,Ok=He(()=>{Pa();bp();Gw();wp=class{constructor(t){t=Ii.checkMatrix(t);let e=t.clone(),n=t.rows,r=t.columns,o=new Float64Array(r),s,a,l,c;for(l=0;l<r;l++){let u=0;for(s=l;s<n;s++)u=Io(u,e.get(s,l));if(u!==0){for(e.get(l,l)<0&&(u=-u),s=l;s<n;s++)e.set(s,l,e.get(s,l)/u);for(e.set(l,l,e.get(l,l)+1),a=l+1;a<r;a++){for(c=0,s=l;s<n;s++)c+=e.get(s,l)*e.get(s,a);for(c=-c/e.get(l,l),s=l;s<n;s++)e.set(s,a,e.get(s,a)+c*e.get(s,l))}}o[l]=-u}this.QR=e,this.Rdiag=o}solve(t){t=Wt.checkMatrix(t);let e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let r=t.columns,o=t.clone(),s=e.columns,a,l,c,u;for(c=0;c<s;c++)for(l=0;l<r;l++){for(u=0,a=c;a<n;a++)u+=e.get(a,c)*o.get(a,l);for(u=-u/e.get(c,c),a=c;a<n;a++)o.set(a,l,o.get(a,l)+u*e.get(a,c))}for(c=s-1;c>=0;c--){for(l=0;l<r;l++)o.set(c,l,o.get(c,l)/this.Rdiag[c]);for(a=0;a<c;a++)for(l=0;l<r;l++)o.set(a,l,o.get(a,l)-o.get(c,l)*e.get(a,c))}return o.subMatrix(0,s-1,0,r-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(this.Rdiag[e]===0)return!1;return!0}get upperTriangularMatrix(){let t=this.QR,e=t.columns,n=new Wt(e,e),r,o;for(r=0;r<e;r++)for(o=0;o<e;o++)r<o?n.set(r,o,t.get(r,o)):r===o?n.set(r,o,this.Rdiag[r]):n.set(r,o,0);return n}get orthogonalMatrix(){let t=this.QR,e=t.rows,n=t.columns,r=new Wt(e,n),o,s,a,l;for(a=n-1;a>=0;a--){for(o=0;o<e;o++)r.set(o,a,0);for(r.set(a,a,1),s=a;s<n;s++)if(t.get(a,a)!==0){for(l=0,o=a;o<e;o++)l+=t.get(o,a)*r.get(o,s);for(l=-l/t.get(a,a),o=a;o<e;o++)r.set(o,s,r.get(o,s)+l*t.get(o,a))}}return r}}});var Tc,Bk=He(()=>{Pa();bp();Gw();Tc=class{constructor(t,e={}){if(t=Ii.checkMatrix(t),t.isEmpty())throw new Error("Matrix must be non-empty");let n=t.rows,r=t.columns,{computeLeftSingularVectors:o=!0,computeRightSingularVectors:s=!0,autoTranspose:a=!1}=e,l=Boolean(o),c=Boolean(s),u=!1,h;if(n<r)if(!a)h=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{h=t.transpose(),n=h.rows,r=h.columns,u=!0;let w=l;l=c,c=w}else h=t.clone();let p=Math.min(n,r),f=Math.min(n+1,r),d=new Float64Array(f),m=new Wt(n,p),x=new Wt(r,r),g=new Float64Array(r),y=new Float64Array(n),b=new Float64Array(f);for(let w=0;w<f;w++)b[w]=w;let v=Math.min(n-1,r),_=Math.max(0,Math.min(r-2,n)),S=Math.max(v,_);for(let w=0;w<S;w++){if(w<v){d[w]=0;for(let R=w;R<n;R++)d[w]=Io(d[w],h.get(R,w));if(d[w]!==0){h.get(w,w)<0&&(d[w]=-d[w]);for(let R=w;R<n;R++)h.set(R,w,h.get(R,w)/d[w]);h.set(w,w,h.get(w,w)+1)}d[w]=-d[w]}for(let R=w+1;R<r;R++){if(w<v&&d[w]!==0){let P=0;for(let D=w;D<n;D++)P+=h.get(D,w)*h.get(D,R);P=-P/h.get(w,w);for(let D=w;D<n;D++)h.set(D,R,h.get(D,R)+P*h.get(D,w))}g[R]=h.get(w,R)}if(l&&w<v)for(let R=w;R<n;R++)m.set(R,w,h.get(R,w));if(w<_){g[w]=0;for(let R=w+1;R<r;R++)g[w]=Io(g[w],g[R]);if(g[w]!==0){g[w+1]<0&&(g[w]=0-g[w]);for(let R=w+1;R<r;R++)g[R]/=g[w];g[w+1]+=1}if(g[w]=-g[w],w+1<n&&g[w]!==0){for(let R=w+1;R<n;R++)y[R]=0;for(let R=w+1;R<n;R++)for(let P=w+1;P<r;P++)y[R]+=g[P]*h.get(R,P);for(let R=w+1;R<r;R++){let P=-g[R]/g[w+1];for(let D=w+1;D<n;D++)h.set(D,R,h.get(D,R)+P*y[D])}}if(c)for(let R=w+1;R<r;R++)x.set(R,w,g[R])}}let E=Math.min(r,n+1);if(v<r&&(d[v]=h.get(v,v)),n<E&&(d[E-1]=0),_+1<E&&(g[_]=h.get(_,E-1)),g[E-1]=0,l){for(let w=v;w<p;w++){for(let R=0;R<n;R++)m.set(R,w,0);m.set(w,w,1)}for(let w=v-1;w>=0;w--)if(d[w]!==0){for(let R=w+1;R<p;R++){let P=0;for(let D=w;D<n;D++)P+=m.get(D,w)*m.get(D,R);P=-P/m.get(w,w);for(let D=w;D<n;D++)m.set(D,R,m.get(D,R)+P*m.get(D,w))}for(let R=w;R<n;R++)m.set(R,w,-m.get(R,w));m.set(w,w,1+m.get(w,w));for(let R=0;R<w-1;R++)m.set(R,w,0)}else{for(let R=0;R<n;R++)m.set(R,w,0);m.set(w,w,1)}}if(c)for(let w=r-1;w>=0;w--){if(w<_&&g[w]!==0)for(let R=w+1;R<r;R++){let P=0;for(let D=w+1;D<r;D++)P+=x.get(D,w)*x.get(D,R);P=-P/x.get(w+1,w);for(let D=w+1;D<r;D++)x.set(D,R,x.get(D,R)+P*x.get(D,w))}for(let R=0;R<r;R++)x.set(R,w,0);x.set(w,w,1)}let M=E-1,N=0,I=Number.EPSILON;for(;E>0;){let w,R;for(w=E-2;w>=-1&&w!==-1;w--){let P=Number.MIN_VALUE+I*Math.abs(d[w]+Math.abs(d[w+1]));if(Math.abs(g[w])<=P||Number.isNaN(g[w])){g[w]=0;break}}if(w===E-2)R=4;else{let P;for(P=E-1;P>=w&&P!==w;P--){let D=(P!==E?Math.abs(g[P]):0)+(P!==w+1?Math.abs(g[P-1]):0);if(Math.abs(d[P])<=I*D){d[P]=0;break}}P===w?R=3:P===E-1?R=1:(R=2,w=P)}switch(w++,R){case 1:{let P=g[E-2];g[E-2]=0;for(let D=E-2;D>=w;D--){let F=Io(d[D],P),z=d[D]/F,V=P/F;if(d[D]=F,D!==w&&(P=-V*g[D-1],g[D-1]=z*g[D-1]),c)for(let H=0;H<r;H++)F=z*x.get(H,D)+V*x.get(H,E-1),x.set(H,E-1,-V*x.get(H,D)+z*x.get(H,E-1)),x.set(H,D,F)}break}case 2:{let P=g[w-1];g[w-1]=0;for(let D=w;D<E;D++){let F=Io(d[D],P),z=d[D]/F,V=P/F;if(d[D]=F,P=-V*g[D],g[D]=z*g[D],l)for(let H=0;H<n;H++)F=z*m.get(H,D)+V*m.get(H,w-1),m.set(H,w-1,-V*m.get(H,D)+z*m.get(H,w-1)),m.set(H,D,F)}break}case 3:{let P=Math.max(Math.abs(d[E-1]),Math.abs(d[E-2]),Math.abs(g[E-2]),Math.abs(d[w]),Math.abs(g[w])),D=d[E-1]/P,F=d[E-2]/P,z=g[E-2]/P,V=d[w]/P,H=g[w]/P,X=((F+D)*(F-D)+z*z)/2,U=D*z*(D*z),Y=0;(X!==0||U!==0)&&(X<0?Y=0-Math.sqrt(X*X+U):Y=Math.sqrt(X*X+U),Y=U/(X+Y));let Z=(V+D)*(V-D)+Y,K=V*H;for(let J=w;J<E-1;J++){let G=Io(Z,K);G===0&&(G=Number.MIN_VALUE);let nt=Z/G,et=K/G;if(J!==w&&(g[J-1]=G),Z=nt*d[J]+et*g[J],g[J]=nt*g[J]-et*d[J],K=et*d[J+1],d[J+1]=nt*d[J+1],c)for(let at=0;at<r;at++)G=nt*x.get(at,J)+et*x.get(at,J+1),x.set(at,J+1,-et*x.get(at,J)+nt*x.get(at,J+1)),x.set(at,J,G);if(G=Io(Z,K),G===0&&(G=Number.MIN_VALUE),nt=Z/G,et=K/G,d[J]=G,Z=nt*g[J]+et*d[J+1],d[J+1]=-et*g[J]+nt*d[J+1],K=et*g[J+1],g[J+1]=nt*g[J+1],l&&J<n-1)for(let at=0;at<n;at++)G=nt*m.get(at,J)+et*m.get(at,J+1),m.set(at,J+1,-et*m.get(at,J)+nt*m.get(at,J+1)),m.set(at,J,G)}g[E-2]=Z,N=N+1;break}case 4:{if(d[w]<=0&&(d[w]=d[w]<0?-d[w]:0,c))for(let P=0;P<=M;P++)x.set(P,w,-x.get(P,w));for(;w<M&&!(d[w]>=d[w+1]);){let P=d[w];if(d[w]=d[w+1],d[w+1]=P,c&&w<r-1)for(let D=0;D<r;D++)P=x.get(D,w+1),x.set(D,w+1,x.get(D,w)),x.set(D,w,P);if(l&&w<n-1)for(let D=0;D<n;D++)P=m.get(D,w+1),m.set(D,w+1,m.get(D,w)),m.set(D,w,P);w++}N=0,E--;break}}}if(u){let w=x;x=m,m=w}this.m=n,this.n=r,this.s=d,this.U=m,this.V=x}solve(t){let e=t,n=this.threshold,r=this.s.length,o=Wt.zeros(r,r);for(let p=0;p<r;p++)Math.abs(this.s[p])<=n?o.set(p,p,0):o.set(p,p,1/this.s[p]);let s=this.U,a=this.rightSingularVectors,l=a.mmul(o),c=a.rows,u=s.rows,h=Wt.zeros(c,u);for(let p=0;p<c;p++)for(let f=0;f<u;f++){let d=0;for(let m=0;m<r;m++)d+=l.get(p,m)*s.get(f,m);h.set(p,f,d)}return h.mmul(e)}solveForDiagonal(t){return this.solve(Wt.diag(t))}inverse(){let t=this.V,e=this.threshold,n=t.rows,r=t.columns,o=new Wt(n,this.s.length);for(let u=0;u<n;u++)for(let h=0;h<r;h++)Math.abs(this.s[h])>e&&o.set(u,h,t.get(u,h)/this.s[h]);let s=this.U,a=s.rows,l=s.columns,c=new Wt(n,a);for(let u=0;u<n;u++)for(let h=0;h<a;h++){let p=0;for(let f=0;f<l;f++)p+=o.get(u,f)*s.get(h,f);c.set(u,h,p)}return c}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s;for(let r=0,o=n.length;r<o;r++)n[r]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Wt.diag(this.s)}}});function jw(i,t=!1){return i=Ii.checkMatrix(i),t?new Tc(i).inverse():Vk(i,Wt.eye(i.rows))}function Vk(i,t,e=!1){return i=Ii.checkMatrix(i),t=Ii.checkMatrix(t),e?new Tc(i).solve(t):i.isSquare()?new _p(i).solve(t):new wp(i).solve(t)}var Hk=He(()=>{Fk();Ok();Bk();Pa();bp()});var $k=He(()=>{Pa();zk();Hk()});function JX(i,t,e,n,r){let o=e.length,s=i.x.length,a=new Array(o);for(let l=0;l<o;l++){a[l]=new Array(s);let c=e.slice();c[l]+=n;let u=r(c);for(let h=0;h<s;h++)a[l][h]=t[h]-u(i.x[h])}return new Wt(a)}function QX(i,t){let e=i.x.length,n=new Array(e);for(let r=0;r<e;r++)n[r]=[i.y[r]-t[r]];return new Wt(n)}function qw(i,t,e,n,r){let o=e*n*n,s=Wt.eye(t.length,t.length,o),a=r(t),l=new Float64Array(i.x.length);for(let p=0;p<i.x.length;p++)l[p]=a(i.x[p]);let c=JX(i,l,t,n,r),u=QX(i,l),h=jw(s.add(c.mmul(c.transpose())));return t=new Wt([t]),t=t.sub(h.mmul(c).mmul(u).mul(n).transpose()),t.to1DArray()}var Uk=He(()=>{$k()});var Gk={};Dr(Gk,{default:()=>Wk});function Wk(i,t,e={}){let{maxIterations:n=100,gradientDifference:r=.1,damping:o=0,errorTolerance:s=.01,minValues:a,maxValues:l,initialValues:c}=e;if(o<=0)throw new Error("The damping option must be a positive number");if(!i.x||!i.y)throw new Error("The data parameter must have x and y elements");if(!yp(i.x)||i.x.length<2||!yp(i.y)||i.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(i.x.length!==i.y.length)throw new Error("The data parameter elements must have the same size");let u=c||new Array(t.length).fill(1),h=u.length;if(l=l||new Array(h).fill(Number.MAX_SAFE_INTEGER),a=a||new Array(h).fill(Number.MIN_SAFE_INTEGER),l.length!==a.length)throw new Error("minValues and maxValues must be the same size");if(!yp(u))throw new Error("initialValues must be an array");let p=Xg(i,u,t),f=p<=s,d;for(d=0;d<n&&!f;d++){u=qw(i,u,o,r,t);for(let m=0;m<h;m++)u[m]=Math.min(Math.max(a[m],u[m]),l[m]);if(p=Xg(i,u,t),isNaN(p))break;f=p<=s}return{parameterValues:u,parameterError:p,iterations:d}}var jk=He(()=>{tk();ek();Uk()});var oR=un(fn=>{"use strict";var qk=fn&&fn.__awaiter||function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(c){try{l(n.next(c))}catch(u){o(u)}}function a(c){try{l(n.throw(c))}catch(u){o(u)}}function l(c){c.done?r(c.value):new e(function(u){u(c.value)}).then(s,a)}l((n=n.apply(i,t||[])).next())})},Xk=fn&&fn.__generator||function(i,t){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,r,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,r&&(o=c[0]&2?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++,r=c[1],c=[0];continue;case 7:c=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){e=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){e.label=c[1];break}if(c[0]===6&&e.label<o[1]){e.label=o[1],o=c;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(c);break}o[2]&&e.ops.pop(),e.trys.pop();continue}c=t.call(i,e)}catch(u){c=[6,u],r=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},Xw=fn&&fn.__read||function(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var n=e.call(i),r,o=[],s;try{for(;(t===void 0||t-- >0)&&!(r=n.next()).done;)o.push(r.value)}catch(a){s={error:a}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(s)throw s.error}}return o},Kk=fn&&fn.__spread||function(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(Xw(arguments[t]));return i},Sp=fn&&fn.__importStar||function(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)Object.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t.default=i,t},tK=fn&&fn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(fn,"__esModule",{value:!0});var eK=Sp(Pw()),on=Sp(Nw()),Jg=Sp(QA()),Yk=Sp(Ow()),pn=Sp(Mc()),nK=tK((jk(),Hb(Gk))),Zk=1e-5,Qg=.001,iK=function(){function i(t){t===void 0&&(t={});var e=this;this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.transformQueueSize=4,this.targetMetric="categorical",this.targetWeight=.5,this.targetNNeighbors=this.nNeighbors,this.distanceFn=tR,this.isInitialized=!1,this.rpForest=[],this.embedding=[],this.optimizationState=new oK;var n=function(r){t[r]!==void 0&&(e[r]=t[r])};n("distanceFn"),n("learningRate"),n("localConnectivity"),n("minDist"),n("nComponents"),n("nEpochs"),n("nNeighbors"),n("negativeSampleRate"),n("random"),n("repulsionStrength"),n("setOpMixRatio"),n("spread"),n("transformQueueSize")}return i.prototype.fit=function(t){return this.initializeFit(t),this.optimizeLayout(),this.embedding},i.prototype.fitAsync=function(t,e){return e===void 0&&(e=function(){return!0}),qk(this,void 0,void 0,function(){return Xk(this,function(n){switch(n.label){case 0:return this.initializeFit(t),[4,this.optimizeLayoutAsync(e)];case 1:return n.sent(),[2,this.embedding]}})})},i.prototype.setSupervisedProjection=function(t,e){e===void 0&&(e={}),this.Y=t,this.targetMetric=e.targetMetric||this.targetMetric,this.targetWeight=e.targetWeight||this.targetWeight,this.targetNNeighbors=e.targetNNeighbors||this.targetNNeighbors},i.prototype.setPrecomputedKNN=function(t,e){this.knnIndices=t,this.knnDistances=e},i.prototype.initializeFit=function(t){if(t.length<=this.nNeighbors)throw new Error("Not enough data points ("+t.length+") to create nNeighbors: "+this.nNeighbors+".  Add more data points or adjust the configuration.");if(this.X===t&&this.isInitialized)return this.getNEpochs();if(this.X=t,!this.knnIndices&&!this.knnDistances){var e=this.nearestNeighbors(t);this.knnIndices=e.knnIndices,this.knnDistances=e.knnDistances}this.graph=this.fuzzySimplicialSet(t,this.nNeighbors,this.setOpMixRatio),this.makeSearchFns(),this.searchGraph=this.makeSearchGraph(t),this.processGraphForSupervisedProjection();var n=this.initializeSimplicialSetEmbedding(),r=n.head,o=n.tail,s=n.epochsPerSample;return this.optimizationState.head=r,this.optimizationState.tail=o,this.optimizationState.epochsPerSample=s,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},i.prototype.makeSearchFns=function(){var t=Jg.makeInitializations(this.distanceFn),e=t.initFromTree,n=t.initFromRandom;this.initFromTree=e,this.initFromRandom=n,this.search=Jg.makeInitializedNNSearch(this.distanceFn)},i.prototype.makeSearchGraph=function(t){for(var e=this.knnIndices,n=this.knnDistances,r=[t.length,t.length],o=new on.SparseMatrix([],[],[],r),s=0;s<e.length;s++)for(var a=e[s],l=n[s],c=0;c<a.length;c++){var u=a[c],h=l[c];h>0&&o.set(s,u,h)}var p=on.transpose(o);return on.maximum(o,p)},i.prototype.transform=function(t){var e=this,n=this.X;if(n===void 0||n.length===0)throw new Error("No data has been fit.");var r=Math.floor(this.nNeighbors*this.transformQueueSize);r=Math.min(n.length,r);var o=Jg.initializeSearch(this.rpForest,n,t,r,this.initFromRandom,this.initFromTree,this.random),s=this.search(n,this.searchGraph,o,t),a=eK.deheapSort(s),l=a.indices,c=a.weights;l=l.map(function(F){return F.slice(0,e.nNeighbors)}),c=c.map(function(F){return F.slice(0,e.nNeighbors)});var u=Math.max(0,this.localConnectivity-1),h=this.smoothKNNDistance(c,this.nNeighbors,u),p=h.sigmas,f=h.rhos,d=this.computeMembershipStrengths(l,c,p,f),m=d.rows,x=d.cols,g=d.vals,y=[t.length,n.length],b=new on.SparseMatrix(m,x,g,y),v=on.normalize(b,"l1"),_=on.getCSR(v),S=t.length,E=pn.reshape2d(_.indices,S,this.nNeighbors),M=pn.reshape2d(_.values,S,this.nNeighbors),N=rR(E,M,this.embedding),I=this.nEpochs?this.nEpochs/3:b.nRows<=1e4?100:30,w=b.getValues().reduce(function(F,z){return z>F?z:F},0);b=b.map(function(F){return F<w/I?0:F}),b=on.eliminateZeros(b);var R=this.makeEpochsPerSample(b.getValues(),I),P=b.getRows(),D=b.getCols();return this.assignOptimizationStateParameters({headEmbedding:N,tailEmbedding:this.embedding,head:P,tail:D,currentEpoch:0,nEpochs:I,nVertices:b.getDims()[1],epochsPerSample:R}),this.prepareForOptimizationLoop(),this.optimizeLayout()},i.prototype.processGraphForSupervisedProjection=function(){var t=this,e=t.Y,n=t.X;if(e){if(e.length!==n.length)throw new Error("Length of X and y must be equal");if(this.targetMetric==="categorical"){var r=this.targetWeight<1,o=r?2.5*(1/(1-this.targetWeight)):1e12;this.graph=this.categoricalSimplicialSetIntersection(this.graph,e,o)}}},i.prototype.step=function(){var t=this.optimizationState.currentEpoch;return t<this.getNEpochs()&&this.optimizeLayoutStep(t),this.optimizationState.currentEpoch},i.prototype.getEmbedding=function(){return this.embedding},i.prototype.nearestNeighbors=function(t){var e=this,n=e.distanceFn,r=e.nNeighbors,o=function(d){return Math.log(d)/Math.log(2)},s=Jg.makeNNDescent(n,this.random),a=function(d){return d===.5?0:Math.round(d)},l=5+Math.floor(a(Math.pow(t.length,.5)/20)),c=Math.max(5,Math.floor(Math.round(o(t.length))));this.rpForest=Yk.makeForest(t,r,l,this.random);var u=Yk.makeLeafArray(this.rpForest),h=s(t,u,r,c),p=h.indices,f=h.weights;return{knnIndices:p,knnDistances:f}},i.prototype.fuzzySimplicialSet=function(t,e,n){n===void 0&&(n=1);var r=this,o=r.knnIndices,s=o===void 0?[]:o,a=r.knnDistances,l=a===void 0?[]:a,c=r.localConnectivity,u=this.smoothKNNDistance(l,e,c),h=u.sigmas,p=u.rhos,f=this.computeMembershipStrengths(s,l,h,p),d=f.rows,m=f.cols,x=f.vals,g=[t.length,t.length],y=new on.SparseMatrix(d,m,x,g),b=on.transpose(y),v=on.pairwiseMultiply(y,b),_=on.subtract(on.add(y,b),v),S=on.multiplyScalar(_,n),E=on.multiplyScalar(v,1-n),M=on.add(S,E);return M},i.prototype.categoricalSimplicialSetIntersection=function(t,e,n,r){r===void 0&&(r=1);var o=nR(t,e,r,n);return o=on.eliminateZeros(o),iR(o)},i.prototype.smoothKNNDistance=function(t,e,n,r,o){n===void 0&&(n=1),r===void 0&&(r=64),o===void 0&&(o=1);for(var s=Math.log(e)/Math.log(2)*o,a=pn.zeros(t.length),l=pn.zeros(t.length),c=0;c<t.length;c++){var u=0,h=1/0,p=1,f=t[c],d=f.filter(function(E){return E>0});if(d.length>=n){var m=Math.floor(n),x=n-m;m>0?(a[c]=d[m-1],x>Zk&&(a[c]+=x*(d[m]-d[m-1]))):a[c]=x*d[0]}else d.length>0&&(a[c]=pn.max(d));for(var g=0;g<r;g++){for(var y=0,b=1;b<t[c].length;b++){var v=t[c][b]-a[c];v>0?y+=Math.exp(-(v/p)):y+=1}if(Math.abs(y-s)<Zk)break;y>s?(h=p,p=(u+h)/2):(u=p,h===1/0?p*=2:p=(u+h)/2)}if(l[c]=p,a[c]>0){var _=pn.mean(f);l[c]<Qg*_&&(l[c]=Qg*_)}else{var S=pn.mean(t.map(pn.mean));l[c]<Qg*S&&(l[c]=Qg*S)}}return{sigmas:l,rhos:a}},i.prototype.computeMembershipStrengths=function(t,e,n,r){for(var o=t.length,s=t[0].length,a=pn.zeros(o*s),l=pn.zeros(o*s),c=pn.zeros(o*s),u=0;u<o;u++)for(var h=0;h<s;h++){var p=0;t[u][h]!==-1&&(t[u][h]===u?p=0:e[u][h]-r[u]<=0?p=1:p=Math.exp(-((e[u][h]-r[u])/n[u])),a[u*s+h]=u,l[u*s+h]=t[u][h],c[u*s+h]=p)}return{rows:a,cols:l,vals:c}},i.prototype.initializeSimplicialSetEmbedding=function(){for(var t=this,e=this.getNEpochs(),n=this.nComponents,r=this.graph.getValues(),o=0,s=0;s<r.length;s++){var a=r[s];o<r[s]&&(o=a)}var l=this.graph.map(function(m){return m<o/e?0:m});this.embedding=pn.zeros(l.nRows).map(function(){return pn.zeros(n).map(function(){return pn.tauRand(t.random)*20+-10})});for(var c=[],u=[],h=[],p=l.getAll(),s=0;s<p.length;s++){var f=p[s];f.value&&(c.push(f.value),h.push(f.row),u.push(f.col))}var d=this.makeEpochsPerSample(c,e);return{head:u,tail:h,epochsPerSample:d}},i.prototype.makeEpochsPerSample=function(t,e){var n=pn.filled(t.length,-1),r=pn.max(t),o=t.map(function(s){return s/r*e});return o.forEach(function(s,a){s>0&&(n[a]=e/o[a])}),n},i.prototype.assignOptimizationStateParameters=function(t){Object.assign(this.optimizationState,t)},i.prototype.prepareForOptimizationLoop=function(){var t=this,e=t.repulsionStrength,n=t.learningRate,r=t.negativeSampleRate,o=this.optimizationState,s=o.epochsPerSample,a=o.headEmbedding,l=o.tailEmbedding,c=a[0].length,u=a.length===l.length,h=s.map(function(d){return d/r}),p=Kk(h),f=Kk(s);this.assignOptimizationStateParameters({epochOfNextSample:f,epochOfNextNegativeSample:p,epochsPerNegativeSample:h,moveOther:u,initialAlpha:n,alpha:n,gamma:e,dim:c})},i.prototype.initializeOptimization=function(){var t=this.embedding,e=this.embedding,n=this.optimizationState,r=n.head,o=n.tail,s=n.epochsPerSample,a=this.getNEpochs(),l=this.graph.nCols,c=eR(this.spread,this.minDist),u=c.a,h=c.b;this.assignOptimizationStateParameters({headEmbedding:t,tailEmbedding:e,head:r,tail:o,epochsPerSample:s,a:u,b:h,nEpochs:a,nVertices:l})},i.prototype.optimizeLayoutStep=function(t){for(var e=this.optimizationState,n=e.head,r=e.tail,o=e.headEmbedding,s=e.tailEmbedding,a=e.epochsPerSample,l=e.epochOfNextSample,c=e.epochOfNextNegativeSample,u=e.epochsPerNegativeSample,h=e.moveOther,p=e.initialAlpha,f=e.alpha,d=e.gamma,m=e.a,x=e.b,g=e.dim,y=e.nEpochs,b=e.nVertices,v=4,_=0;_<a.length;_++)if(!(l[_]>t)){var S=n[_],E=r[_],M=o[S],N=s[E],I=Qk(M,N),w=0;I>0&&(w=-2*m*x*Math.pow(I,x-1),w/=m*Math.pow(I,x)+1);for(var R=0;R<g;R++){var P=Jk(w*(M[R]-N[R]),v);M[R]+=P*f,h&&(N[R]+=-P*f)}l[_]+=a[_];for(var D=Math.floor((t-c[_])/u[_]),F=0;F<D;F++){var z=pn.tauRandInt(b,this.random),V=s[z],H=Qk(M,V),X=0;if(H>0)X=2*d*x,X/=(.001+H)*(m*Math.pow(H,x)+1);else if(S===z)continue;for(var R=0;R<g;R++){var P=4;X>0&&(P=Jk(X*(M[R]-V[R]),v)),M[R]+=P*f}}c[_]+=D*u[_]}return e.alpha=p*(1-t/y),e.currentEpoch+=1,o},i.prototype.optimizeLayoutAsync=function(t){var e=this;return t===void 0&&(t=function(){return!0}),new Promise(function(n,r){var o=function(){return qk(e,void 0,void 0,function(){var s,a,l,c,u,h;return Xk(this,function(p){try{if(s=this.optimizationState,a=s.nEpochs,l=s.currentEpoch,this.embedding=this.optimizeLayoutStep(l),c=this.optimizationState.currentEpoch,u=t(c)===!1,h=c===a,!u&&!h)setTimeout(function(){return o()},0);else return[2,n(h)]}catch(f){r(f)}return[2]})})};setTimeout(function(){return o()},0)})},i.prototype.optimizeLayout=function(t){t===void 0&&(t=function(){return!0});for(var e=!1,n=[];!e;){var r=this.optimizationState,o=r.nEpochs,s=r.currentEpoch;n=this.optimizeLayoutStep(s);var a=this.optimizationState.currentEpoch,l=t(a)===!1;e=a===o||l}return n},i.prototype.getNEpochs=function(){var t=this.graph;if(this.nEpochs>0)return this.nEpochs;var e=t.nRows;return e<=2500?500:e<=5e3?400:e<=7500?300:200},i}();fn.UMAP=iK;function tR(i,t){for(var e=0,n=0;n<i.length;n++)e+=Math.pow(i[n]-t[n],2);return Math.sqrt(e)}fn.euclidean=tR;function rK(i,t){for(var e=0,n=0,r=0,o=0;o<i.length;o++)e+=i[o]*t[o],n+=Math.pow(i[o],2),r+=Math.pow(t[o],2);return n===0&&r===0?0:n===0||r===0?1:1-e/Math.sqrt(n*r)}fn.cosine=rK;var oK=function(){function i(){this.currentEpoch=0,this.headEmbedding=[],this.tailEmbedding=[],this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0}return i}();function Jk(i,t){return i>t?t:i<-t?-t:i}function Qk(i,t){for(var e=0,n=0;n<i.length;n++)e+=Math.pow(i[n]-t[n],2);return e}function eR(i,t){var e=function(p){var f=Xw(p,2),d=f[0],m=f[1];return function(x){return 1/(1+d*Math.pow(x,2*m))}},n=pn.linear(0,i*3,300).map(function(p){return p<t?1:p}),r=pn.zeros(n.length).map(function(p,f){var d=n[f]>=t;return d?Math.exp(-(n[f]-t)/i):p}),o=[.5,.5],s={x:n,y:r},a={damping:1.5,initialValues:o,gradientDifference:.1,maxIterations:100,errorTolerance:.01},l=nK.default(s,e,a).parameterValues,c=Xw(l,2),u=c[0],h=c[1];return{a:u,b:h}}fn.findABParams=eR;function nR(i,t,e,n){return e===void 0&&(e=1),n===void 0&&(n=5),i.map(function(r,o,s){return t[o]===-1||t[s]===-1?r*Math.exp(-e):t[o]!==t[s]?r*Math.exp(-n):r})}fn.fastIntersection=nR;function iR(i){i=on.normalize(i,"max");var t=on.transpose(i),e=on.pairwiseMultiply(t,i);return i=on.add(i,on.subtract(t,e)),on.eliminateZeros(i)}fn.resetLocalConnectivity=iR;function rR(i,t,e){for(var n=pn.zeros(i.length).map(function(l){return pn.zeros(e[0].length)}),r=0;r<i.length;r++)for(var o=0;o<i[0].length;o++)for(var s=0;s<e[0].length;s++){var a=i[r][o];n[r][s]+=t[r][o]*e[a][s]}return n}fn.initTransform=rR});var sR=un(Kw=>{"use strict";Object.defineProperty(Kw,"__esModule",{value:!0});var sK=oR();Kw.UMAP=sK.UMAP});var aR=un((exports,module)=>{"use strict";var numeric=typeof exports=="undefined"?function(){}:exports;typeof global!="undefined"&&(global.numeric=numeric);numeric.version="1.2.6";numeric.bench=function(t,e){var n,r,o,s;for(typeof e=="undefined"&&(e=15),o=.5,n=new Date;;){for(o*=2,s=o;s>3;s-=4)t(),t(),t(),t();for(;s>0;)t(),s--;if(r=new Date,r-n>e)break}for(s=o;s>3;s-=4)t(),t(),t(),t();for(;s>0;)t(),s--;return r=new Date,1e3*(3*o-1)/(r-n)};numeric._myIndexOf=function(t){var e=this.length,n;for(n=0;n<e;++n)if(this[n]===t)return n;return-1};numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf;numeric.Function=Function;numeric.precision=4;numeric.largeArray=50;numeric.prettyPrint=function(t){function e(o){if(o===0)return"0";if(isNaN(o))return"NaN";if(o<0)return"-"+e(-o);if(isFinite(o)){var s=Math.floor(Math.log(o)/Math.log(10)),a=o/Math.pow(10,s),l=a.toPrecision(numeric.precision);return parseFloat(l)===10&&(s++,a=1,l=a.toPrecision(numeric.precision)),parseFloat(l).toString()+"e"+s.toString()}return"Infinity"}var n=[];function r(o){var s;if(typeof o=="undefined")return n.push(Array(numeric.precision+8).join(" ")),!1;if(typeof o=="string")return n.push('"'+o+'"'),!1;if(typeof o=="boolean")return n.push(o.toString()),!1;if(typeof o=="number"){var a=e(o),l=o.toPrecision(numeric.precision),c=parseFloat(o.toString()).toString(),u=[a,l,c,parseFloat(l).toString(),parseFloat(c).toString()];for(s=1;s<u.length;s++)u[s].length<a.length&&(a=u[s]);return n.push(Array(numeric.precision+8-a.length).join(" ")+a),!1}if(o===null)return n.push("null"),!1;if(typeof o=="function"){n.push(o.toString());var h=!1;for(s in o)o.hasOwnProperty(s)&&(h?n.push(`,
`):n.push(`
{`),h=!0,n.push(s),n.push(`: 
`),r(o[s]));return h&&n.push(`}
`),!0}if(o instanceof Array){if(o.length>numeric.largeArray)return n.push("...Large Array..."),!0;var h=!1;for(n.push("["),s=0;s<o.length;s++)s>0&&(n.push(","),h&&n.push(`
 `)),h=r(o[s]);return n.push("]"),!0}n.push("{");var h=!1;for(s in o)o.hasOwnProperty(s)&&(h&&n.push(`,
`),h=!0,n.push(s),n.push(`: 
`),r(o[s]));return n.push("}"),!0}return r(t),n.join("")};numeric.parseDate=function(t){function e(n){if(typeof n=="string")return Date.parse(n.replace(/-/g,"/"));if(!(n instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var r=[],o;for(o=0;o<n.length;o++)r[o]=e(n[o]);return r}return e(t)};numeric.parseFloat=function(t){function e(n){if(typeof n=="string")return parseFloat(n);if(!(n instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var r=[],o;for(o=0;o<n.length;o++)r[o]=e(n[o]);return r}return e(t)};numeric.parseCSV=function(t){var e=t.split(`
`),n,r,o=[],s=/(([^'",]*)|('[^']*')|("[^"]*")),/g,a=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,l=function(p){return p.substr(0,p.length-1)},c=0;for(r=0;r<e.length;r++){var u=(e[r]+",").match(s),h;if(u.length>0){for(o[c]=[],n=0;n<u.length;n++)h=l(u[n]),a.test(h)?o[c][n]=parseFloat(h):o[c][n]=h;c++}}return o};numeric.toCSV=function(t){var e=numeric.dim(t),n,r,o,s,a,l;for(o=e[0],s=e[1],l=[],n=0;n<o;n++){for(a=[],r=0;r<o;r++)a[r]=t[n][r].toString();l[n]=a.join(", ")}return l.join(`
`)+`
`};numeric.getURL=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),e};numeric.imageURL=function(t){function e(y){var b=y.length,v,_,S,E,M,N,I,w,R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",P="";for(v=0;v<b;v+=3)_=y[v],S=y[v+1],E=y[v+2],M=_>>2,N=((_&3)<<4)+(S>>4),I=((S&15)<<2)+(E>>6),w=E&63,v+1>=b?I=w=64:v+2>=b&&(w=64),P+=R.charAt(M)+R.charAt(N)+R.charAt(I)+R.charAt(w);return P}function n(y,b,v){typeof b=="undefined"&&(b=0),typeof v=="undefined"&&(v=y.length);var _=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],S=-1,E=0,M=y.length,N;for(N=b;N<v;N++)E=(S^y[N])&255,S=S>>>8^_[E];return S^-1}var r=t[0].length,o=t[0][0].length,s,a,l,c,u,h,p,f,d,m,x,g=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,o>>24&255,o>>16&255,o>>8&255,o&255,r>>24&255,r>>16&255,r>>8&255,r&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(x=n(g,12,29),g[29]=x>>24&255,g[30]=x>>16&255,g[31]=x>>8&255,g[32]=x&255,s=1,a=0,f=0;f<r;f++){for(f<r-1?g.push(0):g.push(1),h=3*o+1+(f===0)&255,p=3*o+1+(f===0)>>8&255,g.push(h),g.push(p),g.push(~h&255),g.push(~p&255),f===0&&g.push(0),d=0;d<o;d++)for(c=0;c<3;c++)h=t[c][f][d],h>255?h=255:h<0?h=0:h=Math.round(h),s=(s+h)%65521,a=(a+s)%65521,g.push(h);g.push(0)}return m=(a<<16)+s,g.push(m>>24&255),g.push(m>>16&255),g.push(m>>8&255),g.push(m&255),u=g.length-41,g[33]=u>>24&255,g[34]=u>>16&255,g[35]=u>>8&255,g[36]=u&255,x=n(g,37),g.push(x>>24&255),g.push(x>>16&255),g.push(x>>8&255),g.push(x&255),g.push(0),g.push(0),g.push(0),g.push(0),g.push(73),g.push(69),g.push(78),g.push(68),g.push(174),g.push(66),g.push(96),g.push(130),"data:image/png;base64,"+e(g)};numeric._dim=function(t){for(var e=[];typeof t=="object";)e.push(t.length),t=t[0];return e};numeric.dim=function(t){var e,n;return typeof t=="object"?(e=t[0],typeof e=="object"?(n=e[0],typeof n=="object"?numeric._dim(t):[t.length,e.length]):[t.length]):[]};numeric.mapreduce=function(t,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+`;
if(typeof x === "number") { var xi = x; `+t+`; return accum; }
if(typeof _s === "undefined") _s = numeric.dim(x);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i,xi;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) {
        accum = arguments.callee(x[i],accum,_s,_k+1);
    }    return accum;
}
for(i=_n-1;i>=1;i-=2) { 
    xi = x[i];
    `+t+`;
    xi = x[i-1];
    `+t+`;
}
if(i === 0) {
    xi = x[i];
    `+t+`
}
return accum;`)};numeric.mapreduce2=function(t,e){return Function("x",`var n = x.length;
var i,xi;
`+e+`;
for(i=n-1;i!==-1;--i) { 
    xi = x[i];
    `+t+`;
}
return accum;`)};numeric.same=function i(t,e){var n,r;if(!(t instanceof Array)||!(e instanceof Array)||(r=t.length,r!==e.length))return!1;for(n=0;n<r;n++)if(t[n]!==e[n])if(typeof t[n]=="object"){if(!i(t[n],e[n]))return!1}else return!1;return!0};numeric.rep=function(t,e,n){typeof n=="undefined"&&(n=0);var r=t[n],o=Array(r),s;if(n===t.length-1){for(s=r-2;s>=0;s-=2)o[s+1]=e,o[s]=e;return s===-1&&(o[0]=e),o}for(s=r-1;s>=0;s--)o[s]=numeric.rep(t,e,n+1);return o};numeric.dotMMsmall=function(t,e){var n,r,o,s,a,l,c,u,h,p,f,d,m,x;for(s=t.length,a=e.length,l=e[0].length,c=Array(s),n=s-1;n>=0;n--){for(u=Array(l),h=t[n],o=l-1;o>=0;o--){for(p=h[a-1]*e[a-1][o],r=a-2;r>=1;r-=2)f=r-1,p+=h[r]*e[r][o]+h[f]*e[f][o];r===0&&(p+=h[0]*e[0][o]),u[o]=p}c[n]=u}return c};numeric._getCol=function(t,e,n){var r=t.length,o;for(o=r-1;o>0;--o)n[o]=t[o][e],--o,n[o]=t[o][e];o===0&&(n[0]=t[0][e])};numeric.dotMMbig=function(t,e){var n=numeric._getCol,r=e.length,o=Array(r),s=t.length,a=e[0].length,l=new Array(s),c,u=numeric.dotVV,h,p,f,d;for(--r,--s,h=s;h!==-1;--h)l[h]=Array(a);for(--a,h=a;h!==-1;--h)for(n(e,h,o),p=s;p!==-1;--p)d=0,c=t[p],l[p][h]=u(c,o);return l};numeric.dotMV=function(t,e){var n=t.length,r=e.length,o,s=Array(n),a=numeric.dotVV;for(o=n-1;o>=0;o--)s[o]=a(t[o],e);return s};numeric.dotVM=function(t,e){var n,r,o,s,a,l,c,u,h,p,f,d,m,x,g,y,b,v,_;for(s=t.length,a=e[0].length,c=Array(a),o=a-1;o>=0;o--){for(p=t[s-1]*e[s-1][o],r=s-2;r>=1;r-=2)f=r-1,p+=t[r]*e[r][o]+t[f]*e[f][o];r===0&&(p+=t[0]*e[0][o]),c[o]=p}return c};numeric.dotVV=function(t,e){var n,r=t.length,o,s=t[r-1]*e[r-1];for(n=r-2;n>=1;n-=2)o=n-1,s+=t[n]*e[n]+t[o]*e[o];return n===0&&(s+=t[0]*e[0]),s};numeric.dot=function(t,e){var n=numeric.dim;switch(n(t).length*1e3+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(t,e):numeric.dotMMbig(t,e);case 2001:return numeric.dotMV(t,e);case 1002:return numeric.dotVM(t,e);case 1001:return numeric.dotVV(t,e);case 1e3:return numeric.mulVS(t,e);case 1:return numeric.mulSV(t,e);case 0:return t*e;default:throw new Error("numeric.dot only works on vectors and matrices")}};numeric.diag=function(t){var e,n,r,o=t.length,s=Array(o),a;for(e=o-1;e>=0;e--){for(a=Array(o),n=e+2,r=o-1;r>=n;r-=2)a[r]=0,a[r-1]=0;for(r>e&&(a[r]=0),a[e]=t[e],r=e-1;r>=1;r-=2)a[r]=0,a[r-1]=0;r===0&&(a[0]=0),s[e]=a}return s};numeric.getDiag=function(i){var t=Math.min(i.length,i[0].length),e,n=Array(t);for(e=t-1;e>=1;--e)n[e]=i[e][e],--e,n[e]=i[e][e];return e===0&&(n[0]=i[0][0]),n};numeric.identity=function(t){return numeric.diag(numeric.rep([t],1))};numeric.pointwise=function(t,e,n){typeof n=="undefined"&&(n="");var r=[],o,s=/\[i\]$/,a,l="",c=!1;for(o=0;o<t.length;o++)s.test(t[o])?(a=t[o].substring(0,t[o].length-3),l=a):a=t[o],a==="ret"&&(c=!0),r.push(a);return r[t.length]="_s",r[t.length+1]="_k",r[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+l+`);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i`+(c?"":", ret = Array(_n)")+`;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+t.join(",")+`,_s,_k+1);
    return ret;
}
`+n+`
for(i=_n-1;i!==-1;--i) {
    `+e+`
}
return ret;`,Function.apply(null,r)};numeric.pointwise2=function(t,e,n){typeof n=="undefined"&&(n="");var r=[],o,s=/\[i\]$/,a,l="",c=!1;for(o=0;o<t.length;o++)s.test(t[o])?(a=t[o].substring(0,t[o].length-3),l=a):a=t[o],a==="ret"&&(c=!0),r.push(a);return r[t.length]="var _n = "+l+`.length;
var i`+(c?"":", ret = Array(_n)")+`;
`+n+`
for(i=_n-1;i!==-1;--i) {
`+e+`
}
return ret;`,Function.apply(null,r)};numeric._biforeach=function i(t,e,n,r,o){if(r===n.length-1){o(t,e);return}var s,a=n[r];for(s=a-1;s>=0;s--)i(typeof t=="object"?t[s]:t,typeof e=="object"?e[s]:e,n,r+1,o)};numeric._biforeach2=function i(t,e,n,r,o){if(r===n.length-1)return o(t,e);var s,a=n[r],l=Array(a);for(s=a-1;s>=0;--s)l[s]=i(typeof t=="object"?t[s]:t,typeof e=="object"?e[s]:e,n,r+1,o);return l};numeric._foreach=function i(t,e,n,r){if(n===e.length-1){r(t);return}var o,s=e[n];for(o=s-1;o>=0;o--)i(t[o],e,n+1,r)};numeric._foreach2=function i(t,e,n,r){if(n===e.length-1)return r(t);var o,s=e[n],a=Array(s);for(o=s-1;o>=0;o--)a[o]=i(t[o],e,n+1,r);return a};numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="};numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"];numeric.mathfuns2=["atan2","pow","max","min"];numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""};numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]};(function(){var i,t;for(i=0;i<numeric.mathfuns2.length;++i)t=numeric.mathfuns2[i],numeric.ops2[t]=t;for(i in numeric.ops2)if(numeric.ops2.hasOwnProperty(i)){t=numeric.ops2[i];var e,n,r="";numeric.myIndexOf.call(numeric.mathfuns2,i)!==-1?(r="var "+t+" = Math."+t+`;
`,e=function(o,s,a){return o+" = "+t+"("+s+","+a+")"},n=function(o,s){return o+" = "+t+"("+o+","+s+")"}):(e=function(o,s,a){return o+" = "+s+" "+t+" "+a},numeric.opseq.hasOwnProperty(i+"eq")?n=function(o,s){return o+" "+t+"= "+s}:n=function(o,s){return o+" = "+o+" "+t+" "+s}),numeric[i+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),r),numeric[i+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),r),numeric[i+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),r),numeric[i]=Function(`var n = arguments.length, i, x = arguments[0], y;
var VV = numeric.`+i+"VV, VS = numeric."+i+"VS, SV = numeric."+i+`SV;
var dim = numeric.dim;
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof x === "object") {
      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);
      else x = numeric._biforeach2(x,y,dim(x),0,VS);
  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);
  else `+n("x","y")+`
}
return x;
`),numeric[t]=numeric[i],numeric[i+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],n("ret[i]","x[i]"),r),numeric[i+"eqS"]=numeric.pointwise2(["ret[i]","x"],n("ret[i]","x"),r),numeric[i+"eq"]=Function(`var n = arguments.length, i, x = arguments[0], y;
var V = numeric.`+i+"eqV, S = numeric."+i+`eqS
var s = numeric.dim(x);
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);
  else numeric._biforeach(x,y,s,0,S);
}
return x;
`)}for(i=0;i<numeric.mathfuns2.length;++i)t=numeric.mathfuns2[i],delete numeric.ops2[t];for(i=0;i<numeric.mathfuns.length;++i)t=numeric.mathfuns[i],numeric.ops1[t]=t;for(i in numeric.ops1)numeric.ops1.hasOwnProperty(i)&&(r="",t=numeric.ops1[i],numeric.myIndexOf.call(numeric.mathfuns,i)!==-1&&Math.hasOwnProperty(t)&&(r="var "+t+" = Math."+t+`;
`),numeric[i+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",r),numeric[i+"eq"]=Function("x",'if(typeof x !== "object") return '+t+`x
var i;
var V = numeric.`+i+`eqV;
var s = numeric.dim(x);
numeric._foreach(x,s,0,V);
return x;
`),numeric[i+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",r),numeric[i]=Function("x",'if(typeof x !== "object") return '+t+`(x)
var i;
var V = numeric.`+i+`V;
var s = numeric.dim(x);
return numeric._foreach2(x,s,0,V);
`));for(i=0;i<numeric.mathfuns.length;++i)t=numeric.mathfuns[i],delete numeric.ops1[t];for(i in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(i)&&(t=numeric.mapreducers[i],numeric[i+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[i]=Function("x","s","k",t[1]+`if(typeof x !== "object") {    xi = x;
`+t[0]+`;
    return accum;
}if(typeof s === "undefined") s = numeric.dim(x);
if(typeof k === "undefined") k = 0;
if(k === s.length-1) return numeric.`+i+`V(x);
var xi;
var n = x.length, i;
for(i=n-1;i!==-1;--i) {
   xi = arguments.callee(x[i]);
`+t[0]+`;
}
return accum;
`))})();numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;");numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;");numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;");numeric.trunc=function(t,e){return typeof t=="object"?typeof e=="object"?numeric.truncVV(t,e):numeric.truncVS(t,e):typeof e=="object"?numeric.truncSV(t,e):Math.round(t/e)*e};numeric.inv=function(m){var e=numeric.dim(m),n=Math.abs,r=e[0],o=e[1],s=numeric.clone(m),a,l,c=numeric.identity(r),u,h,p,f,d,m;for(f=0;f<o;++f){var x=-1,g=-1;for(p=f;p!==r;++p)d=n(s[p][f]),d>g&&(x=p,g=d);for(l=s[x],s[x]=s[f],s[f]=l,h=c[x],c[x]=c[f],c[f]=h,m=l[f],d=f;d!==o;++d)l[d]/=m;for(d=o-1;d!==-1;--d)h[d]/=m;for(p=r-1;p!==-1;--p)if(p!==f){for(a=s[p],u=c[p],m=a[f],d=f+1;d!==o;++d)a[d]-=l[d]*m;for(d=o-1;d>0;--d)u[d]-=h[d]*m,--d,u[d]-=h[d]*m;d===0&&(u[0]-=h[0]*m)}}return c};numeric.det=function(t){var e=numeric.dim(t);if(e.length!==2||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n=e[0],r=1,o,s,a,l=numeric.clone(t),c,u,h,p,f,d,m;for(s=0;s<n-1;s++){for(a=s,o=s+1;o<n;o++)Math.abs(l[o][s])>Math.abs(l[a][s])&&(a=o);for(a!==s&&(p=l[a],l[a]=l[s],l[s]=p,r*=-1),c=l[s],o=s+1;o<n;o++){for(u=l[o],h=u[s]/c[s],a=s+1;a<n-1;a+=2)f=a+1,u[a]-=c[a]*h,u[f]-=c[f]*h;a!==n&&(u[a]-=c[a]*h)}if(c[s]===0)return 0;r*=c[s]}return r*l[s][s]};numeric.transpose=function(t){var e,n,r=t.length,o=t[0].length,s=Array(o),a,l,c;for(n=0;n<o;n++)s[n]=Array(r);for(e=r-1;e>=1;e-=2){for(l=t[e],a=t[e-1],n=o-1;n>=1;--n)c=s[n],c[e]=l[n],c[e-1]=a[n],--n,c=s[n],c[e]=l[n],c[e-1]=a[n];n===0&&(c=s[0],c[e]=l[0],c[e-1]=a[0])}if(e===0){for(a=t[0],n=o-1;n>=1;--n)s[n][0]=a[n],--n,s[n][0]=a[n];n===0&&(s[0][0]=a[0])}return s};numeric.negtranspose=function(t){var e,n,r=t.length,o=t[0].length,s=Array(o),a,l,c;for(n=0;n<o;n++)s[n]=Array(r);for(e=r-1;e>=1;e-=2){for(l=t[e],a=t[e-1],n=o-1;n>=1;--n)c=s[n],c[e]=-l[n],c[e-1]=-a[n],--n,c=s[n],c[e]=-l[n],c[e-1]=-a[n];n===0&&(c=s[0],c[e]=-l[0],c[e-1]=-a[0])}if(e===0){for(a=t[0],n=o-1;n>=1;--n)s[n][0]=-a[n],--n,s[n][0]=-a[n];n===0&&(s[0][0]=-a[0])}return s};numeric._random=function i(t,e){var n,r=t[e],o=Array(r),s;if(e===t.length-1){for(s=Math.random,n=r-1;n>=1;n-=2)o[n]=s(),o[n-1]=s();return n===0&&(o[0]=s()),o}for(n=r-1;n>=0;n--)o[n]=i(t,e+1);return o};numeric.random=function(t){return numeric._random(t,0)};numeric.norm2=function(t){return Math.sqrt(numeric.norm2Squared(t))};numeric.linspace=function(t,e,n){if(typeof n=="undefined"&&(n=Math.max(Math.round(e-t)+1,1)),n<2)return n===1?[t]:[];var r,o=Array(n);for(n--,r=n;r>=0;r--)o[r]=(r*e+(n-r)*t)/n;return o};numeric.getBlock=function(t,e,n){var r=numeric.dim(t);function o(s,a){var l,c=e[a],u=n[a]-c,h=Array(u);if(a===r.length-1){for(l=u;l>=0;l--)h[l]=s[l+c];return h}for(l=u;l>=0;l--)h[l]=o(s[l+c],a+1);return h}return o(t,0)};numeric.setBlock=function(t,e,n,r){var o=numeric.dim(t);function s(a,l,c){var u,h=e[c],p=n[c]-h;if(c===o.length-1)for(u=p;u>=0;u--)a[u+h]=l[u];for(u=p;u>=0;u--)s(a[u+h],l[u],c+1)}return s(t,r,0),t};numeric.getRange=function(t,e,n){var r=e.length,o=n.length,s,a,l=Array(r),c,u;for(s=r-1;s!==-1;--s)for(l[s]=Array(o),c=l[s],u=t[e[s]],a=o-1;a!==-1;--a)c[a]=u[n[a]];return l};numeric.blockMatrix=function(t){var e=numeric.dim(t);if(e.length<4)return numeric.blockMatrix([t]);var n=e[0],r=e[1],o,s,a,l,c;for(o=0,s=0,a=0;a<n;++a)o+=t[a][0].length;for(l=0;l<r;++l)s+=t[0][l][0].length;var u=Array(o);for(a=0;a<o;++a)u[a]=Array(s);var h=0,p,f,d,m,x;for(a=0;a<n;++a){for(p=s,l=r-1;l!==-1;--l)for(c=t[a][l],p-=c[0].length,d=c.length-1;d!==-1;--d)for(x=c[d],f=u[h+d],m=x.length-1;m!==-1;--m)f[p+m]=x[m];h+=t[a][0].length}return u};numeric.tensor=function(t,e){if(typeof t=="number"||typeof e=="number")return numeric.mul(t,e);var n=numeric.dim(t),r=numeric.dim(e);if(n.length!==1||r.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var o=n[0],s=r[0],a=Array(o),l,c,u,h;for(c=o-1;c>=0;c--){for(l=Array(s),h=t[c],u=s-1;u>=3;--u)l[u]=h*e[u],--u,l[u]=h*e[u],--u,l[u]=h*e[u],--u,l[u]=h*e[u];for(;u>=0;)l[u]=h*e[u],--u;a[c]=l}return a};numeric.T=function(t,e){this.x=t,this.y=e};numeric.t=function(t,e){return new numeric.T(t,e)};numeric.Tbinop=function(t,e,n,r,o){var s=numeric.indexOf;if(typeof o!="string"){var a;o="";for(a in numeric)numeric.hasOwnProperty(a)&&(t.indexOf(a)>=0||e.indexOf(a)>=0||n.indexOf(a)>=0||r.indexOf(a)>=0)&&a.length>1&&(o+="var "+a+" = numeric."+a+`;
`)}return Function(["y"],`var x = this;
if(!(y instanceof numeric.T)) { y = new numeric.T(y); }
`+o+`
if(x.y) {  if(y.y) {    return new numeric.T(`+r+`);
  }
  return new numeric.T(`+n+`);
}
if(y.y) {
  return new numeric.T(`+e+`);
}
return new numeric.T(`+t+`);
`)};numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)");numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)");numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))");numeric.T.prototype.reciprocal=function(){var t=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(t(this.x,this.x),t(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))};numeric.T.prototype.div=function(t){if(t instanceof numeric.T||(t=new numeric.T(t)),t.y)return this.mul(t.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,t.x),e(this.y,t.x)):new numeric.T(e(this.x,t.x))};numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))");numeric.T.prototype.transpose=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),t(n)):new numeric.T(t(e))};numeric.T.prototype.transjugate=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),numeric.negtranspose(n)):new numeric.T(t(e))};numeric.Tunop=function(t,e,n){return typeof n!="string"&&(n=""),Function(`var x = this;
`+n+`
if(x.y) {  `+e+`;
}
`+t+`;
`)};numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;");numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));");numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;");numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));");numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);");numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;");numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));",`var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();
return new numeric.T(numeric.log(r.x),theta.x);`);numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);",`var f = numeric.norm2Squared;
return Math.sqrt(f(x.x)+f(x.y));`);numeric.T.prototype.inv=function(){var t=this;if(typeof t.y=="undefined")return new numeric.T(numeric.inv(t.x));var e=t.x.length,m,x,g,n=numeric.identity(e),r=numeric.rep([e,e],0),o=numeric.clone(t.x),s=numeric.clone(t.y),a,l,c,u,h,p,f,d,m,x,g,y,b,v,_,S,E,M;for(m=0;m<e;m++){for(v=o[m][m],_=s[m][m],y=v*v+_*_,g=m,x=m+1;x<e;x++)v=o[x][m],_=s[x][m],b=v*v+_*_,b>y&&(g=x,y=b);for(g!==m&&(M=o[m],o[m]=o[g],o[g]=M,M=s[m],s[m]=s[g],s[g]=M,M=n[m],n[m]=n[g],n[g]=M,M=r[m],r[m]=r[g],r[g]=M),a=o[m],l=s[m],h=n[m],p=r[m],v=a[m],_=l[m],x=m+1;x<e;x++)S=a[x],E=l[x],a[x]=(S*v+E*_)/y,l[x]=(E*v-S*_)/y;for(x=0;x<e;x++)S=h[x],E=p[x],h[x]=(S*v+E*_)/y,p[x]=(E*v-S*_)/y;for(x=m+1;x<e;x++){for(c=o[x],u=s[x],f=n[x],d=r[x],v=c[m],_=u[m],g=m+1;g<e;g++)S=a[g],E=l[g],c[g]-=S*v-E*_,u[g]-=E*v+S*_;for(g=0;g<e;g++)S=h[g],E=p[g],f[g]-=S*v-E*_,d[g]-=E*v+S*_}}for(m=e-1;m>0;m--)for(h=n[m],p=r[m],x=m-1;x>=0;x--)for(f=n[x],d=r[x],v=o[x][m],_=s[x][m],g=e-1;g>=0;g--)S=h[g],E=p[g],f[g]-=v*S-_*E,d[g]-=v*E+_*S;return new numeric.T(n,r)};numeric.T.prototype.get=function(t){var e=this.x,n=this.y,r=0,o,s=t.length;if(n){for(;r<s;)o=t[r],e=e[o],n=n[o],r++;return new numeric.T(e,n)}for(;r<s;)o=t[r],e=e[o],r++;return new numeric.T(e)};numeric.T.prototype.set=function(t,e){var n=this.x,r=this.y,o=0,s,a=t.length,l=e.x,c=e.y;if(a===0)return c?this.y=c:r&&(this.y=void 0),this.x=n,this;if(c){for(r||(r=numeric.rep(numeric.dim(n),0),this.y=r);o<a-1;)s=t[o],n=n[s],r=r[s],o++;return s=t[o],n[s]=l,r[s]=c,this}if(r){for(;o<a-1;)s=t[o],n=n[s],r=r[s],o++;return s=t[o],n[s]=l,l instanceof Array?r[s]=numeric.rep(numeric.dim(l),0):r[s]=0,this}for(;o<a-1;)s=t[o],n=n[s],o++;return s=t[o],n[s]=l,this};numeric.T.prototype.getRows=function(t,e){var n=e-t+1,r,o=Array(n),s,a=this.x,l=this.y;for(r=t;r<=e;r++)o[r-t]=a[r];if(l){for(s=Array(n),r=t;r<=e;r++)s[r-t]=l[r];return new numeric.T(o,s)}return new numeric.T(o)};numeric.T.prototype.setRows=function(t,e,n){var r,o=this.x,s=this.y,a=n.x,l=n.y;for(r=t;r<=e;r++)o[r]=a[r-t];if(l)for(s||(s=numeric.rep(numeric.dim(o),0),this.y=s),r=t;r<=e;r++)s[r]=l[r-t];else if(s)for(r=t;r<=e;r++)s[r]=numeric.rep([a[r-t].length],0);return this};numeric.T.prototype.getRow=function(t){var e=this.x,n=this.y;return n?new numeric.T(e[t],n[t]):new numeric.T(e[t])};numeric.T.prototype.setRow=function(t,e){var n=this.x,r=this.y,o=e.x,s=e.y;return n[t]=o,s?(r||(r=numeric.rep(numeric.dim(n),0),this.y=r),r[t]=s):r&&(r=numeric.rep([o.length],0)),this};numeric.T.prototype.getBlock=function(t,e){var n=this.x,r=this.y,o=numeric.getBlock;return r?new numeric.T(o(n,t,e),o(r,t,e)):new numeric.T(o(n,t,e))};numeric.T.prototype.setBlock=function(t,e,n){n instanceof numeric.T||(n=new numeric.T(n));var r=this.x,o=this.y,s=numeric.setBlock,a=n.x,l=n.y;if(l)return o||(this.y=numeric.rep(numeric.dim(this),0),o=this.y),s(r,t,e,a),s(o,t,e,l),this;s(r,t,e,a),o&&s(o,t,e,numeric.rep(numeric.dim(a),0))};numeric.T.rep=function(t,e){var n=numeric.T;e instanceof n||(e=new n(e));var r=e.x,o=e.y,s=numeric.rep;return o?new n(s(t,r),s(t,o)):new n(s(t,r))};numeric.T.diag=function(t){t instanceof numeric.T||(t=new numeric.T(t));var e=t.x,n=t.y,r=numeric.diag;return n?new numeric.T(r(e),r(n)):new numeric.T(r(e))};numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)};numeric.T.identity=function(t){return new numeric.T(numeric.identity(t))};numeric.T.prototype.getDiag=function(){var t=numeric,e=this.x,n=this.y;return n?new t.T(t.getDiag(e),t.getDiag(n)):new t.T(t.getDiag(e))};numeric.house=function(t){var e=numeric.clone(t),n=t[0]>=0?1:-1,r=n*numeric.norm2(t);e[0]+=r;var o=numeric.norm2(e);if(o===0)throw new Error("eig: internal error");return numeric.div(e,o)};numeric.toUpperHessenberg=function(t){var e=numeric.dim(t);if(e.length!==2||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n=e[0],r,o,s,a,l,c=numeric.clone(t),u,h,p,f,d=numeric.identity(n),m;for(o=0;o<n-2;o++){for(a=Array(n-o-1),r=o+1;r<n;r++)a[r-o-1]=c[r][o];if(numeric.norm2(a)>0){for(l=numeric.house(a),u=numeric.getBlock(c,[o+1,o],[n-1,n-1]),h=numeric.tensor(l,numeric.dot(l,u)),r=o+1;r<n;r++)for(p=c[r],f=h[r-o-1],s=o;s<n;s++)p[s]-=2*f[s-o];for(u=numeric.getBlock(c,[0,o+1],[n-1,n-1]),h=numeric.tensor(numeric.dot(u,l),l),r=0;r<n;r++)for(p=c[r],f=h[r],s=o+1;s<n;s++)p[s]-=2*f[s-o-1];for(u=Array(n-o-1),r=o+1;r<n;r++)u[r-o-1]=d[r];for(h=numeric.tensor(l,numeric.dot(l,u)),r=o+1;r<n;r++)for(m=d[r],f=h[r-o-1],s=0;s<n;s++)m[s]-=2*f[s]}}return{H:c,Q:d}};numeric.epsilon=2220446049250313e-31;numeric.QRFrancis=function(i,t){typeof t=="undefined"&&(t=1e4),i=numeric.clone(i);var e=numeric.clone(i),n=numeric.dim(i),r=n[0],o,s,a,l,c,u,h,p,f,d=numeric.identity(r),m,x,g,y,b,v,_,S,E;if(r<3)return{Q:d,B:[[0,r-1]]};var M=numeric.epsilon;for(E=0;E<t;E++){for(_=0;_<r-1;_++)if(Math.abs(i[_+1][_])<M*(Math.abs(i[_][_])+Math.abs(i[_+1][_+1]))){var N=numeric.QRFrancis(numeric.getBlock(i,[0,0],[_,_]),t),I=numeric.QRFrancis(numeric.getBlock(i,[_+1,_+1],[r-1,r-1]),t);for(g=Array(_+1),v=0;v<=_;v++)g[v]=d[v];for(y=numeric.dot(N.Q,g),v=0;v<=_;v++)d[v]=y[v];for(g=Array(r-_-1),v=_+1;v<r;v++)g[v-_-1]=d[v];for(y=numeric.dot(I.Q,g),v=_+1;v<r;v++)d[v]=y[v-_-1];return{Q:d,B:N.B.concat(numeric.add(I.B,_+1))}}if(a=i[r-2][r-2],l=i[r-2][r-1],c=i[r-1][r-2],u=i[r-1][r-1],p=a+u,h=a*u-l*c,f=numeric.getBlock(i,[0,0],[2,2]),p*p>=4*h){var w,R;w=.5*(p+Math.sqrt(p*p-4*h)),R=.5*(p-Math.sqrt(p*p-4*h)),f=numeric.add(numeric.sub(numeric.dot(f,f),numeric.mul(f,w+R)),numeric.diag(numeric.rep([3],w*R)))}else f=numeric.add(numeric.sub(numeric.dot(f,f),numeric.mul(f,p)),numeric.diag(numeric.rep([3],h)));for(o=[f[0][0],f[1][0],f[2][0]],s=numeric.house(o),g=[i[0],i[1],i[2]],y=numeric.tensor(s,numeric.dot(s,g)),v=0;v<3;v++)for(x=i[v],b=y[v],S=0;S<r;S++)x[S]-=2*b[S];for(g=numeric.getBlock(i,[0,0],[r-1,2]),y=numeric.tensor(numeric.dot(g,s),s),v=0;v<r;v++)for(x=i[v],b=y[v],S=0;S<3;S++)x[S]-=2*b[S];for(g=[d[0],d[1],d[2]],y=numeric.tensor(s,numeric.dot(s,g)),v=0;v<3;v++)for(m=d[v],b=y[v],S=0;S<r;S++)m[S]-=2*b[S];var P;for(_=0;_<r-2;_++){for(S=_;S<=_+1;S++)if(Math.abs(i[S+1][S])<M*(Math.abs(i[S][S])+Math.abs(i[S+1][S+1]))){var N=numeric.QRFrancis(numeric.getBlock(i,[0,0],[S,S]),t),I=numeric.QRFrancis(numeric.getBlock(i,[S+1,S+1],[r-1,r-1]),t);for(g=Array(S+1),v=0;v<=S;v++)g[v]=d[v];for(y=numeric.dot(N.Q,g),v=0;v<=S;v++)d[v]=y[v];for(g=Array(r-S-1),v=S+1;v<r;v++)g[v-S-1]=d[v];for(y=numeric.dot(I.Q,g),v=S+1;v<r;v++)d[v]=y[v-S-1];return{Q:d,B:N.B.concat(numeric.add(I.B,S+1))}}for(P=Math.min(r-1,_+3),o=Array(P-_),v=_+1;v<=P;v++)o[v-_-1]=i[v][_];for(s=numeric.house(o),g=numeric.getBlock(i,[_+1,_],[P,r-1]),y=numeric.tensor(s,numeric.dot(s,g)),v=_+1;v<=P;v++)for(x=i[v],b=y[v-_-1],S=_;S<r;S++)x[S]-=2*b[S-_];for(g=numeric.getBlock(i,[0,_+1],[r-1,P]),y=numeric.tensor(numeric.dot(g,s),s),v=0;v<r;v++)for(x=i[v],b=y[v],S=_+1;S<=P;S++)x[S]-=2*b[S-_-1];for(g=Array(P-_),v=_+1;v<=P;v++)g[v-_-1]=d[v];for(y=numeric.tensor(s,numeric.dot(s,g)),v=_+1;v<=P;v++)for(m=d[v],b=y[v-_-1],S=0;S<r;S++)m[S]-=2*b[S]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")};numeric.eig=function(t,e){var n=numeric.toUpperHessenberg(t),r=numeric.QRFrancis(n.H,e),o=numeric.T,D=t.length,s,a,l=!1,c=r.B,u=numeric.dot(r.Q,numeric.dot(n.H,numeric.transpose(r.Q))),h=new o(numeric.dot(r.Q,n.Q)),p,f=c.length,d,m,x,g,y,b,v,_,S,E,M,N,I,w,R=Math.sqrt;for(a=0;a<f;a++)if(s=c[a][0],s!==c[a][1]){if(d=s+1,m=u[s][s],x=u[s][d],g=u[d][s],y=u[d][d],x===0&&g===0)continue;b=-m-y,v=m*y-x*g,_=b*b-4*v,_>=0?(b<0?S=-.5*(b-R(_)):S=-.5*(b+R(_)),I=(m-S)*(m-S)+x*x,w=g*g+(y-S)*(y-S),I>w?(I=R(I),M=(m-S)/I,N=x/I):(w=R(w),M=g/w,N=(y-S)/w),p=new o([[N,-M],[M,N]]),h.setRows(s,d,p.dot(h.getRows(s,d)))):(S=-.5*b,E=.5*R(-_),I=(m-S)*(m-S)+x*x,w=g*g+(y-S)*(y-S),I>w?(I=R(I+E*E),M=(m-S)/I,N=x/I,S=0,E/=I):(w=R(w+E*E),M=g/w,N=(y-S)/w,S=E/w,E=0),p=new o([[N,-M],[M,N]],[[S,E],[E,-S]]),h.setRows(s,d,p.dot(h.getRows(s,d))))}var P=h.dot(t).dot(h.transjugate()),D=t.length,F=numeric.T.identity(D);for(d=0;d<D;d++)if(d>0)for(a=d-1;a>=0;a--){var z=P.get([a,a]),V=P.get([d,d]);if(numeric.neq(z.x,V.x)||numeric.neq(z.y,V.y))S=P.getRow(a).getBlock([a],[d-1]),E=F.getRow(d).getBlock([a],[d-1]),F.set([d,a],P.get([a,d]).neg().sub(S.dot(E)).div(z.sub(V)));else{F.setRow(d,F.getRow(a));continue}}for(d=0;d<D;d++)S=F.getRow(d),F.setRow(d,S.div(S.norm2()));return F=F.transpose(),F=h.transjugate().dot(F),{lambda:P.getDiag(),E:F}};numeric.ccsSparse=function(t){var e=t.length,a,n,r,o,s=[];for(r=e-1;r!==-1;--r){n=t[r];for(o in n){for(o=parseInt(o);o>=s.length;)s[s.length]=0;n[o]!==0&&s[o]++}}var a=s.length,l=Array(a+1);for(l[0]=0,r=0;r<a;++r)l[r+1]=l[r]+s[r];var c=Array(l[a]),u=Array(l[a]);for(r=e-1;r!==-1;--r){n=t[r];for(o in n)n[o]!==0&&(s[o]--,c[l[o]+s[o]]=r,u[l[o]+s[o]]=n[o])}return[l,c,u]};numeric.ccsFull=function(t){var e=t[0],n=t[1],r=t[2],o=numeric.ccsDim(t),s=o[0],a=o[1],l,c,u,h,p,f=numeric.rep([s,a],0);for(l=0;l<a;l++)for(u=e[l],h=e[l+1],c=u;c<h;++c)f[n[c]][l]=r[c];return f};numeric.ccsTSolve=function(t,e,n,r,o){var s=t[0],a=t[1],l=t[2],c=s.length-1,u=Math.max,h=0;typeof r=="undefined"&&(n=numeric.rep([c],0)),typeof r=="undefined"&&(r=numeric.linspace(0,n.length-1)),typeof o=="undefined"&&(o=[]);function p(S){var E;if(n[S]===0){for(n[S]=1,E=s[S];E<s[S+1];++E)p(a[E]);o[h]=S,++h}}var f,d,m,x,g,y,b,v,_;for(f=r.length-1;f!==-1;--f)p(r[f]);for(o.length=h,f=o.length-1;f!==-1;--f)n[o[f]]=0;for(f=r.length-1;f!==-1;--f)d=r[f],n[d]=e[d];for(f=o.length-1;f!==-1;--f){for(d=o[f],m=s[d],x=u(s[d+1],m),g=m;g!==x;++g)if(a[g]===d){n[d]/=l[g];break}for(_=n[d],g=m;g!==x;++g)y=a[g],y!==d&&(n[y]-=_*l[g])}return n};numeric.ccsDFS=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)};numeric.ccsDFS.prototype.dfs=function(t,e,n,r,o,s){var a=0,l,c=o.length,u=this.k,h=this.k1,p=this.j,f,d;if(r[t]===0)for(r[t]=1,p[0]=t,u[0]=f=e[t],h[0]=d=e[t+1];;)if(f>=d){if(o[c]=p[a],a===0)return;++c,--a,f=u[a],d=h[a]}else l=s[n[f]],r[l]===0?(r[l]=1,u[a]=f,++a,p[a]=l,f=e[l],h[a]=d=e[l+1]):++f};numeric.ccsLPSolve=function(t,e,n,r,o,s,a){var l=t[0],c=t[1],u=t[2],h=l.length-1,p=0,f=e[0],d=e[1],m=e[2],x,g,y,b,v,_,S,E,M,N,I,w;for(g=f[o],y=f[o+1],r.length=0,x=g;x<y;++x)a.dfs(s[d[x]],l,c,n,r,s);for(x=r.length-1;x!==-1;--x)n[r[x]]=0;for(x=g;x!==y;++x)b=s[d[x]],n[b]=m[x];for(x=r.length-1;x!==-1;--x){for(b=r[x],_=l[b],S=l[b+1],E=_;E<S;++E)if(s[c[E]]===b){n[b]/=u[E];break}for(w=n[b],E=_;E<S;++E)M=s[c[E]],M!==b&&(n[M]-=w*u[E])}return n};numeric.ccsLUP1=function(t,e){var n=t[0].length-1,r=[numeric.rep([n+1],0),[],[]],o=[numeric.rep([n+1],0),[],[]],s=r[0],a=r[1],l=r[2],c=o[0],u=o[1],h=o[2],p=numeric.rep([n],0),f=numeric.rep([n],0),d,m,x,g,y,b,v,_,S,E,M=numeric.ccsLPSolve,N=Math.max,I=Math.abs,w=numeric.linspace(0,n-1),R=numeric.linspace(0,n-1),P=new numeric.ccsDFS(n);for(typeof e=="undefined"&&(e=1),d=0;d<n;++d){for(M(r,t,p,f,d,R,P),b=-1,v=-1,m=f.length-1;m!==-1;--m)x=f[m],!(x<=d)&&(_=I(p[x]),_>b&&(v=x,b=_));for(I(p[d])<e*b&&(m=w[d],b=w[v],w[d]=b,R[b]=d,w[v]=m,R[m]=v,b=p[d],p[d]=p[v],p[v]=b),b=s[d],v=c[d],S=p[d],a[b]=w[d],l[b]=1,++b,m=f.length-1;m!==-1;--m)x=f[m],_=p[x],f[m]=0,p[x]=0,x<=d?(u[v]=x,h[v]=_,++v):(a[b]=w[x],l[b]=_/S,++b);s[d+1]=b,c[d+1]=v}for(m=a.length-1;m!==-1;--m)a[m]=R[a[m]];return{L:r,U:o,P:w,Pinv:R}};numeric.ccsDFS0=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)};numeric.ccsDFS0.prototype.dfs=function(t,e,n,r,o,s,a){var l=0,c,u=o.length,h=this.k,p=this.k1,f=this.j,d,m;if(r[t]===0)for(r[t]=1,f[0]=t,h[0]=d=e[s[t]],p[0]=m=e[s[t]+1];;){if(isNaN(d))throw new Error("Ow!");if(d>=m){if(o[u]=s[f[l]],l===0)return;++u,--l,d=h[l],m=p[l]}else c=n[d],r[c]===0?(r[c]=1,h[l]=d,++l,f[l]=c,c=s[c],d=e[c],p[l]=m=e[c+1]):++d}};numeric.ccsLPSolve0=function(t,e,n,r,o,s,a,l){var c=t[0],u=t[1],h=t[2],p=c.length-1,f=0,d=e[0],m=e[1],x=e[2],g,y,b,v,_,S,E,M,N,I,w,R;for(y=d[o],b=d[o+1],r.length=0,g=y;g<b;++g)l.dfs(m[g],c,u,n,r,s,a);for(g=r.length-1;g!==-1;--g)v=r[g],n[a[v]]=0;for(g=y;g!==b;++g)v=m[g],n[v]=x[g];for(g=r.length-1;g!==-1;--g){for(v=r[g],N=a[v],S=c[v],E=c[v+1],M=S;M<E;++M)if(u[M]===N){n[N]/=h[M];break}for(R=n[N],M=S;M<E;++M)n[u[M]]-=R*h[M];n[N]=R}};numeric.ccsLUP0=function(t,e){var n=t[0].length-1,r=[numeric.rep([n+1],0),[],[]],o=[numeric.rep([n+1],0),[],[]],s=r[0],a=r[1],l=r[2],c=o[0],u=o[1],h=o[2],p=numeric.rep([n],0),f=numeric.rep([n],0),d,m,x,g,y,b,v,_,S,E,M=numeric.ccsLPSolve0,N=Math.max,I=Math.abs,w=numeric.linspace(0,n-1),R=numeric.linspace(0,n-1),P=new numeric.ccsDFS0(n);for(typeof e=="undefined"&&(e=1),d=0;d<n;++d){for(M(r,t,p,f,d,R,w,P),b=-1,v=-1,m=f.length-1;m!==-1;--m)x=f[m],!(x<=d)&&(_=I(p[w[x]]),_>b&&(v=x,b=_));for(I(p[w[d]])<e*b&&(m=w[d],b=w[v],w[d]=b,R[b]=d,w[v]=m,R[m]=v),b=s[d],v=c[d],S=p[w[d]],a[b]=w[d],l[b]=1,++b,m=f.length-1;m!==-1;--m)x=f[m],_=p[w[x]],f[m]=0,p[w[x]]=0,x<=d?(u[v]=x,h[v]=_,++v):(a[b]=w[x],l[b]=_/S,++b);s[d+1]=b,c[d+1]=v}for(m=a.length-1;m!==-1;--m)a[m]=R[a[m]];return{L:r,U:o,P:w,Pinv:R}};numeric.ccsLUP=numeric.ccsLUP0;numeric.ccsDim=function(t){return[numeric.sup(t[1])+1,t[0].length-1]};numeric.ccsGetBlock=function(t,e,n){var r=numeric.ccsDim(t),o=r[0],s=r[1];typeof e=="undefined"?e=numeric.linspace(0,o-1):typeof e=="number"&&(e=[e]),typeof n=="undefined"?n=numeric.linspace(0,s-1):typeof n=="number"&&(n=[n]);var a,l,c,u=e.length,h,p=n.length,f,d,m,x=numeric.rep([s],0),g=[],y=[],b=[x,g,y],v=t[0],_=t[1],S=t[2],E=numeric.rep([o],0),M=0,N=numeric.rep([o],0);for(h=0;h<p;++h){d=n[h];var I=v[d],w=v[d+1];for(a=I;a<w;++a)f=_[a],N[f]=1,E[f]=S[a];for(a=0;a<u;++a)m=e[a],N[m]&&(g[M]=a,y[M]=E[e[a]],++M);for(a=I;a<w;++a)f=_[a],N[f]=0;x[h+1]=M}return b};numeric.ccsDot=function(t,e){var n=t[0],r=t[1],o=t[2],s=e[0],a=e[1],l=e[2],c=numeric.ccsDim(t),u=numeric.ccsDim(e),h=c[0],p=c[1],f=u[1],d=numeric.rep([h],0),m=numeric.rep([h],0),x=Array(h),g=numeric.rep([f],0),y=[],b=[],v=[g,y,b],_,S,E,M,N,I,w,R,P,D,F;for(E=0;E!==f;++E){for(M=s[E],N=s[E+1],P=0,S=M;S<N;++S)for(D=a[S],F=l[S],I=n[D],w=n[D+1],_=I;_<w;++_)R=r[_],m[R]===0&&(x[P]=R,m[R]=1,P=P+1),d[R]=d[R]+o[_]*F;for(M=g[E],N=M+P,g[E+1]=N,S=P-1;S!==-1;--S)F=M+S,_=x[S],y[F]=_,b[F]=d[_],m[_]=0,d[_]=0;g[E+1]=g[E]+P}return v};numeric.ccsLUPSolve=function(t,e){var n=t.L,r=t.U,o=t.P,s=e[0],a=!1;typeof s!="object"&&(e=[[0,e.length],numeric.linspace(0,e.length-1),e],s=e[0],a=!0);var l=e[1],c=e[2],u=n[0].length-1,h=s.length-1,p=numeric.rep([u],0),f=Array(u),d=numeric.rep([u],0),m=Array(u),x=numeric.rep([h+1],0),g=[],y=[],b=numeric.ccsTSolve,v,_,S,E,M,N,I=0;for(v=0;v<h;++v){for(M=0,S=s[v],E=s[v+1],_=S;_<E;++_)N=t.Pinv[l[_]],m[M]=N,d[N]=c[_],++M;for(m.length=M,b(n,d,p,m,f),_=m.length-1;_!==-1;--_)d[m[_]]=0;if(b(r,p,d,f,m),a)return d;for(_=f.length-1;_!==-1;--_)p[f[_]]=0;for(_=m.length-1;_!==-1;--_)N=m[_],g[I]=N,y[I]=d[N],d[N]=0,++I;x[v+1]=I}return[x,g,y]};numeric.ccsbinop=function(t,e){return typeof e=="undefined"&&(e=""),Function("X","Y",`var Xi = X[0], Xj = X[1], Xv = X[2];
var Yi = Y[0], Yj = Y[1], Yv = Y[2];
var n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;
var Zi = numeric.rep([n+1],0), Zj = [], Zv = [];
var x = numeric.rep([m],0),y = numeric.rep([m],0);
var xk,yk,zk;
var i,j,j0,j1,k,p=0;
`+e+`for(i=0;i<n;++i) {
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Xj[j];
    x[k] = 1;
    Zj[p] = k;
    ++p;
  }
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Yj[j];
    y[k] = Yv[j];
    if(x[k] === 0) {
      Zj[p] = k;
      ++p;
    }
  }
  Zi[i+1] = p;
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];
  j0 = Zi[i]; j1 = Zi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Zj[j];
    xk = x[k];
    yk = y[k];
`+t+`
    Zv[j] = zk;
  }
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;
}
return [Zi,Zj,Zv];`)};(function(){var k,A,B,C;for(k in numeric.ops2)isFinite(eval("1"+numeric.ops2[k]+"0"))?A="[Y[0],Y[1],numeric."+k+"(X,Y[2])]":A="NaN",isFinite(eval("0"+numeric.ops2[k]+"1"))?B="[X[0],X[1],numeric."+k+"(X[2],Y)]":B="NaN",isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?C="numeric.ccs"+k+"MM(X,Y)":C="NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+`;
if(typeof Y === "number") return `+B+`;
return `+C+`;
`)})();numeric.ccsScatter=function i(t){var e=t[0],n=t[1],r=t[2],o=numeric.sup(n)+1,s=e.length,a=numeric.rep([o],0),l=Array(s),c=Array(s),u=numeric.rep([o],0),h;for(h=0;h<s;++h)u[n[h]]++;for(h=0;h<o;++h)a[h+1]=a[h]+u[h];var p=a.slice(0),f,d;for(h=0;h<s;++h)d=n[h],f=p[d],l[f]=e[h],c[f]=r[h],p[d]=p[d]+1;return[a,l,c]};numeric.ccsGather=function i(t){var e=t[0],n=t[1],r=t[2],o=e.length-1,s=n.length,a=Array(s),l=Array(s),c=Array(s),u,h,p,f,d;for(d=0,u=0;u<o;++u)for(p=e[u],f=e[u+1],h=p;h!==f;++h)l[d]=u,a[d]=n[h],c[d]=r[h],++d;return[a,l,c]};numeric.sdim=function i(t,e,n){if(typeof e=="undefined"&&(e=[]),typeof t!="object")return e;typeof n=="undefined"&&(n=0),n in e||(e[n]=0),t.length>e[n]&&(e[n]=t.length);var r;for(r in t)t.hasOwnProperty(r)&&i(t[r],e,n+1);return e};numeric.sclone=function i(t,e,n){typeof e=="undefined"&&(e=0),typeof n=="undefined"&&(n=numeric.sdim(t).length);var r,o=Array(t.length);if(e===n-1){for(r in t)t.hasOwnProperty(r)&&(o[r]=t[r]);return o}for(r in t)t.hasOwnProperty(r)&&(o[r]=i(t[r],e+1,n));return o};numeric.sdiag=function i(t){var e=t.length,n,r=Array(e),o,s,a;for(n=e-1;n>=1;n-=2)o=n-1,r[n]=[],r[n][n]=t[n],r[o]=[],r[o][o]=t[o];return n===0&&(r[0]=[],r[0][0]=t[n]),r};numeric.sidentity=function i(t){return numeric.sdiag(numeric.rep([t],1))};numeric.stranspose=function i(t){var e=[],n=t.length,r,o,s;for(r in t)if(!!t.hasOwnProperty(r)){s=t[r];for(o in s)!s.hasOwnProperty(o)||(typeof e[o]!="object"&&(e[o]=[]),e[o][r]=s[o])}return e};numeric.sLUP=function i(t,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")};numeric.sdotMM=function i(t,e){var n=t.length,r=e.length,o=numeric.stranspose(e),s=o.length,a,l,c,u,h,p,f=Array(n),d;for(c=n-1;c>=0;c--){for(d=[],a=t[c],h=s-1;h>=0;h--){p=0,l=o[h];for(u in a)!a.hasOwnProperty(u)||u in l&&(p+=a[u]*l[u]);p&&(d[h]=p)}f[c]=d}return f};numeric.sdotMV=function i(t,e){var n=t.length,r,o,s,a=Array(n),l;for(o=n-1;o>=0;o--){r=t[o],l=0;for(s in r)!r.hasOwnProperty(s)||e[s]&&(l+=r[s]*e[s]);l&&(a[o]=l)}return a};numeric.sdotVM=function i(t,e){var n,r,o,s,a=[],l;for(n in t)if(!!t.hasOwnProperty(n)){o=e[n],s=t[n];for(r in o)!o.hasOwnProperty(r)||(a[r]||(a[r]=0),a[r]+=s*o[r])}return a};numeric.sdotVV=function i(t,e){var n,r=0;for(n in t)t[n]&&e[n]&&(r+=t[n]*e[n]);return r};numeric.sdot=function i(t,e){var n=numeric.sdim(t).length,r=numeric.sdim(e).length,o=n*1e3+r;switch(o){case 0:return t*e;case 1001:return numeric.sdotVV(t,e);case 2001:return numeric.sdotMV(t,e);case 1002:return numeric.sdotVM(t,e);case 2002:return numeric.sdotMM(t,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+r)}};numeric.sscatter=function i(t){var e=t[0].length,n,r,o,s=t.length,a=[],l;for(r=e-1;r>=0;--r)if(!!t[s-1][r]){for(l=a,o=0;o<s-2;o++)n=t[o][r],l[n]||(l[n]=[]),l=l[n];l[t[o][r]]=t[o+1][r]}return a};numeric.sgather=function i(t,e,n){typeof e=="undefined"&&(e=[]),typeof n=="undefined"&&(n=[]);var r,o,s;r=n.length;for(o in t)if(t.hasOwnProperty(o))if(n[r]=parseInt(o),s=t[o],typeof s=="number"){if(s){if(e.length===0)for(o=r+1;o>=0;--o)e[o]=[];for(o=r;o>=0;--o)e[o].push(n[o]);e[r+1].push(s)}}else i(s,e,n);return n.length>r&&n.pop(),e};numeric.cLU=function i(t){var e=t[0],n=t[1],r=t[2],N=e.length,o=0,s,a,l,c,u,h;for(s=0;s<N;s++)e[s]>o&&(o=e[s]);o++;var p=Array(o),f=Array(o),d=numeric.rep([o],1/0),m=numeric.rep([o],-1/0),b,v,x;for(l=0;l<N;l++)s=e[l],a=n[l],a<d[s]&&(d[s]=a),a>m[s]&&(m[s]=a);for(s=0;s<o-1;s++)m[s]>m[s+1]&&(m[s+1]=m[s]);for(s=o-1;s>=1;s--)d[s]<d[s-1]&&(d[s-1]=d[s]);var g=0,y=0;for(s=0;s<o;s++)f[s]=numeric.rep([m[s]-d[s]+1],0),p[s]=numeric.rep([s-d[s]],0),g+=s-d[s]+1,y+=m[s]-s+1;for(l=0;l<N;l++)s=e[l],f[s][n[l]-d[s]]=r[l];for(s=0;s<o-1;s++)for(c=s-d[s],b=f[s],a=s+1;d[a]<=s&&a<o;a++)if(u=s-d[a],h=m[s]-s,v=f[a],x=v[u]/b[c],x){for(l=1;l<=h;l++)v[l+u]-=x*b[l+c];p[a][s-d[a]]=x}var b=[],v=[],_=[],S=[],E=[],M=[],N,I,w;for(N=0,I=0,s=0;s<o;s++){for(c=d[s],u=m[s],w=f[s],a=s;a<=u;a++)w[a-c]&&(b[N]=s,v[N]=a,_[N]=w[a-c],N++);for(w=p[s],a=c;a<s;a++)w[a-c]&&(S[I]=s,E[I]=a,M[I]=w[a-c],I++);S[I]=s,E[I]=s,M[I]=1,I++}return{U:[b,v,_],L:[S,E,M]}};numeric.cLUsolve=function i(t,e){var n=t.L,r=t.U,o=numeric.clone(e),s=n[0],a=n[1],l=n[2],c=r[0],u=r[1],h=r[2],p=c.length,f=s.length,d=o.length,m,x,g;for(g=0,m=0;m<d;m++){for(;a[g]<m;)o[m]-=l[g]*o[a[g]],g++;g++}for(g=p-1,m=d-1;m>=0;m--){for(;u[g]>m;)o[m]-=h[g]*o[u[g]],g--;o[m]/=h[g],g--}return o};numeric.cgrid=function i(t,e){typeof t=="number"&&(t=[t,t]);var n=numeric.rep(t,-1),r,o,s;if(typeof e!="function")switch(e){case"L":e=function(a,l){return a>=t[0]/2||l<t[1]/2};break;default:e=function(a,l){return!0};break}for(s=0,r=1;r<t[0]-1;r++)for(o=1;o<t[1]-1;o++)e(r,o)&&(n[r][o]=s,s++);return n};numeric.cdelsq=function i(t){var e=[[-1,0],[0,-1],[0,1],[1,0]],n=numeric.dim(t),r=n[0],o=n[1],s,a,l,c,u,h=[],p=[],f=[];for(s=1;s<r-1;s++)for(a=1;a<o-1;a++)if(!(t[s][a]<0)){for(l=0;l<4;l++)c=s+e[l][0],u=a+e[l][1],!(t[c][u]<0)&&(h.push(t[s][a]),p.push(t[c][u]),f.push(-1));h.push(t[s][a]),p.push(t[s][a]),f.push(4)}return[h,p,f]};numeric.cdotMV=function i(t,e){var n,r=t[0],o=t[1],s=t[2],a,l=r.length,c;for(c=0,a=0;a<l;a++)r[a]>c&&(c=r[a]);for(c++,n=numeric.rep([c],0),a=0;a<l;a++)n[r[a]]+=s[a]*e[o[a]];return n};numeric.Spline=function i(t,e,n,r,o){this.x=t,this.yl=e,this.yr=n,this.kl=r,this.kr=o};numeric.Spline.prototype._at=function i(l,e){var n=this.x,r=this.yl,o=this.yr,s=this.kl,a=this.kr,l,c,u,h,p=numeric.add,f=numeric.sub,d=numeric.mul;c=f(d(s[e],n[e+1]-n[e]),f(o[e+1],r[e])),u=p(d(a[e+1],n[e]-n[e+1]),f(o[e+1],r[e])),h=(l-n[e])/(n[e+1]-n[e]);var m=h*(1-h);return p(p(p(d(1-h,r[e]),d(h,o[e+1])),d(c,m*(1-h))),d(u,m*h))};numeric.Spline.prototype.at=function i(t){if(typeof t=="number"){var e=this.x,u=e.length,n,r,o,s=Math.floor,a,l,c;for(n=0,r=u-1;r-n>1;)o=s((n+r)/2),e[o]<=t?n=o:r=o;return this._at(t,n)}var u=t.length,h,p=Array(u);for(h=u-1;h!==-1;--h)p[h]=this.at(t[h]);return p};numeric.Spline.prototype.diff=function i(){var t=this.x,e=this.yl,n=this.yr,r=this.kl,o=this.kr,s=e.length,a,l,c,u=r,h=o,p=Array(s),f=Array(s),d=numeric.add,m=numeric.mul,x=numeric.div,g=numeric.sub;for(a=s-1;a!==-1;--a)l=t[a+1]-t[a],c=g(n[a+1],e[a]),p[a]=x(d(m(c,6),m(r[a],-4*l),m(o[a+1],-2*l)),l*l),f[a+1]=x(d(m(c,-6),m(r[a],2*l),m(o[a+1],4*l)),l*l);return new numeric.Spline(t,u,h,p,f)};numeric.Spline.prototype.roots=function i(){function t(J){return J*J}function e(J,G,nt,et,at){var it=nt*2-(G-J),St=-et*2+(G-J),yt=(at+1)*.5,rt=yt*(1-yt);return(1-yt)*J+yt*G+it*rt*(1-yt)+St*rt*yt}var v=[],n=this.x,r=this.yl,o=this.yr,s=this.kl,a=this.kr;typeof r[0]=="number"&&(r=[r],o=[o],s=[s],a=[a]);var l=r.length,c=n.length-1,u,h,p,f,d,m,x,g,y,b,v=Array(l),_,S,E,M,N,I,w,R,P,D,F,z,V,H,X,U,Y,Z=Math.sqrt;for(u=0;u!==l;++u){for(x=r[u],g=o[u],y=s[u],b=a[u],_=[],h=0;h!==c;h++){for(h>0&&g[h]*x[h]<0&&_.push(n[h]),P=n[h+1]-n[h],D=n[h],M=x[h],N=g[h+1],S=y[h]/P,E=b[h+1]/P,R=t(S-E+3*(M-N))+12*E*M,I=E+3*M+2*S-3*N,w=3*(E+S+2*(M-N)),R<=0?(z=I/w,z>n[h]&&z<n[h+1]?F=[n[h],z,n[h+1]]:F=[n[h],n[h+1]]):(z=(I-Z(R))/w,V=(I+Z(R))/w,F=[n[h]],z>n[h]&&z<n[h+1]&&F.push(z),V>n[h]&&V<n[h+1]&&F.push(V),F.push(n[h+1])),X=F[0],z=this._at(X,h),p=0;p<F.length-1;p++){if(U=F[p+1],V=this._at(U,h),z===0){_.push(X),X=U,z=V;continue}if(V===0||z*V>0){X=U,z=V;continue}for(var K=0;Y=(z*U-V*X)/(z-V),!(Y<=X||Y>=U);)if(H=this._at(Y,h),H*V>0)U=Y,V=H,K===-1&&(z*=.5),K=-1;else if(H*z>0)X=Y,z=H,K===1&&(V*=.5),K=1;else break;_.push(Y),X=F[p+1],z=this._at(X,h)}V===0&&_.push(U)}v[u]=_}return typeof this.yl[0]=="number"?v[0]:v};numeric.spline=function i(t,e,n,r){var o=t.length,s=[],a=[],l=[],c,u=numeric.sub,h=numeric.mul,p=numeric.add;for(c=o-2;c>=0;c--)a[c]=t[c+1]-t[c],l[c]=u(e[c+1],e[c]);(typeof n=="string"||typeof r=="string")&&(n=r="periodic");var f=[[],[],[]];switch(typeof n){case"undefined":s[0]=h(3/(a[0]*a[0]),l[0]),f[0].push(0,0),f[1].push(0,1),f[2].push(2/a[0],1/a[0]);break;case"string":s[0]=p(h(3/(a[o-2]*a[o-2]),l[o-2]),h(3/(a[0]*a[0]),l[0])),f[0].push(0,0,0),f[1].push(o-2,0,1),f[2].push(1/a[o-2],2/a[o-2]+2/a[0],1/a[0]);break;default:s[0]=n,f[0].push(0),f[1].push(0),f[2].push(1);break}for(c=1;c<o-1;c++)s[c]=p(h(3/(a[c-1]*a[c-1]),l[c-1]),h(3/(a[c]*a[c]),l[c])),f[0].push(c,c,c),f[1].push(c-1,c,c+1),f[2].push(1/a[c-1],2/a[c-1]+2/a[c],1/a[c]);switch(typeof r){case"undefined":s[o-1]=h(3/(a[o-2]*a[o-2]),l[o-2]),f[0].push(o-1,o-1),f[1].push(o-2,o-1),f[2].push(1/a[o-2],2/a[o-2]);break;case"string":f[1][f[1].length-1]=0;break;default:s[o-1]=r,f[0].push(o-1),f[1].push(o-1),f[2].push(1);break}typeof s[0]!="number"?s=numeric.transpose(s):s=[s];var d=Array(s.length);if(typeof n=="string")for(c=d.length-1;c!==-1;--c)d[c]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(f)),s[c]),d[c][o-1]=d[c][0];else for(c=d.length-1;c!==-1;--c)d[c]=numeric.cLUsolve(numeric.cLU(f),s[c]);return typeof e[0]=="number"?d=d[0]:d=numeric.transpose(d),new numeric.Spline(t,e,e,d,d)};numeric.fftpow2=function i(t,e){var n=t.length;if(n!==1){var r=Math.cos,o=Math.sin,s,a,l=Array(n/2),c=Array(n/2),u=Array(n/2),h=Array(n/2);for(a=n/2,s=n-1;s!==-1;--s)--a,u[a]=t[s],h[a]=e[s],--s,l[a]=t[s],c[a]=e[s];i(l,c),i(u,h),a=n/2;var p,f=-6.283185307179586/n,d,m;for(s=n-1;s!==-1;--s)--a,a===-1&&(a=n/2-1),p=f*s,d=r(p),m=o(p),t[s]=l[a]+d*u[a]-m*h[a],e[s]=c[a]+d*h[a]+m*u[a]}};numeric._ifftpow2=function i(t,e){var n=t.length;if(n!==1){var r=Math.cos,o=Math.sin,s,a,l=Array(n/2),c=Array(n/2),u=Array(n/2),h=Array(n/2);for(a=n/2,s=n-1;s!==-1;--s)--a,u[a]=t[s],h[a]=e[s],--s,l[a]=t[s],c[a]=e[s];i(l,c),i(u,h),a=n/2;var p,f=6.283185307179586/n,d,m;for(s=n-1;s!==-1;--s)--a,a===-1&&(a=n/2-1),p=f*s,d=r(p),m=o(p),t[s]=l[a]+d*u[a]-m*h[a],e[s]=c[a]+d*h[a]+m*u[a]}};numeric.ifftpow2=function i(t,e){numeric._ifftpow2(t,e),numeric.diveq(t,t.length),numeric.diveq(e,e.length)};numeric.convpow2=function i(t,e,n,r){numeric.fftpow2(t,e),numeric.fftpow2(n,r);var o,s=t.length,a,l,c,u;for(o=s-1;o!==-1;--o)a=t[o],c=e[o],l=n[o],u=r[o],t[o]=a*l-c*u,e[o]=a*u+c*l;numeric.ifftpow2(t,e)};numeric.T.prototype.fft=function i(){var t=this.x,e=this.y,n=t.length,r=Math.log,o=r(2),s=Math.ceil(r(2*n-1)/o),a=Math.pow(2,s),l=numeric.rep([a],0),c=numeric.rep([a],0),u=Math.cos,h=Math.sin,p,f=-3.141592653589793/n,d,m=numeric.rep([a],0),x=numeric.rep([a],0),g=Math.floor(n/2);for(p=0;p<n;p++)m[p]=t[p];if(typeof e!="undefined")for(p=0;p<n;p++)x[p]=e[p];for(l[0]=1,p=1;p<=a/2;p++)d=f*p*p,l[p]=u(d),c[p]=h(d),l[a-p]=u(d),c[a-p]=h(d);var y=new numeric.T(m,x),b=new numeric.T(l,c);return y=y.mul(b),numeric.convpow2(y.x,y.y,numeric.clone(b.x),numeric.neg(b.y)),y=y.mul(b),y.x.length=n,y.y.length=n,y};numeric.T.prototype.ifft=function i(){var t=this.x,e=this.y,n=t.length,r=Math.log,o=r(2),s=Math.ceil(r(2*n-1)/o),a=Math.pow(2,s),l=numeric.rep([a],0),c=numeric.rep([a],0),u=Math.cos,h=Math.sin,p,f=3.141592653589793/n,d,m=numeric.rep([a],0),x=numeric.rep([a],0),g=Math.floor(n/2);for(p=0;p<n;p++)m[p]=t[p];if(typeof e!="undefined")for(p=0;p<n;p++)x[p]=e[p];for(l[0]=1,p=1;p<=a/2;p++)d=f*p*p,l[p]=u(d),c[p]=h(d),l[a-p]=u(d),c[a-p]=h(d);var y=new numeric.T(m,x),b=new numeric.T(l,c);return y=y.mul(b),numeric.convpow2(y.x,y.y,numeric.clone(b.x),numeric.neg(b.y)),y=y.mul(b),y.x.length=n,y.y.length=n,y.div(n)};numeric.gradient=function i(t,e){var n=e.length,r=t(e);if(isNaN(r))throw new Error("gradient: f(x) is a NaN!");var d=Math.max,o,s=numeric.clone(e),a,l,c=Array(n),u=numeric.div,h=numeric.sub,p,f,d=Math.max,m=.001,x=Math.abs,g=Math.min,y,b,v,_=0,S,E,M;for(o=0;o<n;o++)for(var N=d(1e-6*r,1e-8);;){if(++_,_>20)throw new Error("Numerical gradient fails");if(s[o]=e[o]+N,a=t(s),s[o]=e[o]-N,l=t(s),s[o]=e[o],isNaN(a)||isNaN(l)){N/=16;continue}if(c[o]=(a-l)/(2*N),y=e[o]-N,b=e[o],v=e[o]+N,S=(a-r)/N,E=(r-l)/N,M=d(x(c[o]),x(r),x(a),x(l),x(y),x(b),x(v),1e-8),p=g(d(x(S-c[o]),x(E-c[o]),x(S-E))/M,N/M),p>m)N/=16;else break}return c};numeric.uncmin=function i(t,e,n,r,o,s,a){var l=numeric.gradient;typeof a=="undefined"&&(a={}),typeof n=="undefined"&&(n=1e-8),typeof r=="undefined"&&(r=function(et){return l(t,et)}),typeof o=="undefined"&&(o=1e3),e=numeric.clone(e);var c=e.length,u=t(e),h,p;if(isNaN(u))throw new Error("uncmin: f(x0) is a NaN!");var f=Math.max,d=numeric.norm2;n=f(n,numeric.epsilon);var m,x,g,y=a.Hinv||numeric.identity(c),b=numeric.dot,v=numeric.inv,_=numeric.sub,S=numeric.add,E=numeric.tensor,M=numeric.div,N=numeric.mul,I=numeric.all,w=numeric.isFinite,R=numeric.neg,P=0,D,F,z,V,H,X,U,Y,Z,K,J,G,nt="";for(x=r(e);P<o;){if(typeof s=="function"&&s(P,e,u,x,y)){nt="Callback returned true";break}if(!I(w(x))){nt="Gradient has Infinity or NaN";break}if(m=R(b(y,x)),!I(w(m))){nt="Search direction has Infinity or NaN";break}if(K=d(m),K<n){nt="Newton step smaller than tol";break}for(Z=1,p=b(x,m),z=e;P<o&&!(Z*K<n);){if(F=N(m,Z),z=S(e,F),h=t(z),h-u>=.1*Z*p||isNaN(h)){Z*=.5,++P;continue}break}if(Z*K<n){nt="Line search step size smaller than tol";break}if(P===o){nt="maxit reached during line search";break}g=r(z),V=_(g,x),U=b(V,F),H=b(y,V),y=_(S(y,N((U+b(V,H))/(U*U),E(F,F))),M(S(E(H,F),E(F,H)),U)),e=z,u=h,x=g,++P}return{solution:e,f:u,gradient:x,invHessian:y,iterations:P,message:nt}};numeric.Dopri=function i(t,e,n,r,o,s,a){this.x=t,this.y=e,this.f=n,this.ymid=r,this.iterations=o,this.events=a,this.message=s};numeric.Dopri.prototype._at=function i(x,e){function n(I){return I*I}var r=this,o=r.x,s=r.y,a=r.f,l=r.ymid,c=o.length,u,h,p,f,d,m,x,g=Math.floor,y,b=.5,v=numeric.add,_=numeric.mul,S=numeric.sub,E,M,N;return u=o[e],h=o[e+1],f=s[e],d=s[e+1],y=h-u,p=u+b*y,m=l[e],E=S(a[e],_(f,1/(u-p)+2/(u-h))),M=S(a[e+1],_(d,1/(h-p)+2/(h-u))),N=[n(x-h)*(x-p)/n(u-h)/(u-p),n(x-u)*n(x-h)/n(u-p)/n(h-p),n(x-u)*(x-p)/n(h-u)/(h-p),(x-u)*n(x-h)*(x-p)/n(u-h)/(u-p),(x-h)*n(x-u)*(x-p)/n(u-h)/(h-p)],v(v(v(v(_(f,N[0]),_(m,N[1])),_(d,N[2])),_(E,N[3])),_(M,N[4]))};numeric.Dopri.prototype.at=function i(t){var e,n,r,o=Math.floor;if(typeof t!="number"){var s=t.length,a=Array(s);for(e=s-1;e!==-1;--e)a[e]=this.at(t[e]);return a}var l=this.x;for(e=0,n=l.length-1;n-e>1;)r=o(.5*(e+n)),l[r]<=t?e=r:n=r;return this._at(t,e)};numeric.dopri=function i(t,e,n,r,o,s,a){typeof o=="undefined"&&(o=1e-6),typeof s=="undefined"&&(s=1e3);var l=[t],c=[n],u=[r(t,n)],h,p,f,d,m,x,g=[],y=1/5,b=[3/40,9/40],v=[44/45,-56/15,32/9],_=[19372/6561,-25360/2187,64448/6561,-212/729],S=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],E=[35/384,0,500/1113,125/192,-2187/6784,11/84],M=[.5*6025192743/30085553152,0,.5*51252292925/65400821598,.5*-2691868925/45128329728,.5*187940372067/1594534317056,.5*-1776094331/19743644256,.5*11237099/235043384],N=[1/5,3/10,4/5,8/9,1,1],I=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],w=0,R,P,D=(e-t)/10,F=0,z=numeric.add,V=numeric.mul,H,X,U=Math.max,Y=Math.min,Z=Math.abs,K=numeric.norminf,J=Math.pow,G=numeric.any,nt=numeric.lt,et=numeric.and,at=numeric.sub,it,St,yt,rt=new numeric.Dopri(l,c,u,g,-1,"");for(typeof a=="function"&&(it=a(t,n));t<e&&F<s;){if(++F,t+D>e&&(D=e-t),h=r(t+N[0]*D,z(n,V(y*D,u[w]))),p=r(t+N[1]*D,z(z(n,V(b[0]*D,u[w])),V(b[1]*D,h))),f=r(t+N[2]*D,z(z(z(n,V(v[0]*D,u[w])),V(v[1]*D,h)),V(v[2]*D,p))),d=r(t+N[3]*D,z(z(z(z(n,V(_[0]*D,u[w])),V(_[1]*D,h)),V(_[2]*D,p)),V(_[3]*D,f))),m=r(t+N[4]*D,z(z(z(z(z(n,V(S[0]*D,u[w])),V(S[1]*D,h)),V(S[2]*D,p)),V(S[3]*D,f)),V(S[4]*D,d))),H=z(z(z(z(z(n,V(u[w],D*E[0])),V(p,D*E[2])),V(f,D*E[3])),V(d,D*E[4])),V(m,D*E[5])),x=r(t+D,H),R=z(z(z(z(z(V(u[w],D*I[0]),V(p,D*I[2])),V(f,D*I[3])),V(d,D*I[4])),V(m,D*I[5])),V(x,D*I[6])),typeof R=="number"?X=Z(R):X=K(R),X>o){if(D=.2*D*J(o/X,.25),t+D===t){rt.msg="Step size became too small";break}continue}if(g[w]=z(z(z(z(z(z(n,V(u[w],D*M[0])),V(p,D*M[2])),V(f,D*M[3])),V(d,D*M[4])),V(m,D*M[5])),V(x,D*M[6])),++w,l[w]=t+D,c[w]=H,u[w]=x,typeof a=="function"){var vt,ct=t,_t=t+.5*D,gt;if(St=a(_t,g[w-1]),yt=et(nt(it,0),nt(0,St)),G(yt)||(ct=_t,_t=t+D,it=St,St=a(_t,H),yt=et(nt(it,0),nt(0,St))),G(yt)){for(var Pt,Dt,Jt,Qt,re=0,j=1,$=1;;){if(typeof it=="number")gt=($*St*ct-j*it*_t)/($*St-j*it);else for(gt=_t,P=it.length-1;P!==-1;--P)it[P]<0&&St[P]>0&&(gt=Y(gt,($*St[P]*ct-j*it[P]*_t)/($*St[P]-j*it[P])));if(gt<=ct||gt>=_t)break;vt=rt._at(gt,w-1),Qt=a(gt,vt),Jt=et(nt(it,0),nt(0,Qt)),G(Jt)?(_t=gt,St=Qt,yt=Jt,$=1,re===-1?j*=.5:j=1,re=-1):(ct=gt,it=Qt,j=1,re===1?$*=.5:$=1,re=1)}return H=rt._at(.5*(t+gt),w-1),rt.f[w]=r(gt,vt),rt.x[w]=gt,rt.y[w]=vt,rt.ymid[w-1]=H,rt.events=yt,rt.iterations=F,rt}}t+=D,n=H,it=St,D=Y(.8*D*J(o/X,.25),4*D)}return rt.iterations=F,rt};numeric.LU=function(i,t){t=t||!1;var e=Math.abs,n,r,o,s,a,l,c,u,h,p=i.length,f=p-1,d=new Array(p);for(t||(i=numeric.clone(i)),o=0;o<p;++o){for(c=o,l=i[o],h=e(l[o]),r=o+1;r<p;++r)s=e(i[r][o]),h<s&&(h=s,c=r);for(d[o]=c,c!=o&&(i[o]=i[c],i[c]=l,l=i[o]),a=l[o],n=o+1;n<p;++n)i[n][o]/=a;for(n=o+1;n<p;++n){for(u=i[n],r=o+1;r<f;++r)u[r]-=u[o]*l[r],++r,u[r]-=u[o]*l[r];r===f&&(u[r]-=u[o]*l[r])}}return{LU:i,P:d}};numeric.LUsolve=function i(t,e){var n,r,o=t.LU,s=o.length,a=numeric.clone(e),l=t.P,c,u,h,p;for(n=s-1;n!==-1;--n)a[n]=e[n];for(n=0;n<s;++n)for(c=l[n],l[n]!==n&&(p=a[n],a[n]=a[c],a[c]=p),u=o[n],r=0;r<n;++r)a[n]-=a[r]*u[r];for(n=s-1;n>=0;--n){for(u=o[n],r=n+1;r<s;++r)a[n]-=a[r]*u[r];a[n]/=u[n]}return a};numeric.solve=function i(t,e,n){return numeric.LUsolve(numeric.LU(t,n),e)};numeric.echelonize=function i(t){var e=numeric.dim(t),n=e[0],r=e[1],o=numeric.identity(n),s=Array(n),a,l,c,u,h,p,f,d,m=Math.abs,x=numeric.diveq;for(t=numeric.clone(t),a=0;a<n;++a){for(c=0,h=t[a],p=o[a],l=1;l<r;++l)m(h[c])<m(h[l])&&(c=l);for(s[a]=c,x(p,h[c]),x(h,h[c]),l=0;l<n;++l)if(l!==a){for(f=t[l],d=f[c],u=r-1;u!==-1;--u)f[u]-=h[u]*d;for(f=o[l],u=n-1;u!==-1;--u)f[u]-=p[u]*d}}return{I:o,A:t,P:s}};numeric.__solveLP=function i(t,e,n,r,o,s,a){var l=numeric.sum,c=numeric.log,u=numeric.mul,h=numeric.sub,p=numeric.dot,f=numeric.div,d=numeric.add,m=t.length,x=n.length,g,y=!1,b,v=0,_=1,S,E,M=numeric.transpose(e),N=numeric.svd,I=numeric.transpose,w=numeric.leq,R=Math.sqrt,P=Math.abs,D=numeric.muleq,F=numeric.norminf,z=numeric.any,V=Math.min,H=numeric.all,X=numeric.gt,U=Array(m),Y=Array(x),Z=numeric.rep([x],1),K,J=numeric.solve,G=h(n,p(e,s)),nt,et=p(t,t),at;for(nt=v;nt<o;++nt){var it,St,yt;for(it=x-1;it!==-1;--it)Y[it]=f(e[it],G[it]);var rt=I(Y);for(it=m-1;it!==-1;--it)U[it]=l(rt[it]);_=.25*P(et/p(t,U));var vt=100*R(et/p(U,U));for((!isFinite(_)||_>vt)&&(_=vt),at=d(t,u(_,U)),K=p(rt,Y),it=m-1;it!==-1;--it)K[it][it]+=1;yt=J(K,f(at,_),!0);var ct=f(G,p(e,yt)),_t=1;for(it=x-1;it!==-1;--it)ct[it]<0&&(_t=V(_t,-.999*ct[it]));if(g=h(s,u(yt,_t)),G=h(n,p(e,g)),!H(X(G,0)))return{solution:s,message:"",iterations:nt};if(s=g,_<r)return{solution:g,message:"",iterations:nt};if(a){var gt=p(t,at),Pt=p(e,at);for(y=!0,it=x-1;it!==-1;--it)if(gt*Pt[it]<0){y=!1;break}}else s[m-1]>=0?y=!1:y=!0;if(y)return{solution:g,message:"Unbounded",iterations:nt}}return{solution:s,message:"maximum iteration count exceeded",iterations:nt}};numeric._solveLP=function i(t,e,n,r,o){var s=t.length,a=n.length,b,l=numeric.sum,c=numeric.log,u=numeric.mul,h=numeric.sub,p=numeric.dot,f=numeric.div,d=numeric.add,m=numeric.rep([s],0).concat([1]),x=numeric.rep([a,1],-1),g=numeric.blockMatrix([[e,x]]),y=n,b=numeric.rep([s],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),v=numeric.__solveLP(m,g,y,r,o,b,!1),_=numeric.clone(v.solution);_.length=s;var S=numeric.inf(h(n,p(e,_)));if(S<0)return{solution:NaN,message:"Infeasible",iterations:v.iterations};var E=numeric.__solveLP(t,e,n,r,o-v.iterations,_,!0);return E.iterations+=v.iterations,E};numeric.solveLP=function i(t,e,n,r,o,s,a){if(typeof a=="undefined"&&(a=1e3),typeof s=="undefined"&&(s=numeric.epsilon),typeof r=="undefined")return numeric._solveLP(t,e,n,s,a);var l=r.length,c=r[0].length,u=e.length,h=numeric.echelonize(r),p=numeric.rep([c],0),f=h.P,d=[],m;for(m=f.length-1;m!==-1;--m)p[f[m]]=1;for(m=c-1;m!==-1;--m)p[m]===0&&d.push(m);var x=numeric.getRange,g=numeric.linspace(0,l-1),y=numeric.linspace(0,u-1),b=x(r,g,d),v=x(e,y,f),_=x(e,y,d),S=numeric.dot,E=numeric.sub,M=S(v,h.I),N=E(_,S(M,b)),I=E(n,S(M,o)),w=Array(f.length),R=Array(d.length);for(m=f.length-1;m!==-1;--m)w[m]=t[f[m]];for(m=d.length-1;m!==-1;--m)R[m]=t[d[m]];var P=E(R,S(w,S(h.I,b))),D=numeric._solveLP(P,N,I,s,a),F=D.solution;if(F!==F)return D;var z=S(h.I,E(o,S(b,F))),V=Array(t.length);for(m=f.length-1;m!==-1;--m)V[f[m]]=z[m];for(m=d.length-1;m!==-1;--m)V[d[m]]=F[m];return{solution:V,message:D.message,iterations:D.iterations}};numeric.MPStoLP=function i(t){t instanceof String&&t.split(`
`);var e=0,n=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],r=t.length,o,s,a,l=0,c={},u=[],h=0,p={},f=0,d,m=[],x=[],g=[];function y(E){throw new Error("MPStoLP: "+E+`
Line `+o+": "+t[o]+`
Current state: `+n[e]+`
`)}for(o=0;o<r;++o){a=t[o];var b=a.match(/\S*/g),v=[];for(s=0;s<b.length;++s)b[s]!==""&&v.push(b[s]);if(v.length!==0){for(s=0;s<n.length&&a.substr(0,n[s].length)!==n[s];++s);if(s<n.length){if(e=s,s===1&&(d=v[1]),s===6)return{name:d,c:m,A:numeric.transpose(x),b:g,rows:c,vars:p};continue}switch(e){case 0:case 1:y("Unexpected line");case 2:switch(v[0]){case"N":l===0?l=v[1]:y("Two or more N rows");break;case"L":c[v[1]]=h,u[h]=1,g[h]=0,++h;break;case"G":c[v[1]]=h,u[h]=-1,g[h]=0,++h;break;case"E":c[v[1]]=h,u[h]=0,g[h]=0,++h;break;default:y("Parse error "+numeric.prettyPrint(v))}break;case 3:p.hasOwnProperty(v[0])||(p[v[0]]=f,m[f]=0,x[f]=numeric.rep([h],0),++f);var _=p[v[0]];for(s=1;s<v.length;s+=2){if(v[s]===l){m[_]=parseFloat(v[s+1]);continue}var S=c[v[s]];x[_][S]=(u[S]<0?-1:1)*parseFloat(v[s+1])}break;case 4:for(s=1;s<v.length;s+=2)g[c[v[s]]]=(u[c[v[s]]]<0?-1:1)*parseFloat(v[s+1]);break;case 5:break;case 6:y("Internal error")}}}y("Reached end of file without ENDATA")};numeric.seedrandom={pow:Math.pow,random:Math.random};(function(i,t,e,n,r,o,s){t.seedrandom=function(p,f){var d=[],m;return p=c(l(f?[p,i]:arguments.length?p:[new Date().getTime(),i,window],3),d),m=new a(d),c(m.S,i),t.random=function(){for(var g=m.g(n),y=s,b=0;g<r;)g=(g+b)*e,y*=e,b=m.g(1);for(;g>=o;)g/=2,y/=2,b>>>=1;return(g+b)/y},p};function a(h){var p,f,d=this,m=h.length,x=0,g=d.i=d.j=d.m=0;for(d.S=[],d.c=[],m||(h=[m++]);x<e;)d.S[x]=x++;for(x=0;x<e;x++)p=d.S[x],g=u(g+p+h[x%m]),f=d.S[g],d.S[x]=f,d.S[g]=p;d.g=function(b){var v=d.S,_=u(d.i+1),S=v[_],E=u(d.j+S),M=v[E];v[_]=M,v[E]=S;for(var N=v[u(S+M)];--b;)_=u(_+1),S=v[_],E=u(E+S),M=v[E],v[_]=M,v[E]=S,N=N*e+v[u(S+M)];return d.i=_,d.j=E,N},d.g(e)}function l(h,p,f,d,m){if(f=[],m=typeof h,p&&m=="object"){for(d in h)if(d.indexOf("S")<5)try{f.push(l(h[d],p-1))}catch(x){}}return f.length?f:h+(m!="string"?"\0":"")}function c(h,p,f,d){for(h+="",f=0,d=0;d<h.length;d++)p[u(d)]=u((f^=p[u(d)]*19)+h.charCodeAt(d));h="";for(d in p)h+=String.fromCharCode(p[d]);return h}function u(h){return h&e-1}s=t.pow(e,n),r=t.pow(2,r),o=r*2,c(t.random(),i)})([],numeric.seedrandom,256,6,52);(function(i){function t(l){if(typeof l!="object")return l;var c=[],u,h=l.length;for(u=0;u<h;u++)c[u+1]=t(l[u]);return c}function e(l){if(typeof l!="object")return l;var c=[],u,h=l.length;for(u=1;u<h;u++)c[u-1]=e(l[u]);return c}function n(l,c,u){var h,p,f,d,m;for(f=1;f<=u;f=f+1){for(l[f][f]=1/l[f][f],m=-l[f][f],h=1;h<f;h=h+1)l[h][f]=m*l[h][f];if(d=f+1,u<d)break;for(p=d;p<=u;p=p+1)for(m=l[f][p],l[f][p]=0,h=1;h<=f;h=h+1)l[h][p]=l[h][p]+m*l[h][f]}}function r(l,c,u,h){var p,f,d,m;for(f=1;f<=u;f=f+1){for(m=0,p=1;p<f;p=p+1)m=m+l[p][f]*h[p];h[f]=(h[f]-m)/l[f][f]}for(d=1;d<=u;d=d+1)for(f=u+1-d,h[f]=h[f]/l[f][f],m=-h[f],p=1;p<f;p=p+1)h[p]=h[p]+m*l[p][f]}function o(l,c,u,h){var p,f,d,m,x,g;for(f=1;f<=u;f=f+1){if(h[1]=f,g=0,d=f-1,d<1){if(g=l[f][f]-g,g<=0)break;l[f][f]=Math.sqrt(g)}else{for(m=1;m<=d;m=m+1){for(x=l[m][f],p=1;p<m;p=p+1)x=x-l[p][f]*l[p][m];x=x/l[m][m],l[m][f]=x,g=g+x*x}if(g=l[f][f]-g,g<=0)break;l[f][f]=Math.sqrt(g)}h[1]=0}}function s(l,c,u,h,p,f,d,m,x,g,y,b,v,_,S,E){var M,N,I,w,R,P,D,F,z,V,H,X,U,Y,Z,K,J,G,nt,et,at,it,St,yt,rt,vt,ct;U=Math.min(h,g),I=2*h+U*(U+5)/2+2*g+1,yt=1e-60;do yt=yt+yt,rt=1+.1*yt,vt=1+.2*yt;while(rt<=1||vt<=1);for(M=1;M<=h;M=M+1)S[M]=c[M];for(M=h+1;M<=I;M=M+1)S[M]=0;for(M=1;M<=g;M=M+1)b[M]=0;if(R=[],E[1]===0){if(o(l,u,h,R),R[1]!==0){E[1]=2;return}r(l,u,h,c),n(l,u,h)}else{for(N=1;N<=h;N=N+1)for(p[N]=0,M=1;M<=N;M=M+1)p[N]=p[N]+l[M][N]*c[M];for(N=1;N<=h;N=N+1)for(c[N]=0,M=N;M<=h;M=M+1)c[N]=c[N]+l[N][M]*p[M]}for(f[1]=0,N=1;N<=h;N=N+1)for(p[N]=c[N],f[1]=f[1]+S[N]*p[N],S[N]=0,M=N+1;M<=h;M=M+1)l[M][N]=0;for(f[1]=-f[1]/2,E[1]=0,D=h,F=D+h,H=F+U,z=H+U+1,V=z+U*(U+1)/2,Y=V+g,M=1;M<=g;M=M+1){for(K=0,N=1;N<=h;N=N+1)K=K+d[N][M]*d[N][M];S[Y+M]=Math.sqrt(K)}v=0,_[1]=0,_[2]=0;function _t(){for(_[1]=_[1]+1,I=V,M=1;M<=g;M=M+1){for(I=I+1,K=-m[M],N=1;N<=h;N=N+1)K=K+d[N][M]*p[N];if(Math.abs(K)<yt&&(K=0),M>y)S[I]=K;else if(S[I]=-Math.abs(K),K>0){for(N=1;N<=h;N=N+1)d[N][M]=-d[N][M];m[M]=-m[M]}}for(M=1;M<=v;M=M+1)S[V+b[M]]=0;for(X=0,Z=0,M=1;M<=g;M=M+1)S[V+M]<Z*S[Y+M]&&(X=M,Z=S[V+M]/S[Y+M]);return X===0?999:0}function gt(){for(M=1;M<=h;M=M+1){for(K=0,N=1;N<=h;N=N+1)K=K+l[N][M]*d[N][X];S[M]=K}for(w=D,M=1;M<=h;M=M+1)S[w+M]=0;for(N=v+1;N<=h;N=N+1)for(M=1;M<=h;M=M+1)S[w+M]=S[w+M]+l[M][N]*S[N];for(it=!0,M=v;M>=1;M=M-1){for(K=S[M],I=z+M*(M+3)/2,w=I-M,N=M+1;N<=v;N=N+1)K=K-S[I]*S[F+N],I=I+N;if(K=K/S[w],S[F+M]=K,b[M]<y||K<0)break;it=!1,P=M}if(!it)for(J=S[H+P]/S[F+P],M=1;M<=v&&!(b[M]<y||S[F+M]<0);M=M+1)Z=S[H+M]/S[F+M],Z<J&&(J=Z,P=M);for(K=0,M=D+1;M<=D+h;M=M+1)K=K+S[M]*S[M];if(Math.abs(K)<=yt){if(it)return E[1]=1,999;for(M=1;M<=v;M=M+1)S[H+M]=S[H+M]-J*S[F+M];return S[H+v+1]=S[H+v+1]+J,700}else{for(K=0,M=1;M<=h;M=M+1)K=K+S[D+M]*d[M][X];for(G=-S[V+X]/K,St=!0,it||J<G&&(G=J,St=!1),M=1;M<=h;M=M+1)p[M]=p[M]+G*S[D+M],Math.abs(p[M])<yt&&(p[M]=0);for(f[1]=f[1]+G*K*(G/2+S[H+v+1]),M=1;M<=v;M=M+1)S[H+M]=S[H+M]-G*S[F+M];if(S[H+v+1]=S[H+v+1]+G,St){for(v=v+1,b[v]=X,I=z+(v-1)*v/2+1,M=1;M<=v-1;M=M+1)S[I]=S[M],I=I+1;if(v===h)S[I]=S[h];else{for(M=h;M>=v+1&&!(S[M]===0||(nt=Math.max(Math.abs(S[M-1]),Math.abs(S[M])),et=Math.min(Math.abs(S[M-1]),Math.abs(S[M])),S[M-1]>=0?Z=Math.abs(nt*Math.sqrt(1+et*et/(nt*nt))):Z=-Math.abs(nt*Math.sqrt(1+et*et/(nt*nt))),nt=S[M-1]/Z,et=S[M]/Z,nt===1));M=M-1)if(nt===0)for(S[M-1]=et*Z,N=1;N<=h;N=N+1)Z=l[N][M-1],l[N][M-1]=l[N][M],l[N][M]=Z;else for(S[M-1]=Z,at=et/(1+nt),N=1;N<=h;N=N+1)Z=nt*l[N][M-1]+et*l[N][M],l[N][M]=at*(l[N][M-1]+Z)-l[N][M],l[N][M-1]=Z;S[I]=S[v]}}else{for(K=-m[X],N=1;N<=h;N=N+1)K=K+p[N]*d[N][X];if(X>y)S[V+X]=K;else if(S[V+X]=-Math.abs(K),K>0){for(N=1;N<=h;N=N+1)d[N][X]=-d[N][X];m[X]=-m[X]}return 700}}return 0}function Pt(){if(I=z+P*(P+1)/2+1,w=I+P,S[w]===0||(nt=Math.max(Math.abs(S[w-1]),Math.abs(S[w])),et=Math.min(Math.abs(S[w-1]),Math.abs(S[w])),S[w-1]>=0?Z=Math.abs(nt*Math.sqrt(1+et*et/(nt*nt))):Z=-Math.abs(nt*Math.sqrt(1+et*et/(nt*nt))),nt=S[w-1]/Z,et=S[w]/Z,nt===1))return 798;if(nt===0){for(M=P+1;M<=v;M=M+1)Z=S[w-1],S[w-1]=S[w],S[w]=Z,w=w+M;for(M=1;M<=h;M=M+1)Z=l[M][P],l[M][P]=l[M][P+1],l[M][P+1]=Z}else{for(at=et/(1+nt),M=P+1;M<=v;M=M+1)Z=nt*S[w-1]+et*S[w],S[w]=at*(S[w-1]+Z)-S[w],S[w-1]=Z,w=w+M;for(M=1;M<=h;M=M+1)Z=nt*l[M][P]+et*l[M][P+1],l[M][P+1]=at*(l[M][P]+Z)-l[M][P+1],l[M][P]=Z}return 0}function Dt(){for(w=I-P,M=1;M<=P;M=M+1)S[w]=S[I],I=I+1,w=w+1;return S[H+P]=S[H+P+1],b[P]=b[P+1],P=P+1,P<v?797:0}function Jt(){return S[H+v]=S[H+v+1],S[H+v+1]=0,b[v]=0,v=v-1,_[2]=_[2]+1,0}for(ct=0;;){if(ct=_t(),ct===999)return;for(;ct=gt(),ct!==0;){if(ct===999)return;if(ct===700)if(P===v)Jt();else{for(;Pt(),ct=Dt(),ct===797;);Jt()}}}}function a(l,c,u,h,p,f){l=t(l),c=t(c),u=t(u);var d,m,x,g,y,b=[],v=[],_=[],S=[],E=[],M;if(p=p||0,f=f?t(f):[void 0,0],h=h?t(h):[],m=l.length-1,x=u[1].length-1,!h)for(d=1;d<=x;d=d+1)h[d]=0;for(d=1;d<=x;d=d+1)v[d]=0;for(g=0,y=Math.min(m,x),d=1;d<=m;d=d+1)_[d]=0;for(b[1]=0,d=1;d<=2*m+y*(y+5)/2+2*x+1;d=d+1)S[d]=0;for(d=1;d<=2;d=d+1)E[d]=0;return s(l,c,m,m,_,b,u,h,m,x,p,v,g,E,S,f),M="",f[1]===1&&(M="constraints are inconsistent, no solution!"),f[1]===2&&(M="matrix D in quadratic function is not positive definite!"),{solution:e(_),value:e(b),unconstrained_solution:e(c),iterations:e(E),iact:e(v),message:M}}i.solveQP=a})(numeric);numeric.svd=function i(t){var e,n=numeric.epsilon,r=1e-64/n,o=50,s=0,a=0,l=0,c=0,u=0,h=numeric.clone(t),p=h.length,f=h[0].length;if(p<f)throw"Need more rows than columns";var d=new Array(f),m=new Array(f);for(a=0;a<f;a++)d[a]=m[a]=0;var x=numeric.rep([f,f],0);function g(R,P){return R=Math.abs(R),P=Math.abs(P),R>P?R*Math.sqrt(1+P*P/R/R):P==0?R:P*Math.sqrt(1+R*R/P/P)}var y=0,b=0,v=0,_=0,S=0,E=0,M=0;for(a=0;a<f;a++){for(d[a]=b,M=0,u=a+1,l=a;l<p;l++)M+=h[l][a]*h[l][a];if(M<=r)b=0;else for(y=h[a][a],b=Math.sqrt(M),y>=0&&(b=-b),v=y*b-M,h[a][a]=y-b,l=u;l<f;l++){for(M=0,c=a;c<p;c++)M+=h[c][a]*h[c][l];for(y=M/v,c=a;c<p;c++)h[c][l]+=y*h[c][a]}for(m[a]=b,M=0,l=u;l<f;l++)M=M+h[a][l]*h[a][l];if(M<=r)b=0;else{for(y=h[a][a+1],b=Math.sqrt(M),y>=0&&(b=-b),v=y*b-M,h[a][a+1]=y-b,l=u;l<f;l++)d[l]=h[a][l]/v;for(l=u;l<p;l++){for(M=0,c=u;c<f;c++)M+=h[l][c]*h[a][c];for(c=u;c<f;c++)h[l][c]+=M*d[c]}}S=Math.abs(m[a])+Math.abs(d[a]),S>_&&(_=S)}for(a=f-1;a!=-1;a+=-1){if(b!=0){for(v=b*h[a][a+1],l=u;l<f;l++)x[l][a]=h[a][l]/v;for(l=u;l<f;l++){for(M=0,c=u;c<f;c++)M+=h[a][c]*x[c][l];for(c=u;c<f;c++)x[c][l]+=M*x[c][a]}}for(l=u;l<f;l++)x[a][l]=0,x[l][a]=0;x[a][a]=1,b=d[a],u=a}for(a=f-1;a!=-1;a+=-1){for(u=a+1,b=m[a],l=u;l<f;l++)h[a][l]=0;if(b!=0){for(v=h[a][a]*b,l=u;l<f;l++){for(M=0,c=u;c<p;c++)M+=h[c][a]*h[c][l];for(y=M/v,c=a;c<p;c++)h[c][l]+=y*h[c][a]}for(l=a;l<p;l++)h[l][a]=h[l][a]/b}else for(l=a;l<p;l++)h[l][a]=0;h[a][a]+=1}for(n=n*_,c=f-1;c!=-1;c+=-1)for(var N=0;N<o;N++){var I=!1;for(u=c;u!=-1;u+=-1){if(Math.abs(d[u])<=n){I=!0;break}if(Math.abs(m[u-1])<=n)break}if(!I){s=0,M=1;var w=u-1;for(a=u;a<c+1&&(y=M*d[a],d[a]=s*d[a],!(Math.abs(y)<=n));a++)for(b=m[a],v=g(y,b),m[a]=v,s=b/v,M=-y/v,l=0;l<p;l++)S=h[l][w],E=h[l][a],h[l][w]=S*s+E*M,h[l][a]=-S*M+E*s}if(E=m[c],u==c){if(E<0)for(m[c]=-E,l=0;l<f;l++)x[l][c]=-x[l][c];break}if(N>=o-1)throw"Error: no convergence.";for(_=m[u],S=m[c-1],b=d[c-1],v=d[c],y=((S-E)*(S+E)+(b-v)*(b+v))/(2*v*S),b=g(y,1),y<0?y=((_-E)*(_+E)+v*(S/(y-b)-v))/_:y=((_-E)*(_+E)+v*(S/(y+b)-v))/_,s=1,M=1,a=u+1;a<c+1;a++){for(b=d[a],S=m[a],v=M*b,b=s*b,E=g(y,v),d[a-1]=E,s=y/E,M=v/E,y=_*s+b*M,b=-_*M+b*s,v=S*M,S=S*s,l=0;l<f;l++)_=x[l][a-1],E=x[l][a],x[l][a-1]=_*s+E*M,x[l][a]=-_*M+E*s;for(E=g(y,v),m[a-1]=E,s=y/E,M=v/E,y=s*b+M*S,_=-M*b+s*S,l=0;l<p;l++)S=h[l][a-1],E=h[l][a],h[l][a-1]=S*s+E*M,h[l][a]=-S*M+E*s}d[u]=0,d[c]=y,m[c]=_}for(a=0;a<m.length;a++)m[a]<n&&(m[a]=0);for(a=0;a<f;a++)for(l=a-1;l>=0;l--)if(m[l]<m[a]){for(s=m[l],m[l]=m[a],m[a]=s,c=0;c<h.length;c++)e=h[c][a],h[c][a]=h[c][l],h[c][l]=e;for(c=0;c<x.length;c++)e=x[c][a],x[c][a]=x[c][l],x[c][l]=e;a=l}return{U:h,S:m,V:x}}});var qR=un(()=>{});var XR=un(()=>{});var EP=un((MP,HS)=>{(function(i,t,e){function n(a){var l=this,c=s();l.next=function(){var u=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=u-(l.c=u|0)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(a),l.s0<0&&(l.s0+=1),l.s1-=c(a),l.s1<0&&(l.s1+=1),l.s2-=c(a),l.s2<0&&(l.s2+=1),c=null}function r(a,l){return l.c=a.c,l.s0=a.s0,l.s1=a.s1,l.s2=a.s2,l}function o(a,l){var c=new n(a),u=l&&l.state,h=c.next;return h.int32=function(){return c.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,u&&(typeof u=="object"&&r(u,c),h.state=function(){return r(c,{})}),h}function s(){var a=4022871197,l=function(c){c=c.toString();for(var u=0;u<c.length;u++){a+=c.charCodeAt(u);var h=.02519603282416938*a;a=h>>>0,h-=a,h*=a,a=h>>>0,h-=a,a+=h*4294967296}return(a>>>0)*23283064365386963e-26};return l}t&&t.exports?t.exports=o:e&&e.amd?e(function(){return o}):this.alea=o})(MP,typeof HS=="object"&&HS,typeof define=="function"&&define)});var IP=un((TP,$S)=>{(function(i,t,e){function n(s){var a=this,l="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var u=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^u^u>>>8},s===(s|0)?a.x=s:l+=s;for(var c=0;c<l.length+64;c++)a.x^=l.charCodeAt(c)|0,a.next()}function r(s,a){return a.x=s.x,a.y=s.y,a.z=s.z,a.w=s.w,a}function o(s,a){var l=new n(s),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var h=l.next()>>>11,p=(l.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(typeof c=="object"&&r(c,l),u.state=function(){return r(l,{})}),u}t&&t.exports?t.exports=o:e&&e.amd?e(function(){return o}):this.xor128=o})(TP,typeof $S=="object"&&$S,typeof define=="function"&&define)});var kP=un((AP,US)=>{(function(i,t,e){function n(s){var a=this,l="";a.next=function(){var u=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(u^u<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,s===(s|0)?a.x=s:l+=s;for(var c=0;c<l.length+64;c++)a.x^=l.charCodeAt(c)|0,c==l.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function r(s,a){return a.x=s.x,a.y=s.y,a.z=s.z,a.w=s.w,a.v=s.v,a.d=s.d,a}function o(s,a){var l=new n(s),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var h=l.next()>>>11,p=(l.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(typeof c=="object"&&r(c,l),u.state=function(){return r(l,{})}),u}t&&t.exports?t.exports=o:e&&e.amd?e(function(){return o}):this.xorwow=o})(AP,typeof US=="object"&&US,typeof define=="function"&&define)});var PP=un((RP,WS)=>{(function(i,t,e){function n(s){var a=this;a.next=function(){var c=a.x,u=a.i,h,p,f;return h=c[u],h^=h>>>7,p=h^h<<24,h=c[u+1&7],p^=h^h>>>10,h=c[u+3&7],p^=h^h>>>3,h=c[u+4&7],p^=h^h<<7,h=c[u+7&7],h=h^h<<13,p^=h^h<<9,c[u]=p,a.i=u+1&7,p};function l(c,u){var h,p,f=[];if(u===(u|0))p=f[0]=u;else for(u=""+u,h=0;h<u.length;++h)f[h&7]=f[h&7]<<15^u.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?p=f[7]=-1:p=f[h],c.x=f,c.i=0,h=256;h>0;--h)c.next()}l(a,s)}function r(s,a){return a.x=s.x.slice(),a.i=s.i,a}function o(s,a){s==null&&(s=+new Date);var l=new n(s),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var h=l.next()>>>11,p=(l.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(c.x&&r(c,l),u.state=function(){return r(l,{})}),u}t&&t.exports?t.exports=o:e&&e.amd?e(function(){return o}):this.xorshift7=o})(RP,typeof WS=="object"&&WS,typeof define=="function"&&define)});var LP=un((NP,GS)=>{(function(i,t,e){function n(s){var a=this;a.next=function(){var c=a.w,u=a.X,h=a.i,p,f;return a.w=c=c+1640531527|0,f=u[h+34&127],p=u[h=h+1&127],f^=f<<13,p^=p<<17,f^=f>>>15,p^=p>>>12,f=u[h]=f^p,a.i=h,f+(c^c>>>16)|0};function l(c,u){var h,p,f,d,m,x=[],g=128;for(u===(u|0)?(p=u,u=null):(u=u+"\0",p=0,g=Math.max(g,u.length)),f=0,d=-32;d<g;++d)u&&(p^=u.charCodeAt((d+32)%u.length)),d===0&&(m=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,d>=0&&(m=m+1640531527|0,h=x[d&127]^=p+m,f=h==0?f+1:0);for(f>=128&&(x[(u&&u.length||0)&127]=-1),f=127,d=4*128;d>0;--d)p=x[f+34&127],h=x[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,x[f]=p^h;c.w=m,c.X=x,c.i=f}l(a,s)}function r(s,a){return a.i=s.i,a.w=s.w,a.X=s.X.slice(),a}function o(s,a){s==null&&(s=+new Date);var l=new n(s),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var h=l.next()>>>11,p=(l.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(c.X&&r(c,l),u.state=function(){return r(l,{})}),u}t&&t.exports?t.exports=o:e&&e.amd?e(function(){return o}):this.xor4096=o})(NP,typeof GS=="object"&&GS,typeof define=="function"&&define)});var zP=un((DP,jS)=>{(function(i,t,e){function n(s){var a=this,l="";a.next=function(){var u=a.b,h=a.c,p=a.d,f=a.a;return u=u<<25^u>>>7^h,h=h-p|0,p=p<<24^p>>>8^f,f=f-u|0,a.b=u=u<<20^u>>>12^h,a.c=h=h-p|0,a.d=p<<16^h>>>16^f,a.a=f-u|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,s===Math.floor(s)?(a.a=s/4294967296|0,a.b=s|0):l+=s;for(var c=0;c<l.length+20;c++)a.b^=l.charCodeAt(c)|0,a.next()}function r(s,a){return a.a=s.a,a.b=s.b,a.c=s.c,a.d=s.d,a}function o(s,a){var l=new n(s),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var h=l.next()>>>11,p=(l.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(typeof c=="object"&&r(c,l),u.state=function(){return r(l,{})}),u}t&&t.exports?t.exports=o:e&&e.amd?e(function(){return o}):this.tychei=o})(DP,typeof jS=="object"&&jS,typeof define=="function"&&define)});var FP=un(()=>{});var OP=un((Jkt,Y0)=>{(function(i,t){var e=this,n=256,r=6,o=52,s="random",a=t.pow(n,r),l=t.pow(2,o),c=l*2,u=n-1,h;function p(b,v,_){var S=[];v=v==!0?{entropy:!0}:v||{};var E=x(m(v.entropy?[b,y(i)]:b==null?g():b,3),S),M=new f(S),N=function(){for(var I=M.g(r),w=a,R=0;I<l;)I=(I+R)*n,w*=n,R=M.g(1);for(;I>=c;)I/=2,w/=2,R>>>=1;return(I+R)/w};return N.int32=function(){return M.g(4)|0},N.quick=function(){return M.g(4)/4294967296},N.double=N,x(y(M.S),i),(v.pass||_||function(I,w,R,P){return P&&(P.S&&d(P,M),I.state=function(){return d(M,{})}),R?(t[s]=I,w):I})(N,E,"global"in v?v.global:this==t,v.state)}t["seed"+s]=p;function f(b){var v,_=b.length,S=this,E=0,M=S.i=S.j=0,N=S.S=[];for(_||(b=[_++]);E<n;)N[E]=E++;for(E=0;E<n;E++)N[E]=N[M=u&M+b[E%_]+(v=N[E])],N[M]=v;(S.g=function(I){for(var w,R=0,P=S.i,D=S.j,F=S.S;I--;)w=F[P=u&P+1],R=R*n+F[u&(F[P]=F[D=u&D+w])+(F[D]=w)];return S.i=P,S.j=D,R})(n)}function d(b,v){return v.i=b.i,v.j=b.j,v.S=b.S.slice(),v}function m(b,v){var _=[],S=typeof b,E;if(v&&S=="object")for(E in b)try{_.push(m(b[E],v-1))}catch(M){}return _.length?_:S=="string"?b:b+"\0"}function x(b,v){for(var _=b+"",S,E=0;E<_.length;)v[u&E]=u&(S^=v[u&E]*19)+_.charCodeAt(E++);return y(v)}function g(){try{var b;return h&&(b=h.randomBytes)?b=b(n):(b=new Uint8Array(n),(e.crypto||e.msCrypto).getRandomValues(b)),y(b)}catch(S){var v=e.navigator,_=v&&v.plugins;return[+new Date,e,_,e.screen,y(i)]}}function y(b){return String.fromCharCode.apply(0,b)}if(x(t.random(),i),typeof Y0=="object"&&Y0.exports){Y0.exports=p;try{h=FP()}catch(b){}}else typeof define=="function"&&define.amd&&define(function(){return p})})([],Math)});var VP=un((Qkt,BP)=>{var aZ=EP(),lZ=IP(),cZ=kP(),uZ=PP(),hZ=LP(),pZ=zP(),Xa=OP();Xa.alea=aZ;Xa.xor128=lZ;Xa.xorwow=cZ;Xa.xorshift7=uZ;Xa.xor4096=hZ;Xa.tychei=pZ;BP.exports=Xa});var BH={};Dr(BH,{isAnyArray:()=>aa});function aa(i){let t=fmt.call(i);return t.endsWith("Array]")&&!t.includes("Big")}var fmt,mm=He(()=>{fmt=Object.prototype.toString});function VH(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!aa(i))throw new TypeError("input must be an array");if(i.length===0)throw new TypeError("input must not be empty");var e=t.fromIndex,n=e===void 0?0:e,r=t.toIndex,o=r===void 0?i.length:r;if(n<0||n>=i.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>i.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=i[n],a=n+1;a<o;a++)i[a]>s&&(s=i[a]);return s}var HH=He(()=>{mm()});function $H(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!aa(i))throw new TypeError("input must be an array");if(i.length===0)throw new TypeError("input must not be empty");var e=t.fromIndex,n=e===void 0?0:e,r=t.toIndex,o=r===void 0?i.length:r;if(n<0||n>=i.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>i.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=i[n],a=n+1;a<o;a++)i[a]<s&&(s=i[a]);return s}var UH=He(()=>{mm()});var WH={};Dr(WH,{default:()=>dmt});function dmt(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(aa(i)){if(i.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var e;if(t.output!==void 0){if(!aa(t.output))throw new TypeError("output option must be an array if specified");e=t.output}else e=new Array(i.length);var n=$H(i),r=VH(i);if(n===r)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=t.min,s=o===void 0?t.autoMinMax?n:0:o,a=t.max,l=a===void 0?t.autoMinMax?r:1:a;if(s>=l)throw new RangeError("min option must be smaller than max option");for(var c=(l-s)/(r-n),u=0;u<i.length;u++)e[u]=(i[u]-n)*c+s;return e}var GH=He(()=>{mm();HH();UH()});var JH=un(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});var Si=(mm(),Hb(BH)),jH=(GH(),Hb(WH)),Q2=" ".repeat(2),KH=" ".repeat(4);function mmt(){return YH(this)}function YH(i,t={}){let{maxRows:e=15,maxColumns:n=10,maxNumSize:r=8,padMinus:o="auto"}=t;return`${i.constructor.name} {
${Q2}[
${KH}${gmt(i,e,n,r,o)}
${Q2}]
${Q2}rows: ${i.rows}
${Q2}columns: ${i.columns}
}`}function gmt(i,t,e,n,r){let{rows:o,columns:s}=i,a=Math.min(o,t),l=Math.min(s,e),c=[];if(r==="auto"){r=!1;t:for(let u=0;u<a;u++)for(let h=0;h<l;h++)if(i.get(u,h)<0){r=!0;break t}}for(let u=0;u<a;u++){let h=[];for(let p=0;p<l;p++)h.push(xmt(i.get(u,p),n,r));c.push(`${h.join(" ")}`)}return l!==s&&(c[c.length-1]+=` ... ${s-e} more columns`),a!==o&&c.push(`... ${o-t} more rows`),c.join(`
${KH}`)}function xmt(i,t,e){return(i>=0&&e?` ${qH(i,t-1)}`:qH(i,t)).padEnd(t)}function qH(i,t){let e=i.toString();if(e.length<=t)return e;let n=i.toFixed(t);if(n.length>t&&(n=i.toFixed(Math.max(0,t-(n.length-t)))),n.length<=t&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let r=i.toExponential(t);return r.length>t&&(r=i.toExponential(Math.max(0,t-(r.length-t)))),r.slice(0)}function ymt(i,t){i.prototype.add=function(n){return typeof n=="number"?this.addS(n):this.addM(n)},i.prototype.addS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)+n);return this},i.prototype.addM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)+n.get(r,o));return this},i.add=function(n,r){return new t(n).add(r)},i.prototype.sub=function(n){return typeof n=="number"?this.subS(n):this.subM(n)},i.prototype.subS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)-n);return this},i.prototype.subM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)-n.get(r,o));return this},i.sub=function(n,r){return new t(n).sub(r)},i.prototype.subtract=i.prototype.sub,i.prototype.subtractS=i.prototype.subS,i.prototype.subtractM=i.prototype.subM,i.subtract=i.sub,i.prototype.mul=function(n){return typeof n=="number"?this.mulS(n):this.mulM(n)},i.prototype.mulS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)*n);return this},i.prototype.mulM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)*n.get(r,o));return this},i.mul=function(n,r){return new t(n).mul(r)},i.prototype.multiply=i.prototype.mul,i.prototype.multiplyS=i.prototype.mulS,i.prototype.multiplyM=i.prototype.mulM,i.multiply=i.mul,i.prototype.div=function(n){return typeof n=="number"?this.divS(n):this.divM(n)},i.prototype.divS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)/n);return this},i.prototype.divM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)/n.get(r,o));return this},i.div=function(n,r){return new t(n).div(r)},i.prototype.divide=i.prototype.div,i.prototype.divideS=i.prototype.divS,i.prototype.divideM=i.prototype.divM,i.divide=i.div,i.prototype.mod=function(n){return typeof n=="number"?this.modS(n):this.modM(n)},i.prototype.modS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)%n);return this},i.prototype.modM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)%n.get(r,o));return this},i.mod=function(n,r){return new t(n).mod(r)},i.prototype.modulus=i.prototype.mod,i.prototype.modulusS=i.prototype.modS,i.prototype.modulusM=i.prototype.modM,i.modulus=i.mod,i.prototype.and=function(n){return typeof n=="number"?this.andS(n):this.andM(n)},i.prototype.andS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)&n);return this},i.prototype.andM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)&n.get(r,o));return this},i.and=function(n,r){return new t(n).and(r)},i.prototype.or=function(n){return typeof n=="number"?this.orS(n):this.orM(n)},i.prototype.orS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)|n);return this},i.prototype.orM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)|n.get(r,o));return this},i.or=function(n,r){return new t(n).or(r)},i.prototype.xor=function(n){return typeof n=="number"?this.xorS(n):this.xorM(n)},i.prototype.xorS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)^n);return this},i.prototype.xorM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)^n.get(r,o));return this},i.xor=function(n,r){return new t(n).xor(r)},i.prototype.leftShift=function(n){return typeof n=="number"?this.leftShiftS(n):this.leftShiftM(n)},i.prototype.leftShiftS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)<<n);return this},i.prototype.leftShiftM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)<<n.get(r,o));return this},i.leftShift=function(n,r){return new t(n).leftShift(r)},i.prototype.signPropagatingRightShift=function(n){return typeof n=="number"?this.signPropagatingRightShiftS(n):this.signPropagatingRightShiftM(n)},i.prototype.signPropagatingRightShiftS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)>>n);return this},i.prototype.signPropagatingRightShiftM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)>>n.get(r,o));return this},i.signPropagatingRightShift=function(n,r){return new t(n).signPropagatingRightShift(r)},i.prototype.rightShift=function(n){return typeof n=="number"?this.rightShiftS(n):this.rightShiftM(n)},i.prototype.rightShiftS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)>>>n);return this},i.prototype.rightShiftM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)>>>n.get(r,o));return this},i.rightShift=function(n,r){return new t(n).rightShift(r)},i.prototype.zeroFillRightShift=i.prototype.rightShift,i.prototype.zeroFillRightShiftS=i.prototype.rightShiftS,i.prototype.zeroFillRightShiftM=i.prototype.rightShiftM,i.zeroFillRightShift=i.rightShift,i.prototype.not=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,~this.get(n,r));return this},i.not=function(n){return new t(n).not()},i.prototype.abs=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.abs(this.get(n,r)));return this},i.abs=function(n){return new t(n).abs()},i.prototype.acos=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.acos(this.get(n,r)));return this},i.acos=function(n){return new t(n).acos()},i.prototype.acosh=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.acosh(this.get(n,r)));return this},i.acosh=function(n){return new t(n).acosh()},i.prototype.asin=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.asin(this.get(n,r)));return this},i.asin=function(n){return new t(n).asin()},i.prototype.asinh=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.asinh(this.get(n,r)));return this},i.asinh=function(n){return new t(n).asinh()},i.prototype.atan=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.atan(this.get(n,r)));return this},i.atan=function(n){return new t(n).atan()},i.prototype.atanh=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.atanh(this.get(n,r)));return this},i.atanh=function(n){return new t(n).atanh()},i.prototype.cbrt=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.cbrt(this.get(n,r)));return this},i.cbrt=function(n){return new t(n).cbrt()},i.prototype.ceil=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.ceil(this.get(n,r)));return this},i.ceil=function(n){return new t(n).ceil()},i.prototype.clz32=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.clz32(this.get(n,r)));return this},i.clz32=function(n){return new t(n).clz32()},i.prototype.cos=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.cos(this.get(n,r)));return this},i.cos=function(n){return new t(n).cos()},i.prototype.cosh=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.cosh(this.get(n,r)));return this},i.cosh=function(n){return new t(n).cosh()},i.prototype.exp=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.exp(this.get(n,r)));return this},i.exp=function(n){return new t(n).exp()},i.prototype.expm1=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.expm1(this.get(n,r)));return this},i.expm1=function(n){return new t(n).expm1()},i.prototype.floor=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.floor(this.get(n,r)));return this},i.floor=function(n){return new t(n).floor()},i.prototype.fround=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.fround(this.get(n,r)));return this},i.fround=function(n){return new t(n).fround()},i.prototype.log=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.log(this.get(n,r)));return this},i.log=function(n){return new t(n).log()},i.prototype.log1p=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.log1p(this.get(n,r)));return this},i.log1p=function(n){return new t(n).log1p()},i.prototype.log10=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.log10(this.get(n,r)));return this},i.log10=function(n){return new t(n).log10()},i.prototype.log2=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.log2(this.get(n,r)));return this},i.log2=function(n){return new t(n).log2()},i.prototype.round=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.round(this.get(n,r)));return this},i.round=function(n){return new t(n).round()},i.prototype.sign=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.sign(this.get(n,r)));return this},i.sign=function(n){return new t(n).sign()},i.prototype.sin=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.sin(this.get(n,r)));return this},i.sin=function(n){return new t(n).sin()},i.prototype.sinh=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.sinh(this.get(n,r)));return this},i.sinh=function(n){return new t(n).sinh()},i.prototype.sqrt=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.sqrt(this.get(n,r)));return this},i.sqrt=function(n){return new t(n).sqrt()},i.prototype.tan=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.tan(this.get(n,r)));return this},i.tan=function(n){return new t(n).tan()},i.prototype.tanh=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.tanh(this.get(n,r)));return this},i.tanh=function(n){return new t(n).tanh()},i.prototype.trunc=function(){for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.set(n,r,Math.trunc(this.get(n,r)));return this},i.trunc=function(n){return new t(n).trunc()},i.pow=function(n,r){return new t(n).pow(r)},i.prototype.pow=function(n){return typeof n=="number"?this.powS(n):this.powM(n)},i.prototype.powS=function(n){for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,Math.pow(this.get(r,o),n));return this},i.prototype.powM=function(n){if(n=t.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.set(r,o,Math.pow(this.get(r,o),n.get(r,o)));return this}}function sr(i,t,e){let n=e?i.rows:i.rows-1;if(t<0||t>n)throw new RangeError("Row index out of range")}function ar(i,t,e){let n=e?i.columns:i.columns-1;if(t<0||t>n)throw new RangeError("Column index out of range")}function Sh(i,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==i.columns)throw new RangeError("vector size must be the same as the number of columns");return t}function Ch(i,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==i.rows)throw new RangeError("vector size must be the same as the number of rows");return t}function LE(i,t){if(!Si.isAnyArray(t))throw new TypeError("row indices must be an array");for(let e=0;e<t.length;e++)if(t[e]<0||t[e]>=i.rows)throw new RangeError("row indices are out of range")}function DE(i,t){if(!Si.isAnyArray(t))throw new TypeError("column indices must be an array");for(let e=0;e<t.length;e++)if(t[e]<0||t[e]>=i.columns)throw new RangeError("column indices are out of range")}function CE(i,t,e,n,r){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(tb("startRow",t),tb("endRow",e),tb("startColumn",n),tb("endColumn",r),t>e||n>r||t<0||t>=i.rows||e<0||e>=i.rows||n<0||n>=i.columns||r<0||r>=i.columns)throw new RangeError("Submatrix indices are out of range")}function cb(i,t=0){let e=[];for(let n=0;n<i;n++)e.push(t);return e}function tb(i,t){if(typeof t!="number")throw new TypeError(`${i} must be a number`)}function wh(i){if(i.isEmpty())throw new Error("Empty matrix has no elements to index")}function vmt(i){let t=cb(i.rows);for(let e=0;e<i.rows;++e)for(let n=0;n<i.columns;++n)t[e]+=i.get(e,n);return t}function bmt(i){let t=cb(i.columns);for(let e=0;e<i.rows;++e)for(let n=0;n<i.columns;++n)t[n]+=i.get(e,n);return t}function _mt(i){let t=0;for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)t+=i.get(e,n);return t}function wmt(i){let t=cb(i.rows,1);for(let e=0;e<i.rows;++e)for(let n=0;n<i.columns;++n)t[e]*=i.get(e,n);return t}function Smt(i){let t=cb(i.columns,1);for(let e=0;e<i.rows;++e)for(let n=0;n<i.columns;++n)t[n]*=i.get(e,n);return t}function Cmt(i){let t=1;for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)t*=i.get(e,n);return t}function Mmt(i,t,e){let n=i.rows,r=i.columns,o=[];for(let s=0;s<n;s++){let a=0,l=0,c=0;for(let u=0;u<r;u++)c=i.get(s,u)-e[s],a+=c,l+=c*c;t?o.push((l-a*a/r)/(r-1)):o.push((l-a*a/r)/r)}return o}function Emt(i,t,e){let n=i.rows,r=i.columns,o=[];for(let s=0;s<r;s++){let a=0,l=0,c=0;for(let u=0;u<n;u++)c=i.get(u,s)-e[s],a+=c,l+=c*c;t?o.push((l-a*a/n)/(n-1)):o.push((l-a*a/n)/n)}return o}function Tmt(i,t,e){let n=i.rows,r=i.columns,o=n*r,s=0,a=0,l=0;for(let c=0;c<n;c++)for(let u=0;u<r;u++)l=i.get(c,u)-e,s+=l,a+=l*l;return t?(a-s*s/o)/(o-1):(a-s*s/o)/o}function Imt(i,t){for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)i.set(e,n,i.get(e,n)-t[e])}function Amt(i,t){for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)i.set(e,n,i.get(e,n)-t[n])}function kmt(i,t){for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)i.set(e,n,i.get(e,n)-t)}function Rmt(i){let t=[];for(let e=0;e<i.rows;e++){let n=0;for(let r=0;r<i.columns;r++)n+=Math.pow(i.get(e,r),2)/(i.columns-1);t.push(Math.sqrt(n))}return t}function Pmt(i,t){for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)i.set(e,n,i.get(e,n)/t[e])}function Nmt(i){let t=[];for(let e=0;e<i.columns;e++){let n=0;for(let r=0;r<i.rows;r++)n+=Math.pow(i.get(r,e),2)/(i.rows-1);t.push(Math.sqrt(n))}return t}function Lmt(i,t){for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)i.set(e,n,i.get(e,n)/t[n])}function Dmt(i){let t=i.size-1,e=0;for(let n=0;n<i.columns;n++)for(let r=0;r<i.rows;r++)e+=Math.pow(i.get(r,n),2)/t;return Math.sqrt(e)}function zmt(i,t){for(let e=0;e<i.rows;e++)for(let n=0;n<i.columns;n++)i.set(e,n,i.get(e,n)/t)}var se=class{static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("data length does not match given dimensions");let o=new Nt(t,e);for(let s=0;s<t;s++)for(let a=0;a<e;a++)o.set(s,a,n[s*e+a]);return o}static rowVector(t){let e=new Nt(1,t.length);for(let n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){let e=new Nt(t.length,1);for(let n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static zeros(t,e){return new Nt(t,e)}static ones(t,e){return new Nt(t,e).fill(1)}static rand(t,e,n={}){if(typeof n!="object")throw new TypeError("options must be an object");let{random:r=Math.random}=n,o=new Nt(t,e);for(let s=0;s<t;s++)for(let a=0;a<e;a++)o.set(s,a,r());return o}static randInt(t,e,n={}){if(typeof n!="object")throw new TypeError("options must be an object");let{min:r=0,max:o=1e3,random:s=Math.random}=n;if(!Number.isInteger(r))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(r>=o)throw new RangeError("min must be smaller than max");let a=o-r,l=new Nt(t,e);for(let c=0;c<t;c++)for(let u=0;u<e;u++){let h=r+Math.round(s()*a);l.set(c,u,h)}return l}static eye(t,e,n){e===void 0&&(e=t),n===void 0&&(n=1);let r=Math.min(t,e),o=this.zeros(t,e);for(let s=0;s<r;s++)o.set(s,s,n);return o}static diag(t,e,n){let r=t.length;e===void 0&&(e=r),n===void 0&&(n=e);let o=Math.min(r,e,n),s=this.zeros(e,n);for(let a=0;a<o;a++)s.set(a,a,t[a]);return s}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,r=t.columns,o=new Nt(n,r);for(let s=0;s<n;s++)for(let a=0;a<r;a++)o.set(s,a,Math.min(t.get(s,a),e.get(s,a)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,r=t.columns,o=new this(n,r);for(let s=0;s<n;s++)for(let a=0;a<r;a++)o.set(s,a,Math.max(t.get(s,a),e.get(s,a)));return o}static checkMatrix(t){return se.isMatrix(t)?t:new Nt(t)}static isMatrix(t){return t!=null&&t.klass==="Matrix"}get size(){return this.rows*this.columns}apply(t){if(typeof t!="function")throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.call(this,e,n);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let n=0;n<this.columns;n++)t[e].push(this.get(e,n))}return t}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(this.get(t,t)!==0)return!1;return!0}isEchelonForm(){let t=0,e=0,n=-1,r=!0,o=!1;for(;t<this.rows&&r;){for(e=0,o=!1;e<this.columns&&o===!1;)this.get(t,e)===0?e++:this.get(t,e)===1&&e>n?(o=!0,n=e):(r=!1,o=!0);t++}return r}isReducedEchelonForm(){let t=0,e=0,n=-1,r=!0,o=!1;for(;t<this.rows&&r;){for(e=0,o=!1;e<this.columns&&o===!1;)this.get(t,e)===0?e++:this.get(t,e)===1&&e>n?(o=!0,n=e):(r=!1,o=!0);for(let s=e+1;s<this.rows;s++)this.get(t,s)!==0&&(r=!1);t++}return r}echelonForm(){let t=this.clone(),e=0,n=0;for(;e<t.rows&&n<t.columns;){let r=e;for(let o=e;o<t.rows;o++)t.get(o,n)>t.get(r,n)&&(r=o);if(t.get(r,n)===0)n++;else{t.swapRows(e,r);let o=t.get(e,n);for(let s=n;s<t.columns;s++)t.set(e,s,t.get(e,s)/o);for(let s=e+1;s<t.rows;s++){let a=t.get(s,n)/t.get(e,n);t.set(s,n,0);for(let l=n+1;l<t.columns;l++)t.set(s,l,t.get(s,l)-t.get(e,l)*a)}e++,n++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,n=t.rows,r=n-1;for(;r>=0;)if(t.maxRow(r)===0)r--;else{let o=0,s=!1;for(;o<n&&s===!1;)t.get(r,o)===1?s=!0:o++;for(let a=0;a<r;a++){let l=t.get(a,o);for(let c=o;c<e;c++){let u=t.get(a,c)-l*t.get(r,c);t.set(a,c,u)}}r--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if(typeof t!="object")throw new TypeError("options must be an object");let{rows:e=1,columns:n=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let r=new Nt(this.rows*e,this.columns*n);for(let o=0;o<e;o++)for(let s=0;s<n;s++)r.setSubMatrix(this,this.rows*o,this.columns*s);return r}fill(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){sr(this,t);let e=[];for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}getRowVector(t){return Nt.rowVector(this.getRow(t))}setRow(t,e){sr(this,t),e=Sh(this,e);for(let n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){sr(this,t),sr(this,e);for(let n=0;n<this.columns;n++){let r=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,r)}return this}getColumn(t){ar(this,t);let e=[];for(let n=0;n<this.rows;n++)e.push(this.get(n,t));return e}getColumnVector(t){return Nt.columnVector(this.getColumn(t))}setColumn(t,e){ar(this,t),e=Ch(this,e);for(let n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){ar(this,t),ar(this,e);for(let n=0;n<this.rows;n++){let r=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,r)}return this}addRowVector(t){t=Sh(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=Sh(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=Sh(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=Sh(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=Ch(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=Ch(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=Ch(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=Ch(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){sr(this,t);for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){ar(this,t);for(let n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{let e=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>e[n]&&(e[n]=this.get(n,r));return e}case"column":{let e=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>e[r]&&(e[r]=this.get(n,r));return e}case void 0:{let e=this.get(0,0);for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>e&&(e=this.get(n,r));return e}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){wh(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{let e=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<e[n]&&(e[n]=this.get(n,r));return e}case"column":{let e=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<e[r]&&(e[r]=this.get(n,r));return e}case void 0:{let e=this.get(0,0);for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<e&&(e=this.get(n,r));return e}default:throw new Error(`invalid option: ${t}`)}}minIndex(){wh(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){if(sr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){sr(this,t),wh(this);let e=this.get(t,0),n=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){if(sr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){sr(this,t),wh(this);let e=this.get(t,0),n=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){if(ar(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){ar(this,t),wh(this);let e=this.get(0,t),n=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){if(ar(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){ar(this,t),wh(this);let e=this.get(0,t),n=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let n=0;n<t;n++)e.push(this.get(n,n));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){se.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let n=0;for(let r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=Nt.checkMatrix(t);let e=this.rows,n=this.columns,r=t.columns,o=new Nt(e,r),s=new Float64Array(n);for(let a=0;a<r;a++){for(let l=0;l<n;l++)s[l]=t.get(l,a);for(let l=0;l<e;l++){let c=0;for(let u=0;u<n;u++)c+=this.get(l,u)*s[u];o.set(l,a,c)}}return o}strassen2x2(t){t=Nt.checkMatrix(t);let e=new Nt(2,2),n=this.get(0,0),r=t.get(0,0),o=this.get(0,1),s=t.get(0,1),a=this.get(1,0),l=t.get(1,0),c=this.get(1,1),u=t.get(1,1),h=(n+c)*(r+u),p=(a+c)*r,f=n*(s-u),d=c*(l-r),m=(n+o)*u,x=(a-n)*(r+s),g=(o-c)*(l+u),y=h+d-m+g,b=f+m,v=p+d,_=h-p+f+x;return e.set(0,0,y),e.set(0,1,b),e.set(1,0,v),e.set(1,1,_),e}strassen3x3(t){t=Nt.checkMatrix(t);let e=new Nt(3,3),n=this.get(0,0),r=this.get(0,1),o=this.get(0,2),s=this.get(1,0),a=this.get(1,1),l=this.get(1,2),c=this.get(2,0),u=this.get(2,1),h=this.get(2,2),p=t.get(0,0),f=t.get(0,1),d=t.get(0,2),m=t.get(1,0),x=t.get(1,1),g=t.get(1,2),y=t.get(2,0),b=t.get(2,1),v=t.get(2,2),_=(n+r+o-s-a-u-h)*x,S=(n-s)*(-f+x),E=a*(-p+f+m-x-g-y+v),M=(-n+s+a)*(p-f+x),N=(s+a)*(-p+f),I=n*p,w=(-n+c+u)*(p-d+g),R=(-n+c)*(d-g),P=(c+u)*(-p+d),D=(n+r+o-a-l-c-u)*g,F=u*(-p+d+m-x-g-y+b),z=(-o+u+h)*(x+y-b),V=(o-h)*(x-b),H=o*y,X=(u+h)*(-y+b),U=(-o+a+l)*(g+y-v),Y=(o-l)*(g-v),Z=(a+l)*(-y+v),K=r*m,J=l*b,G=s*d,nt=c*f,et=h*v,at=I+H+K,it=_+M+N+I+z+H+X,St=I+w+P+D+H+U+Z,yt=S+E+M+I+H+U+Y,rt=S+M+N+I+J,vt=H+U+Y+Z+G,ct=I+w+R+F+z+V+H,_t=z+V+H+X+nt,gt=I+w+R+P+et;return e.set(0,0,at),e.set(0,1,it),e.set(0,2,St),e.set(1,0,yt),e.set(1,1,rt),e.set(1,2,vt),e.set(2,0,ct),e.set(2,1,_t),e.set(2,2,gt),e}mmulStrassen(t){t=Nt.checkMatrix(t);let e=this.clone(),n=e.rows,r=e.columns,o=t.rows,s=t.columns;r!==o&&console.warn(`Multiplying ${n} x ${r} and ${o} x ${s} matrix: dimensions do not match.`);function a(h,p,f){let d=h.rows,m=h.columns;if(d===p&&m===f)return h;{let x=se.zeros(p,f);return x=x.setSubMatrix(h,0,0),x}}let l=Math.max(n,o),c=Math.max(r,s);e=a(e,l,c),t=a(t,l,c);function u(h,p,f,d){if(f<=512||d<=512)return h.mmul(p);f%2===1&&d%2===1?(h=a(h,f+1,d+1),p=a(p,f+1,d+1)):f%2===1?(h=a(h,f+1,d),p=a(p,f+1,d)):d%2===1&&(h=a(h,f,d+1),p=a(p,f,d+1));let m=parseInt(h.rows/2,10),x=parseInt(h.columns/2,10),g=h.subMatrix(0,m-1,0,x-1),y=p.subMatrix(0,m-1,0,x-1),b=h.subMatrix(0,m-1,x,h.columns-1),v=p.subMatrix(0,m-1,x,p.columns-1),_=h.subMatrix(m,h.rows-1,0,x-1),S=p.subMatrix(m,p.rows-1,0,x-1),E=h.subMatrix(m,h.rows-1,x,h.columns-1),M=p.subMatrix(m,p.rows-1,x,p.columns-1),N=u(se.add(g,E),se.add(y,M),m,x),I=u(se.add(_,E),y,m,x),w=u(g,se.sub(v,M),m,x),R=u(E,se.sub(S,y),m,x),P=u(se.add(g,b),M,m,x),D=u(se.sub(_,g),se.add(y,v),m,x),F=u(se.sub(b,E),se.add(S,M),m,x),z=se.add(N,R);z.sub(P),z.add(F);let V=se.add(w,P),H=se.add(I,R),X=se.sub(N,I);X.add(w),X.add(D);let U=se.zeros(2*z.rows,2*z.columns);return U=U.setSubMatrix(z,0,0),U=U.setSubMatrix(V,z.rows,0),U=U.setSubMatrix(H,0,z.columns),U=U.setSubMatrix(X,z.rows,z.columns),U.subMatrix(0,f-1,0,d-1)}return u(e,t,l,c)}scaleRows(t={}){if(typeof t!="object")throw new TypeError("options must be an object");let{min:e=0,max:n=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let r=new Nt(this.rows,this.columns);for(let o=0;o<this.rows;o++){let s=this.getRow(o);s.length>0&&jH(s,{min:e,max:n,output:s}),r.setRow(o,s)}return r}scaleColumns(t={}){if(typeof t!="object")throw new TypeError("options must be an object");let{min:e=0,max:n=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let r=new Nt(this.rows,this.columns);for(let o=0;o<this.columns;o++){let s=this.getColumn(o);s.length&&jH(s,{min:e,max:n,output:s}),r.setColumn(o,s)}return r}flipRows(){let t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let n=0;n<t;n++){let r=this.get(e,n),o=this.get(e,this.columns-1-n);this.set(e,n,o),this.set(e,this.columns-1-n,r)}return this}flipColumns(){let t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let n=0;n<t;n++){let r=this.get(n,e),o=this.get(this.rows-1-n,e);this.set(n,e,o),this.set(this.rows-1-n,e,r)}return this}kroneckerProduct(t){t=Nt.checkMatrix(t);let e=this.rows,n=this.columns,r=t.rows,o=t.columns,s=new Nt(e*r,n*o);for(let a=0;a<e;a++)for(let l=0;l<n;l++)for(let c=0;c<r;c++)for(let u=0;u<o;u++)s.set(r*a+c,o*l+u,this.get(a,l)*t.get(c,u));return s}kroneckerSum(t){if(t=Nt.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,n=t.rows,r=this.kroneckerProduct(Nt.eye(n,n)),o=Nt.eye(e,e).kroneckerProduct(t);return r.add(o)}transpose(){let t=new Nt(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t=XH){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=XH){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){CE(this,t,e,n,r);let o=new Nt(e-t+1,r-n+1);for(let s=t;s<=e;s++)for(let a=n;a<=r;a++)o.set(s-t,a-n,this.get(s,a));return o}subMatrixRow(t,e,n){if(e===void 0&&(e=0),n===void 0&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let r=new Nt(t.length,n-e+1);for(let o=0;o<t.length;o++)for(let s=e;s<=n;s++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);r.set(o,s-e,this.get(t[o],s))}return r}subMatrixColumn(t,e,n){if(e===void 0&&(e=0),n===void 0&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let r=new Nt(n-e+1,t.length);for(let o=0;o<t.length;o++)for(let s=e;s<=n;s++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);r.set(s-e,o,this.get(s,t[o]))}return r}setSubMatrix(t,e,n){if(t=Nt.checkMatrix(t),t.isEmpty())return this;let r=e+t.rows-1,o=n+t.columns-1;CE(this,e,r,n,o);for(let s=0;s<t.rows;s++)for(let a=0;a<t.columns;a++)this.set(e+s,n+a,t.get(s,a));return this}selection(t,e){LE(this,t),DE(this,e);let n=new Nt(t.length,e.length);for(let r=0;r<t.length;r++){let o=t[r];for(let s=0;s<e.length;s++){let a=e[s];n.set(r,s,this.get(o,a))}}return n}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let n=0;n<t;n++)e+=this.get(n,n);return e}clone(){return this.constructor.copy(this,new Nt(this.rows,this.columns))}static copy(t,e){for(let[n,r,o]of t.entries())e.set(n,r,o);return e}sum(t){switch(t){case"row":return vmt(this);case"column":return bmt(this);case void 0:return _mt(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return wmt(this);case"column":return Smt(this);case void 0:return Cmt(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){let e=this.sum(t);switch(t){case"row":{for(let n=0;n<this.rows;n++)e[n]/=this.columns;return e}case"column":{for(let n=0;n<this.columns;n++)e[n]/=this.rows;return e}case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if(typeof t=="object"&&(e=t,t=void 0),typeof e!="object")throw new TypeError("options must be an object");let{unbiased:n=!0,mean:r=this.mean(t)}=e;if(typeof n!="boolean")throw new TypeError("unbiased must be a boolean");switch(t){case"row":{if(!Si.isAnyArray(r))throw new TypeError("mean must be an array");return Mmt(this,n,r)}case"column":{if(!Si.isAnyArray(r))throw new TypeError("mean must be an array");return Emt(this,n,r)}case void 0:{if(typeof r!="number")throw new TypeError("mean must be a number");return Tmt(this,n,r)}default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){typeof t=="object"&&(e=t,t=void 0);let n=this.variance(t,e);if(t===void 0)return Math.sqrt(n);for(let r=0;r<n.length;r++)n[r]=Math.sqrt(n[r]);return n}center(t,e={}){if(typeof t=="object"&&(e=t,t=void 0),typeof e!="object")throw new TypeError("options must be an object");let{center:n=this.mean(t)}=e;switch(t){case"row":{if(!Si.isAnyArray(n))throw new TypeError("center must be an array");return Imt(this,n),this}case"column":{if(!Si.isAnyArray(n))throw new TypeError("center must be an array");return Amt(this,n),this}case void 0:{if(typeof n!="number")throw new TypeError("center must be a number");return kmt(this,n),this}default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if(typeof t=="object"&&(e=t,t=void 0),typeof e!="object")throw new TypeError("options must be an object");let n=e.scale;switch(t){case"row":{if(n===void 0)n=Rmt(this);else if(!Si.isAnyArray(n))throw new TypeError("scale must be an array");return Pmt(this,n),this}case"column":{if(n===void 0)n=Nmt(this);else if(!Si.isAnyArray(n))throw new TypeError("scale must be an array");return Lmt(this,n),this}case void 0:{if(n===void 0)n=Dmt(this);else if(typeof n!="number")throw new TypeError("scale must be a number");return zmt(this,n),this}default:throw new Error(`invalid option: ${t}`)}}toString(t){return YH(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}};se.prototype.klass="Matrix";typeof Symbol!="undefined"&&(se.prototype[Symbol.for("nodejs.util.inspect.custom")]=mmt);function XH(i,t){return i-t}function Fmt(i){return i.every(t=>typeof t=="number")}se.random=se.rand;se.randomInt=se.randInt;se.diagonal=se.diag;se.prototype.diagonal=se.prototype.diag;se.identity=se.eye;se.prototype.negate=se.prototype.neg;se.prototype.tensorProduct=se.prototype.kroneckerProduct;var xm,ME,ab=class extends se{constructor(e,n){super();Ub(this,xm);UE(this,"data");if(ab.isMatrix(e))Wb(this,xm,ME).call(this,e.rows,e.columns),ab.copy(e,this);else if(Number.isInteger(e)&&e>=0)Wb(this,xm,ME).call(this,e,n);else if(Si.isAnyArray(e)){let r=e;if(e=r.length,n=e?r[0].length:0,typeof n!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let o=0;o<e;o++){if(r[o].length!==n)throw new RangeError("Inconsistent array dimensions");if(!Fmt(r[o]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[o]))}this.rows=e,this.columns=n}else throw new TypeError("First argument must be a positive number or an array")}set(e,n,r){return this.data[e][n]=r,this}get(e,n){return this.data[e][n]}removeRow(e){return sr(this,e),this.data.splice(e,1),this.rows-=1,this}addRow(e,n){return n===void 0&&(n=e,e=this.rows),sr(this,e,!0),n=Float64Array.from(Sh(this,n)),this.data.splice(e,0,n),this.rows+=1,this}removeColumn(e){ar(this,e);for(let n=0;n<this.rows;n++){let r=new Float64Array(this.columns-1);for(let o=0;o<e;o++)r[o]=this.data[n][o];for(let o=e+1;o<this.columns;o++)r[o-1]=this.data[n][o];this.data[n]=r}return this.columns-=1,this}addColumn(e,n){typeof n=="undefined"&&(n=e,e=this.columns),ar(this,e,!0),n=Ch(this,n);for(let r=0;r<this.rows;r++){let o=new Float64Array(this.columns+1),s=0;for(;s<e;s++)o[s]=this.data[r][s];for(o[s++]=n[r];s<this.columns+1;s++)o[s]=this.data[r][s-1];this.data[r]=o}return this.columns+=1,this}},Nt=ab;xm=new WeakSet,ME=function(e,n){if(this.data=[],Number.isInteger(n)&&n>=0)for(let r=0;r<e;r++)this.data.push(new Float64Array(n));else throw new TypeError("nColumns must be a positive integer");this.rows=e,this.columns=n};ymt(se,Nt);var ai,lb=class extends se{constructor(e){super();Ub(this,ai,void 0);if(Nt.isMatrix(e)){if(!e.isSymmetric())throw new TypeError("not symmetric data");Mm(this,ai,Nt.copy(e,new Nt(e.rows,e.rows)))}else if(Number.isInteger(e)&&e>=0)Mm(this,ai,new Nt(e,e));else if(Mm(this,ai,new Nt(e)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return cr(this,ai).size}get rows(){return cr(this,ai).rows}get columns(){return cr(this,ai).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(e){return Nt.isMatrix(e)&&e.klassType==="SymmetricMatrix"}static zeros(e){return new this(e)}static ones(e){return new this(e).fill(1)}clone(){let e=new lb(this.diagonalSize);for(let[n,r,o]of this.upperRightEntries())e.set(n,r,o);return e}toMatrix(){return new Nt(this)}get(e,n){return cr(this,ai).get(e,n)}set(e,n,r){return cr(this,ai).set(e,n,r),cr(this,ai).set(n,e,r),this}removeCross(e){return cr(this,ai).removeRow(e),cr(this,ai).removeColumn(e),this}addCross(e,n){n===void 0&&(n=e,e=this.diagonalSize);let r=n.slice();return r.splice(e,1),cr(this,ai).addRow(e,r),cr(this,ai).addColumn(e,n),this}applyMask(e){if(e.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");let n=[];for(let[r,o]of e.entries())o||n.push(r);n.reverse();for(let r of n)this.removeCross(r);return this}toCompact(){let{diagonalSize:e}=this,n=new Array(e*(e+1)/2);for(let r=0,o=0,s=0;s<n.length;s++)n[s]=this.get(o,r),++r>=e&&(r=++o);return n}static fromCompact(e){let n=e.length,r=(Math.sqrt(8*n+1)-1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(e)}`);let o=new lb(r);for(let s=0,a=0,l=0;l<n;l++)o.set(s,a,e[l]),++s>=r&&(s=++a);return o}*upperRightEntries(){for(let e=0,n=0;e<this.diagonalSize;void 0){let r=this.get(e,n);yield[e,n,r],++n>=this.diagonalSize&&(n=++e)}}*upperRightValues(){for(let e=0,n=0;e<this.diagonalSize;void 0)yield this.get(e,n),++n>=this.diagonalSize&&(n=++e)}},Fl=lb;ai=new WeakMap;Fl.prototype.klassType="SymmetricMatrix";var Eh=class extends Fl{static isDistanceMatrix(t){return Fl.isSymmetricMatrix(t)&&t.klassSubType==="DistanceMatrix"}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,n){return t===e&&(n=0),super.set(t,e,n)}addCross(t,e){return e===void 0&&(e=t,t=this.diagonalSize),e=e.slice(),e[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new Fl(this)}clone(){let t=new Eh(this.diagonalSize);for(let[e,n,r]of this.upperRightEntries())e!==n&&t.set(e,n,r);return t}toCompact(){let{diagonalSize:t}=this,e=(t-1)*t/2,n=new Array(e);for(let r=1,o=0,s=0;s<n.length;s++)n[s]=this.get(o,r),++r>=t&&(r=++o+1);return n}static fromCompact(t){let e=t.length,n=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);let r=new this(n);for(let o=1,s=0,a=0;a<e;a++)r.set(o,s,t[a]),++o>=n&&(o=++s+1);return r}};Eh.prototype.klassSubType="DistanceMatrix";var Tr=class extends se{constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}},EE=class extends Tr{constructor(t,e){ar(t,e),super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}},TE=class extends Tr{constructor(t,e){DE(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,n){return this.matrix.set(t,this.columnIndices[e],n),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},IE=class extends Tr{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},AE=class extends Tr{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},kE=class extends Tr{constructor(t,e){sr(t,e),super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}},RE=class extends Tr{constructor(t,e){LE(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,n){return this.matrix.set(this.rowIndices[t],e,n),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},Mh=class extends Tr{constructor(t,e,n){LE(t,e),DE(t,n),super(t,e.length,n.length),this.rowIndices=e,this.columnIndices=n}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}},PE=class extends Tr{constructor(t,e,n,r,o){CE(t,e,n,r,o),super(t,n-e+1,o-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},NE=class extends Tr{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}},ib=class extends se{constructor(t,e={}){let{rows:n=1}=e;if(t.length%n!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=n,this.columns=t.length/n,this.data=t}set(t,e,n){let r=this._calculateIndex(t,e);return this.data[r]=n,this}get(t,e){let n=this._calculateIndex(t,e);return this.data[n]}_calculateIndex(t,e){return t*this.columns+e}},xi=class extends se{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}};function Omt(i,t){if(Si.isAnyArray(i))return i[0]&&Si.isAnyArray(i[0])?new xi(i):new ib(i,t);throw new Error("the argument is not an array")}var Th=class{constructor(t){t=xi.checkMatrix(t);let e=t.clone(),n=e.rows,r=e.columns,o=new Float64Array(n),s=1,a,l,c,u,h,p,f,d,m;for(a=0;a<n;a++)o[a]=a;for(d=new Float64Array(n),l=0;l<r;l++){for(a=0;a<n;a++)d[a]=e.get(a,l);for(a=0;a<n;a++){for(m=Math.min(a,l),h=0,c=0;c<m;c++)h+=e.get(a,c)*d[c];d[a]-=h,e.set(a,l,d[a])}for(u=l,a=l+1;a<n;a++)Math.abs(d[a])>Math.abs(d[u])&&(u=a);if(u!==l){for(c=0;c<r;c++)p=e.get(u,c),e.set(u,c,e.get(l,c)),e.set(l,c,p);f=o[u],o[u]=o[l],o[l]=f,s=-s}if(l<n&&e.get(l,l)!==0)for(a=l+1;a<n;a++)e.set(a,l,e.get(a,l)/e.get(l,l))}this.LU=e,this.pivotVector=o,this.pivotSign=s}isSingular(){let t=this.LU,e=t.columns;for(let n=0;n<e;n++)if(t.get(n,n)===0)return!0;return!1}solve(t){t=Nt.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r=t.columns,o=t.subMatrixRow(this.pivotVector,0,r-1),s=e.columns,a,l,c;for(c=0;c<s;c++)for(a=c+1;a<s;a++)for(l=0;l<r;l++)o.set(a,l,o.get(a,l)-o.get(c,l)*e.get(a,c));for(c=s-1;c>=0;c--){for(l=0;l<r;l++)o.set(c,l,o.get(c,l)/e.get(c,c));for(a=0;a<c;a++)for(l=0;l<r;l++)o.set(a,l,o.get(a,l)-o.get(c,l)*e.get(a,c))}return o}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,n=t.columns;for(let r=0;r<n;r++)e*=t.get(r,r);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,r=new Nt(e,n);for(let o=0;o<e;o++)for(let s=0;s<n;s++)o>s?r.set(o,s,t.get(o,s)):o===s?r.set(o,s,1):r.set(o,s,0);return r}get upperTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,r=new Nt(e,n);for(let o=0;o<e;o++)for(let s=0;s<n;s++)o<=s?r.set(o,s,t.get(o,s)):r.set(o,s,0);return r}get pivotPermutationVector(){return Array.from(this.pivotVector)}};function Ko(i,t){let e=0;return Math.abs(i)>Math.abs(t)?(e=t/i,Math.abs(i)*Math.sqrt(1+e*e)):t!==0?(e=i/t,Math.abs(t)*Math.sqrt(1+e*e)):0}var gm=class{constructor(t){t=xi.checkMatrix(t);let e=t.clone(),n=t.rows,r=t.columns,o=new Float64Array(r),s,a,l,c;for(l=0;l<r;l++){let u=0;for(s=l;s<n;s++)u=Ko(u,e.get(s,l));if(u!==0){for(e.get(l,l)<0&&(u=-u),s=l;s<n;s++)e.set(s,l,e.get(s,l)/u);for(e.set(l,l,e.get(l,l)+1),a=l+1;a<r;a++){for(c=0,s=l;s<n;s++)c+=e.get(s,l)*e.get(s,a);for(c=-c/e.get(l,l),s=l;s<n;s++)e.set(s,a,e.get(s,a)+c*e.get(s,l))}}o[l]=-u}this.QR=e,this.Rdiag=o}solve(t){t=Nt.checkMatrix(t);let e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let r=t.columns,o=t.clone(),s=e.columns,a,l,c,u;for(c=0;c<s;c++)for(l=0;l<r;l++){for(u=0,a=c;a<n;a++)u+=e.get(a,c)*o.get(a,l);for(u=-u/e.get(c,c),a=c;a<n;a++)o.set(a,l,o.get(a,l)+u*e.get(a,c))}for(c=s-1;c>=0;c--){for(l=0;l<r;l++)o.set(c,l,o.get(c,l)/this.Rdiag[c]);for(a=0;a<c;a++)for(l=0;l<r;l++)o.set(a,l,o.get(a,l)-o.get(c,l)*e.get(a,c))}return o.subMatrix(0,s-1,0,r-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(this.Rdiag[e]===0)return!1;return!0}get upperTriangularMatrix(){let t=this.QR,e=t.columns,n=new Nt(e,e),r,o;for(r=0;r<e;r++)for(o=0;o<e;o++)r<o?n.set(r,o,t.get(r,o)):r===o?n.set(r,o,this.Rdiag[r]):n.set(r,o,0);return n}get orthogonalMatrix(){let t=this.QR,e=t.rows,n=t.columns,r=new Nt(e,n),o,s,a,l;for(a=n-1;a>=0;a--){for(o=0;o<e;o++)r.set(o,a,0);for(r.set(a,a,1),s=a;s<n;s++)if(t.get(a,a)!==0){for(l=0,o=a;o<e;o++)l+=t.get(o,a)*r.get(o,s);for(l=-l/t.get(a,a),o=a;o<e;o++)r.set(o,s,r.get(o,s)+l*t.get(o,a))}}return r}},la=class{constructor(t,e={}){if(t=xi.checkMatrix(t),t.isEmpty())throw new Error("Matrix must be non-empty");let n=t.rows,r=t.columns,{computeLeftSingularVectors:o=!0,computeRightSingularVectors:s=!0,autoTranspose:a=!1}=e,l=Boolean(o),c=Boolean(s),u=!1,h;if(n<r)if(!a)h=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{h=t.transpose(),n=h.rows,r=h.columns,u=!0;let I=l;l=c,c=I}else h=t.clone();let p=Math.min(n,r),f=Math.min(n+1,r),d=new Float64Array(f),m=new Nt(n,p),x=new Nt(r,r),g=new Float64Array(r),y=new Float64Array(n),b=new Float64Array(f);for(let I=0;I<f;I++)b[I]=I;let v=Math.min(n-1,r),_=Math.max(0,Math.min(r-2,n)),S=Math.max(v,_);for(let I=0;I<S;I++){if(I<v){d[I]=0;for(let w=I;w<n;w++)d[I]=Ko(d[I],h.get(w,I));if(d[I]!==0){h.get(I,I)<0&&(d[I]=-d[I]);for(let w=I;w<n;w++)h.set(w,I,h.get(w,I)/d[I]);h.set(I,I,h.get(I,I)+1)}d[I]=-d[I]}for(let w=I+1;w<r;w++){if(I<v&&d[I]!==0){let R=0;for(let P=I;P<n;P++)R+=h.get(P,I)*h.get(P,w);R=-R/h.get(I,I);for(let P=I;P<n;P++)h.set(P,w,h.get(P,w)+R*h.get(P,I))}g[w]=h.get(I,w)}if(l&&I<v)for(let w=I;w<n;w++)m.set(w,I,h.get(w,I));if(I<_){g[I]=0;for(let w=I+1;w<r;w++)g[I]=Ko(g[I],g[w]);if(g[I]!==0){g[I+1]<0&&(g[I]=0-g[I]);for(let w=I+1;w<r;w++)g[w]/=g[I];g[I+1]+=1}if(g[I]=-g[I],I+1<n&&g[I]!==0){for(let w=I+1;w<n;w++)y[w]=0;for(let w=I+1;w<n;w++)for(let R=I+1;R<r;R++)y[w]+=g[R]*h.get(w,R);for(let w=I+1;w<r;w++){let R=-g[w]/g[I+1];for(let P=I+1;P<n;P++)h.set(P,w,h.get(P,w)+R*y[P])}}if(c)for(let w=I+1;w<r;w++)x.set(w,I,g[w])}}let E=Math.min(r,n+1);if(v<r&&(d[v]=h.get(v,v)),n<E&&(d[E-1]=0),_+1<E&&(g[_]=h.get(_,E-1)),g[E-1]=0,l){for(let I=v;I<p;I++){for(let w=0;w<n;w++)m.set(w,I,0);m.set(I,I,1)}for(let I=v-1;I>=0;I--)if(d[I]!==0){for(let w=I+1;w<p;w++){let R=0;for(let P=I;P<n;P++)R+=m.get(P,I)*m.get(P,w);R=-R/m.get(I,I);for(let P=I;P<n;P++)m.set(P,w,m.get(P,w)+R*m.get(P,I))}for(let w=I;w<n;w++)m.set(w,I,-m.get(w,I));m.set(I,I,1+m.get(I,I));for(let w=0;w<I-1;w++)m.set(w,I,0)}else{for(let w=0;w<n;w++)m.set(w,I,0);m.set(I,I,1)}}if(c)for(let I=r-1;I>=0;I--){if(I<_&&g[I]!==0)for(let w=I+1;w<r;w++){let R=0;for(let P=I+1;P<r;P++)R+=x.get(P,I)*x.get(P,w);R=-R/x.get(I+1,I);for(let P=I+1;P<r;P++)x.set(P,w,x.get(P,w)+R*x.get(P,I))}for(let w=0;w<r;w++)x.set(w,I,0);x.set(I,I,1)}let M=E-1,N=Number.EPSILON;for(;E>0;){let I,w;for(I=E-2;I>=-1&&I!==-1;I--){let R=Number.MIN_VALUE+N*Math.abs(d[I]+Math.abs(d[I+1]));if(Math.abs(g[I])<=R||Number.isNaN(g[I])){g[I]=0;break}}if(I===E-2)w=4;else{let R;for(R=E-1;R>=I&&R!==I;R--){let P=(R!==E?Math.abs(g[R]):0)+(R!==I+1?Math.abs(g[R-1]):0);if(Math.abs(d[R])<=N*P){d[R]=0;break}}R===I?w=3:R===E-1?w=1:(w=2,I=R)}switch(I++,w){case 1:{let R=g[E-2];g[E-2]=0;for(let P=E-2;P>=I;P--){let D=Ko(d[P],R),F=d[P]/D,z=R/D;if(d[P]=D,P!==I&&(R=-z*g[P-1],g[P-1]=F*g[P-1]),c)for(let V=0;V<r;V++)D=F*x.get(V,P)+z*x.get(V,E-1),x.set(V,E-1,-z*x.get(V,P)+F*x.get(V,E-1)),x.set(V,P,D)}break}case 2:{let R=g[I-1];g[I-1]=0;for(let P=I;P<E;P++){let D=Ko(d[P],R),F=d[P]/D,z=R/D;if(d[P]=D,R=-z*g[P],g[P]=F*g[P],l)for(let V=0;V<n;V++)D=F*m.get(V,P)+z*m.get(V,I-1),m.set(V,I-1,-z*m.get(V,P)+F*m.get(V,I-1)),m.set(V,P,D)}break}case 3:{let R=Math.max(Math.abs(d[E-1]),Math.abs(d[E-2]),Math.abs(g[E-2]),Math.abs(d[I]),Math.abs(g[I])),P=d[E-1]/R,D=d[E-2]/R,F=g[E-2]/R,z=d[I]/R,V=g[I]/R,H=((D+P)*(D-P)+F*F)/2,X=P*F*(P*F),U=0;(H!==0||X!==0)&&(H<0?U=0-Math.sqrt(H*H+X):U=Math.sqrt(H*H+X),U=X/(H+U));let Y=(z+P)*(z-P)+U,Z=z*V;for(let K=I;K<E-1;K++){let J=Ko(Y,Z);J===0&&(J=Number.MIN_VALUE);let G=Y/J,nt=Z/J;if(K!==I&&(g[K-1]=J),Y=G*d[K]+nt*g[K],g[K]=G*g[K]-nt*d[K],Z=nt*d[K+1],d[K+1]=G*d[K+1],c)for(let et=0;et<r;et++)J=G*x.get(et,K)+nt*x.get(et,K+1),x.set(et,K+1,-nt*x.get(et,K)+G*x.get(et,K+1)),x.set(et,K,J);if(J=Ko(Y,Z),J===0&&(J=Number.MIN_VALUE),G=Y/J,nt=Z/J,d[K]=J,Y=G*g[K]+nt*d[K+1],d[K+1]=-nt*g[K]+G*d[K+1],Z=nt*g[K+1],g[K+1]=G*g[K+1],l&&K<n-1)for(let et=0;et<n;et++)J=G*m.get(et,K)+nt*m.get(et,K+1),m.set(et,K+1,-nt*m.get(et,K)+G*m.get(et,K+1)),m.set(et,K,J)}g[E-2]=Y;break}case 4:{if(d[I]<=0&&(d[I]=d[I]<0?-d[I]:0,c))for(let R=0;R<=M;R++)x.set(R,I,-x.get(R,I));for(;I<M&&!(d[I]>=d[I+1]);){let R=d[I];if(d[I]=d[I+1],d[I+1]=R,c&&I<r-1)for(let P=0;P<r;P++)R=x.get(P,I+1),x.set(P,I+1,x.get(P,I)),x.set(P,I,R);if(l&&I<n-1)for(let P=0;P<n;P++)R=m.get(P,I+1),m.set(P,I+1,m.get(P,I)),m.set(P,I,R);I++}E--;break}}}if(u){let I=x;x=m,m=I}this.m=n,this.n=r,this.s=d,this.U=m,this.V=x}solve(t){let e=t,n=this.threshold,r=this.s.length,o=Nt.zeros(r,r);for(let p=0;p<r;p++)Math.abs(this.s[p])<=n?o.set(p,p,0):o.set(p,p,1/this.s[p]);let s=this.U,a=this.rightSingularVectors,l=a.mmul(o),c=a.rows,u=s.rows,h=Nt.zeros(c,u);for(let p=0;p<c;p++)for(let f=0;f<u;f++){let d=0;for(let m=0;m<r;m++)d+=l.get(p,m)*s.get(f,m);h.set(p,f,d)}return h.mmul(e)}solveForDiagonal(t){return this.solve(Nt.diag(t))}inverse(){let t=this.V,e=this.threshold,n=t.rows,r=t.columns,o=new Nt(n,this.s.length);for(let u=0;u<n;u++)for(let h=0;h<r;h++)Math.abs(this.s[h])>e&&o.set(u,h,t.get(u,h)/this.s[h]);let s=this.U,a=s.rows,l=s.columns,c=new Nt(n,a);for(let u=0;u<n;u++)for(let h=0;h<a;h++){let p=0;for(let f=0;f<l;f++)p+=o.get(u,f)*s.get(h,f);c.set(u,h,p)}return c}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s;for(let r=0,o=n.length;r<o;r++)n[r]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Nt.diag(this.s)}};function Bmt(i,t=!1){return i=xi.checkMatrix(i),t?new la(i).inverse():ZH(i,Nt.eye(i.rows))}function ZH(i,t,e=!1){return i=xi.checkMatrix(i),t=xi.checkMatrix(t),e?new la(i).solve(t):i.isSquare()?new Th(i).solve(t):new gm(i).solve(t)}function nb(i){if(i=Nt.checkMatrix(i),i.isSquare()){if(i.columns===0)return 1;let t,e,n,r;if(i.columns===2)return t=i.get(0,0),e=i.get(0,1),n=i.get(1,0),r=i.get(1,1),t*r-e*n;if(i.columns===3){let o,s,a;return o=new Mh(i,[1,2],[1,2]),s=new Mh(i,[1,2],[0,2]),a=new Mh(i,[1,2],[0,1]),t=i.get(0,0),e=i.get(0,1),n=i.get(0,2),t*nb(o)-e*nb(s)+n*nb(a)}else return new Th(i).determinant}else throw Error("determinant can only be calculated for a square matrix")}function Vmt(i,t){let e=[];for(let n=0;n<i;n++)n!==t&&e.push(n);return e}function Hmt(i,t,e,n=1e-9,r=1e-9){if(i>r)return new Array(t.rows+1).fill(0);{let o=t.addRow(e,[0]);for(let s=0;s<o.rows;s++)Math.abs(o.get(s,0))<n&&o.set(s,0,0);return o.to1DArray()}}function $mt(i,t={}){let{thresholdValue:e=1e-9,thresholdError:n=1e-9}=t;i=Nt.checkMatrix(i);let r=i.rows,o=new Nt(r,r);for(let s=0;s<r;s++){let a=Nt.columnVector(i.getRow(s)),l=i.subMatrixRow(Vmt(r,s)).transpose(),u=new la(l).solve(a),h=Nt.sub(a,l.mmul(u)).abs().max();o.setRow(s,Hmt(h,u,s,e,n))}return o}function Umt(i,t=Number.EPSILON){if(i=Nt.checkMatrix(i),i.isEmpty())return i.transpose();let e=new la(i,{autoTranspose:!0}),n=e.leftSingularVectors,r=e.rightSingularVectors,o=e.diagonal;for(let s=0;s<o.length;s++)Math.abs(o[s])>t?o[s]=1/o[s]:o[s]=0;return r.mmul(Nt.diag(o).mmul(n.transpose()))}function Wmt(i,t=i,e={}){i=new Nt(i);let n=!1;if(typeof t=="object"&&!Nt.isMatrix(t)&&!Si.isAnyArray(t)?(e=t,t=i,n=!0):t=new Nt(t),i.rows!==t.rows)throw new TypeError("Both matrices must have the same number of rows");let{center:r=!0}=e;r&&(i=i.center("column"),n||(t=t.center("column")));let o=i.transpose().mmul(t);for(let s=0;s<o.rows;s++)for(let a=0;a<o.columns;a++)o.set(s,a,o.get(s,a)*(1/(i.rows-1)));return o}function Gmt(i,t=i,e={}){i=new Nt(i);let n=!1;if(typeof t=="object"&&!Nt.isMatrix(t)&&!Si.isAnyArray(t)?(e=t,t=i,n=!0):t=new Nt(t),i.rows!==t.rows)throw new TypeError("Both matrices must have the same number of rows");let{center:r=!0,scale:o=!0}=e;r&&(i.center("column"),n||t.center("column")),o&&(i.scale("column"),n||t.scale("column"));let s=i.standardDeviation("column",{unbiased:!0}),a=n?s:t.standardDeviation("column",{unbiased:!0}),l=i.transpose().mmul(t);for(let c=0;c<l.rows;c++)for(let u=0;u<l.columns;u++)l.set(c,u,l.get(c,u)*(1/(s[c]*a[u]))*(1/(i.rows-1)));return l}var rb=class{constructor(t,e={}){let{assumeSymmetric:n=!1}=e;if(t=xi.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let r=t.columns,o=new Nt(r,r),s=new Float64Array(r),a=new Float64Array(r),l=t,c,u,h=!1;if(n?h=!0:h=t.isSymmetric(),h){for(c=0;c<r;c++)for(u=0;u<r;u++)o.set(c,u,l.get(c,u));jmt(r,a,s,o),qmt(r,a,s,o)}else{let p=new Nt(r,r),f=new Float64Array(r);for(u=0;u<r;u++)for(c=0;c<r;c++)p.set(c,u,l.get(c,u));Xmt(r,p,f,o),Kmt(r,a,s,o,p)}this.n=r,this.e=a,this.d=s,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t=this.n,e=this.e,n=this.d,r=new Nt(t,t),o,s;for(o=0;o<t;o++){for(s=0;s<t;s++)r.set(o,s,0);r.set(o,o,n[o]),e[o]>0?r.set(o,o+1,e[o]):e[o]<0&&r.set(o,o-1,e[o])}return r}};function jmt(i,t,e,n){let r,o,s,a,l,c,u,h;for(l=0;l<i;l++)e[l]=n.get(i-1,l);for(a=i-1;a>0;a--){for(h=0,s=0,c=0;c<a;c++)h=h+Math.abs(e[c]);if(h===0)for(t[a]=e[a-1],l=0;l<a;l++)e[l]=n.get(a-1,l),n.set(a,l,0),n.set(l,a,0);else{for(c=0;c<a;c++)e[c]/=h,s+=e[c]*e[c];for(r=e[a-1],o=Math.sqrt(s),r>0&&(o=-o),t[a]=h*o,s=s-r*o,e[a-1]=r-o,l=0;l<a;l++)t[l]=0;for(l=0;l<a;l++){for(r=e[l],n.set(l,a,r),o=t[l]+n.get(l,l)*r,c=l+1;c<=a-1;c++)o+=n.get(c,l)*e[c],t[c]+=n.get(c,l)*r;t[l]=o}for(r=0,l=0;l<a;l++)t[l]/=s,r+=t[l]*e[l];for(u=r/(s+s),l=0;l<a;l++)t[l]-=u*e[l];for(l=0;l<a;l++){for(r=e[l],o=t[l],c=l;c<=a-1;c++)n.set(c,l,n.get(c,l)-(r*t[c]+o*e[c]));e[l]=n.get(a-1,l),n.set(a,l,0)}}e[a]=s}for(a=0;a<i-1;a++){if(n.set(i-1,a,n.get(a,a)),n.set(a,a,1),s=e[a+1],s!==0){for(c=0;c<=a;c++)e[c]=n.get(c,a+1)/s;for(l=0;l<=a;l++){for(o=0,c=0;c<=a;c++)o+=n.get(c,a+1)*n.get(c,l);for(c=0;c<=a;c++)n.set(c,l,n.get(c,l)-o*e[c])}}for(c=0;c<=a;c++)n.set(c,a+1,0)}for(l=0;l<i;l++)e[l]=n.get(i-1,l),n.set(i-1,l,0);n.set(i-1,i-1,1),t[0]=0}function qmt(i,t,e,n){let r,o,s,a,l,c,u,h,p,f,d,m,x,g,y,b;for(s=1;s<i;s++)t[s-1]=t[s];t[i-1]=0;let v=0,_=0,S=Number.EPSILON;for(c=0;c<i;c++){for(_=Math.max(_,Math.abs(e[c])+Math.abs(t[c])),u=c;u<i&&!(Math.abs(t[u])<=S*_);)u++;if(u>c)do{for(r=e[c],h=(e[c+1]-r)/(2*t[c]),p=Ko(h,1),h<0&&(p=-p),e[c]=t[c]/(h+p),e[c+1]=t[c]*(h+p),f=e[c+1],o=r-e[c],s=c+2;s<i;s++)e[s]-=o;for(v=v+o,h=e[u],d=1,m=d,x=d,g=t[c+1],y=0,b=0,s=u-1;s>=c;s--)for(x=m,m=d,b=y,r=d*t[s],o=d*h,p=Ko(h,t[s]),t[s+1]=y*p,y=t[s]/p,d=h/p,h=d*e[s]-y*r,e[s+1]=o+y*(d*r+y*e[s]),l=0;l<i;l++)o=n.get(l,s+1),n.set(l,s+1,y*n.get(l,s)+d*o),n.set(l,s,d*n.get(l,s)-y*o);h=-y*b*x*g*t[c]/f,t[c]=y*h,e[c]=d*h}while(Math.abs(t[c])>S*_);e[c]=e[c]+v,t[c]=0}for(s=0;s<i-1;s++){for(l=s,h=e[s],a=s+1;a<i;a++)e[a]<h&&(l=a,h=e[a]);if(l!==s)for(e[l]=e[s],e[s]=h,a=0;a<i;a++)h=n.get(a,s),n.set(a,s,n.get(a,l)),n.set(a,l,h)}}function Xmt(i,t,e,n){let r=0,o=i-1,s,a,l,c,u,h,p;for(h=r+1;h<=o-1;h++){for(p=0,c=h;c<=o;c++)p=p+Math.abs(t.get(c,h-1));if(p!==0){for(l=0,c=o;c>=h;c--)e[c]=t.get(c,h-1)/p,l+=e[c]*e[c];for(a=Math.sqrt(l),e[h]>0&&(a=-a),l=l-e[h]*a,e[h]=e[h]-a,u=h;u<i;u++){for(s=0,c=o;c>=h;c--)s+=e[c]*t.get(c,u);for(s=s/l,c=h;c<=o;c++)t.set(c,u,t.get(c,u)-s*e[c])}for(c=0;c<=o;c++){for(s=0,u=o;u>=h;u--)s+=e[u]*t.get(c,u);for(s=s/l,u=h;u<=o;u++)t.set(c,u,t.get(c,u)-s*e[u])}e[h]=p*e[h],t.set(h,h-1,p*a)}}for(c=0;c<i;c++)for(u=0;u<i;u++)n.set(c,u,c===u?1:0);for(h=o-1;h>=r+1;h--)if(t.get(h,h-1)!==0){for(c=h+1;c<=o;c++)e[c]=t.get(c,h-1);for(u=h;u<=o;u++){for(a=0,c=h;c<=o;c++)a+=e[c]*n.get(c,u);for(a=a/e[h]/t.get(h,h-1),c=h;c<=o;c++)n.set(c,u,n.get(c,u)+a*e[c])}}}function Kmt(i,t,e,n,r){let o=i-1,s=0,a=i-1,l=Number.EPSILON,c=0,u=0,h=0,p=0,f=0,d=0,m=0,x=0,g,y,b,v,_,S,E,M,N,I,w,R,P,D,F;for(g=0;g<i;g++)for((g<s||g>a)&&(e[g]=r.get(g,g),t[g]=0),y=Math.max(g-1,0);y<i;y++)u=u+Math.abs(r.get(g,y));for(;o>=s;){for(v=o;v>s&&(d=Math.abs(r.get(v-1,v-1))+Math.abs(r.get(v,v)),d===0&&(d=u),!(Math.abs(r.get(v,v-1))<l*d));)v--;if(v===o)r.set(o,o,r.get(o,o)+c),e[o]=r.get(o,o),t[o]=0,o--,x=0;else if(v===o-1){if(E=r.get(o,o-1)*r.get(o-1,o),h=(r.get(o-1,o-1)-r.get(o,o))/2,p=h*h+E,m=Math.sqrt(Math.abs(p)),r.set(o,o,r.get(o,o)+c),r.set(o-1,o-1,r.get(o-1,o-1)+c),M=r.get(o,o),p>=0){for(m=h>=0?h+m:h-m,e[o-1]=M+m,e[o]=e[o-1],m!==0&&(e[o]=M-E/m),t[o-1]=0,t[o]=0,M=r.get(o,o-1),d=Math.abs(M)+Math.abs(m),h=M/d,p=m/d,f=Math.sqrt(h*h+p*p),h=h/f,p=p/f,y=o-1;y<i;y++)m=r.get(o-1,y),r.set(o-1,y,p*m+h*r.get(o,y)),r.set(o,y,p*r.get(o,y)-h*m);for(g=0;g<=o;g++)m=r.get(g,o-1),r.set(g,o-1,p*m+h*r.get(g,o)),r.set(g,o,p*r.get(g,o)-h*m);for(g=s;g<=a;g++)m=n.get(g,o-1),n.set(g,o-1,p*m+h*n.get(g,o)),n.set(g,o,p*n.get(g,o)-h*m)}else e[o-1]=M+h,e[o]=M+h,t[o-1]=m,t[o]=-m;o=o-2,x=0}else{if(M=r.get(o,o),N=0,E=0,v<o&&(N=r.get(o-1,o-1),E=r.get(o,o-1)*r.get(o-1,o)),x===10){for(c+=M,g=s;g<=o;g++)r.set(g,g,r.get(g,g)-M);d=Math.abs(r.get(o,o-1))+Math.abs(r.get(o-1,o-2)),M=N=.75*d,E=-.4375*d*d}if(x===30&&(d=(N-M)/2,d=d*d+E,d>0)){for(d=Math.sqrt(d),N<M&&(d=-d),d=M-E/((N-M)/2+d),g=s;g<=o;g++)r.set(g,g,r.get(g,g)-d);c+=d,M=N=E=.964}for(x=x+1,_=o-2;_>=v&&(m=r.get(_,_),f=M-m,d=N-m,h=(f*d-E)/r.get(_+1,_)+r.get(_,_+1),p=r.get(_+1,_+1)-m-f-d,f=r.get(_+2,_+1),d=Math.abs(h)+Math.abs(p)+Math.abs(f),h=h/d,p=p/d,f=f/d,!(_===v||Math.abs(r.get(_,_-1))*(Math.abs(p)+Math.abs(f))<l*(Math.abs(h)*(Math.abs(r.get(_-1,_-1))+Math.abs(m)+Math.abs(r.get(_+1,_+1))))));)_--;for(g=_+2;g<=o;g++)r.set(g,g-2,0),g>_+2&&r.set(g,g-3,0);for(b=_;b<=o-1&&(D=b!==o-1,b!==_&&(h=r.get(b,b-1),p=r.get(b+1,b-1),f=D?r.get(b+2,b-1):0,M=Math.abs(h)+Math.abs(p)+Math.abs(f),M!==0&&(h=h/M,p=p/M,f=f/M)),M!==0);b++)if(d=Math.sqrt(h*h+p*p+f*f),h<0&&(d=-d),d!==0){for(b!==_?r.set(b,b-1,-d*M):v!==_&&r.set(b,b-1,-r.get(b,b-1)),h=h+d,M=h/d,N=p/d,m=f/d,p=p/h,f=f/h,y=b;y<i;y++)h=r.get(b,y)+p*r.get(b+1,y),D&&(h=h+f*r.get(b+2,y),r.set(b+2,y,r.get(b+2,y)-h*m)),r.set(b,y,r.get(b,y)-h*M),r.set(b+1,y,r.get(b+1,y)-h*N);for(g=0;g<=Math.min(o,b+3);g++)h=M*r.get(g,b)+N*r.get(g,b+1),D&&(h=h+m*r.get(g,b+2),r.set(g,b+2,r.get(g,b+2)-h*f)),r.set(g,b,r.get(g,b)-h),r.set(g,b+1,r.get(g,b+1)-h*p);for(g=s;g<=a;g++)h=M*n.get(g,b)+N*n.get(g,b+1),D&&(h=h+m*n.get(g,b+2),n.set(g,b+2,n.get(g,b+2)-h*f)),n.set(g,b,n.get(g,b)-h),n.set(g,b+1,n.get(g,b+1)-h*p)}}}if(u!==0){for(o=i-1;o>=0;o--)if(h=e[o],p=t[o],p===0)for(v=o,r.set(o,o,1),g=o-1;g>=0;g--){for(E=r.get(g,g)-h,f=0,y=v;y<=o;y++)f=f+r.get(g,y)*r.get(y,o);if(t[g]<0)m=E,d=f;else if(v=g,t[g]===0?r.set(g,o,E!==0?-f/E:-f/(l*u)):(M=r.get(g,g+1),N=r.get(g+1,g),p=(e[g]-h)*(e[g]-h)+t[g]*t[g],S=(M*d-m*f)/p,r.set(g,o,S),r.set(g+1,o,Math.abs(M)>Math.abs(m)?(-f-E*S)/M:(-d-N*S)/m)),S=Math.abs(r.get(g,o)),l*S*S>1)for(y=g;y<=o;y++)r.set(y,o,r.get(y,o)/S)}else if(p<0)for(v=o-1,Math.abs(r.get(o,o-1))>Math.abs(r.get(o-1,o))?(r.set(o-1,o-1,p/r.get(o,o-1)),r.set(o-1,o,-(r.get(o,o)-h)/r.get(o,o-1))):(F=eb(0,-r.get(o-1,o),r.get(o-1,o-1)-h,p),r.set(o-1,o-1,F[0]),r.set(o-1,o,F[1])),r.set(o,o-1,0),r.set(o,o,1),g=o-2;g>=0;g--){for(I=0,w=0,y=v;y<=o;y++)I=I+r.get(g,y)*r.get(y,o-1),w=w+r.get(g,y)*r.get(y,o);if(E=r.get(g,g)-h,t[g]<0)m=E,f=I,d=w;else if(v=g,t[g]===0?(F=eb(-I,-w,E,p),r.set(g,o-1,F[0]),r.set(g,o,F[1])):(M=r.get(g,g+1),N=r.get(g+1,g),R=(e[g]-h)*(e[g]-h)+t[g]*t[g]-p*p,P=(e[g]-h)*2*p,R===0&&P===0&&(R=l*u*(Math.abs(E)+Math.abs(p)+Math.abs(M)+Math.abs(N)+Math.abs(m))),F=eb(M*f-m*I+p*w,M*d-m*w-p*I,R,P),r.set(g,o-1,F[0]),r.set(g,o,F[1]),Math.abs(M)>Math.abs(m)+Math.abs(p)?(r.set(g+1,o-1,(-I-E*r.get(g,o-1)+p*r.get(g,o))/M),r.set(g+1,o,(-w-E*r.get(g,o)-p*r.get(g,o-1))/M)):(F=eb(-f-N*r.get(g,o-1),-d-N*r.get(g,o),m,p),r.set(g+1,o-1,F[0]),r.set(g+1,o,F[1]))),S=Math.max(Math.abs(r.get(g,o-1)),Math.abs(r.get(g,o))),l*S*S>1)for(y=g;y<=o;y++)r.set(y,o-1,r.get(y,o-1)/S),r.set(y,o,r.get(y,o)/S)}for(g=0;g<i;g++)if(g<s||g>a)for(y=g;y<i;y++)n.set(g,y,r.get(g,y));for(y=i-1;y>=s;y--)for(g=s;g<=a;g++){for(m=0,b=s;b<=Math.min(y,a);b++)m=m+n.get(g,b)*r.get(b,y);n.set(g,y,m)}}}function eb(i,t,e,n){let r,o;return Math.abs(e)>Math.abs(n)?(r=n/e,o=e+r*n,[(i+r*t)/o,(t-r*i)/o]):(r=e/n,o=n+r*e,[(r*i+t)/o,(r*t-i)/o])}var ob=class{constructor(t){if(t=xi.checkMatrix(t),!t.isSymmetric())throw new Error("Matrix is not symmetric");let e=t,n=e.rows,r=new Nt(n,n),o=!0,s,a,l;for(a=0;a<n;a++){let c=0;for(l=0;l<a;l++){let u=0;for(s=0;s<l;s++)u+=r.get(l,s)*r.get(a,s);u=(e.get(a,l)-u)/r.get(l,l),r.set(a,l,u),c=c+u*u}for(c=e.get(a,a)-c,o&=c>0,r.set(a,a,Math.sqrt(Math.max(c,0))),l=a+1;l<n;l++)r.set(a,l,0)}this.L=r,this.positiveDefinite=Boolean(o)}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=xi.checkMatrix(t);let e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let r=t.columns,o=t.clone(),s,a,l;for(l=0;l<n;l++)for(a=0;a<r;a++){for(s=0;s<l;s++)o.set(l,a,o.get(l,a)-o.get(s,a)*e.get(l,s));o.set(l,a,o.get(l,a)/e.get(l,l))}for(l=n-1;l>=0;l--)for(a=0;a<r;a++){for(s=l+1;s<n;s++)o.set(l,a,o.get(l,a)-o.get(s,a)*e.get(s,l));o.set(l,a,o.get(l,a)/e.get(l,l))}return o}get lowerTriangularMatrix(){return this.L}},sb=class{constructor(t,e={}){t=xi.checkMatrix(t);let{Y:n}=e,{scaleScores:r=!1,maxIterations:o=1e3,terminationCriteria:s=1e-10}=e,a;if(n){if(Si.isAnyArray(n)&&typeof n[0]=="number"?n=Nt.columnVector(n):n=xi.checkMatrix(n),n.rows!==t.rows)throw new Error("Y should have the same number of rows as X");a=n.getColumnVector(0)}else a=t.getColumnVector(0);let l=1,c,u,h,p;for(let f=0;f<o&&l>s;f++)h=t.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),h=h.div(h.norm()),c=t.mmul(h).div(h.transpose().mmul(h).get(0,0)),f>0&&(l=c.clone().sub(p).pow(2).sum()),p=c.clone(),n?(u=n.transpose().mmul(c).div(c.transpose().mmul(c).get(0,0)),u=u.div(u.norm()),a=n.mmul(u).div(u.transpose().mmul(u).get(0,0))):a=c;if(n){let f=t.transpose().mmul(c).div(c.transpose().mmul(c).get(0,0));f=f.div(f.norm());let d=t.clone().sub(c.clone().mmul(f.transpose())),m=a.transpose().mmul(c).div(c.transpose().mmul(c).get(0,0)),x=n.clone().sub(c.clone().mulS(m.get(0,0)).mmul(u.transpose()));this.t=c,this.p=f.transpose(),this.w=h.transpose(),this.q=u,this.u=a,this.s=c.transpose().mmul(c),this.xResidual=d,this.yResidual=x,this.betas=m}else this.w=h.transpose(),this.s=c.transpose().mmul(c).sqrt(),r?this.t=c.clone().div(this.s.get(0,0)):this.t=c,this.xResidual=t.sub(c.mmul(h.transpose()))}};ye.AbstractMatrix=se;ye.CHO=ob;ye.CholeskyDecomposition=ob;ye.DistanceMatrix=Eh;ye.EVD=rb;ye.EigenvalueDecomposition=rb;ye.LU=Th;ye.LuDecomposition=Th;ye.Matrix=Nt;ye.MatrixColumnSelectionView=TE;ye.MatrixColumnView=EE;ye.MatrixFlipColumnView=IE;ye.MatrixFlipRowView=AE;ye.MatrixRowSelectionView=RE;ye.MatrixRowView=kE;ye.MatrixSelectionView=Mh;ye.MatrixSubView=PE;ye.MatrixTransposeView=NE;ye.NIPALS=sb;ye.Nipals=sb;ye.QR=gm;ye.QrDecomposition=gm;ye.SVD=la;ye.SingularValueDecomposition=la;ye.SymmetricMatrix=Fl;ye.WrapperMatrix1D=ib;ye.WrapperMatrix2D=xi;ye.correlation=Gmt;ye.covariance=Wmt;ye.default=Nt;ye.determinant=nb;ye.inverse=Bmt;ye.linearDependencies=$mt;ye.pseudoInverse=Umt;ye.solve=ZH;ye.wrap=Omt});window.ga=function(){};window.JSCompiler_renameProperty=function(i,t){return i};var Y$=/(url\()([^)]*)(\))/g,Z$=/(^\/[^\/])|(^#)|(^[\w-\d]*:)/,Em,Mi;function ha(i,t){if(i&&Z$.test(i)||i==="//")return i;if(Em===void 0){Em=!1;try{let e=new URL("b","http://a");e.pathname="c%20d",Em=e.href==="http://a/c%20d"}catch(e){}}if(t||(t=document.baseURI||window.location.href),Em)try{return new URL(i,t).href}catch(e){return i}return Mi||(Mi=document.implementation.createHTMLDocument("temp"),Mi.base=Mi.createElement("base"),Mi.head.appendChild(Mi.base),Mi.anchor=Mi.createElement("a"),Mi.body.appendChild(Mi.anchor)),Mi.base.href=t,Mi.anchor.href=i,Mi.anchor.href||i}function Fh(i,t){return i.replace(Y$,function(e,n,r,o){return n+"'"+ha(r.replace(/["']/g,""),t)+"'"+o})}function Wl(i){return i.substring(0,i.lastIndexOf("/")+1)}var pa=!window.ShadyDOM||!window.ShadyDOM.inUse,o1t=Boolean(!window.ShadyCSS||window.ShadyCSS.nativeCss),s1t=!window.customElements.polyfillWrapFlushCallback,GE=pa&&"adoptedStyleSheets"in Document.prototype&&"replaceSync"in CSSStyleSheet.prototype&&(()=>{try{let i=new CSSStyleSheet;i.replaceSync("");let t=document.createElement("div");return t.attachShadow({mode:"open"}),t.shadowRoot.adoptedStyleSheets=[i],t.shadowRoot.adoptedStyleSheets[0]===i}catch(i){return!1}})(),jE=window.Polymer&&window.Polymer.rootPath||Wl(document.baseURI||window.location.href);var Oh=window.Polymer&&window.Polymer.sanitizeDOMValue||void 0;var qE=window.Polymer&&window.Polymer.setPassiveTouchGestures||!1;var Bi=window.Polymer&&window.Polymer.strictTemplatePolicy||!1,XE=function(i){Bi=i},KE=window.Polymer&&window.Polymer.allowTemplateFromDomModule||!1;var xo=window.Polymer&&window.Polymer.legacyOptimizations||!1;var Tm=window.Polymer&&window.Polymer.legacyWarnings||!1;var YE=window.Polymer&&window.Polymer.syncInitialRender||!1;var Im=window.Polymer&&window.Polymer.legacyUndefined||!1;var ZE=window.Polymer&&window.Polymer.orderedComputed||!1;var Gb=!0;var jb=window.Polymer&&window.Polymer.removeNestedTemplates||!1;var Am=window.Polymer&&window.Polymer.fastDomIf||!1;var Bh=window.Polymer&&window.Polymer.suppressTemplateNotifications||!1;var Vh=window.Polymer&&window.Polymer.legacyNoObservedAttributes||!1;var JE=window.Polymer&&window.Polymer.useAdoptedStyleSheetsWithBuiltCSS||!1;XE(!0);var qb={},e5={};function QE(i,t){qb[i]=e5[i.toLowerCase()]=t}function t5(i){return qb[i]||e5[i.toLowerCase()]}function J$(i){i.querySelector("style")&&console.warn("dom-module %s has style outside template",i.id)}var yo=class extends HTMLElement{static get observedAttributes(){return["id"]}static import(t,e){if(t){let n=t5(t);return n&&e?n.querySelector(e):n}return null}attributeChangedCallback(t,e,n,r){e!==n&&this.register()}get assetpath(){if(!this.__assetpath){let t=window.HTMLImports&&HTMLImports.importForElement?HTMLImports.importForElement(this)||document:this.ownerDocument,e=ha(this.getAttribute("assetpath")||"",t.baseURI);this.__assetpath=Wl(e)}return this.__assetpath}register(t){if(t=t||this.id,t){if(Bi&&t5(t)!==void 0)throw QE(t,null),new Error(`strictTemplatePolicy: dom-module ${t} re-registered`);this.id=t,QE(t,this),J$(this)}}};yo.prototype.modules=qb;customElements.define("dom-module",yo);function n5(i){let{moduleName:t,styleContent:e}=i,n=document.createElement("dom-module"),r=document.createElement("template"),o=[];i.styleDependencies&&i.styleDependencies.forEach(a=>{let l=document.createElement("style");l.setAttribute("include",a),o.push(l)});let s=document.createElement("style");Object.assign(s,{textContent:e}),o.forEach(a=>{r.content.appendChild(a)}),r.content.appendChild(s),n.appendChild(r),n.register(t)}n5({moduleName:"vz-projector-styles",styleContent:`
    :host {
      --paper-input-container-label: {
        font-size: 14px;
      }
      --paper-input-container-input: {
        font-size: 14px;
      }
      /* TODO: Figure out why this doesn't work */
      --paper-dropdown-menu-input: {
        font-size: 14px;
      }
    }

    paper-button {
      background: #e3e3e3;
      margin-left: 0;
      text-transform: none;
    }

    paper-dropdown-menu paper-item {
      font-size: 13px;
    }

    paper-tooltip {
      max-width: 200px;
      --paper-tooltip: {
        font-size: 12px;
      }
    }

    paper-checkbox {
      --paper-checkbox-checked-color: #880e4f;
    }

    paper-toggle-button {
      --paper-toggle-button-checked-bar-color: #880e4f;
      --paper-toggle-button-checked-button-color: #880e4f;
      --paper-toggle-button-checked-ink-color: #880e4f;
    }

    paper-icon-button {
      border-radius: 50%;
    }

    paper-icon-button[active] {
      color: white;
      background-color: #880e4f;
    }

    .slider {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      justify-content: space-between;
    }

    .slider span {
      width: 35px;
      text-align: right;
    }

    .slider label {
      align-items: center;
      display: flex;
    }

    .help-icon {
      height: 15px;
      left: 2px;
      min-width: 15px;
      min-height: 15px;
      margin: 0;
      padding: 0;
      top: -2px;
      width: 15px;
    }

    .ink-panel {
      display: flex;
      flex-direction: column;
      font-size: 14px;
    }

    .ink-panel h4 {
      border-bottom: 1px solid #ddd;
      font-size: 14px;
      font-weight: 500;
      margin: 0;
      margin-bottom: 10px;
      padding-bottom: 5px;
    }

    .ink-panel-header {
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      border-top: 1px solid rgba(0, 0, 0, 0.1);
      height: 50px;
    }

    .ink-panel-content {
      display: none;
      height: 100%;
    }

    .ink-panel-content.active {
      display: block;
    }

    .ink-panel-content h3 {
      font-weight: 500;
      font-size: 14px;
      margin-top: 20px;
      margin-bottom: 5px;
      text-transform: uppercase;
    }

    .ink-panel-header h3 {
      font-weight: 500;
      font-size: 14px;
      margin: 0;
      padding: 0 24px;
      text-transform: uppercase;
    }

    /* - Tabs */
    .ink-tab-group {
      align-items: center;
      box-sizing: border-box;
      display: flex;
      height: 100%;
      justify-content: space-around;
    }

    .ink-tab-group .projection-tab {
      color: rgba(0, 0, 0, 0.5);
      cursor: pointer;
      font-weight: 300;
      line-height: 49px;
      padding: 0 12px;
      text-align: center;
      text-transform: uppercase;
    }

    .ink-tab-group .projection-tab:hover {
      color: black;
    }

    .ink-tab-group .projection-tab.active {
      border-bottom: 2px solid black;
      color: black;
      font-weight: 500;
    }

    h4 {
      margin: 30px 0 10px 0;
    }

    .dismiss-dialog-note {
      margin-top: 25px;
      font-size: 11px;
      text-align: right;
    }
  `});var A5=zh(I5(),1),{__extends:x1t,__assign:y1t,__rest:v1t,__decorate:wt,__param:b1t,__esDecorate:_1t,__runInitializers:w1t,__propKey:S1t,__setFunctionName:C1t,__metadata:ht,__awaiter:M1t,__generator:E1t,__exportStar:T1t,__createBinding:I1t,__values:A1t,__read:k1t,__spread:R1t,__spreadArrays:P1t,__spreadArray:N1t,__await:L1t,__asyncGenerator:D1t,__asyncDelegator:z1t,__asyncValues:F1t,__makeTemplateObject:O1t,__importStar:B1t,__importDefault:V1t,__classPrivateFieldGet:H1t,__classPrivateFieldSet:$1t,__classPrivateFieldIn:U1t}=A5.default;function Fe(i){return t=>{if(i)if(t.hasOwnProperty("is")){if(i!==t.is)throw new Error(`custom element tag names do not match: (${i} !== ${t.is})`)}else Object.defineProperty(t,"is",{value:i});window.customElements.define(t.is,t)}}function k5(i,t,e){i.constructor.hasOwnProperty("properties")||Object.defineProperty(i.constructor,"properties",{value:{}}),i.constructor.properties[t]=Object.assign({},i.constructor.properties[t],e)}function Rt(i){return(t,e)=>{k5(t,e,i)}}function Nn(...i){return(t,e)=>{t.constructor.hasOwnProperty("observers")||Object.defineProperty(t.constructor,"observers",{value:[]}),t.constructor.observers.push(`${e}(${i.join(",")})`)}}function R5(i,...t){return(e,n,r)=>{let o=`__compute${n}`;Object.defineProperty(e,o,{value:r.get}),r.get=void 0;let s=[i,...t].join(",");k5(e,n,{computed:`${o}(${s})`})}}var G1t=P5((i,t)=>i.querySelector(t)),j1t=P5((i,t)=>i.querySelectorAll(t));function P5(i){return t=>(e,n)=>{Object.defineProperty(e,n,{get(){return i(this.shadowRoot,t)},enumerable:!0,configurable:!0})}}var Q$=0;function N5(){}N5.prototype.__mixinApplications;N5.prototype.__mixinSet;var Ge=function(i){let t=i.__mixinApplications;t||(t=new WeakMap,i.__mixinApplications=t);let e=Q$++;function n(r){let o=r.__mixinSet;if(o&&o[e])return r;let s=t,a=s.get(r);if(!a){a=i(r),s.set(r,a);let l=Object.create(a.__mixinSet||o||null);l[e]=!0,a.__mixinSet=l}return a}return n};var tU="link[rel=import][type~=css]",eU="include",L5="shady-unscoped";function Kb(i){return yo.import(i)}function D5(i){let t=i.body?i.body:i,e=Fh(t.textContent,i.baseURI),n=document.createElement("style");return n.textContent=e,n}function nU(i){let t=i.trim().split(/\s+/),e=[];for(let n=0;n<t.length;n++)e.push(...iU(t[n]));return e}function iU(i){let t=Kb(i);if(!t)return console.warn("Could not find style data in module named",i),[];if(t._styles===void 0){let e=[];e.push(...Yb(t));let n=t.querySelector("template");n&&e.push(...Nm(n,t.assetpath)),t._styles=e}return t._styles}function Nm(i,t){if(!i._styles){let e=[],n=i.content.querySelectorAll("style");for(let r=0;r<n.length;r++){let o=n[r],s=o.getAttribute(eU);s&&e.push(...nU(s).filter(function(a,l,c){return c.indexOf(a)===l})),t&&(o.textContent=Fh(o.textContent,t)),e.push(o)}i._styles=e}return i._styles}function z5(i){let t=Kb(i);return t?Yb(t):[]}function Yb(i){let t=[],e=i.querySelectorAll(tU);for(let n=0;n<e.length;n++){let r=e[n];if(r.import){let o=r.import,s=r.hasAttribute(L5);if(s&&!o._unscopedStyle){let a=D5(o);a.setAttribute(L5,""),o._unscopedStyle=a}else o._style||(o._style=D5(o));t.push(s?o._unscopedStyle:o._style)}}return t}function F5(i){let t=i.trim().split(/\s+/),e="";for(let n=0;n<t.length;n++)e+=rU(t[n]);return e}function rU(i){let t=Kb(i);if(t&&t._cssText===void 0){let e=sU(t),n=t.querySelector("template");n&&(e+=oU(n,t.assetpath)),t._cssText=e||null}return t||console.warn("Could not find style data in module named",i),t&&t._cssText||""}function oU(i,t){let e="",n=Nm(i,t);for(let r=0;r<n.length;r++){let o=n[r];o.parentNode&&o.parentNode.removeChild(o),e+=o.textContent}return e}function sU(i){let t="",e=Yb(i);for(let n=0;n<e.length;n++)t+=e[n].textContent;return t}var Ot=window.ShadyDOM&&window.ShadyDOM.noPatch&&window.ShadyDOM.wrap?window.ShadyDOM.wrap:window.ShadyDOM?i=>ShadyDOM.patch(i):i=>i;function Lm(i){return i.indexOf(".")>=0}function ur(i){let t=i.indexOf(".");return t===-1?i:i.slice(0,t)}function Zb(i,t){return i.indexOf(t+".")===0}function jl(i,t){return t.indexOf(i+".")===0}function vo(i,t,e){return t+e.slice(i.length)}function Dm(i,t){return i===t||Zb(i,t)||jl(i,t)}function ql(i){if(Array.isArray(i)){let t=[];for(let e=0;e<i.length;e++){let n=i[e].toString().split(".");for(let r=0;r<n.length;r++)t.push(n[r])}return t.join(".")}else return i}function O5(i){return Array.isArray(i)?ql(i).split("."):i.toString().split(".")}function Un(i,t,e){let n=i,r=O5(t);for(let o=0;o<r.length;o++){if(!n)return;let s=r[o];n=n[s]}return e&&(e.path=r.join(".")),n}function Jb(i,t,e){let n=i,r=O5(t),o=r[r.length-1];if(r.length>1){for(let s=0;s<r.length-1;s++){let a=r[s];if(n=n[a],!n)return}n[o]=e}else n[t]=e;return r.join(".")}var zm={},aU=/-[a-z]/g,lU=/([A-Z])/g;function ns(i){return zm[i]||(zm[i]=i.indexOf("-")<0?i:i.replace(aU,t=>t[1].toUpperCase()))}function Xl(i){return zm[i]||(zm[i]=i.replace(lU,"-$1").toLowerCase())}var cU=0,B5=0,Kl=[],uU=0,Qb=!1,V5=document.createTextNode("");new window.MutationObserver(hU).observe(V5,{characterData:!0});function hU(){Qb=!1;let i=Kl.length;for(let t=0;t<i;t++){let e=Kl[t];if(e)try{e()}catch(n){setTimeout(()=>{throw n})}}Kl.splice(0,i),B5+=i}var is={after(i){return{run(t){return window.setTimeout(t,i)},cancel(t){window.clearTimeout(t)}}},run(i,t){return window.setTimeout(i,t)},cancel(i){window.clearTimeout(i)}};var Yl={run(i){return window.requestAnimationFrame(i)},cancel(i){window.cancelAnimationFrame(i)}};var H5={run(i){return window.requestIdleCallback?window.requestIdleCallback(i):window.setTimeout(i,16)},cancel(i){window.cancelIdleCallback?window.cancelIdleCallback(i):window.clearTimeout(i)}};var Wn={run(i){return Qb||(Qb=!0,V5.textContent=uU++),Kl.push(i),cU++},cancel(i){let t=i-B5;if(t>=0){if(!Kl[t])throw new Error("invalid async handle: "+i);Kl[t]=null}}};var pU=Wn,Fm=Ge(i=>{class t extends i{static createProperties(n){let r=this.prototype;for(let o in n)o in r||r._createPropertyAccessor(o)}static attributeNameForProperty(n){return n.toLowerCase()}static typeForProperty(n){}_createPropertyAccessor(n,r){this._addPropertyToAttributeMap(n),this.hasOwnProperty(JSCompiler_renameProperty("__dataHasAccessor",this))||(this.__dataHasAccessor=Object.assign({},this.__dataHasAccessor)),this.__dataHasAccessor[n]||(this.__dataHasAccessor[n]=!0,this._definePropertyAccessor(n,r))}_addPropertyToAttributeMap(n){this.hasOwnProperty(JSCompiler_renameProperty("__dataAttributes",this))||(this.__dataAttributes=Object.assign({},this.__dataAttributes));let r=this.__dataAttributes[n];return r||(r=this.constructor.attributeNameForProperty(n),this.__dataAttributes[r]=n),r}_definePropertyAccessor(n,r){Object.defineProperty(this,n,{get(){return this.__data[n]},set:r?function(){}:function(o){this._setPendingProperty(n,o,!0)&&this._invalidateProperties()}})}constructor(){super(),this.__dataEnabled=!1,this.__dataReady=!1,this.__dataInvalid=!1,this.__data={},this.__dataPending=null,this.__dataOld=null,this.__dataInstanceProps=null,this.__dataCounter=0,this.__serializing=!1,this._initializeProperties()}ready(){this.__dataReady=!0,this._flushProperties()}_initializeProperties(){for(let n in this.__dataHasAccessor)this.hasOwnProperty(n)&&(this.__dataInstanceProps=this.__dataInstanceProps||{},this.__dataInstanceProps[n]=this[n],delete this[n])}_initializeInstanceProperties(n){Object.assign(this,n)}_setProperty(n,r){this._setPendingProperty(n,r)&&this._invalidateProperties()}_getProperty(n){return this.__data[n]}_setPendingProperty(n,r,o){let s=this.__data[n],a=this._shouldPropertyChange(n,r,s);return a&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),this.__dataOld&&!(n in this.__dataOld)&&(this.__dataOld[n]=s),this.__data[n]=r,this.__dataPending[n]=r),a}_isPropertyPending(n){return!!(this.__dataPending&&this.__dataPending.hasOwnProperty(n))}_invalidateProperties(){!this.__dataInvalid&&this.__dataReady&&(this.__dataInvalid=!0,pU.run(()=>{this.__dataInvalid&&(this.__dataInvalid=!1,this._flushProperties())}))}_enableProperties(){this.__dataEnabled||(this.__dataEnabled=!0,this.__dataInstanceProps&&(this._initializeInstanceProperties(this.__dataInstanceProps),this.__dataInstanceProps=null),this.ready())}_flushProperties(){this.__dataCounter++;let n=this.__data,r=this.__dataPending,o=this.__dataOld;this._shouldPropertiesChange(n,r,o)&&(this.__dataPending=null,this.__dataOld=null,this._propertiesChanged(n,r,o)),this.__dataCounter--}_shouldPropertiesChange(n,r,o){return Boolean(r)}_propertiesChanged(n,r,o){}_shouldPropertyChange(n,r,o){return o!==r&&(o===o||r===r)}attributeChangedCallback(n,r,o,s){r!==o&&this._attributeToProperty(n,o),super.attributeChangedCallback&&super.attributeChangedCallback(n,r,o,s)}_attributeToProperty(n,r,o){if(!this.__serializing){let s=this.__dataAttributes,a=s&&s[n]||n;this[a]=this._deserializeValue(r,o||this.constructor.typeForProperty(a))}}_propertyToAttribute(n,r,o){this.__serializing=!0,o=arguments.length<3?this[n]:o,this._valueToNodeAttribute(this,o,r||this.constructor.attributeNameForProperty(n)),this.__serializing=!1}_valueToNodeAttribute(n,r,o){let s=this._serializeValue(r);(o==="class"||o==="name"||o==="slot")&&(n=Ot(n)),s===void 0?n.removeAttribute(o):n.setAttribute(o,s)}_serializeValue(n){switch(typeof n){case"boolean":return n?"":void 0;default:return n!=null?n.toString():void 0}}_deserializeValue(n,r){switch(r){case Boolean:return n!==null;case Number:return Number(n);default:return n}}}return t});var $5={},Om=HTMLElement.prototype;for(;Om;){let i=Object.getOwnPropertyNames(Om);for(let t=0;t<i.length;t++)$5[i[t]]=!0;Om=Object.getPrototypeOf(Om)}function fU(i,t){if(!$5[t]){let e=i[t];e!==void 0&&(i.__data?i._setPendingProperty(t,e):(i.__dataProto?i.hasOwnProperty(JSCompiler_renameProperty("__dataProto",i))||(i.__dataProto=Object.create(i.__dataProto)):i.__dataProto={},i.__dataProto[t]=e))}}var Bm=Ge(i=>{let t=Fm(i);class e extends t{static createPropertiesForAttributes(){let r=this.observedAttributes;for(let o=0;o<r.length;o++)this.prototype._createPropertyAccessor(ns(r[o]))}static attributeNameForProperty(r){return Xl(r)}_initializeProperties(){this.__dataProto&&(this._initializeProtoProperties(this.__dataProto),this.__dataProto=null),super._initializeProperties()}_initializeProtoProperties(r){for(let o in r)this._setProperty(o,r[o])}_ensureAttribute(r,o){let s=this;s.hasAttribute(r)||this._valueToNodeAttribute(s,o,r)}_serializeValue(r){switch(typeof r){case"object":if(r instanceof Date)return r.toString();if(r)try{return JSON.stringify(r)}catch(o){return""}default:return super._serializeValue(r)}}_deserializeValue(r,o){let s;switch(o){case Object:try{s=JSON.parse(r)}catch(a){s=r}break;case Array:try{s=JSON.parse(r)}catch(a){s=null,console.warn(`Polymer::Attributes: couldn't decode Array as JSON: ${r}`)}break;case Date:s=isNaN(r)?String(r):Number(r),s=new Date(s);break;default:s=super._deserializeValue(r,o);break}return s}_definePropertyAccessor(r,o){fU(this,r),super._definePropertyAccessor(r,o)}_hasAccessor(r){return this.__dataHasAccessor&&this.__dataHasAccessor[r]}_isPropertyPending(r){return Boolean(this.__dataPending&&r in this.__dataPending)}}return e});var dU={"dom-if":!0,"dom-repeat":!0},U5=!1,W5=!1;function mU(){if(!U5){U5=!0;let i=document.createElement("textarea");i.placeholder="a",W5=i.placeholder===i.textContent}return W5}function gU(i){mU()&&i.localName==="textarea"&&i.placeholder&&i.placeholder===i.textContent&&(i.textContent=null)}function xU(i){let t=i.getAttribute("is");if(t&&dU[t]){let e=i;for(e.removeAttribute("is"),i=e.ownerDocument.createElement(t),e.parentNode.replaceChild(i,e),i.appendChild(e);e.attributes.length;)i.setAttribute(e.attributes[0].name,e.attributes[0].value),e.removeAttribute(e.attributes[0].name)}return i}function G5(i,t){let e=t.parentInfo&&G5(i,t.parentInfo);if(e){for(let n=e.firstChild,r=0;n;n=n.nextSibling)if(t.parentIndex===r++)return n}else return i}function yU(i,t,e,n){n.id&&(t[n.id]=e)}function vU(i,t,e){if(e.events&&e.events.length)for(let n=0,r=e.events,o;n<r.length&&(o=r[n]);n++)i._addMethodEventListenerToNode(t,o.name,o.value,i)}function bU(i,t,e,n){e.templateInfo&&(t._templateInfo=e.templateInfo,t._parentTemplateInfo=n)}function _U(i,t,e){return i=i._methodHost||i,function(r){i[e]?i[e](r,r.detail):console.warn("listener method `"+e+"` not defined")}}var j5=Ge(i=>{class t extends i{static _parseTemplate(n,r){if(!n._templateInfo){let o=n._templateInfo={};o.nodeInfoList=[],o.nestedTemplate=Boolean(r),o.stripWhiteSpace=r&&r.stripWhiteSpace||n.hasAttribute("strip-whitespace"),this._parseTemplateContent(n,o,{parent:null})}return n._templateInfo}static _parseTemplateContent(n,r,o){return this._parseTemplateNode(n.content,r,o)}static _parseTemplateNode(n,r,o){let s=!1,a=n;return a.localName=="template"&&!a.hasAttribute("preserve-content")?s=this._parseTemplateNestedTemplate(a,r,o)||s:a.localName==="slot"&&(r.hasInsertionPoint=!0),gU(a),a.firstChild&&this._parseTemplateChildNodes(a,r,o),a.hasAttributes&&a.hasAttributes()&&(s=this._parseTemplateNodeAttributes(a,r,o)||s),s||o.noted}static _parseTemplateChildNodes(n,r,o){if(!(n.localName==="script"||n.localName==="style"))for(let s=n.firstChild,a=0,l;s;s=l){if(s.localName=="template"&&(s=xU(s)),l=s.nextSibling,s.nodeType===Node.TEXT_NODE){let u=l;for(;u&&u.nodeType===Node.TEXT_NODE;)s.textContent+=u.textContent,l=u.nextSibling,n.removeChild(u),u=l;if(r.stripWhiteSpace&&!s.textContent.trim()){n.removeChild(s);continue}}let c={parentIndex:a,parentInfo:o};this._parseTemplateNode(s,r,c)&&(c.infoIndex=r.nodeInfoList.push(c)-1),s.parentNode&&a++}}static _parseTemplateNestedTemplate(n,r,o){let s=n,a=this._parseTemplate(s,r);return(a.content=s.content.ownerDocument.createDocumentFragment()).appendChild(s.content),o.templateInfo=a,!0}static _parseTemplateNodeAttributes(n,r,o){let s=!1,a=Array.from(n.attributes);for(let l=a.length-1,c;c=a[l];l--)s=this._parseTemplateNodeAttribute(n,r,o,c.name,c.value)||s;return s}static _parseTemplateNodeAttribute(n,r,o,s,a){return s.slice(0,3)==="on-"?(n.removeAttribute(s),o.events=o.events||[],o.events.push({name:s.slice(3),value:a}),!0):s==="id"?(o.id=a,!0):!1}static _contentForTemplate(n){let r=n._templateInfo;return r&&r.content||n.content}_stampTemplate(n,r){n&&!n.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(n),r=r||this.constructor._parseTemplate(n);let o=r.nodeInfoList,s=r.content||n.content,a=document.importNode(s,!0);a.__noInsertionPoint=!r.hasInsertionPoint;let l=a.nodeList=new Array(o.length);a.$={};for(let c=0,u=o.length,h;c<u&&(h=o[c]);c++){let p=l[c]=G5(a,h);yU(this,a.$,p,h),bU(this,p,h,r),vU(this,p,h)}return a=a,a}_addMethodEventListenerToNode(n,r,o,s){s=s||n;let a=_U(s,r,o);return this._addEventListenerToNode(n,r,a),a}_addEventListenerToNode(n,r,o){n.addEventListener(r,o)}_removeEventListenerFromNode(n,r,o){n.removeEventListener(r,o)}}return t});var Wh=0,Gh=[],Te={COMPUTE:"__computeEffects",REFLECT:"__reflectEffects",NOTIFY:"__notifyEffects",PROPAGATE:"__propagateEffects",OBSERVE:"__observeEffects",READ_ONLY:"__readOnly"},tT="__computeInfo",wU=/[A-Z]/;function t_(i,t,e){let n=i[t];if(!n)n=i[t]={};else if(!i.hasOwnProperty(t)&&(n=i[t]=Object.create(i[t]),e))for(let r in n){let o=n[r],s=n[r]=Array(o.length);for(let a=0;a<o.length;a++)s[a]=o[a]}return n}function Uh(i,t,e,n,r,o){if(t){let s=!1,a=Wh++;for(let l in e){let c=r?ur(l):l,u=t[c];if(u)for(let h=0,p=u.length,f;h<p&&(f=u[h]);h++)(!f.info||f.info.lastRun!==a)&&(!r||r_(l,f.trigger))&&(f.info&&(f.info.lastRun=a),f.fn(i,l,e,n,f.info,r,o),s=!0)}return s}return!1}function SU(i,t,e,n,r,o,s,a){let l=!1,c=s?ur(n):n,u=t[c];if(u)for(let h=0,p=u.length,f;h<p&&(f=u[h]);h++)(!f.info||f.info.lastRun!==e)&&(!s||r_(n,f.trigger))&&(f.info&&(f.info.lastRun=e),f.fn(i,n,r,o,f.info,s,a),l=!0);return l}function r_(i,t){if(t){let e=t.name;return e==i||!!(t.structured&&Zb(e,i))||!!(t.wildcard&&jl(e,i))}else return!0}function q5(i,t,e,n,r){let o=typeof r.method=="string"?i[r.method]:r.method,s=r.property;o?o.call(i,i.__data[s],n[s]):r.dynamicFn||console.warn("observer method `"+r.method+"` not defined")}function CU(i,t,e,n,r){let o=i[Te.NOTIFY],s,a=Wh++;for(let c in t)t[c]&&(o&&SU(i,o,a,c,e,n,r)||r&&MU(i,c,e))&&(s=!0);let l;s&&(l=i.__dataHost)&&l._invalidateProperties&&l._invalidateProperties()}function MU(i,t,e){let n=ur(t);if(n!==t){let r=Xl(n)+"-changed";return eT(i,r,e[t],t),!0}return!1}function eT(i,t,e,n){let r={value:e,queueProperty:!0};n&&(r.path=n),Ot(i).dispatchEvent(new CustomEvent(t,{detail:r}))}function EU(i,t,e,n,r,o){let a=(o?ur(t):t)!=t?t:null,l=a?Un(i,a):i.__data[t];a&&l===void 0&&(l=e[t]),eT(i,r.eventName,l,a)}function TU(i,t,e,n,r){let o,s=i.detail,a=s&&s.path;a?(n=vo(e,n,a),o=s&&s.value):o=i.currentTarget[e],o=r?!o:o,(!t[Te.READ_ONLY]||!t[Te.READ_ONLY][n])&&t._setPendingPropertyOrPath(n,o,!0,Boolean(a))&&(!s||!s.queueProperty)&&t._invalidateProperties()}function IU(i,t,e,n,r){let o=i.__data[t];Oh&&(o=Oh(o,r.attrName,"attribute",i)),i._propertyToAttribute(t,r.attrName,o)}function AU(i,t,e,n){let r=i[Te.COMPUTE];if(r)if(ZE){Wh++;let o=RU(i),s=[];for(let l in t)X5(l,r,s,o,n);let a;for(;a=s.shift();)nT(i,"",t,e,a)&&X5(a.methodInfo,r,s,o,n);Object.assign(e,i.__dataOld),Object.assign(t,i.__dataPending),i.__dataPending=null}else{let o=t;for(;Uh(i,r,o,e,n);)Object.assign(e,i.__dataOld),Object.assign(t,i.__dataPending),o=i.__dataPending,i.__dataPending=null}}var kU=(i,t,e)=>{let n=0,r=t.length-1,o=-1;for(;n<=r;){let s=n+r>>1,a=e.get(t[s].methodInfo)-e.get(i.methodInfo);if(a<0)n=s+1;else if(a>0)r=s-1;else{o=s;break}}o<0&&(o=r+1),t.splice(o,0,i)},X5=(i,t,e,n,r)=>{let o=r?ur(i):i,s=t[o];if(s)for(let a=0;a<s.length;a++){let l=s[a];l.info.lastRun!==Wh&&(!r||r_(i,l.trigger))&&(l.info.lastRun=Wh,kU(l.info,e,n))}};function RU(i){let t=i.constructor.__orderedComputedDeps;if(!t){t=new Map;let e=i[Te.COMPUTE],{counts:n,ready:r,total:o}=PU(i),s;for(;s=r.shift();){t.set(s,t.size);let a=e[s];a&&a.forEach(l=>{let c=l.info.methodInfo;--o,--n[c]===0&&r.push(c)})}o!==0&&console.warn(`Computed graph for ${i.localName} incomplete; circular?`),i.constructor.__orderedComputedDeps=t}return t}function PU(i){let t=i[tT],e={},n=i[Te.COMPUTE],r=[],o=0;for(let s in t){let a=t[s];o+=e[s]=a.args.filter(l=>!l.literal).length+(a.dynamicFn?1:0)}for(let s in n)t[s]||r.push(s);return{counts:e,ready:r,total:o}}function nT(i,t,e,n,r){let o=i_(i,t,e,n,r);if(o===Gh)return!1;let s=r.methodInfo;return i.__dataHasAccessor&&i.__dataHasAccessor[s]?i._setPendingProperty(s,o,!0):(i[s]=o,!1)}function NU(i,t,e){let n=i.__dataLinkedPaths;if(n){let r;for(let o in n){let s=n[o];jl(o,t)?(r=vo(o,s,t),i._setPendingPropertyOrPath(r,e,!0,!0)):jl(s,t)&&(r=vo(s,o,t),i._setPendingPropertyOrPath(r,e,!0,!0))}}}function e_(i,t,e,n,r,o,s){e.bindings=e.bindings||[];let a={kind:n,target:r,parts:o,literal:s,isCompound:o.length!==1};if(e.bindings.push(a),OU(a)){let{event:c,negate:u}=a.parts[0];a.listenerEvent=c||Xl(r)+"-changed",a.listenerNegate=u}let l=t.nodeInfoList.length;for(let c=0;c<a.parts.length;c++){let u=a.parts[c];u.compoundIndex=c,LU(i,t,a,u,l)}}function LU(i,t,e,n,r){if(!n.literal)if(e.kind==="attribute"&&e.target[0]==="-")console.warn("Cannot set attribute "+e.target+' because "-" is not a valid attribute starting character');else{let o=n.dependencies,s={index:r,binding:e,part:n,evaluator:i};for(let a=0;a<o.length;a++){let l=o[a];typeof l=="string"&&(l=rT(l),l.wildcard=!0),i._addTemplatePropertyEffect(t,l.rootProperty,{fn:DU,info:s,trigger:l})}}}function DU(i,t,e,n,r,o,s){let a=s[r.index],l=r.binding,c=r.part;if(o&&c.source&&t.length>c.source.length&&l.kind=="property"&&!l.isCompound&&a.__isPropertyEffectsClient&&a.__dataHasAccessor&&a.__dataHasAccessor[l.target]){let u=e[t];t=vo(c.source,l.target,t),a._setPendingPropertyOrPath(t,u,!1,!0)&&i._enqueueClient(a)}else{let u=r.evaluator._evaluateBinding(i,c,t,e,n,o);u!==Gh&&zU(i,a,l,c,u)}}function zU(i,t,e,n,r){if(r=FU(t,r,e,n),Oh&&(r=Oh(r,e.target,e.kind,t)),e.kind=="attribute")i._valueToNodeAttribute(t,r,e.target);else{let o=e.target;t.__isPropertyEffectsClient&&t.__dataHasAccessor&&t.__dataHasAccessor[o]?(!t[Te.READ_ONLY]||!t[Te.READ_ONLY][o])&&t._setPendingProperty(o,r)&&i._enqueueClient(t):i._setUnmanagedPropertyToNode(t,o,r)}}function FU(i,t,e,n){if(e.isCompound){let r=i.__dataCompoundStorage[e.target];r[n.compoundIndex]=t,t=r.join("")}return e.kind!=="attribute"&&(e.target==="textContent"||e.target==="value"&&(i.localName==="input"||i.localName==="textarea"))&&(t=t==null?"":t),t}function OU(i){return Boolean(i.target)&&i.kind!="attribute"&&i.kind!="text"&&!i.isCompound&&i.parts[0].mode==="{"}function BU(i,t){let{nodeList:e,nodeInfoList:n}=t;if(n.length)for(let r=0;r<n.length;r++){let o=n[r],s=e[r],a=o.bindings;if(a)for(let l=0;l<a.length;l++){let c=a[l];VU(s,c),HU(s,i,c)}s.__dataHost=i}}function VU(i,t){if(t.isCompound){let e=i.__dataCompoundStorage||(i.__dataCompoundStorage={}),n=t.parts,r=new Array(n.length);for(let s=0;s<n.length;s++)r[s]=n[s].literal;let o=t.target;e[o]=r,t.literal&&t.kind=="property"&&(o==="className"&&(i=Ot(i)),i[o]=t.literal)}}function HU(i,t,e){if(e.listenerEvent){let n=e.parts[0];i.addEventListener(e.listenerEvent,function(r){TU(r,t,e.target,n.source,n.negate)})}}function K5(i,t,e,n,r,o){o=t.static||o&&(typeof o!="object"||o[t.methodName]);let s={methodName:t.methodName,args:t.args,methodInfo:r,dynamicFn:o};for(let a=0,l;a<t.args.length&&(l=t.args[a]);a++)l.literal||i._addPropertyEffect(l.rootProperty,e,{fn:n,info:s,trigger:l});return o&&i._addPropertyEffect(t.methodName,e,{fn:n,info:s}),s}function i_(i,t,e,n,r){let o=i._methodHost||i,s=o[r.methodName];if(s){let a=i._marshalArgs(r.args,t,e);return a===Gh?Gh:s.apply(o,a)}else r.dynamicFn||console.warn("method `"+r.methodName+"` not defined")}var $U=[],iT="(?:[a-zA-Z_$][\\w.:$\\-*]*)",UU="(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)",WU="(?:'(?:[^'\\\\]|\\\\.)*')",GU='(?:"(?:[^"\\\\]|\\\\.)*")',jU="(?:"+WU+"|"+GU+")",Y5="(?:("+iT+"|"+UU+"|"+jU+")\\s*)",qU="(?:"+Y5+"(?:,\\s*"+Y5+")*)",XU="(?:\\(\\s*(?:"+qU+"?)\\)\\s*)",KU="("+iT+"\\s*"+XU+"?)",YU="(\\[\\[|{{)\\s*",ZU="(?:]]|}})",JU="(?:(!)\\s*)?",QU=YU+JU+KU+ZU,Z5=new RegExp(QU,"g");function J5(i){let t="";for(let e=0;e<i.length;e++)t+=i[e].literal||"";return t}function n_(i){let t=i.match(/([^\s]+?)\(([\s\S]*)\)/);if(t){let n={methodName:t[1],static:!0,args:$U};if(t[2].trim()){let r=t[2].replace(/\\,/g,"&comma;").split(",");return tW(r,n)}else return n}return null}function tW(i,t){return t.args=i.map(function(e){let n=rT(e);return n.literal||(t.static=!1),n},this),t}function rT(i){let t=i.trim().replace(/&comma;/g,",").replace(/\\(.)/g,"$1"),e={name:t,value:"",literal:!1},n=t[0];switch(n==="-"&&(n=t[1]),n>="0"&&n<="9"&&(n="#"),n){case"'":case'"':e.value=t.slice(1,-1),e.literal=!0;break;case"#":e.value=Number(t),e.literal=!0;break}return e.literal||(e.rootProperty=ur(t),e.structured=Lm(t),e.structured&&(e.wildcard=t.slice(-2)==".*",e.wildcard&&(e.name=t.slice(0,-2)))),e}function Q5(i,t,e){let n=Un(i,e);return n===void 0&&(n=t[e]),n}function oT(i,t,e,n){let r={indexSplices:n};Im&&!i._overrideLegacyUndefined&&(t.splices=r),i.notifyPath(e+".splices",r),i.notifyPath(e+".length",t.length),Im&&!i._overrideLegacyUndefined&&(r.indexSplices=[])}function Hh(i,t,e,n,r,o){oT(i,t,e,[{index:n,addedCount:r,removed:o,object:t,type:"splice"}])}function eW(i){return i[0].toUpperCase()+i.substring(1)}var fa=Ge(i=>{let t=j5(Bm(i));class e extends t{constructor(){super(),this.__isPropertyEffectsClient=!0,this.__dataClientsReady,this.__dataPendingClients,this.__dataToNotify,this.__dataLinkedPaths,this.__dataHasPaths,this.__dataCompoundStorage,this.__dataHost,this.__dataTemp,this.__dataClientsInitialized,this.__data,this.__dataPending,this.__dataOld,this.__computeEffects,this.__computeInfo,this.__reflectEffects,this.__notifyEffects,this.__propagateEffects,this.__observeEffects,this.__readOnly,this.__templateInfo,this._overrideLegacyUndefined}get PROPERTY_EFFECT_TYPES(){return Te}_initializeProperties(){super._initializeProperties(),this._registerHost(),this.__dataClientsReady=!1,this.__dataPendingClients=null,this.__dataToNotify=null,this.__dataLinkedPaths=null,this.__dataHasPaths=!1,this.__dataCompoundStorage=this.__dataCompoundStorage||null,this.__dataHost=this.__dataHost||null,this.__dataTemp={},this.__dataClientsInitialized=!1}_registerHost(){if($h.length){let r=$h[$h.length-1];r._enqueueClient(this),this.__dataHost=r}}_initializeProtoProperties(r){this.__data=Object.create(r),this.__dataPending=Object.create(r),this.__dataOld={}}_initializeInstanceProperties(r){let o=this[Te.READ_ONLY];for(let s in r)(!o||!o[s])&&(this.__dataPending=this.__dataPending||{},this.__dataOld=this.__dataOld||{},this.__data[s]=this.__dataPending[s]=r[s])}_addPropertyEffect(r,o,s){this._createPropertyAccessor(r,o==Te.READ_ONLY);let a=t_(this,o,!0)[r];a||(a=this[o][r]=[]),a.push(s)}_removePropertyEffect(r,o,s){let a=t_(this,o,!0)[r],l=a.indexOf(s);l>=0&&a.splice(l,1)}_hasPropertyEffect(r,o){let s=this[o];return Boolean(s&&s[r])}_hasReadOnlyEffect(r){return this._hasPropertyEffect(r,Te.READ_ONLY)}_hasNotifyEffect(r){return this._hasPropertyEffect(r,Te.NOTIFY)}_hasReflectEffect(r){return this._hasPropertyEffect(r,Te.REFLECT)}_hasComputedEffect(r){return this._hasPropertyEffect(r,Te.COMPUTE)}_setPendingPropertyOrPath(r,o,s,a){if(a||ur(Array.isArray(r)?r[0]:r)!==r){if(!a){let l=Un(this,r);if(r=Jb(this,r,o),!r||!super._shouldPropertyChange(r,o,l))return!1}if(this.__dataHasPaths=!0,this._setPendingProperty(r,o,s))return NU(this,r,o),!0}else{if(this.__dataHasAccessor&&this.__dataHasAccessor[r])return this._setPendingProperty(r,o,s);this[r]=o}return!1}_setUnmanagedPropertyToNode(r,o,s){(s!==r[o]||typeof s=="object")&&(o==="className"&&(r=Ot(r)),r[o]=s)}_setPendingProperty(r,o,s){let a=this.__dataHasPaths&&Lm(r),l=a?this.__dataTemp:this.__data;return this._shouldPropertyChange(r,o,l[r])?(this.__dataPending||(this.__dataPending={},this.__dataOld={}),r in this.__dataOld||(this.__dataOld[r]=this.__data[r]),a?this.__dataTemp[r]=o:this.__data[r]=o,this.__dataPending[r]=o,(a||this[Te.NOTIFY]&&this[Te.NOTIFY][r])&&(this.__dataToNotify=this.__dataToNotify||{},this.__dataToNotify[r]=s),!0):!1}_setProperty(r,o){this._setPendingProperty(r,o,!0)&&this._invalidateProperties()}_invalidateProperties(){this.__dataReady&&this._flushProperties()}_enqueueClient(r){this.__dataPendingClients=this.__dataPendingClients||[],r!==this&&this.__dataPendingClients.push(r)}_flushClients(){this.__dataClientsReady?this.__enableOrFlushClients():(this.__dataClientsReady=!0,this._readyClients(),this.__dataReady=!0)}__enableOrFlushClients(){let r=this.__dataPendingClients;if(r){this.__dataPendingClients=null;for(let o=0;o<r.length;o++){let s=r[o];s.__dataEnabled?s.__dataPending&&s._flushProperties():s._enableProperties()}}}_readyClients(){this.__enableOrFlushClients()}setProperties(r,o){for(let s in r)(o||!this[Te.READ_ONLY]||!this[Te.READ_ONLY][s])&&this._setPendingPropertyOrPath(s,r[s],!0);this._invalidateProperties()}ready(){this._flushProperties(),this.__dataClientsReady||this._flushClients(),this.__dataPending&&this._flushProperties()}_propertiesChanged(r,o,s){let a=this.__dataHasPaths;this.__dataHasPaths=!1;let l;AU(this,o,s,a),l=this.__dataToNotify,this.__dataToNotify=null,this._propagatePropertyChanges(o,s,a),this._flushClients(),Uh(this,this[Te.REFLECT],o,s,a),Uh(this,this[Te.OBSERVE],o,s,a),l&&CU(this,l,o,s,a),this.__dataCounter==1&&(this.__dataTemp={})}_propagatePropertyChanges(r,o,s){this[Te.PROPAGATE]&&Uh(this,this[Te.PROPAGATE],r,o,s),this.__templateInfo&&this._runEffectsForTemplate(this.__templateInfo,r,o,s)}_runEffectsForTemplate(r,o,s,a){let l=(c,u)=>{Uh(this,r.propertyEffects,c,s,u,r.nodeList);for(let h=r.firstChild;h;h=h.nextSibling)this._runEffectsForTemplate(h,c,s,u)};r.runEffects?r.runEffects(l,o,a):l(o,a)}linkPaths(r,o){r=ql(r),o=ql(o),this.__dataLinkedPaths=this.__dataLinkedPaths||{},this.__dataLinkedPaths[r]=o}unlinkPaths(r){r=ql(r),this.__dataLinkedPaths&&delete this.__dataLinkedPaths[r]}notifySplices(r,o){let s={path:""},a=Un(this,r,s);oT(this,a,s.path,o)}get(r,o){return Un(o||this,r)}set(r,o,s){s?Jb(s,r,o):(!this[Te.READ_ONLY]||!this[Te.READ_ONLY][r])&&this._setPendingPropertyOrPath(r,o,!0)&&this._invalidateProperties()}push(r,...o){let s={path:""},a=Un(this,r,s),l=a.length,c=a.push(...o);return o.length&&Hh(this,a,s.path,l,o.length,[]),c}pop(r){let o={path:""},s=Un(this,r,o),a=Boolean(s.length),l=s.pop();return a&&Hh(this,s,o.path,s.length,0,[l]),l}splice(r,o,s,...a){let l={path:""},c=Un(this,r,l);o<0?o=c.length-Math.floor(-o):o&&(o=Math.floor(o));let u;return arguments.length===2?u=c.splice(o):u=c.splice(o,s,...a),(a.length||u.length)&&Hh(this,c,l.path,o,a.length,u),u}shift(r){let o={path:""},s=Un(this,r,o),a=Boolean(s.length),l=s.shift();return a&&Hh(this,s,o.path,0,0,[l]),l}unshift(r,...o){let s={path:""},a=Un(this,r,s),l=a.unshift(...o);return o.length&&Hh(this,a,s.path,0,o.length,[]),l}notifyPath(r,o){let s;if(arguments.length==1){let a={path:""};o=Un(this,r,a),s=a.path}else Array.isArray(r)?s=ql(r):s=r;this._setPendingPropertyOrPath(s,o,!0,!0)&&this._invalidateProperties()}_createReadOnlyProperty(r,o){this._addPropertyEffect(r,Te.READ_ONLY),o&&(this["_set"+eW(r)]=function(s){this._setProperty(r,s)})}_createPropertyObserver(r,o,s){let a={property:r,method:o,dynamicFn:Boolean(s)};this._addPropertyEffect(r,Te.OBSERVE,{fn:q5,info:a,trigger:{name:r}}),s&&this._addPropertyEffect(o,Te.OBSERVE,{fn:q5,info:a,trigger:{name:o}})}_createMethodObserver(r,o){let s=n_(r);if(!s)throw new Error("Malformed observer expression '"+r+"'");K5(this,s,Te.OBSERVE,i_,null,o)}_createNotifyingProperty(r){this._addPropertyEffect(r,Te.NOTIFY,{fn:EU,info:{eventName:Xl(r)+"-changed",property:r}})}_createReflectedProperty(r){let o=this.constructor.attributeNameForProperty(r);o[0]==="-"?console.warn("Property "+r+" cannot be reflected to attribute "+o+' because "-" is not a valid starting attribute name. Use a lowercase first letter for the property instead.'):this._addPropertyEffect(r,Te.REFLECT,{fn:IU,info:{attrName:o}})}_createComputedProperty(r,o,s){let a=n_(o);if(!a)throw new Error("Malformed computed expression '"+o+"'");let l=K5(this,a,Te.COMPUTE,nT,r,s);t_(this,tT)[r]=l}_marshalArgs(r,o,s){let a=this.__data,l=[];for(let c=0,u=r.length;c<u;c++){let{name:h,structured:p,wildcard:f,value:d,literal:m}=r[c];if(!m)if(f){let x=jl(h,o),g=Q5(a,s,x?o:h);d={path:x?o:h,value:g,base:x?Un(a,h):g}}else d=p?Q5(a,s,h):a[h];if(Im&&!this._overrideLegacyUndefined&&d===void 0&&r.length>1)return Gh;l[c]=d}return l}static addPropertyEffect(r,o,s){this.prototype._addPropertyEffect(r,o,s)}static createPropertyObserver(r,o,s){this.prototype._createPropertyObserver(r,o,s)}static createMethodObserver(r,o){this.prototype._createMethodObserver(r,o)}static createNotifyingProperty(r){this.prototype._createNotifyingProperty(r)}static createReadOnlyProperty(r,o){this.prototype._createReadOnlyProperty(r,o)}static createReflectedProperty(r){this.prototype._createReflectedProperty(r)}static createComputedProperty(r,o,s){this.prototype._createComputedProperty(r,o,s)}static bindTemplate(r){return this.prototype._bindTemplate(r)}_bindTemplate(r,o){let s=this.constructor._parseTemplate(r),a=this.__preBoundTemplateInfo==s;if(!a)for(let l in s.propertyEffects)this._createPropertyAccessor(l);if(o)if(s=Object.create(s),s.wasPreBound=a,!this.__templateInfo)this.__templateInfo=s;else{let l=r._parentTemplateInfo||this.__templateInfo,c=l.lastChild;s.parent=l,l.lastChild=s,s.previousSibling=c,c?c.nextSibling=s:l.firstChild=s}else this.__preBoundTemplateInfo=s;return s}static _addTemplatePropertyEffect(r,o,s){let a=r.hostProps=r.hostProps||{};a[o]=!0;let l=r.propertyEffects=r.propertyEffects||{};(l[o]=l[o]||[]).push(s)}_stampTemplate(r,o){o=o||this._bindTemplate(r,!0),$h.push(this);let s=super._stampTemplate(r,o);if($h.pop(),o.nodeList=s.nodeList,!o.wasPreBound){let a=o.childNodes=[];for(let l=s.firstChild;l;l=l.nextSibling)a.push(l)}return s.templateInfo=o,BU(this,o),this.__dataClientsReady&&(this._runEffectsForTemplate(o,this.__data,null,!1),this._flushClients()),s}_removeBoundDom(r){let o=r.templateInfo,{previousSibling:s,nextSibling:a,parent:l}=o;s?s.nextSibling=a:l&&(l.firstChild=a),a?a.previousSibling=s:l&&(l.lastChild=s),o.nextSibling=o.previousSibling=null;let c=o.childNodes;for(let u=0;u<c.length;u++){let h=c[u];Ot(Ot(h).parentNode).removeChild(h)}}static _parseTemplateNode(r,o,s){let a=t._parseTemplateNode.call(this,r,o,s);if(r.nodeType===Node.TEXT_NODE){let l=this._parseBindings(r.textContent,o);l&&(r.textContent=J5(l)||" ",e_(this,o,s,"text","textContent",l),a=!0)}return a}static _parseTemplateNodeAttribute(r,o,s,a,l){let c=this._parseBindings(l,o);if(c){let u=a,h="property";wU.test(a)?h="attribute":a[a.length-1]=="$"&&(a=a.slice(0,-1),h="attribute");let p=J5(c);return p&&h=="attribute"&&(a=="class"&&r.hasAttribute("class")&&(p+=" "+r.getAttribute(a)),r.setAttribute(a,p)),h=="attribute"&&u=="disable-upgrade$"&&r.setAttribute(a,""),r.localName==="input"&&u==="value"&&r.setAttribute(u,""),r.removeAttribute(u),h==="property"&&(a=ns(a)),e_(this,o,s,h,a,c,p),!0}else return t._parseTemplateNodeAttribute.call(this,r,o,s,a,l)}static _parseTemplateNestedTemplate(r,o,s){let a=t._parseTemplateNestedTemplate.call(this,r,o,s),l=r.parentNode,c=s.templateInfo,u=l.localName==="dom-if",h=l.localName==="dom-repeat";jb&&(u||h)&&(l.removeChild(r),s=s.parentInfo,s.templateInfo=c,s.noted=!0,a=!1);let p=c.hostProps;if(Am&&u)p&&(o.hostProps=Object.assign(o.hostProps||{},p),jb||(s.parentInfo.noted=!0));else{let f="{";for(let d in p){let m=[{mode:f,source:d,dependencies:[d],hostProp:!0}];e_(this,o,s,"property","_host_"+d,m)}}return a}static _parseBindings(r,o){let s=[],a=0,l;for(;(l=Z5.exec(r))!==null;){l.index>a&&s.push({literal:r.slice(a,l.index)});let c=l[1][0],u=Boolean(l[2]),h=l[3].trim(),p=!1,f="",d=-1;c=="{"&&(d=h.indexOf("::"))>0&&(f=h.substring(d+2),h=h.substring(0,d),p=!0);let m=n_(h),x=[];if(m){let{args:g,methodName:y}=m;for(let v=0;v<g.length;v++){let _=g[v];_.literal||x.push(_)}let b=o.dynamicFns;(b&&b[y]||m.static)&&(x.push(y),m.dynamicFn=!0)}else x.push(h);s.push({source:h,mode:c,negate:u,customEvent:p,signature:m,dependencies:x,event:f}),a=Z5.lastIndex}if(a&&a<r.length){let c=r.substring(a);c&&s.push({literal:c})}return s.length?s:null}static _evaluateBinding(r,o,s,a,l,c){let u;return o.signature?u=i_(r,s,a,l,o.signature):s!=o.source?u=Un(r,o.source):c&&Lm(s)?u=Un(r,s):u=r.__data[s],o.negate&&(u=!u),u}}return e}),$h=[];var nW=0;function sT(){nW++}var iW=[];function Vm(i){iW.push(i)}function rW(i){let t={};for(let e in i){let n=i[e];t[e]=typeof n=="function"?{type:n}:n}return t}var aT=Ge(i=>{let t=Fm(i);function e(o){let s=Object.getPrototypeOf(o);return s.prototype instanceof r?s:null}function n(o){if(!o.hasOwnProperty(JSCompiler_renameProperty("__ownProperties",o))){let s=null;if(o.hasOwnProperty(JSCompiler_renameProperty("properties",o))){let a=o.properties;a&&(s=rW(a))}o.__ownProperties=s}return o.__ownProperties}class r extends t{static get observedAttributes(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))){Vm(this.prototype);let s=this._properties;this.__observedAttributes=s?Object.keys(s).map(a=>this.prototype._addPropertyToAttributeMap(a)):[]}return this.__observedAttributes}static finalize(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__finalized",this))){let s=e(this);s&&s.finalize(),this.__finalized=!0,this._finalizeClass()}}static _finalizeClass(){let s=n(this);s&&this.createProperties(s)}static get _properties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__properties",this))){let s=e(this);this.__properties=Object.assign({},s&&s._properties,n(this))}return this.__properties}static typeForProperty(s){let a=this._properties[s];return a&&a.type}_initializeProperties(){sT(),this.constructor.finalize(),super._initializeProperties()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._enableProperties()}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback()}}return r});var lT="3.4.1",Hm=window.ShadyCSS&&window.ShadyCSS.cssBuild,rs=Ge(i=>{let t=aT(fa(i));function e(l){if(!l.hasOwnProperty(JSCompiler_renameProperty("__propertyDefaults",l))){l.__propertyDefaults=null;let c=l._properties;for(let u in c){let h=c[u];"value"in h&&(l.__propertyDefaults=l.__propertyDefaults||{},l.__propertyDefaults[u]=h)}}return l.__propertyDefaults}function n(l){return l.hasOwnProperty(JSCompiler_renameProperty("__ownObservers",l))||(l.__ownObservers=l.hasOwnProperty(JSCompiler_renameProperty("observers",l))?l.observers:null),l.__ownObservers}function r(l,c,u,h){u.computed&&(u.readOnly=!0),u.computed&&(l._hasReadOnlyEffect(c)?console.warn(`Cannot redefine computed property '${c}'.`):l._createComputedProperty(c,u.computed,h)),u.readOnly&&!l._hasReadOnlyEffect(c)?l._createReadOnlyProperty(c,!u.computed):u.readOnly===!1&&l._hasReadOnlyEffect(c)&&console.warn(`Cannot make readOnly property '${c}' non-readOnly.`),u.reflectToAttribute&&!l._hasReflectEffect(c)?l._createReflectedProperty(c):u.reflectToAttribute===!1&&l._hasReflectEffect(c)&&console.warn(`Cannot make reflected property '${c}' non-reflected.`),u.notify&&!l._hasNotifyEffect(c)?l._createNotifyingProperty(c):u.notify===!1&&l._hasNotifyEffect(c)&&console.warn(`Cannot make notify property '${c}' non-notify.`),u.observer&&l._createPropertyObserver(c,u.observer,h[u.observer]),l._addPropertyToAttributeMap(c)}function o(l,c,u,h){if(!Hm){let p=c.content.querySelectorAll("style"),f=Nm(c),d=z5(u),m=c.content.firstElementChild;for(let g=0;g<d.length;g++){let y=d[g];y.textContent=l._processStyleText(y.textContent,h),c.content.insertBefore(y,m)}let x=0;for(let g=0;g<f.length;g++){let y=f[g],b=p[x];b!==y?(y=y.cloneNode(!0),b.parentNode.insertBefore(y,b)):x++,y.textContent=l._processStyleText(y.textContent,h)}}if(window.ShadyCSS&&window.ShadyCSS.prepareTemplate(c,u),JE&&Hm&&GE){let p=c.content.querySelectorAll("style");if(p){let f="";Array.from(p).forEach(d=>{f+=d.textContent,d.parentNode.removeChild(d)}),l._styleSheet=new CSSStyleSheet,l._styleSheet.replaceSync(f)}}}function s(l){let c=null;if(l&&(!Bi||KE)&&(c=yo.import(l,"template"),Bi&&!c))throw new Error(`strictTemplatePolicy: expecting dom-module or null template for ${l}`);return c}class a extends t{static get polymerElementVersion(){return lT}static _finalizeClass(){t._finalizeClass.call(this);let c=n(this);c&&this.createObservers(c,this._properties),this._prepareTemplate()}static _prepareTemplate(){let c=this.template;c&&(typeof c=="string"?(console.error("template getter must return HTMLTemplateElement"),c=null):xo||(c=c.cloneNode(!0))),this.prototype._template=c}static createProperties(c){for(let u in c)r(this.prototype,u,c[u],c)}static createObservers(c,u){let h=this.prototype;for(let p=0;p<c.length;p++)h._createMethodObserver(c[p],u)}static get template(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_template",this))){let c=this.prototype.hasOwnProperty(JSCompiler_renameProperty("_template",this.prototype))?this.prototype._template:void 0;this._template=c!==void 0?c:this.hasOwnProperty(JSCompiler_renameProperty("is",this))&&s(this.is)||Object.getPrototypeOf(this.prototype).constructor.template}return this._template}static set template(c){this._template=c}static get importPath(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_importPath",this))){let c=this.importMeta;if(c)this._importPath=Wl(c.url);else{let u=yo.import(this.is);this._importPath=u&&u.assetpath||Object.getPrototypeOf(this.prototype).constructor.importPath}}return this._importPath}constructor(){super(),this._template,this._importPath,this.rootPath,this.importPath,this.root,this.$}_initializeProperties(){this.constructor.finalize(),this.constructor._finalizeTemplate(this.localName),super._initializeProperties(),this.rootPath=jE,this.importPath=this.constructor.importPath;let c=e(this.constructor);if(!!c)for(let u in c){let h=c[u];if(this._canApplyPropertyDefault(u)){let p=typeof h.value=="function"?h.value.call(this):h.value;this._hasAccessor(u)?this._setPendingProperty(u,p,!0):this[u]=p}}}_canApplyPropertyDefault(c){return!this.hasOwnProperty(c)}static _processStyleText(c,u){return Fh(c,u)}static _finalizeTemplate(c){let u=this.prototype._template;if(u&&!u.__polymerFinalized){u.__polymerFinalized=!0;let h=this.importPath,p=h?ha(h):"";o(this,u,c,p),this.prototype._bindTemplate(u)}}connectedCallback(){window.ShadyCSS&&this._template&&window.ShadyCSS.styleElement(this),super.connectedCallback()}ready(){this._template&&(this.root=this._stampTemplate(this._template),this.$=this.root.$),super.ready()}_readyClients(){this._template&&(this.root=this._attachDom(this.root)),super._readyClients()}_attachDom(c){let u=Ot(this);if(u.attachShadow)return c?(u.shadowRoot||(u.attachShadow({mode:"open",shadyUpgradeFragment:c}),u.shadowRoot.appendChild(c),this.constructor._styleSheet&&(u.shadowRoot.adoptedStyleSheets=[this.constructor._styleSheet])),YE&&window.ShadyDOM&&window.ShadyDOM.flushInitial(u.shadowRoot),u.shadowRoot):null;throw new Error("ShadowDOM not available. PolymerElement can create dom as children instead of in ShadowDOM by setting `this.root = this;` before `ready`.")}updateStyles(c){window.ShadyCSS&&window.ShadyCSS.styleSubtree(this,c)}resolveUrl(c,u){return!u&&this.importPath&&(u=ha(this.importPath)),ha(c,u)}static _parseTemplateContent(c,u,h){return u.dynamicFns=u.dynamicFns||this._properties,t._parseTemplateContent.call(this,c,u,h)}static _addTemplatePropertyEffect(c,u,h){return Tm&&!(u in this._properties)&&!(h.info.part.signature&&h.info.part.signature.static)&&!h.info.part.hostProp&&!c.nestedTemplate&&console.warn(`Property '${u}' used in template but not declared in 'properties'; attribute will not be observed.`),t._addTemplatePropertyEffect.call(this,c,u,h)}}return a});var $m=class{constructor(t){this.value=t.toString()}toString(){return this.value}};function oW(i){if(i instanceof $m)return i.value;throw new Error(`non-literal value passed to Polymer's htmlLiteral function: ${i}`)}function sW(i){if(i instanceof HTMLTemplateElement)return i.innerHTML;if(i instanceof $m)return oW(i);throw new Error(`non-template value passed to Polymer's html function: ${i}`)}var ut=function(t,...e){let n=document.createElement("template");return n.innerHTML=e.reduce((r,o,s)=>r+sW(o)+t[s+1],t[0]),n};var ve=rs(HTMLElement);var aW=function(t){return lW(t)&&!cW(t)};function lW(i){return!!i&&typeof i=="object"}function cW(i){var t=Object.prototype.toString.call(i);return t==="[object RegExp]"||t==="[object Date]"||pW(i)}var uW=typeof Symbol=="function"&&Symbol.for,hW=uW?Symbol.for("react.element"):60103;function pW(i){return i.$$typeof===hW}function fW(i){return Array.isArray(i)?[]:{}}function qh(i,t){return t.clone!==!1&&t.isMergeableObject(i)?nc(fW(i),i,t):i}function dW(i,t,e){return i.concat(t).map(function(n){return qh(n,e)})}function mW(i,t){if(!t.customMerge)return nc;var e=t.customMerge(i);return typeof e=="function"?e:nc}function gW(i){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(i).filter(function(t){return Object.propertyIsEnumerable.call(i,t)}):[]}function cT(i){return Object.keys(i).concat(gW(i))}function IT(i,t){try{return t in i}catch(e){return!1}}function xW(i,t){return IT(i,t)&&!(Object.hasOwnProperty.call(i,t)&&Object.propertyIsEnumerable.call(i,t))}function yW(i,t,e){var n={};return e.isMergeableObject(i)&&cT(i).forEach(function(r){n[r]=qh(i[r],e)}),cT(t).forEach(function(r){xW(i,r)||(IT(i,r)&&e.isMergeableObject(t[r])?n[r]=mW(r,e)(i[r],t[r],e):n[r]=qh(t[r],e))}),n}function nc(i,t,e){e=e||{},e.arrayMerge=e.arrayMerge||dW,e.isMergeableObject=e.isMergeableObject||aW,e.cloneUnlessOtherwiseSpecified=qh;var n=Array.isArray(t),r=Array.isArray(i),o=n===r;return o?n?e.arrayMerge(i,t,e):yW(i,t,e):qh(t,e)}nc.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(n,r){return nc(n,r,e)},{})};var vW=nc,b_=vW;function bW(i){return i instanceof Element}function __(i){return i instanceof HTMLElement}function va(i){return typeof i=="function"}function Xh(i){return typeof i=="string"}function Yn(i){return i===void 0}var Kh=class{on(t,e,n,r=!1){return Yn(this.bindings)&&(this.bindings={}),Yn(this.bindings[t])&&(this.bindings[t]=[]),this.bindings[t].push({handler:e,ctx:n,once:r}),this}once(t,e,n){return this.on(t,e,n,!0)}off(t,e){return Yn(this.bindings)||Yn(this.bindings[t])?this:(Yn(e)?delete this.bindings[t]:this.bindings[t].forEach((n,r)=>{n.handler===e&&this.bindings[t].splice(r,1)}),this)}trigger(t,...e){return!Yn(this.bindings)&&this.bindings[t]&&this.bindings[t].forEach((n,r)=>{let{ctx:o,handler:s,once:a}=n,l=o||this;s.apply(l,e),a&&this.bindings[t].splice(r,1)}),this}};function AT(i){let t=Object.getOwnPropertyNames(i.constructor.prototype);for(let e=0;e<t.length;e++){let n=t[e],r=i[n];n!=="constructor"&&typeof r=="function"&&(i[n]=r.bind(i))}return i}function _W(i,t){return e=>{if(t.isOpen()){let n=t.el&&e.currentTarget===t.el;(!Yn(i)&&e.currentTarget.matches(i)||n)&&t.tour.next()}}}function wW(i){let{event:t,selector:e}=i.options.advanceOn||{};if(t){let n=_W(e,i),r;try{r=document.querySelector(e)}catch(o){}if(!Yn(e)&&!r)return console.error(`No element was found for the selector supplied to advanceOn: ${e}`);r?(r.addEventListener(t,n),i.on("destroy",()=>r.removeEventListener(t,n))):(document.body.addEventListener(t,n,!0),i.on("destroy",()=>document.body.removeEventListener(t,n,!0)))}else return console.error("advanceOn was defined, but no event name was passed.")}function kT(i){return!Xh(i)||i===""?"":i.charAt(i.length-1)!=="-"?`${i}-`:i}function SW(i){let t=i.options.attachTo||{},e=Object.assign({},t);if(va(e.element)&&(e.element=e.element.call(i)),Xh(e.element)){try{e.element=document.querySelector(e.element)}catch(n){}e.element||console.error(`The element for this Shepherd step was not found ${t.element}`)}return e}function RT(i){return i==null?!0:!i.element||!i.on}function w_(){let i=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{let e=(i+Math.random()*16)%16|0;return i=Math.floor(i/16),(t=="x"?e:e&3|8).toString(16)})}function Zn(){return Zn=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},Zn.apply(this,arguments)}function PT(i,t){if(i==null)return{};var e={},n=Object.keys(i),r,o;for(o=0;o<n.length;o++)r=n[o],!(t.indexOf(r)>=0)&&(e[r]=i[r]);return e}var ic=Math.min,ma=Math.max,Gm=Math.round,Um=Math.floor,ss=i=>({x:i,y:i}),CW={left:"right",right:"left",bottom:"top",top:"bottom"},MW={start:"end",end:"start"};function s_(i,t,e){return ma(i,ic(t,e))}function rc(i,t){return typeof i=="function"?i(t):i}function ba(i){return i.split("-")[0]}function Zm(i){return i.split("-")[1]}function S_(i){return i==="x"?"y":"x"}function C_(i){return i==="y"?"height":"width"}function Jm(i){return["top","bottom"].includes(ba(i))?"y":"x"}function M_(i){return S_(Jm(i))}function EW(i,t,e){e===void 0&&(e=!1);let n=Zm(i),r=M_(i),o=C_(r),s=r==="x"?n===(e?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=jm(s)),[s,jm(s)]}function TW(i){let t=jm(i);return[a_(i),t,a_(t)]}function a_(i){return i.replace(/start|end/g,t=>MW[t])}function IW(i,t,e){let n=["left","right"],r=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(i){case"top":case"bottom":return e?t?r:n:t?n:r;case"left":case"right":return t?o:s;default:return[]}}function AW(i,t,e,n){let r=Zm(i),o=IW(ba(i),e==="start",n);return r&&(o=o.map(s=>s+"-"+r),t&&(o=o.concat(o.map(a_)))),o}function jm(i){return i.replace(/left|right|bottom|top/g,t=>CW[t])}function kW(i){return Zn({top:0,right:0,bottom:0,left:0},i)}function NT(i){return typeof i!="number"?kW(i):{top:i,right:i,bottom:i,left:i}}function qm(i){return Zn({},i,{top:i.y,left:i.x,right:i.x+i.width,bottom:i.y+i.height})}var RW=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],PW=["mainAxis","crossAxis","limiter"];function uT(i,t,e){let{reference:n,floating:r}=i,o=Jm(t),s=M_(t),a=C_(s),l=ba(t),c=o==="y",u=n.x+n.width/2-r.width/2,h=n.y+n.height/2-r.height/2,p=n[a]/2-r[a]/2,f;switch(l){case"top":f={x:u,y:n.y-r.height};break;case"bottom":f={x:u,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:h};break;case"left":f={x:n.x-r.width,y:h};break;default:f={x:n.x,y:n.y}}switch(Zm(t)){case"start":f[s]-=p*(e&&c?-1:1);break;case"end":f[s]+=p*(e&&c?-1:1);break}return f}var NW=(i,t,e)=>$t(void 0,null,function*(){let{placement:n="bottom",strategy:r="absolute",middleware:o=[],platform:s}=e,a=o.filter(Boolean),l=yield s.isRTL==null?void 0:s.isRTL(t),c=yield s.getElementRects({reference:i,floating:t,strategy:r}),{x:u,y:h}=uT(c,n,l),p=n,f={},d=0;for(let m=0;m<a.length;m++){let{name:x,fn:g}=a[m],{x:y,y:b,data:v,reset:_}=yield g({x:u,y:h,initialPlacement:n,placement:p,strategy:r,middlewareData:f,rects:c,platform:s,elements:{reference:i,floating:t}});if(u=y!=null?y:u,h=b!=null?b:h,f=Zn({},f,{[x]:Zn({},f[x],v)}),_&&d<=50){d++,typeof _=="object"&&(_.placement&&(p=_.placement),_.rects&&(c=_.rects===!0?yield s.getElementRects({reference:i,floating:t,strategy:r}):_.rects),{x:u,y:h}=uT(c,p,l)),m=-1;continue}}return{x:u,y:h,placement:p,strategy:r,middlewareData:f}});function LT(i,t){return $t(this,null,function*(){var e;t===void 0&&(t={});let{x:n,y:r,platform:o,rects:s,elements:a,strategy:l}=i,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:p=!1,padding:f=0}=rc(t,i),d=NT(f),x=a[p?h==="floating"?"reference":"floating":h],g=qm(yield o.getClippingRect({element:(e=yield o.isElement==null?void 0:o.isElement(x))==null||e?x:x.contextElement||(yield o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),y=h==="floating"?Zn({},s.floating,{x:n,y:r}):s.reference,b=yield o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating),v=(yield o.isElement==null?void 0:o.isElement(b))?(yield o.getScale==null?void 0:o.getScale(b))||{x:1,y:1}:{x:1,y:1},_=qm(o.convertOffsetParentRelativeRectToViewportRelativeRect?yield o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:y,offsetParent:b,strategy:l}):y);return{top:(g.top-_.top+d.top)/v.y,bottom:(_.bottom-g.bottom+d.bottom)/v.y,left:(g.left-_.left+d.left)/v.x,right:(_.right-g.right+d.right)/v.x}})}var LW=i=>({name:"arrow",options:i,fn(e){return $t(this,null,function*(){let{x:n,y:r,placement:o,rects:s,platform:a,elements:l}=e,{element:c,padding:u=0}=rc(i,e)||{};if(c==null)return{};let h=NT(u),p={x:n,y:r},f=M_(o),d=C_(f),m=yield a.getDimensions(c),x=f==="y",g=x?"top":"left",y=x?"bottom":"right",b=x?"clientHeight":"clientWidth",v=s.reference[d]+s.reference[f]-p[f]-s.floating[d],_=p[f]-s.reference[f],S=yield a.getOffsetParent==null?void 0:a.getOffsetParent(c),E=S?S[b]:0;(!E||!(yield a.isElement==null?void 0:a.isElement(S)))&&(E=l.floating[b]||s.floating[d]);let M=v/2-_/2,N=E/2-m[d]/2-1,I=ic(h[g],N),w=ic(h[y],N),R=I,P=E-m[d]-w,D=E/2-m[d]/2+M,F=s_(R,D,P),V=Zm(o)!=null&&D!=F&&s.reference[d]/2-(D<R?I:w)-m[d]/2<0?D<R?R-D:P-D:0;return{[f]:p[f]-V,data:{[f]:F,centerOffset:D-F+V}}})}}),DW=function(t){return t===void 0&&(t={}),{name:"flip",options:t,fn(n){return $t(this,null,function*(){var r;let{placement:o,middlewareData:s,rects:a,initialPlacement:l,platform:c,elements:u}=n,h=rc(t,n),{mainAxis:p=!0,crossAxis:f=!0,fallbackPlacements:d,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:g=!0}=h,y=PT(h,RW),b=ba(o),v=ba(l)===l,_=yield c.isRTL==null?void 0:c.isRTL(u.floating),S=d||(v||!g?[jm(l)]:TW(l));!d&&x!=="none"&&S.push(...AW(l,g,x,_));let E=[l,...S],M=yield LT(n,y),N=[],I=((r=s.flip)==null?void 0:r.overflows)||[];if(p&&N.push(M[b]),f){let D=EW(o,a,_);N.push(M[D[0]],M[D[1]])}if(I=[...I,{placement:o,overflows:N}],!N.every(D=>D<=0)){var w,R;let D=(((w=s.flip)==null?void 0:w.index)||0)+1,F=E[D];if(F)return{data:{index:D,overflows:I},reset:{placement:F}};let z=(R=I.filter(V=>V.overflows[0]<=0).sort((V,H)=>V.overflows[1]-H.overflows[1])[0])==null?void 0:R.placement;if(!z)switch(m){case"bestFit":{var P;let V=(P=I.map(H=>[H.placement,H.overflows.filter(X=>X>0).reduce((X,U)=>X+U,0)]).sort((H,X)=>H[1]-X[1])[0])==null?void 0:P[0];V&&(z=V);break}case"initialPlacement":z=l;break}if(o!==z)return{reset:{placement:z}}}return{}})}}},zW=function(t){return t===void 0&&(t={}),{name:"shift",options:t,fn(n){return $t(this,null,function*(){let{x:r,y:o,placement:s}=n,a=rc(t,n),{mainAxis:l=!0,crossAxis:c=!1,limiter:u={fn:b=>{let{x:v,y:_}=b;return{x:v,y:_}}}}=a,h=PT(a,PW),p={x:r,y:o},f=yield LT(n,h),d=Jm(ba(s)),m=S_(d),x=p[m],g=p[d];if(l){let b=m==="y"?"top":"left",v=m==="y"?"bottom":"right",_=x+f[b],S=x-f[v];x=s_(_,x,S)}if(c){let b=d==="y"?"top":"left",v=d==="y"?"bottom":"right",_=g+f[b],S=g-f[v];g=s_(_,g,S)}let y=u.fn(Zn({},n,{[m]:x,[d]:g}));return Zn({},y,{data:{x:y.x-r,y:y.y-o}})})}}},FW=function(t){return t===void 0&&(t={}),{options:t,fn(e){let{x:n,y:r,placement:o,rects:s,middlewareData:a}=e,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=rc(t,e),h={x:n,y:r},p=Jm(o),f=S_(p),d=h[f],m=h[p],x=rc(l,e),g=typeof x=="number"?{mainAxis:x,crossAxis:0}:Zn({mainAxis:0,crossAxis:0},x);if(c){let v=f==="y"?"height":"width",_=s.reference[f]-s.floating[v]+g.mainAxis,S=s.reference[f]+s.reference[v]-g.mainAxis;d<_?d=_:d>S&&(d=S)}if(u){var y,b;let v=f==="y"?"width":"height",_=["top","left"].includes(ba(o)),S=s.reference[p]-s.floating[v]+(_&&((y=a.offset)==null?void 0:y[p])||0)+(_?0:g.crossAxis),E=s.reference[p]+s.reference[v]+(_?0:((b=a.offset)==null?void 0:b[p])||0)-(_?g.crossAxis:0);m<S?m=S:m>E&&(m=E)}return{[f]:d,[p]:m}}}};function as(i){return DT(i)?(i.nodeName||"").toLowerCase():"#document"}function Ei(i){var t;return(i==null||(t=i.ownerDocument)==null?void 0:t.defaultView)||window}function _o(i){var t;return(t=(DT(i)?i.ownerDocument:i.document)||window.document)==null?void 0:t.documentElement}function DT(i){return i instanceof Node||i instanceof Ei(i).Node}function bo(i){return i instanceof Element||i instanceof Ei(i).Element}function zr(i){return i instanceof HTMLElement||i instanceof Ei(i).HTMLElement}function hT(i){return typeof ShadowRoot=="undefined"?!1:i instanceof ShadowRoot||i instanceof Ei(i).ShadowRoot}function Jh(i){let{overflow:t,overflowX:e,overflowY:n,display:r}=Vi(i);return/auto|scroll|overlay|hidden|clip/.test(t+n+e)&&!["inline","contents"].includes(r)}function OW(i){return["table","td","th"].includes(as(i))}function E_(i){let t=T_(),e=Vi(i);return e.transform!=="none"||e.perspective!=="none"||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(e.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(e.contain||"").includes(n))}function BW(i){let t=oc(i);for(;zr(t)&&!Qm(t);){if(E_(t))return t;t=oc(t)}return null}function T_(){return typeof CSS=="undefined"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Qm(i){return["html","body","#document"].includes(as(i))}function Vi(i){return Ei(i).getComputedStyle(i)}function tg(i){return bo(i)?{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}:{scrollLeft:i.pageXOffset,scrollTop:i.pageYOffset}}function oc(i){if(as(i)==="html")return i;let t=i.assignedSlot||i.parentNode||hT(i)&&i.host||_o(i);return hT(t)?t.host:t}function zT(i){let t=oc(i);return Qm(t)?i.ownerDocument?i.ownerDocument.body:i.body:zr(t)&&Jh(t)?t:zT(t)}function Xm(i,t){var e;t===void 0&&(t=[]);let n=zT(i),r=n===((e=i.ownerDocument)==null?void 0:e.body),o=Ei(n);return r?t.concat(o,o.visualViewport||[],Jh(n)?n:[]):t.concat(n,Xm(n))}function FT(i){let t=Vi(i),e=parseFloat(t.width)||0,n=parseFloat(t.height)||0,r=zr(i),o=r?i.offsetWidth:e,s=r?i.offsetHeight:n,a=Gm(e)!==o||Gm(n)!==s;return a&&(e=o,n=s),{width:e,height:n,$:a}}function I_(i){return bo(i)?i:i.contextElement}function tc(i){let t=I_(i);if(!zr(t))return ss(1);let e=t.getBoundingClientRect(),{width:n,height:r,$:o}=FT(t),s=(o?Gm(e.width):e.width)/n,a=(o?Gm(e.height):e.height)/r;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}var VW=ss(0);function OT(i){let t=Ei(i);return!T_()||!t.visualViewport?VW:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function HW(i,t,e){return t===void 0&&(t=!1),!e||t&&e!==Ei(i)?!1:t}function _a(i,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=!1);let r=i.getBoundingClientRect(),o=I_(i),s=ss(1);t&&(n?bo(n)&&(s=tc(n)):s=tc(i));let a=HW(o,e,n)?OT(o):ss(0),l=(r.left+a.x)/s.x,c=(r.top+a.y)/s.y,u=r.width/s.x,h=r.height/s.y;if(o){let p=Ei(o),f=n&&bo(n)?Ei(n):n,d=p.frameElement;for(;d&&n&&f!==p;){let m=tc(d),x=d.getBoundingClientRect(),g=Vi(d),y=x.left+(d.clientLeft+parseFloat(g.paddingLeft))*m.x,b=x.top+(d.clientTop+parseFloat(g.paddingTop))*m.y;l*=m.x,c*=m.y,u*=m.x,h*=m.y,l+=y,c+=b,d=Ei(d).frameElement}}return qm({width:u,height:h,x:l,y:c})}function $W(i){let{rect:t,offsetParent:e,strategy:n}=i,r=zr(e),o=_o(e);if(e===o)return t;let s={scrollLeft:0,scrollTop:0},a=ss(1),l=ss(0);if((r||!r&&n!=="fixed")&&((as(e)!=="body"||Jh(o))&&(s=tg(e)),zr(e))){let c=_a(e);a=tc(e),l.x=c.x+e.clientLeft,l.y=c.y+e.clientTop}return{width:t.width*a.x,height:t.height*a.y,x:t.x*a.x-s.scrollLeft*a.x+l.x,y:t.y*a.y-s.scrollTop*a.y+l.y}}function UW(i){return Array.from(i.getClientRects())}function BT(i){return _a(_o(i)).left+tg(i).scrollLeft}function WW(i){let t=_o(i),e=tg(i),n=i.ownerDocument.body,r=ma(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),o=ma(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight),s=-e.scrollLeft+BT(i),a=-e.scrollTop;return Vi(n).direction==="rtl"&&(s+=ma(t.clientWidth,n.clientWidth)-r),{width:r,height:o,x:s,y:a}}function GW(i,t){let e=Ei(i),n=_o(i),r=e.visualViewport,o=n.clientWidth,s=n.clientHeight,a=0,l=0;if(r){o=r.width,s=r.height;let c=T_();(!c||c&&t==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:o,height:s,x:a,y:l}}function jW(i,t){let e=_a(i,!0,t==="fixed"),n=e.top+i.clientTop,r=e.left+i.clientLeft,o=zr(i)?tc(i):ss(1),s=i.clientWidth*o.x,a=i.clientHeight*o.y,l=r*o.x,c=n*o.y;return{width:s,height:a,x:l,y:c}}function pT(i,t,e){let n;if(t==="viewport")n=GW(i,e);else if(t==="document")n=WW(_o(i));else if(bo(t))n=jW(t,e);else{let r=OT(i);n=Zn({},t,{x:t.x-r.x,y:t.y-r.y})}return qm(n)}function VT(i,t){let e=oc(i);return e===t||!bo(e)||Qm(e)?!1:Vi(e).position==="fixed"||VT(e,t)}function qW(i,t){let e=t.get(i);if(e)return e;let n=Xm(i).filter(a=>bo(a)&&as(a)!=="body"),r=null,o=Vi(i).position==="fixed",s=o?oc(i):i;for(;bo(s)&&!Qm(s);){let a=Vi(s),l=E_(s);!l&&a.position==="fixed"&&(r=null),(o?!l&&!r:!l&&a.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||Jh(s)&&!l&&VT(i,s))?n=n.filter(u=>u!==s):r=a,s=oc(s)}return t.set(i,n),n}function XW(i){let{element:t,boundary:e,rootBoundary:n,strategy:r}=i,s=[...e==="clippingAncestors"?qW(t,this._c):[].concat(e),n],a=s[0],l=s.reduce((c,u)=>{let h=pT(t,u,r);return c.top=ma(h.top,c.top),c.right=ic(h.right,c.right),c.bottom=ic(h.bottom,c.bottom),c.left=ma(h.left,c.left),c},pT(t,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function KW(i){return FT(i)}function YW(i,t,e){let n=zr(t),r=_o(t),o=e==="fixed",s=_a(i,!0,o,t),a={scrollLeft:0,scrollTop:0},l=ss(0);if(n||!n&&!o)if((as(t)!=="body"||Jh(r))&&(a=tg(t)),n){let c=_a(t,!0,o,t);l.x=c.x+t.clientLeft,l.y=c.y+t.clientTop}else r&&(l.x=BT(r));return{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function fT(i,t){return!zr(i)||Vi(i).position==="fixed"?null:t?t(i):i.offsetParent}function HT(i,t){let e=Ei(i);if(!zr(i))return e;let n=fT(i,t);for(;n&&OW(n)&&Vi(n).position==="static";)n=fT(n,t);return n&&(as(n)==="html"||as(n)==="body"&&Vi(n).position==="static"&&!E_(n))?e:n||BW(i)||e}var ZW=function(t){return $t(this,null,function*(){let{reference:e,floating:n,strategy:r}=t,o=this.getOffsetParent||HT,s=this.getDimensions;return{reference:YW(e,yield o(n),r),floating:Zn({x:0,y:0},yield s(n))}})};function JW(i){return Vi(i).direction==="rtl"}var QW={convertOffsetParentRelativeRectToViewportRelativeRect:$W,getDocumentElement:_o,getClippingRect:XW,getOffsetParent:HT,getElementRects:ZW,getClientRects:UW,getDimensions:KW,getScale:tc,isElement:bo,isRTL:JW};function tG(i,t){let e=null,n,r=_o(i);function o(){clearTimeout(n),e&&e.disconnect(),e=null}function s(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),o();let{left:c,top:u,width:h,height:p}=i.getBoundingClientRect();if(a||t(),!h||!p)return;let f=Um(u),d=Um(r.clientWidth-(c+h)),m=Um(r.clientHeight-(u+p)),x=Um(c),y={rootMargin:-f+"px "+-d+"px "+-m+"px "+-x+"px",threshold:ma(0,ic(1,l))||1},b=!0;function v(_){let S=_[0].intersectionRatio;if(S!==l){if(!b)return s();S?s(!1,S):n=setTimeout(()=>{s(!1,1e-7)},100)}b=!1}try{e=new IntersectionObserver(v,Zn({},y,{root:r.ownerDocument}))}catch(_){e=new IntersectionObserver(v,y)}e.observe(i)}return s(!0),o}function eG(i,t,e,n){n===void 0&&(n={});let{ancestorScroll:r=!0,ancestorResize:o=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=I_(i),u=r||o?[...c?Xm(c):[],...Xm(t)]:[];u.forEach(g=>{r&&g.addEventListener("scroll",e,{passive:!0}),o&&g.addEventListener("resize",e)});let h=c&&a?tG(c,e):null,p=-1,f=null;s&&(f=new ResizeObserver(g=>{let[y]=g;y&&y.target===c&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{f&&f.observe(t)})),e()}),c&&!l&&f.observe(c),f.observe(t));let d,m=l?_a(i):null;l&&x();function x(){let g=_a(i);m&&(g.x!==m.x||g.y!==m.y||g.width!==m.width||g.height!==m.height)&&e(),m=g,d=requestAnimationFrame(x)}return e(),()=>{u.forEach(g=>{r&&g.removeEventListener("scroll",e),o&&g.removeEventListener("resize",e)}),h&&h(),f&&f.disconnect(),f=null,l&&cancelAnimationFrame(d)}}var nG=(i,t,e)=>{let n=new Map,r=Zn({platform:QW},e),o=Zn({},r.platform,{_c:n});return NW(i,t,Zn({},r,{platform:o}))};function iG(i){i.cleanup&&i.cleanup();let t=i._getResolvedAttachToOptions(),e=t.element,n=cG(t,i),r=RT(t);return r&&(e=document.body,i.shepherdElementComponent.getElement().classList.add("shepherd-centered")),i.cleanup=eG(e,i.el,()=>{if(!i.el){i.cleanup();return}sG(e,i,n,r)}),i.target=t.element,n}function rG(i,t){return{floatingUIOptions:b_(i.floatingUIOptions||{},t.floatingUIOptions||{})}}function oG(i){i.cleanup&&i.cleanup(),i.cleanup=null}function sG(i,t,e,n){return nG(i,t.el,e).then(aG(t,n)).then(r=>new Promise(o=>{setTimeout(()=>o(r),300)})).then(r=>{r&&r.el&&r.el.focus({preventScroll:!0})})}function aG(i,t){return({x:e,y:n,placement:r,middlewareData:o})=>(i.el&&(t?Object.assign(i.el.style,{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}):Object.assign(i.el.style,{position:"absolute",left:`${e}px`,top:`${n}px`}),i.el.dataset.popperPlacement=r,lG(i.el,o)),i)}function lG(i,t){let e=i.querySelector(".shepherd-arrow");if(e&&t.arrow){let{x:n,y:r}=t.arrow;Object.assign(e.style,{left:n!=null?`${n}px`:"",top:r!=null?`${r}px`:""})}}function cG(i,t){let e={strategy:"absolute",middleware:[]},n=uG(t);return RT(i)||(e.middleware.push(DW(),zW({limiter:FW(),crossAxis:!0})),n&&e.middleware.push(LW({element:n})),e.placement=i.on),b_(t.options.floatingUIOptions||{},e)}function uG(i){return i.options.arrow&&i.el?i.el.querySelector(".shepherd-arrow"):!1}function Ti(){}function hG(i,t){for(let e in t)i[e]=t[e];return i}function $T(i){return i()}function dT(){return Object.create(null)}function Qh(i){i.forEach($T)}function A_(i){return typeof i=="function"}function wo(i,t){return i!=i?t==t:i!==t||i&&typeof i=="object"||typeof i=="function"}function pG(i){return Object.keys(i).length===0}function sc(i,t){i.appendChild(t)}function pr(i,t,e){i.insertBefore(t,e||null)}function Hi(i){i.parentNode&&i.parentNode.removeChild(i)}function fG(i,t){for(let e=0;e<i.length;e+=1)i[e]&&i[e].d(t)}function Fr(i){return document.createElement(i)}function mT(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function UT(i){return document.createTextNode(i)}function Km(){return UT(" ")}function dG(){return UT("")}function eg(i,t,e,n){return i.addEventListener(t,e,n),()=>i.removeEventListener(t,e,n)}function Ue(i,t,e){e==null?i.removeAttribute(t):i.getAttribute(t)!==e&&i.setAttribute(t,e)}var mG=["width","height"];function gT(i,t){let e=Object.getOwnPropertyDescriptors(i.__proto__);for(let n in t)t[n]==null?i.removeAttribute(n):n==="style"?i.style.cssText=t[n]:n==="__value"?i.value=i[n]=t[n]:e[n]&&e[n].set&&mG.indexOf(n)===-1?i[n]=t[n]:Ue(i,n,t[n])}function gG(i){return Array.from(i.childNodes)}function Zl(i,t,e){i.classList[e?"add":"remove"](t)}var Yh;function jh(i){Yh=i}function WT(){if(!Yh)throw new Error("Function called outside component initialization");return Yh}function xG(i){WT().$$.on_mount.push(i)}function k_(i){WT().$$.after_update.push(i)}var Ql=[],ac=[],ec=[],xT=[],yG=Promise.resolve(),l_=!1;function vG(){l_||(l_=!0,yG.then(GT))}function c_(i){ec.push(i)}var o_=new Set,Jl=0;function GT(){if(Jl!==0)return;let i=Yh;do{try{for(;Jl<Ql.length;){let t=Ql[Jl];Jl++,jh(t),bG(t.$$)}}catch(t){throw Ql.length=0,Jl=0,t}for(jh(null),Ql.length=0,Jl=0;ac.length;)ac.pop()();for(let t=0;t<ec.length;t+=1){let e=ec[t];o_.has(e)||(o_.add(e),e())}ec.length=0}while(Ql.length);for(;xT.length;)xT.pop()();l_=!1,o_.clear(),jh(i)}function bG(i){if(i.fragment!==null){i.update(),Qh(i.before_update);let t=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,t),i.after_update.forEach(c_)}}function _G(i){let t=[],e=[];ec.forEach(n=>i.indexOf(n)===-1?t.push(n):e.push(n)),e.forEach(n=>n()),ec=t}var Wm=new Set,da;function xa(){da={r:0,c:[],p:da}}function ya(){da.r||Qh(da.c),da=da.p}function De(i,t){i&&i.i&&(Wm.delete(i),i.i(t))}function hn(i,t,e,n){if(i&&i.o){if(Wm.has(i))return;Wm.add(i),da.c.push(()=>{Wm.delete(i),n&&(e&&i.d(1),n())}),i.o(t)}else n&&n()}function wG(i,t){let e={},n={},r={$$scope:1},o=i.length;for(;o--;){let s=i[o],a=t[o];if(a){for(let l in s)l in a||(n[l]=1);for(let l in a)r[l]||(e[l]=a[l],r[l]=1);i[o]=a}else for(let l in s)r[l]=1}for(let s in n)s in e||(e[s]=void 0);return e}function wa(i){i&&i.c()}function ls(i,t,e,n){let{fragment:r,after_update:o}=i.$$;r&&r.m(t,e),n||c_(()=>{let s=i.$$.on_mount.map($T).filter(A_);i.$$.on_destroy?i.$$.on_destroy.push(...s):Qh(s),i.$$.on_mount=[]}),o.forEach(c_)}function cs(i,t){let e=i.$$;e.fragment!==null&&(_G(e.after_update),Qh(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function SG(i,t){i.$$.dirty[0]===-1&&(Ql.push(i),vG(),i.$$.dirty.fill(0)),i.$$.dirty[t/31|0]|=1<<t%31}function So(i,t,e,n,r,o,s,a=[-1]){let l=Yh;jh(i);let c=i.$$={fragment:null,ctx:[],props:o,update:Ti,not_equal:r,bound:dT(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:dT(),dirty:a,skip_bound:!1,root:t.target||l.$$.root};s&&s(c.root);let u=!1;if(c.ctx=e?e(i,t.props||{},(h,p,...f)=>{let d=f.length?f[0]:p;return c.ctx&&r(c.ctx[h],c.ctx[h]=d)&&(!c.skip_bound&&c.bound[h]&&c.bound[h](d),u&&SG(i,h)),p}):[],c.update(),u=!0,Qh(c.before_update),c.fragment=n?n(c.ctx):!1,t.target){if(t.hydrate){let h=gG(t.target);c.fragment&&c.fragment.l(h),h.forEach(Hi)}else c.fragment&&c.fragment.c();t.intro&&De(i.$$.fragment),ls(i,t.target,t.anchor,t.customElement),GT()}jh(l)}var hr=class{$destroy(){cs(this,1),this.$destroy=Ti}$on(t,e){if(!A_(e))return Ti;let n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{let r=n.indexOf(e);r!==-1&&n.splice(r,1)}}$set(t){this.$$set&&!pG(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}};function CG(i){let t,e,n,r,o;return{c(){t=Fr("button"),Ue(t,"aria-label",e=i[3]?i[3]:null),Ue(t,"class",n=`${i[1]||""} shepherd-button ${i[4]?"shepherd-button-secondary":""}`),t.disabled=i[2],Ue(t,"tabindex","0")},m(s,a){pr(s,t,a),t.innerHTML=i[5],r||(o=eg(t,"click",function(){A_(i[0])&&i[0].apply(this,arguments)}),r=!0)},p(s,[a]){i=s,a&32&&(t.innerHTML=i[5]),a&8&&e!==(e=i[3]?i[3]:null)&&Ue(t,"aria-label",e),a&18&&n!==(n=`${i[1]||""} shepherd-button ${i[4]?"shepherd-button-secondary":""}`)&&Ue(t,"class",n),a&4&&(t.disabled=i[2])},i:Ti,o:Ti,d(s){s&&Hi(t),r=!1,o()}}}function MG(i,t,e){let{config:n,step:r}=t,o,s,a,l,c,u;function h(p){return va(p)?p=p.call(r):p}return i.$$set=p=>{"config"in p&&e(6,n=p.config),"step"in p&&e(7,r=p.step)},i.$$.update=()=>{i.$$.dirty&192&&(e(0,o=n.action?n.action.bind(r.tour):null),e(1,s=n.classes),e(2,a=n.disabled?h(n.disabled):!1),e(3,l=n.label?h(n.label):null),e(4,c=n.secondary),e(5,u=n.text?h(n.text):null))},[o,s,a,l,c,u,n,r]}var u_=class extends hr{constructor(t){super(),So(this,t,MG,CG,wo,{config:6,step:7})}};function yT(i,t,e){let n=i.slice();return n[2]=t[e],n}function vT(i){let t,e,n=i[1],r=[];for(let s=0;s<n.length;s+=1)r[s]=bT(yT(i,n,s));let o=s=>hn(r[s],1,1,()=>{r[s]=null});return{c(){for(let s=0;s<r.length;s+=1)r[s].c();t=dG()},m(s,a){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(s,a);pr(s,t,a),e=!0},p(s,a){if(a&3){n=s[1];let l;for(l=0;l<n.length;l+=1){let c=yT(s,n,l);r[l]?(r[l].p(c,a),De(r[l],1)):(r[l]=bT(c),r[l].c(),De(r[l],1),r[l].m(t.parentNode,t))}for(xa(),l=n.length;l<r.length;l+=1)o(l);ya()}},i(s){if(!e){for(let a=0;a<n.length;a+=1)De(r[a]);e=!0}},o(s){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)hn(r[a]);e=!1},d(s){fG(r,s),s&&Hi(t)}}}function bT(i){let t,e;return t=new u_({props:{config:i[2],step:i[0]}}),{c(){wa(t.$$.fragment)},m(n,r){ls(t,n,r),e=!0},p(n,r){let o={};r&2&&(o.config=n[2]),r&1&&(o.step=n[0]),t.$set(o)},i(n){e||(De(t.$$.fragment,n),e=!0)},o(n){hn(t.$$.fragment,n),e=!1},d(n){cs(t,n)}}}function EG(i){let t,e,n=i[1]&&vT(i);return{c(){t=Fr("footer"),n&&n.c(),Ue(t,"class","shepherd-footer")},m(r,o){pr(r,t,o),n&&n.m(t,null),e=!0},p(r,[o]){r[1]?n?(n.p(r,o),o&2&&De(n,1)):(n=vT(r),n.c(),De(n,1),n.m(t,null)):n&&(xa(),hn(n,1,1,()=>{n=null}),ya())},i(r){e||(De(n),e=!0)},o(r){hn(n),e=!1},d(r){r&&Hi(t),n&&n.d()}}}function TG(i,t,e){let n,{step:r}=t;return i.$$set=o=>{"step"in o&&e(0,r=o.step)},i.$$.update=()=>{i.$$.dirty&1&&e(1,n=r.options.buttons)},[r,n]}var h_=class extends hr{constructor(t){super(),So(this,t,TG,EG,wo,{step:0})}};function IG(i){let t,e,n,r,o;return{c(){t=Fr("button"),e=Fr("span"),e.textContent="\xD7",Ue(e,"aria-hidden","true"),Ue(t,"aria-label",n=i[0].label?i[0].label:"Close Tour"),Ue(t,"class","shepherd-cancel-icon"),Ue(t,"type","button")},m(s,a){pr(s,t,a),sc(t,e),r||(o=eg(t,"click",i[1]),r=!0)},p(s,[a]){a&1&&n!==(n=s[0].label?s[0].label:"Close Tour")&&Ue(t,"aria-label",n)},i:Ti,o:Ti,d(s){s&&Hi(t),r=!1,o()}}}function AG(i,t,e){let{cancelIcon:n,step:r}=t,o=s=>{s.preventDefault(),r.cancel()};return i.$$set=s=>{"cancelIcon"in s&&e(0,n=s.cancelIcon),"step"in s&&e(2,r=s.step)},[n,o,r]}var p_=class extends hr{constructor(t){super(),So(this,t,AG,IG,wo,{cancelIcon:0,step:2})}};function kG(i){let t;return{c(){t=Fr("h3"),Ue(t,"id",i[1]),Ue(t,"class","shepherd-title")},m(e,n){pr(e,t,n),i[3](t)},p(e,[n]){n&2&&Ue(t,"id",e[1])},i:Ti,o:Ti,d(e){e&&Hi(t),i[3](null)}}}function RG(i,t,e){let{labelId:n,element:r,title:o}=t;k_(()=>{va(o)&&e(2,o=o()),e(0,r.innerHTML=o,r)});function s(a){ac[a?"unshift":"push"](()=>{r=a,e(0,r)})}return i.$$set=a=>{"labelId"in a&&e(1,n=a.labelId),"element"in a&&e(0,r=a.element),"title"in a&&e(2,o=a.title)},[r,n,o,s]}var f_=class extends hr{constructor(t){super(),So(this,t,RG,kG,wo,{labelId:1,element:0,title:2})}};function _T(i){let t,e;return t=new f_({props:{labelId:i[0],title:i[2]}}),{c(){wa(t.$$.fragment)},m(n,r){ls(t,n,r),e=!0},p(n,r){let o={};r&1&&(o.labelId=n[0]),r&4&&(o.title=n[2]),t.$set(o)},i(n){e||(De(t.$$.fragment,n),e=!0)},o(n){hn(t.$$.fragment,n),e=!1},d(n){cs(t,n)}}}function wT(i){let t,e;return t=new p_({props:{cancelIcon:i[3],step:i[1]}}),{c(){wa(t.$$.fragment)},m(n,r){ls(t,n,r),e=!0},p(n,r){let o={};r&8&&(o.cancelIcon=n[3]),r&2&&(o.step=n[1]),t.$set(o)},i(n){e||(De(t.$$.fragment,n),e=!0)},o(n){hn(t.$$.fragment,n),e=!1},d(n){cs(t,n)}}}function PG(i){let t,e,n,r=i[2]&&_T(i),o=i[3]&&i[3].enabled&&wT(i);return{c(){t=Fr("header"),r&&r.c(),e=Km(),o&&o.c(),Ue(t,"class","shepherd-header")},m(s,a){pr(s,t,a),r&&r.m(t,null),sc(t,e),o&&o.m(t,null),n=!0},p(s,[a]){s[2]?r?(r.p(s,a),a&4&&De(r,1)):(r=_T(s),r.c(),De(r,1),r.m(t,e)):r&&(xa(),hn(r,1,1,()=>{r=null}),ya()),s[3]&&s[3].enabled?o?(o.p(s,a),a&8&&De(o,1)):(o=wT(s),o.c(),De(o,1),o.m(t,null)):o&&(xa(),hn(o,1,1,()=>{o=null}),ya())},i(s){n||(De(r),De(o),n=!0)},o(s){hn(r),hn(o),n=!1},d(s){s&&Hi(t),r&&r.d(),o&&o.d()}}}function NG(i,t,e){let{labelId:n,step:r}=t,o,s;return i.$$set=a=>{"labelId"in a&&e(0,n=a.labelId),"step"in a&&e(1,r=a.step)},i.$$.update=()=>{i.$$.dirty&2&&(e(2,o=r.options.title),e(3,s=r.options.cancelIcon))},[n,r,o,s]}var d_=class extends hr{constructor(t){super(),So(this,t,NG,PG,wo,{labelId:0,step:1})}};function LG(i){let t;return{c(){t=Fr("div"),Ue(t,"class","shepherd-text"),Ue(t,"id",i[1])},m(e,n){pr(e,t,n),i[3](t)},p(e,[n]){n&2&&Ue(t,"id",e[1])},i:Ti,o:Ti,d(e){e&&Hi(t),i[3](null)}}}function DG(i,t,e){let{descriptionId:n,element:r,step:o}=t;k_(()=>{let{text:a}=o.options;va(a)&&(a=a.call(o)),__(a)?r.appendChild(a):e(0,r.innerHTML=a,r)});function s(a){ac[a?"unshift":"push"](()=>{r=a,e(0,r)})}return i.$$set=a=>{"descriptionId"in a&&e(1,n=a.descriptionId),"element"in a&&e(0,r=a.element),"step"in a&&e(2,o=a.step)},[r,n,o,s]}var m_=class extends hr{constructor(t){super(),So(this,t,DG,LG,wo,{descriptionId:1,element:0,step:2})}};function ST(i){let t,e;return t=new d_({props:{labelId:i[1],step:i[2]}}),{c(){wa(t.$$.fragment)},m(n,r){ls(t,n,r),e=!0},p(n,r){let o={};r&2&&(o.labelId=n[1]),r&4&&(o.step=n[2]),t.$set(o)},i(n){e||(De(t.$$.fragment,n),e=!0)},o(n){hn(t.$$.fragment,n),e=!1},d(n){cs(t,n)}}}function CT(i){let t,e;return t=new m_({props:{descriptionId:i[0],step:i[2]}}),{c(){wa(t.$$.fragment)},m(n,r){ls(t,n,r),e=!0},p(n,r){let o={};r&1&&(o.descriptionId=n[0]),r&4&&(o.step=n[2]),t.$set(o)},i(n){e||(De(t.$$.fragment,n),e=!0)},o(n){hn(t.$$.fragment,n),e=!1},d(n){cs(t,n)}}}function MT(i){let t,e;return t=new h_({props:{step:i[2]}}),{c(){wa(t.$$.fragment)},m(n,r){ls(t,n,r),e=!0},p(n,r){let o={};r&4&&(o.step=n[2]),t.$set(o)},i(n){e||(De(t.$$.fragment,n),e=!0)},o(n){hn(t.$$.fragment,n),e=!1},d(n){cs(t,n)}}}function zG(i){let t,e=!Yn(i[2].options.title)||i[2].options.cancelIcon&&i[2].options.cancelIcon.enabled,n,r=!Yn(i[2].options.text),o,s=Array.isArray(i[2].options.buttons)&&i[2].options.buttons.length,a,l=e&&ST(i),c=r&&CT(i),u=s&&MT(i);return{c(){t=Fr("div"),l&&l.c(),n=Km(),c&&c.c(),o=Km(),u&&u.c(),Ue(t,"class","shepherd-content")},m(h,p){pr(h,t,p),l&&l.m(t,null),sc(t,n),c&&c.m(t,null),sc(t,o),u&&u.m(t,null),a=!0},p(h,[p]){p&4&&(e=!Yn(h[2].options.title)||h[2].options.cancelIcon&&h[2].options.cancelIcon.enabled),e?l?(l.p(h,p),p&4&&De(l,1)):(l=ST(h),l.c(),De(l,1),l.m(t,n)):l&&(xa(),hn(l,1,1,()=>{l=null}),ya()),p&4&&(r=!Yn(h[2].options.text)),r?c?(c.p(h,p),p&4&&De(c,1)):(c=CT(h),c.c(),De(c,1),c.m(t,o)):c&&(xa(),hn(c,1,1,()=>{c=null}),ya()),p&4&&(s=Array.isArray(h[2].options.buttons)&&h[2].options.buttons.length),s?u?(u.p(h,p),p&4&&De(u,1)):(u=MT(h),u.c(),De(u,1),u.m(t,null)):u&&(xa(),hn(u,1,1,()=>{u=null}),ya())},i(h){a||(De(l),De(c),De(u),a=!0)},o(h){hn(l),hn(c),hn(u),a=!1},d(h){h&&Hi(t),l&&l.d(),c&&c.d(),u&&u.d()}}}function FG(i,t,e){let{descriptionId:n,labelId:r,step:o}=t;return i.$$set=s=>{"descriptionId"in s&&e(0,n=s.descriptionId),"labelId"in s&&e(1,r=s.labelId),"step"in s&&e(2,o=s.step)},[n,r,o]}var g_=class extends hr{constructor(t){super(),So(this,t,FG,zG,wo,{descriptionId:0,labelId:1,step:2})}};function ET(i){let t;return{c(){t=Fr("div"),Ue(t,"class","shepherd-arrow"),Ue(t,"data-popper-arrow","")},m(e,n){pr(e,t,n)},d(e){e&&Hi(t)}}}function OG(i){let t,e,n,r,o,s,a,l,c=i[4].options.arrow&&i[4].options.attachTo&&i[4].options.attachTo.element&&i[4].options.attachTo.on&&ET();n=new g_({props:{descriptionId:i[2],labelId:i[3],step:i[4]}});let u=[{"aria-describedby":r=Yn(i[4].options.text)?null:i[2]},{"aria-labelledby":o=i[4].options.title?i[3]:null},i[1],{role:"dialog"},{tabindex:"0"}],h={};for(let p=0;p<u.length;p+=1)h=hG(h,u[p]);return{c(){t=Fr("div"),c&&c.c(),e=Km(),wa(n.$$.fragment),gT(t,h),Zl(t,"shepherd-has-cancel-icon",i[5]),Zl(t,"shepherd-has-title",i[6]),Zl(t,"shepherd-element",!0)},m(p,f){pr(p,t,f),c&&c.m(t,null),sc(t,e),ls(n,t,null),i[13](t),s=!0,a||(l=eg(t,"keydown",i[7]),a=!0)},p(p,[f]){p[4].options.arrow&&p[4].options.attachTo&&p[4].options.attachTo.element&&p[4].options.attachTo.on?c||(c=ET(),c.c(),c.m(t,e)):c&&(c.d(1),c=null);let d={};f&4&&(d.descriptionId=p[2]),f&8&&(d.labelId=p[3]),f&16&&(d.step=p[4]),n.$set(d),gT(t,h=wG(u,[(!s||f&20&&r!==(r=Yn(p[4].options.text)?null:p[2]))&&{"aria-describedby":r},(!s||f&24&&o!==(o=p[4].options.title?p[3]:null))&&{"aria-labelledby":o},f&2&&p[1],{role:"dialog"},{tabindex:"0"}])),Zl(t,"shepherd-has-cancel-icon",p[5]),Zl(t,"shepherd-has-title",p[6]),Zl(t,"shepherd-element",!0)},i(p){s||(De(n.$$.fragment,p),s=!0)},o(p){hn(n.$$.fragment,p),s=!1},d(p){p&&Hi(t),c&&c.d(),cs(n),i[13](null),a=!1,l()}}}var BG=9,VG=27,HG=37,$G=39;function TT(i){return i.split(" ").filter(t=>!!t.length)}function UG(i,t,e){let{classPrefix:n,element:r,descriptionId:o,firstFocusableElement:s,focusableElements:a,labelId:l,lastFocusableElement:c,step:u,dataStepId:h}=t,p,f,d,m=()=>r;xG(()=>{e(1,h={[`data-${n}shepherd-step-id`]:u.id}),e(9,a=r.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]')),e(8,s=a[0]),e(10,c=a[a.length-1])}),k_(()=>{d!==u.options.classes&&x()});function x(){g(d),d=u.options.classes,y(d)}function g(_){if(Xh(_)){let S=TT(_);S.length&&r.classList.remove(...S)}}function y(_){if(Xh(_)){let S=TT(_);S.length&&r.classList.add(...S)}}let b=_=>{let{tour:S}=u;switch(_.keyCode){case BG:if(a.length===0){_.preventDefault();break}_.shiftKey?(document.activeElement===s||document.activeElement.classList.contains("shepherd-element"))&&(_.preventDefault(),c.focus()):document.activeElement===c&&(_.preventDefault(),s.focus());break;case VG:S.options.exitOnEsc&&(_.stopPropagation(),u.cancel());break;case HG:S.options.keyboardNavigation&&(_.stopPropagation(),S.back());break;case $G:S.options.keyboardNavigation&&(_.stopPropagation(),S.next());break}};function v(_){ac[_?"unshift":"push"](()=>{r=_,e(0,r)})}return i.$$set=_=>{"classPrefix"in _&&e(11,n=_.classPrefix),"element"in _&&e(0,r=_.element),"descriptionId"in _&&e(2,o=_.descriptionId),"firstFocusableElement"in _&&e(8,s=_.firstFocusableElement),"focusableElements"in _&&e(9,a=_.focusableElements),"labelId"in _&&e(3,l=_.labelId),"lastFocusableElement"in _&&e(10,c=_.lastFocusableElement),"step"in _&&e(4,u=_.step),"dataStepId"in _&&e(1,h=_.dataStepId)},i.$$.update=()=>{i.$$.dirty&16&&(e(5,p=u.options&&u.options.cancelIcon&&u.options.cancelIcon.enabled),e(6,f=u.options&&u.options.title))},[r,h,o,l,u,p,f,b,s,a,c,n,m,v]}var x_=class extends hr{constructor(t){super(),So(this,t,UG,OG,wo,{classPrefix:11,element:0,descriptionId:2,firstFocusableElement:8,focusableElements:9,labelId:3,lastFocusableElement:10,step:4,dataStepId:1,getElement:12})}get getElement(){return this.$$.ctx[12]}},Zh=class extends Kh{constructor(t,e={}){return super(t,e),this.tour=t,this.classPrefix=this.tour.options?kT(this.tour.options.classPrefix):"",this.styles=t.styles,this._resolvedAttachTo=null,AT(this),this._setOptions(e),this}cancel(){this.tour.cancel(),this.trigger("cancel")}complete(){this.tour.complete(),this.trigger("complete")}destroy(){oG(this),__(this.el)&&(this.el.remove(),this.el=null),this._updateStepTargetOnHide(),this.trigger("destroy")}getTour(){return this.tour}hide(){this.tour.modal.hide(),this.trigger("before-hide"),this.el&&(this.el.hidden=!0),this._updateStepTargetOnHide(),this.trigger("hide")}_resolveAttachToOptions(){return this._resolvedAttachTo=SW(this),this._resolvedAttachTo}_getResolvedAttachToOptions(){return this._resolvedAttachTo===null?this._resolveAttachToOptions():this._resolvedAttachTo}isOpen(){return Boolean(this.el&&!this.el.hidden)}show(){return va(this.options.beforeShowPromise)?Promise.resolve(this.options.beforeShowPromise()).then(()=>this._show()):Promise.resolve(this._show())}updateStepOptions(t){Object.assign(this.options,t),this.shepherdElementComponent&&this.shepherdElementComponent.$set({step:this})}getElement(){return this.el}getTarget(){return this.target}_createTooltipContent(){let t=`${this.id}-description`,e=`${this.id}-label`;return this.shepherdElementComponent=new x_({target:this.tour.options.stepsContainer||document.body,props:{classPrefix:this.classPrefix,descriptionId:t,labelId:e,step:this,styles:this.styles}}),this.shepherdElementComponent.getElement()}_scrollTo(t){let{element:e}=this._getResolvedAttachToOptions();va(this.options.scrollToHandler)?this.options.scrollToHandler(e):bW(e)&&typeof e.scrollIntoView=="function"&&e.scrollIntoView(t)}_getClassOptions(t){let e=this.tour&&this.tour.options&&this.tour.options.defaultStepOptions,n=t.classes?t.classes:"",r=e&&e.classes?e.classes:"",o=[...n.split(" "),...r.split(" ")],s=new Set(o);return Array.from(s).join(" ").trim()}_setOptions(t={}){let e=this.tour&&this.tour.options&&this.tour.options.defaultStepOptions;e=b_({},e||{}),this.options=Object.assign({arrow:!0},e,t,rG(e,t));let{when:n}=this.options;this.options.classes=this._getClassOptions(t),this.destroy(),this.id=this.options.id||`step-${w_()}`,n&&Object.keys(n).forEach(r=>{this.on(r,n[r],this)})}_setupElements(){Yn(this.el)||this.destroy(),this.el=this._createTooltipContent(),this.options.advanceOn&&wW(this),iG(this)}_show(){this.trigger("before-show"),this._resolveAttachToOptions(),this._setupElements(),this.tour.modal||this.tour._setupModal(),this.tour.modal.setupForStep(this),this._styleTargetElementForStep(this),this.el.hidden=!1,this.options.scrollTo&&setTimeout(()=>{this._scrollTo(this.options.scrollTo)}),this.el.hidden=!1;let t=this.shepherdElementComponent.getElement(),e=this.target||document.body;e.classList.add(`${this.classPrefix}shepherd-enabled`),e.classList.add(`${this.classPrefix}shepherd-target`),t.classList.add("shepherd-enabled"),this.trigger("show")}_styleTargetElementForStep(t){let e=t.target;!e||(t.options.highlightClass&&e.classList.add(t.options.highlightClass),e.classList.remove("shepherd-target-click-disabled"),t.options.canClickTarget===!1&&e.classList.add("shepherd-target-click-disabled"))}_updateStepTargetOnHide(){let t=this.target||document.body;this.options.highlightClass&&t.classList.remove(this.options.highlightClass),t.classList.remove("shepherd-target-click-disabled",`${this.classPrefix}shepherd-enabled`,`${this.classPrefix}shepherd-target`)}};function WG(i){if(i){let{steps:t}=i;t.forEach(e=>{e.options&&e.options.canClickTarget===!1&&e.options.attachTo&&e.target instanceof HTMLElement&&e.target.classList.remove("shepherd-target-click-disabled")})}}function GG({width:i,height:t,x:e=0,y:n=0,r=0}){let{innerWidth:o,innerHeight:s}=window,{topLeft:a=0,topRight:l=0,bottomRight:c=0,bottomLeft:u=0}=typeof r=="number"?{topLeft:r,topRight:r,bottomRight:r,bottomLeft:r}:r;return`M${o},${s}H0V0H${o}V${s}ZM${e+a},${n}a${a},${a},0,0,0-${a},${a}V${t+n-u}a${u},${u},0,0,0,${u},${u}H${i+e-c}a${c},${c},0,0,0,${c}-${c}V${n+l}a${l},${l},0,0,0-${l}-${l}Z`}function jG(i){let t,e,n,r,o;return{c(){t=mT("svg"),e=mT("path"),Ue(e,"d",i[2]),Ue(t,"class",n=`${i[1]?"shepherd-modal-is-visible":""} shepherd-modal-overlay-container`)},m(s,a){pr(s,t,a),sc(t,e),i[11](t),r||(o=eg(t,"touchmove",i[3]),r=!0)},p(s,[a]){a&4&&Ue(e,"d",s[2]),a&2&&n!==(n=`${s[1]?"shepherd-modal-is-visible":""} shepherd-modal-overlay-container`)&&Ue(t,"class",n)},i:Ti,o:Ti,d(s){s&&Hi(t),i[11](null),r=!1,o()}}}function jT(i){if(!i)return null;let e=i instanceof HTMLElement&&window.getComputedStyle(i).overflowY;return e!=="hidden"&&e!=="visible"&&i.scrollHeight>=i.clientHeight?i:jT(i.parentElement)}function qG(i,t){let e=i.getBoundingClientRect(),n=e.y||e.top,r=e.bottom||n+e.height;if(t){let s=t.getBoundingClientRect(),a=s.y||s.top,l=s.bottom||a+s.height;n=Math.max(n,a),r=Math.min(r,l)}let o=Math.max(r-n,0);return{y:n,height:o}}function XG(i,t,e){let{element:n,openingProperties:r}=t;w_();let o=!1,s,a;c();let l=()=>n;function c(){e(4,r={width:0,height:0,x:0,y:0,r:0})}function u(){e(1,o=!1),g()}function h(v=0,_=0,S,E){if(E){let{y:M,height:N}=qG(E,S),{x:I,width:w,left:R}=E.getBoundingClientRect();e(4,r={width:w+v*2,height:N+v*2,x:(I||R)-v,y:M-v,r:_})}else c()}function p(v){g(),v.tour.options.useModalOverlay?(y(v),f()):u()}function f(){e(1,o=!0)}let d=v=>{v.preventDefault()},m=v=>{v.stopPropagation()};function x(){window.addEventListener("touchmove",d,{passive:!1})}function g(){s&&(cancelAnimationFrame(s),s=void 0),window.removeEventListener("touchmove",d,{passive:!1})}function y(v){let{modalOverlayOpeningPadding:_,modalOverlayOpeningRadius:S}=v.options,E=jT(v.target),M=()=>{s=void 0,h(_,S,E,v.target),s=requestAnimationFrame(M)};M(),x()}function b(v){ac[v?"unshift":"push"](()=>{n=v,e(0,n)})}return i.$$set=v=>{"element"in v&&e(0,n=v.element),"openingProperties"in v&&e(4,r=v.openingProperties)},i.$$.update=()=>{i.$$.dirty&16&&e(2,a=GG(r))},[n,o,a,m,r,l,c,u,h,p,f,b]}var y_=class extends hr{constructor(t){super(),So(this,t,XG,jG,wo,{element:0,openingProperties:4,getElement:5,closeModalOpening:6,hide:7,positionModal:8,setupForStep:9,show:10})}get getElement(){return this.$$.ctx[5]}get closeModalOpening(){return this.$$.ctx[6]}get hide(){return this.$$.ctx[7]}get positionModal(){return this.$$.ctx[8]}get setupForStep(){return this.$$.ctx[9]}get show(){return this.$$.ctx[10]}},os=new Kh,v_=class extends Kh{constructor(t={}){super(t),AT(this);let e={exitOnEsc:!0,keyboardNavigation:!0};return this.options=Object.assign({},e,t),this.classPrefix=kT(this.options.classPrefix),this.steps=[],this.addSteps(this.options.steps),["active","cancel","complete","inactive","show","start"].map(r=>{(o=>{this.on(o,s=>{s=s||{},s.tour=this,os.trigger(o,s)})})(r)}),this._setTourID(),this}addStep(t,e){let n=t;return n instanceof Zh?n.tour=this:n=new Zh(this,n),Yn(e)?this.steps.push(n):this.steps.splice(e,0,n),n}addSteps(t){return Array.isArray(t)&&t.forEach(e=>{this.addStep(e)}),this}back(){let t=this.steps.indexOf(this.currentStep);this.show(t-1,!1)}cancel(){return $t(this,null,function*(){if(this.options.confirmCancel){let t=typeof this.options.confirmCancel=="function",e=this.options.confirmCancelMessage||"Are you sure you want to stop the tour?";(t?yield this.options.confirmCancel():window.confirm(e))&&this._done("cancel")}else this._done("cancel")})}complete(){this._done("complete")}getById(t){return this.steps.find(e=>e.id===t)}getCurrentStep(){return this.currentStep}hide(){let t=this.getCurrentStep();if(t)return t.hide()}isActive(){return os.activeTour===this}next(){let t=this.steps.indexOf(this.currentStep);t===this.steps.length-1?this.complete():this.show(t+1,!0)}removeStep(t){let e=this.getCurrentStep();this.steps.some((n,r)=>{if(n.id===t)return n.isOpen()&&n.hide(),n.destroy(),this.steps.splice(r,1),!0}),e&&e.id===t&&(this.currentStep=void 0,this.steps.length?this.show(0):this.cancel())}show(t=0,e=!0){let n=Xh(t)?this.getById(t):this.steps[t];n&&(this._updateStateBeforeShow(),va(n.options.showOn)&&!n.options.showOn()?this._skipStep(n,e):(this.trigger("show",{step:n,previous:this.currentStep}),this.currentStep=n,n.show()))}start(){this.trigger("start"),this.focusedElBeforeOpen=document.activeElement,this.currentStep=null,this._setupModal(),this._setupActiveTour(),this.next()}_done(t){let e=this.steps.indexOf(this.currentStep);if(Array.isArray(this.steps)&&this.steps.forEach(n=>n.destroy()),WG(this),this.trigger(t,{index:e}),os.activeTour=null,this.trigger("inactive",{tour:this}),this.modal&&this.modal.hide(),(t==="cancel"||t==="complete")&&this.modal){let n=document.querySelector(".shepherd-modal-overlay-container");n&&n.remove()}__(this.focusedElBeforeOpen)&&this.focusedElBeforeOpen.focus()}_setupActiveTour(){this.trigger("active",{tour:this}),os.activeTour=this}_setupModal(){this.modal=new y_({target:this.options.modalContainer||document.body,props:{classPrefix:this.classPrefix,styles:this.styles}})}_skipStep(t,e){let n=this.steps.indexOf(t);if(n===this.steps.length-1)this.complete();else{let r=e?n+1:n-1;this.show(r,e)}}_updateStateBeforeShow(){this.currentStep&&this.currentStep.hide(),this.isActive()||this._setupActiveTour()}_setTourID(){let t=this.options.tourName||"tour";this.id=`${t}--${w_()}`}},KG=typeof window=="undefined",Ym=class{constructor(){}};KG?Object.assign(os,{Tour:Ym,Step:Ym}):Object.assign(os,{Tour:v_,Step:Zh});var Sa=!(window.ShadyDOM&&window.ShadyDOM.inUse),ng;function qT(i){i&&i.shimcssproperties?ng=!1:ng=Sa||Boolean(!navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)&&window.CSS&&CSS.supports&&CSS.supports("box-shadow","0 0 0 var(--foo)"))}var us;window.ShadyCSS&&window.ShadyCSS.cssBuild!==void 0&&(us=window.ShadyCSS.cssBuild);var ig=Boolean(window.ShadyCSS&&window.ShadyCSS.disableRuntime);window.ShadyCSS&&window.ShadyCSS.nativeCss!==void 0?ng=window.ShadyCSS.nativeCss:window.ShadyCSS?(qT(window.ShadyCSS),window.ShadyCSS=void 0):qT(window.WebComponents&&window.WebComponents.flags);var lc=ng;var rg=class{constructor(){this.start=0,this.end=0,this.previous=null,this.parent=null,this.rules=null,this.parsedCssText="",this.cssText="",this.atRule=!1,this.type=0,this.keyframesName="",this.selector="",this.parsedSelector=""}};function R_(i){return i=YG(i),XT(ZG(i),i)}function YG(i){return i.replace(Mo.comments,"").replace(Mo.port,"")}function ZG(i){let t=new rg;t.start=0,t.end=i.length;let e=t;for(let n=0,r=i.length;n<r;n++)if(i[n]===KT){e.rules||(e.rules=[]);let o=e,s=o.rules[o.rules.length-1]||null;e=new rg,e.start=n+1,e.parent=o,e.previous=s,o.rules.push(e)}else i[n]===YT&&(e.end=n+1,e=e.parent||t);return t}function XT(i,t){let e=t.substring(i.start,i.end-1);if(i.parsedCssText=i.cssText=e.trim(),i.parent){let r=i.previous?i.previous.end:i.parent.start;e=t.substring(r,i.start-1),e=JG(e),e=e.replace(Mo.multipleSpaces," "),e=e.substring(e.lastIndexOf(";")+1);let o=i.parsedSelector=i.selector=e.trim();i.atRule=o.indexOf(rj)===0,i.atRule?o.indexOf(ij)===0?i.type=Co.MEDIA_RULE:o.match(Mo.keyframesRule)&&(i.type=Co.KEYFRAMES_RULE,i.keyframesName=i.selector.split(Mo.multipleSpaces).pop()):o.indexOf(ZT)===0?i.type=Co.MIXIN_RULE:i.type=Co.STYLE_RULE}let n=i.rules;if(n)for(let r=0,o=n.length,s;r<o&&(s=n[r]);r++)XT(s,t);return i}function JG(i){return i.replace(/\\([0-9a-f]{1,6})\s/gi,function(){let t=arguments[1],e=6-t.length;for(;e--;)t="0"+t;return"\\"+t})}function P_(i,t,e=""){let n="";if(i.cssText||i.rules){let r=i.rules;if(r&&!QG(r))for(let o=0,s=r.length,a;o<s&&(a=r[o]);o++)n=P_(a,t,n);else n=t?i.cssText:tj(i.cssText),n=n.trim(),n&&(n="  "+n+`
`)}return n&&(i.selector&&(e+=i.selector+" "+KT+`
`),e+=n,i.selector&&(e+=YT+`

`)),e}function QG(i){let t=i[0];return Boolean(t)&&Boolean(t.selector)&&t.selector.indexOf(ZT)===0}function tj(i){return i=ej(i),nj(i)}function ej(i){return i.replace(Mo.customProp,"").replace(Mo.mixinProp,"")}function nj(i){return i.replace(Mo.mixinApply,"").replace(Mo.varApply,"")}var Co={STYLE_RULE:1,KEYFRAMES_RULE:7,MEDIA_RULE:4,MIXIN_RULE:1e3},KT="{",YT="}",Mo={comments:/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,port:/@import[^;]*;/gim,customProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,mixinProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,mixinApply:/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,varApply:/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,keyframesRule:/^@[^\s]*keyframes/,multipleSpaces:/\s+/g},ZT="--",ij="@media",rj="@";var tp=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,cc=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi;var JT=/@media\s(.*)/;var QT=new Set,oj="shady-unscoped";function tI(i){let t=i.textContent;if(!QT.has(t)){QT.add(t);let e=document.createElement("style");e.setAttribute("shady-unscoped",""),e.textContent=t,document.head.appendChild(e)}}function eI(i){return i.hasAttribute(oj)}function ep(i,t){return i?(typeof i=="string"&&(i=R_(i)),t&&uc(i,t),P_(i,lc)):""}function N_(i){return!i.__cssRules&&i.textContent&&(i.__cssRules=R_(i.textContent)),i.__cssRules||null}function uc(i,t,e,n){if(!i)return;let r=!1,o=i.type;if(n&&o===Co.MEDIA_RULE){let a=i.selector.match(JT);a&&(window.matchMedia(a[1]).matches||(r=!0))}o===Co.STYLE_RULE?t(i):e&&o===Co.KEYFRAMES_RULE?e(i):o===Co.MIXIN_RULE&&(r=!0);let s=i.rules;if(s&&!r)for(let a=0,l=s.length,c;a<l&&(c=s[a]);a++)uc(c,t,e,n)}function sj(i,t){let e=0;for(let n=t,r=i.length;n<r;n++)if(i[n]==="(")e++;else if(i[n]===")"&&--e===0)return n;return-1}function L_(i,t){let e=i.indexOf("var(");if(e===-1)return t(i,"","","");let n=sj(i,e+3),r=i.substring(e+4,n),o=i.substring(0,e),s=L_(i.substring(n+1),t),a=r.indexOf(",");if(a===-1)return t(o,r.trim(),"",s);let l=r.substring(0,a).trim(),c=r.substring(a+1).trim();return t(o,l,c,s)}var sxt=window.ShadyDOM&&window.ShadyDOM.wrap||(i=>i);function nI(i){let t=i.localName,e="",n="";return t?t.indexOf("-")>-1?e=t:(n=t,e=i.getAttribute&&i.getAttribute("is")||""):(e=i.is,n=i.extends),{is:e,typeExtension:n}}function iI(i){let t=[],e=i.querySelectorAll("style");for(let n=0;n<e.length;n++){let r=e[n];eI(r)?Sa||(tI(r),r.parentNode.removeChild(r)):(t.push(r.textContent),r.parentNode.removeChild(r))}return t.join("").trim()}var rI="css-build";function aj(i){if(us!==void 0)return us;if(i.__cssBuild===void 0){let t=i.getAttribute(rI);if(t)i.__cssBuild=t;else{let e=lj(i);e!==""&&cj(i),i.__cssBuild=e}}return i.__cssBuild||""}function D_(i){return aj(i)!==""}function lj(i){let t=i.localName==="template"?i.content.firstChild:i.firstChild;if(t instanceof Comment){let e=t.textContent.trim().split(":");if(e[0]===rI)return e[1]}return""}function cj(i){let t=i.localName==="template"?i.content.firstChild:i.firstChild;t.parentNode.removeChild(t)}function np(i,t){for(let e in t)e===null?i.style.removeProperty(e):i.style.setProperty(e,t[e])}function og(i,t){let e=window.getComputedStyle(i).getPropertyValue(t);return e?e.trim():""}function oI(i){let t=cc.test(i)||tp.test(i);return cc.lastIndex=0,tp.lastIndex=0,t}var uj=/;\s*/m,hj=/^\s*(initial)|(inherit)\s*$/,sI=/\s*!important/,z_="_-_";var F_=class{constructor(){this._map={}}set(t,e){t=t.trim(),this._map[t]={properties:e,dependants:{}}}get(t){return t=t.trim(),this._map[t]||null}},sg=null,Gn=class{constructor(){this._currentElement=null,this._measureElement=null,this._map=new F_}detectMixin(t){return oI(t)}gatherStyles(t){let e=iI(t.content);if(e){let n=document.createElement("style");return n.textContent=e,t.content.insertBefore(n,t.content.firstChild),n}return null}transformTemplate(t,e){t._gatheredStyle===void 0&&(t._gatheredStyle=this.gatherStyles(t));let n=t._gatheredStyle;return n?this.transformStyle(n,e):null}transformStyle(t,e=""){let n=N_(t);return this.transformRules(n,e),t.textContent=ep(n),n}transformCustomStyle(t){let e=N_(t);return uc(e,n=>{n.selector===":root"&&(n.selector="html"),this.transformRule(n)}),t.textContent=ep(e),e}transformRules(t,e){this._currentElement=e,uc(t,n=>{this.transformRule(n)}),this._currentElement=null}transformRule(t){t.cssText=this.transformCssText(t.parsedCssText,t),t.selector===":root"&&(t.selector=":host > *")}transformCssText(t,e){return t=t.replace(tp,(n,r,o,s)=>this._produceCssProperties(n,r,o,s,e)),this._consumeCssProperties(t,e)}_getInitialValueForProperty(t){return this._measureElement||(this._measureElement=document.createElement("meta"),this._measureElement.setAttribute("apply-shim-measure",""),this._measureElement.style.all="initial",document.head.appendChild(this._measureElement)),window.getComputedStyle(this._measureElement).getPropertyValue(t)}_fallbacksFromPreviousRules(t){let e=t;for(;e.parent;)e=e.parent;let n={},r=!1;return uc(e,o=>{r=r||o===t,!r&&o.selector===t.selector&&Object.assign(n,this._cssTextToMap(o.parsedCssText))}),n}_consumeCssProperties(t,e){let n=null;for(;n=cc.exec(t);){let r=n[0],o=n[1],s=n.index,a=s+r.indexOf("@apply"),l=s+r.length,c=t.slice(0,a),u=t.slice(l),h=e?this._fallbacksFromPreviousRules(e):{};Object.assign(h,this._cssTextToMap(c));let p=this._atApplyToCssProperties(o,h);t=`${c}${p}${u}`,cc.lastIndex=s+p.length}return t}_atApplyToCssProperties(t,e){t=t.replace(uj,"");let n=[],r=this._map.get(t);if(r||(this._map.set(t,{}),r=this._map.get(t)),r){this._currentElement&&(r.dependants[this._currentElement]=!0);let o,s,a,l=r.properties;for(o in l)a=e&&e[o],s=[o,": var(",t,z_,o],a&&s.push(",",a.replace(sI,"")),s.push(")"),sI.test(l[o])&&s.push(" !important"),n.push(s.join(""))}return n.join("; ")}_replaceInitialOrInherit(t,e){let n=hj.exec(e);return n&&(n[1]?e=this._getInitialValueForProperty(t):e="apply-shim-inherit"),e}_cssTextToMap(t,e=!1){let n=t.split(";"),r,o,s={};for(let a=0,l,c;a<n.length;a++)l=n[a],l&&(c=l.split(":"),c.length>1&&(r=c[0].trim(),o=c.slice(1).join(":"),e&&(o=this._replaceInitialOrInherit(r,o)),s[r]=o));return s}_invalidateMixinEntry(t){if(!!sg)for(let e in t.dependants)e!==this._currentElement&&sg(e)}_produceCssProperties(t,e,n,r,o){if(n&&L_(n,(x,g)=>{g&&this._map.get(g)&&(r=`@apply ${g};`)}),!r)return t;let s=this._consumeCssProperties(""+r,o),a=t.slice(0,t.indexOf("--")),l=this._cssTextToMap(s,!0),c=l,u=this._map.get(e),h=u&&u.properties;h?c=Object.assign(Object.create(h),l):this._map.set(e,c);let p=[],f,d,m=!1;for(f in c)d=l[f],d===void 0&&(d="initial"),h&&!(f in h)&&(m=!0),p.push(`${e}${z_}${f}: ${d}`);return m&&this._invalidateMixinEntry(u),u&&(u.properties=c),n&&(a=`${t};${a}`),`${a}${p.join("; ")};`}};Gn.prototype.detectMixin=Gn.prototype.detectMixin;Gn.prototype.transformStyle=Gn.prototype.transformStyle;Gn.prototype.transformCustomStyle=Gn.prototype.transformCustomStyle;Gn.prototype.transformRules=Gn.prototype.transformRules;Gn.prototype.transformRule=Gn.prototype.transformRule;Gn.prototype.transformTemplate=Gn.prototype.transformTemplate;Gn.prototype._separator=z_;Object.defineProperty(Gn.prototype,"invalidCallback",{get(){return sg},set(i){sg=i}});var aI=Gn;var pj={},ip=pj;var ag="_applyShimCurrentVersion",hc="_applyShimNextVersion",lg="_applyShimValidatingVersion",fj=Promise.resolve();function lI(i){let t=ip[i];t&&dj(t)}function dj(i){i[ag]=i[ag]||0,i[lg]=i[lg]||0,i[hc]=(i[hc]||0)+1}function O_(i){return i[ag]===i[hc]}function cI(i){return!O_(i)&&i[lg]===i[hc]}function uI(i){i[lg]=i[hc],i._validating||(i._validating=!0,fj.then(function(){i[ag]=i[hc],i._validating=!1}))}var B_=null,hI=window.HTMLImports&&window.HTMLImports.whenReady||null,V_;function cg(i){requestAnimationFrame(function(){hI?hI(i):(B_||(B_=new Promise(t=>{V_=t}),document.readyState==="complete"?V_():document.addEventListener("readystatechange",()=>{document.readyState==="complete"&&V_()})),B_.then(function(){i&&i()}))})}var pI="__seenByShadyCSS",ug="__shadyCSSCachedStyle",hg=null,rp=null,$i=class{constructor(){this.customStyles=[],this.enqueued=!1,cg(()=>{window.ShadyCSS.flushCustomStyles&&window.ShadyCSS.flushCustomStyles()})}enqueueDocumentValidation(){this.enqueued||!rp||(this.enqueued=!0,cg(rp))}addCustomStyle(t){t[pI]||(t[pI]=!0,this.customStyles.push(t),this.enqueueDocumentValidation())}getStyleForCustomStyle(t){if(t[ug])return t[ug];let e;return t.getStyle?e=t.getStyle():e=t,e}processStyles(){let t=this.customStyles;for(let e=0;e<t.length;e++){let n=t[e];if(n[ug])continue;let r=this.getStyleForCustomStyle(n);if(r){let o=r.__appliedElement||r;hg&&hg(o),n[ug]=o}}return t}};$i.prototype.addCustomStyle=$i.prototype.addCustomStyle;$i.prototype.getStyleForCustomStyle=$i.prototype.getStyleForCustomStyle;$i.prototype.processStyles=$i.prototype.processStyles;Object.defineProperties($i.prototype,{transformCallback:{get(){return hg},set(i){hg=i}},validateCallback:{get(){return rp},set(i){let t=!1;rp||(t=!0),rp=i,t&&this.enqueueDocumentValidation()}}});var op=new aI,H_=class{constructor(){this.customStyleInterface=null,op.invalidCallback=lI}ensure(){this.customStyleInterface||window.ShadyCSS.CustomStyleInterface&&(this.customStyleInterface=window.ShadyCSS.CustomStyleInterface,this.customStyleInterface.transformCallback=t=>{op.transformCustomStyle(t)},this.customStyleInterface.validateCallback=()=>{requestAnimationFrame(()=>{this.customStyleInterface.enqueued&&this.flushCustomStyles()})})}prepareTemplate(t,e){if(this.ensure(),D_(t))return;ip[e]=t;let n=op.transformTemplate(t,e);t._styleAst=n}flushCustomStyles(){if(this.ensure(),!this.customStyleInterface)return;let t=this.customStyleInterface.processStyles();if(!!this.customStyleInterface.enqueued){for(let e=0;e<t.length;e++){let n=t[e],r=this.customStyleInterface.getStyleForCustomStyle(n);r&&op.transformCustomStyle(r)}this.customStyleInterface.enqueued=!1}}styleSubtree(t,e){if(this.ensure(),e&&np(t,e),t.shadowRoot){this.styleElement(t);let n=t.shadowRoot.children||t.shadowRoot.childNodes;for(let r=0;r<n.length;r++)this.styleSubtree(n[r])}else{let n=t.children||t.childNodes;for(let r=0;r<n.length;r++)this.styleSubtree(n[r])}}styleElement(t){this.ensure();let{is:e}=nI(t),n=ip[e];if(!(n&&D_(n))&&n&&!O_(n)){cI(n)||(this.prepareTemplate(n,e),uI(n));let r=t.shadowRoot;if(r){let o=r.querySelector("style");o&&(o.__cssRules=n._styleAst,o.textContent=ep(n._styleAst))}}}styleDocument(t){this.ensure(),this.styleSubtree(document.body,t)}};if(!window.ShadyCSS||!window.ShadyCSS.ScopingShim){let i=new H_,t=window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface;window.ShadyCSS={prepareTemplate(e,n,r){i.flushCustomStyles(),i.prepareTemplate(e,n)},prepareTemplateStyles(e,n,r){window.ShadyCSS.prepareTemplate(e,n,r)},prepareTemplateDom(e,n){},styleSubtree(e,n){i.flushCustomStyles(),i.styleSubtree(e,n)},styleElement(e){i.flushCustomStyles(),i.styleElement(e)},styleDocument(e){i.flushCustomStyles(),i.styleDocument(e)},getComputedStyleValue(e,n){return og(e,n)},flushCustomStyles(){i.flushCustomStyles()},nativeCss:lc,nativeShadow:Sa,cssBuild:us,disableRuntime:ig},t&&(window.ShadyCSS.CustomStyleInterface=t)}window.ShadyCSS.ApplyShim=op;var li=class{constructor(){this._asyncModule=null,this._callback=null,this._timer=null}setConfig(t,e){this._asyncModule=t,this._callback=e,this._timer=this._asyncModule.run(()=>{this._timer=null,sp.delete(this),this._callback()})}cancel(){this.isActive()&&(this._cancelAsync(),sp.delete(this))}_cancelAsync(){this.isActive()&&(this._asyncModule.cancel(this._timer),this._timer=null)}flush(){this.isActive()&&(this.cancel(),this._callback())}isActive(){return this._timer!=null}static debounce(t,e,n){return t instanceof li?t._cancelAsync():t=new li,t.setConfig(e,n),t}},sp=new Set,hs=function(i){sp.add(i)},fI=function(){let i=Boolean(sp.size);return sp.forEach(t=>{try{t.flush()}catch(e){setTimeout(()=>{throw e})}}),i};var G_=typeof document.head.style.touchAction=="string",fg="__polymerGestures",pg="__polymerGesturesHandled",U_="__polymerGesturesTouchAction",dI=25,mI=5,gj=2,xj=2500,bI=["mousedown","mousemove","mouseup","click"],yj=[0,1,4,2],vj=function(){try{return new MouseEvent("test",{buttons:1}).buttons===1}catch(i){return!1}}();function j_(i){return bI.indexOf(i)>-1}var q_=!1;(function(){try{let i=Object.defineProperty({},"passive",{get(){q_=!0}});window.addEventListener("test",null,i),window.removeEventListener("test",null,i)}catch(i){}})();function _I(i){if(!(j_(i)||i==="touchend")&&G_&&q_&&qE)return{passive:!0}}var wI=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/),W_=[],bj={button:!0,input:!0,keygen:!0,meter:!0,output:!0,textarea:!0,progress:!0,select:!0},_j={button:!0,command:!0,fieldset:!0,input:!0,keygen:!0,optgroup:!0,option:!0,select:!0,textarea:!0};function wj(i){return bj[i.localName]||!1}function Sj(i){let t=Array.prototype.slice.call(i.labels||[]);if(!t.length){t=[];let e=i.getRootNode();if(i.id){let n=e.querySelectorAll(`label[for = ${i.id}]`);for(let r=0;r<n.length;r++)t.push(n[r])}}return t}var gI=function(i){let t=i.sourceCapabilities;if(!(t&&!t.firesTouchEvents)&&(i[pg]={skip:!0},i.type==="click")){let e=!1,n=mg(i);for(let r=0;r<n.length;r++){if(n[r].nodeType===Node.ELEMENT_NODE){if(n[r].localName==="label")W_.push(n[r]);else if(wj(n[r])){let o=Sj(n[r]);for(let s=0;s<o.length;s++)e=e||W_.indexOf(o[s])>-1}}if(n[r]===Jn.mouse.target)return}if(e)return;i.preventDefault(),i.stopPropagation()}};function xI(i){let t=wI?["click"]:bI;for(let e=0,n;e<t.length;e++)n=t[e],i?(W_.length=0,document.addEventListener(n,gI,!0)):document.removeEventListener(n,gI,!0)}function Cj(i){if(!Gb)return;Jn.mouse.mouseIgnoreJob||xI(!0);let t=function(){xI(),Jn.mouse.target=null,Jn.mouse.mouseIgnoreJob=null};Jn.mouse.target=mg(i)[0],Jn.mouse.mouseIgnoreJob=li.debounce(Jn.mouse.mouseIgnoreJob,is.after(xj),t)}function Ma(i){let t=i.type;if(!j_(t))return!1;if(t==="mousemove"){let e=i.buttons===void 0?1:i.buttons;return i instanceof window.MouseEvent&&!vj&&(e=yj[i.which]||0),Boolean(e&1)}else return(i.button===void 0?0:i.button)===0}function Mj(i){if(i.type==="click"){if(i.detail===0)return!0;let t=Eo(i);if(!t.nodeType||t.nodeType!==Node.ELEMENT_NODE)return!0;let e=t.getBoundingClientRect(),n=i.pageX,r=i.pageY;return!(n>=e.left&&n<=e.right&&r>=e.top&&r<=e.bottom)}return!1}var Jn={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:!1}};function Ej(i){let t="auto",e=mg(i);for(let n=0,r;n<e.length;n++)if(r=e[n],r[U_]){t=r[U_];break}return t}function SI(i,t,e){i.movefn=t,i.upfn=e,document.addEventListener("mousemove",t),document.addEventListener("mouseup",e)}function pc(i){document.removeEventListener("mousemove",i.movefn),document.removeEventListener("mouseup",i.upfn),i.movefn=null,i.upfn=null}Gb&&document.addEventListener("touchend",Cj,q_?{passive:!0}:!1);var mg=window.ShadyDOM&&window.ShadyDOM.noPatch?window.ShadyDOM.composedPath:i=>i.composedPath&&i.composedPath()||[],lp={},Ca=[];function Tj(i,t){let e=document.elementFromPoint(i,t),n=e;for(;n&&n.shadowRoot&&!window.ShadyDOM;){let r=n;if(n=n.shadowRoot.elementFromPoint(i,t),r===n)break;n&&(e=n)}return e}function Eo(i){let t=mg(i);return t.length>0?t[0]:i.target}function CI(i){let t,e=i.type,r=i.currentTarget[fg];if(!r)return;let o=r[e];if(!!o){if(!i[pg]&&(i[pg]={},e.slice(0,5)==="touch")){i=i;let s=i.changedTouches[0];if(e==="touchstart"&&i.touches.length===1&&(Jn.touch.id=s.identifier),Jn.touch.id!==s.identifier)return;G_||(e==="touchstart"||e==="touchmove")&&Ij(i)}if(t=i[pg],!t.skip){for(let s=0,a;s<Ca.length;s++)a=Ca[s],o[a.name]&&!t[a.name]&&a.flow&&a.flow.start.indexOf(i.type)>-1&&a.reset&&a.reset();for(let s=0,a;s<Ca.length;s++)a=Ca[s],o[a.name]&&!t[a.name]&&(t[a.name]=!0,a[e](i))}}}function Ij(i){let t=i.changedTouches[0],e=i.type;if(e==="touchstart")Jn.touch.x=t.clientX,Jn.touch.y=t.clientY,Jn.touch.scrollDecided=!1;else if(e==="touchmove"){if(Jn.touch.scrollDecided)return;Jn.touch.scrollDecided=!0;let n=Ej(i),r=!1,o=Math.abs(Jn.touch.x-t.clientX),s=Math.abs(Jn.touch.y-t.clientY);i.cancelable&&(n==="none"?r=!0:n==="pan-x"?r=s>o:n==="pan-y"&&(r=o>s)),r?i.preventDefault():dg("track")}}function gg(i,t,e){return lp[t]?(Aj(i,t,e),!0):!1}function MI(i,t,e){return lp[t]?(kj(i,t,e),!0):!1}function Aj(i,t,e){let n=lp[t],r=n.deps,o=n.name,s=i[fg];s||(i[fg]=s={});for(let a=0,l,c;a<r.length;a++)l=r[a],!(wI&&j_(l)&&l!=="click")&&(c=s[l],c||(s[l]=c={_count:0}),c._count===0&&i.addEventListener(l,CI,_I(l)),c[o]=(c[o]||0)+1,c._count=(c._count||0)+1);i.addEventListener(t,e),n.touchAction&&Ea(i,n.touchAction)}function kj(i,t,e){let n=lp[t],r=n.deps,o=n.name,s=i[fg];if(s)for(let a=0,l,c;a<r.length;a++)l=r[a],c=s[l],c&&c[o]&&(c[o]=(c[o]||1)-1,c._count=(c._count||1)-1,c._count===0&&i.removeEventListener(l,CI,_I(l)));i.removeEventListener(t,e)}function X_(i){Ca.push(i);for(let t=0;t<i.emits.length;t++)lp[i.emits[t]]=i}function Rj(i){for(let t=0,e;t<Ca.length;t++){e=Ca[t];for(let n=0,r;n<e.emits.length;n++)if(r=e.emits[n],r===i)return e}return null}function Ea(i,t){G_&&i instanceof HTMLElement&&Wn.run(()=>{i.style.touchAction=t}),i[U_]=t}function K_(i,t,e){let n=new Event(t,{bubbles:!0,cancelable:!0,composed:!0});if(n.detail=e,Ot(i).dispatchEvent(n),n.defaultPrevented){let r=e.preventer||e.sourceEvent;r&&r.preventDefault&&r.preventDefault()}}function dg(i){let t=Rj(i);t.info&&(t.info.prevent=!0)}X_({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset:function(){pc(this.info)},mousedown:function(i){if(!Ma(i))return;let t=Eo(i),e=this,n=function(s){Ma(s)||(ap("up",t,s),pc(e.info))},r=function(s){Ma(s)&&ap("up",t,s),pc(e.info)};SI(this.info,n,r),ap("down",t,i)},touchstart:function(i){ap("down",Eo(i),i.changedTouches[0],i)},touchend:function(i){ap("up",Eo(i),i.changedTouches[0],i)}});function ap(i,t,e,n){!t||K_(t,i,{x:e.clientX,y:e.clientY,sourceEvent:e,preventer:n,prevent:function(r){return dg(r)}})}X_({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:!1,moves:[],addMove:function(i){this.moves.length>gj&&this.moves.shift(),this.moves.push(i)},movefn:null,upfn:null,prevent:!1},reset:function(){this.info.state="start",this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,this.info.prevent=!1,pc(this.info)},mousedown:function(i){if(!Ma(i))return;let t=Eo(i),e=this,n=function(s){let a=s.clientX,l=s.clientY;yI(e.info,a,l)&&(e.info.state=e.info.started?s.type==="mouseup"?"end":"track":"start",e.info.state==="start"&&dg("tap"),e.info.addMove({x:a,y:l}),Ma(s)||(e.info.state="end",pc(e.info)),t&&$_(e.info,t,s),e.info.started=!0)},r=function(s){e.info.started&&n(s),pc(e.info)};SI(this.info,n,r),this.info.x=i.clientX,this.info.y=i.clientY},touchstart:function(i){let t=i.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchmove:function(i){let t=Eo(i),e=i.changedTouches[0],n=e.clientX,r=e.clientY;yI(this.info,n,r)&&(this.info.state==="start"&&dg("tap"),this.info.addMove({x:n,y:r}),$_(this.info,t,e),this.info.state="track",this.info.started=!0)},touchend:function(i){let t=Eo(i),e=i.changedTouches[0];this.info.started&&(this.info.state="end",this.info.addMove({x:e.clientX,y:e.clientY}),$_(this.info,t,e))}});function yI(i,t,e){if(i.prevent)return!1;if(i.started)return!0;let n=Math.abs(i.x-t),r=Math.abs(i.y-e);return n>=mI||r>=mI}function $_(i,t,e){if(!t)return;let n=i.moves[i.moves.length-2],r=i.moves[i.moves.length-1],o=r.x-i.x,s=r.y-i.y,a,l=0;n&&(a=r.x-n.x,l=r.y-n.y),K_(t,"track",{state:i.state,x:e.clientX,y:e.clientY,dx:o,dy:s,ddx:a,ddy:l,sourceEvent:e,hover:function(){return Tj(e.clientX,e.clientY)}})}X_({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:!1},reset:function(){this.info.x=NaN,this.info.y=NaN,this.info.prevent=!1},mousedown:function(i){Ma(i)&&(this.info.x=i.clientX,this.info.y=i.clientY)},click:function(i){Ma(i)&&vI(this.info,i)},touchstart:function(i){let t=i.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchend:function(i){vI(this.info,i.changedTouches[0],i)}});function vI(i,t,e){let n=Math.abs(t.clientX-i.x),r=Math.abs(t.clientY-i.y),o=Eo(e||t);!o||_j[o.localName]&&o.hasAttribute("disabled")||(isNaN(n)||isNaN(r)||n<=dI&&r<=dI||Mj(t))&&(i.prevent||K_(o,"tap",{x:t.clientX,y:t.clientY,sourceEvent:t,preventer:e}))}var EI=Eo;var xg=Ge(i=>{class t extends i{_addEventListenerToNode(n,r,o){gg(n,r,o)||super._addEventListenerToNode(n,r,o)}_removeEventListenerFromNode(n,r,o){MI(n,r,o)||super._removeEventListenerFromNode(n,r,o)}}return t});var Pj=/:host\(:dir\((ltr|rtl)\)\)/g,Nj=':host([dir="$1"])',Lj=/([\s\w-#\.\[\]\*]*):dir\((ltr|rtl)\)/g,Dj=':host([dir="$2"]) $1',zj=/:dir\((?:ltr|rtl)\)/,II=Boolean(window.ShadyDOM&&window.ShadyDOM.inUse),cp=[],up=null,Y_="";function AI(){Y_=document.documentElement.getAttribute("dir")}function kI(i){i.__autoDirOptOut||i.setAttribute("dir",Y_)}function RI(){AI(),Y_=document.documentElement.getAttribute("dir");for(let i=0;i<cp.length;i++)kI(cp[i])}function Fj(){up&&up.takeRecords().length&&RI()}var PI=Ge(i=>{II||up||(AI(),up=new MutationObserver(RI),up.observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]}));let t=Bm(i);class e extends t{static _processStyleText(r,o){return r=t._processStyleText.call(this,r,o),!II&&zj.test(r)&&(r=this._replaceDirInCssText(r),this.__activateDir=!0),r}static _replaceDirInCssText(r){let o=r;return o=o.replace(Pj,Nj),o=o.replace(Lj,Dj),o}constructor(){super(),this.__autoDirOptOut=!1}ready(){super.ready(),this.__autoDirOptOut=this.hasAttribute("dir")}connectedCallback(){t.prototype.connectedCallback&&super.connectedCallback(),this.constructor.__activateDir&&(Fj(),cp.push(this),kI(this))}disconnectedCallback(){if(t.prototype.disconnectedCallback&&super.disconnectedCallback(),this.constructor.__activateDir){let r=cp.indexOf(this);r>-1&&cp.splice(r,1)}}}return e.__activateDir=!1,e});var Z_=!1,Oj=[],NI=[];function Bj(){Z_=!0,requestAnimationFrame(function(){Z_=!1,Vj(Oj),setTimeout(function(){Hj(NI)})})}function Vj(i){for(;i.length;)LI(i.shift())}function Hj(i){for(let t=0,e=i.length;t<e;t++)LI(i.shift())}function LI(i){let t=i[0],e=i[1],n=i[2];try{e.apply(t,n)}catch(r){setTimeout(()=>{throw r})}}function fc(i,t,e){Z_||Bj(),NI.push([i,t,e])}function DI(){document.body.removeAttribute("unresolved")}document.readyState==="interactive"||document.readyState==="complete"?DI():window.addEventListener("DOMContentLoaded",DI);function hp(i,t,e){return{index:i,removed:t,addedCount:e}}var zI=0,FI=1,J_=2,Q_=3;function $j(i,t,e,n,r,o){let s=o-r+1,a=e-t+1,l=new Array(s);for(let c=0;c<s;c++)l[c]=new Array(a),l[c][0]=c;for(let c=0;c<a;c++)l[0][c]=c;for(let c=1;c<s;c++)for(let u=1;u<a;u++)if(tw(i[t+u-1],n[r+c-1]))l[c][u]=l[c-1][u-1];else{let h=l[c-1][u]+1,p=l[c][u-1]+1;l[c][u]=h<p?h:p}return l}function Uj(i){let t=i.length-1,e=i[0].length-1,n=i[t][e],r=[];for(;t>0||e>0;){if(t==0){r.push(J_),e--;continue}if(e==0){r.push(Q_),t--;continue}let o=i[t-1][e-1],s=i[t-1][e],a=i[t][e-1],l;s<a?l=s<o?s:o:l=a<o?a:o,l==o?(o==n?r.push(zI):(r.push(FI),n=o),t--,e--):l==s?(r.push(Q_),t--,n=s):(r.push(J_),e--,n=a)}return r.reverse(),r}function Wj(i,t,e,n,r,o){let s=0,a=0,l,c=Math.min(e-t,o-r);if(t==0&&r==0&&(s=Gj(i,n,c)),e==i.length&&o==n.length&&(a=jj(i,n,c-s)),t+=s,r+=s,e-=a,o-=a,e-t==0&&o-r==0)return[];if(t==e){for(l=hp(t,[],0);r<o;)l.removed.push(n[r++]);return[l]}else if(r==o)return[hp(t,[],e-t)];let u=Uj($j(i,t,e,n,r,o));l=void 0;let h=[],p=t,f=r;for(let d=0;d<u.length;d++)switch(u[d]){case zI:l&&(h.push(l),l=void 0),p++,f++;break;case FI:l||(l=hp(p,[],0)),l.addedCount++,p++,l.removed.push(n[f]),f++;break;case J_:l||(l=hp(p,[],0)),l.addedCount++,p++;break;case Q_:l||(l=hp(p,[],0)),l.removed.push(n[f]),f++;break}return l&&h.push(l),h}function Gj(i,t,e){for(let n=0;n<e;n++)if(!tw(i[n],t[n]))return n;return e}function jj(i,t,e){let n=i.length,r=t.length,o=0;for(;o<e&&tw(i[--n],t[--r]);)o++;return o}function yg(i,t){return Wj(i,0,i.length,t,0,t.length)}function tw(i,t){return i===t}function dc(i){return i.localName==="slot"}var ew=class{static getFlattenedNodes(i){let t=Ot(i);return dc(i)?(i=i,t.assignedNodes({flatten:!0})):Array.from(t.childNodes).map(e=>dc(e)?(e=e,Ot(e).assignedNodes({flatten:!0})):[e]).reduce((e,n)=>e.concat(n),[])}constructor(i,t){this._shadyChildrenObserver=null,this._nativeChildrenObserver=null,this._connected=!1,this._target=i,this.callback=t,this._effectiveNodes=[],this._observer=null,this._scheduled=!1,this._boundSchedule=()=>{this._schedule()},this.connect(),this._schedule()}connect(){dc(this._target)?this._listenSlots([this._target]):Ot(this._target).children&&(this._listenSlots(Ot(this._target).children),window.ShadyDOM?this._shadyChildrenObserver=window.ShadyDOM.observeChildren(this._target,i=>{this._processMutations(i)}):(this._nativeChildrenObserver=new MutationObserver(i=>{this._processMutations(i)}),this._nativeChildrenObserver.observe(this._target,{childList:!0}))),this._connected=!0}disconnect(){dc(this._target)?this._unlistenSlots([this._target]):Ot(this._target).children&&(this._unlistenSlots(Ot(this._target).children),window.ShadyDOM&&this._shadyChildrenObserver?(window.ShadyDOM.unobserveChildren(this._shadyChildrenObserver),this._shadyChildrenObserver=null):this._nativeChildrenObserver&&(this._nativeChildrenObserver.disconnect(),this._nativeChildrenObserver=null)),this._connected=!1}_schedule(){this._scheduled||(this._scheduled=!0,Wn.run(()=>this.flush()))}_processMutations(i){this._processSlotMutations(i),this.flush()}_processSlotMutations(i){if(i)for(let t=0;t<i.length;t++){let e=i[t];e.addedNodes&&this._listenSlots(e.addedNodes),e.removedNodes&&this._unlistenSlots(e.removedNodes)}}flush(){if(!this._connected)return!1;window.ShadyDOM&&ShadyDOM.flush(),this._nativeChildrenObserver?this._processSlotMutations(this._nativeChildrenObserver.takeRecords()):this._shadyChildrenObserver&&this._processSlotMutations(this._shadyChildrenObserver.takeRecords()),this._scheduled=!1;let i={target:this._target,addedNodes:[],removedNodes:[]},t=this.constructor.getFlattenedNodes(this._target),e=yg(t,this._effectiveNodes);for(let r=0,o;r<e.length&&(o=e[r]);r++)for(let s=0,a;s<o.removed.length&&(a=o.removed[s]);s++)i.removedNodes.push(a);for(let r=0,o;r<e.length&&(o=e[r]);r++)for(let s=o.index;s<o.index+o.addedCount;s++)i.addedNodes.push(t[s]);this._effectiveNodes=t;let n=!1;return(i.addedNodes.length||i.removedNodes.length)&&(n=!0,this.callback.call(this._target,i)),n}_listenSlots(i){for(let t=0;t<i.length;t++){let e=i[t];dc(e)&&e.addEventListener("slotchange",this._boundSchedule)}}_unlistenSlots(i){for(let t=0;t<i.length;t++){let e=i[t];dc(e)&&e.removeEventListener("slotchange",this._boundSchedule)}}};var fr=function(){let i,t;do i=window.ShadyDOM&&ShadyDOM.flush(),window.ShadyCSS&&window.ShadyCSS.ScopingShim&&window.ShadyCSS.ScopingShim.flush(),t=fI();while(i||t)};var mc=Element.prototype,qj=mc.matches||mc.matchesSelector||mc.mozMatchesSelector||mc.msMatchesSelector||mc.oMatchesSelector||mc.webkitMatchesSelector,iw=function(i,t){return qj.call(i,t)},ke=class{constructor(t){window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.patch(t),this.node=t}observeNodes(t){return new ew(this.node,t)}unobserveNodes(t){t.disconnect()}notifyObserver(){}deepContains(t){if(Ot(this.node).contains(t))return!0;let e=t,n=t.ownerDocument;for(;e&&e!==n&&e!==this.node;)e=Ot(e).parentNode||Ot(e).host;return e===this.node}getOwnerRoot(){return Ot(this.node).getRootNode()}getDistributedNodes(){return this.node.localName==="slot"?Ot(this.node).assignedNodes({flatten:!0}):[]}getDestinationInsertionPoints(){let t=[],e=Ot(this.node).assignedSlot;for(;e;)t.push(e),e=Ot(e).assignedSlot;return t}importNode(t,e){let n=this.node instanceof Document?this.node:this.node.ownerDocument;return Ot(n).importNode(t,e)}getEffectiveChildNodes(){return ew.getFlattenedNodes(this.node)}queryDistributedElements(t){let e=this.getEffectiveChildNodes(),n=[];for(let r=0,o=e.length,s;r<o&&(s=e[r]);r++)s.nodeType===Node.ELEMENT_NODE&&iw(s,t)&&n.push(s);return n}get activeElement(){let t=this.node;return t._activeElement!==void 0?t._activeElement:t.activeElement}};function Xj(i,t){for(let e=0;e<t.length;e++){let n=t[e];i[n]=function(){return this.node[n].apply(this.node,arguments)}}}function OI(i,t){for(let e=0;e<t.length;e++){let n=t[e];Object.defineProperty(i,n,{get:function(){return this.node[n]},configurable:!0})}}function Kj(i,t){for(let e=0;e<t.length;e++){let n=t[e];Object.defineProperty(i,n,{get:function(){return this.node[n]},set:function(r){this.node[n]=r},configurable:!0})}}var pp=class{constructor(t){this.event=t}get rootTarget(){return this.path[0]}get localTarget(){return this.event.target}get path(){return this.event.composedPath()}};ke.prototype.cloneNode;ke.prototype.appendChild;ke.prototype.insertBefore;ke.prototype.removeChild;ke.prototype.replaceChild;ke.prototype.setAttribute;ke.prototype.removeAttribute;ke.prototype.querySelector;ke.prototype.querySelectorAll;ke.prototype.parentNode;ke.prototype.firstChild;ke.prototype.lastChild;ke.prototype.nextSibling;ke.prototype.previousSibling;ke.prototype.firstElementChild;ke.prototype.lastElementChild;ke.prototype.nextElementSibling;ke.prototype.previousElementSibling;ke.prototype.childNodes;ke.prototype.children;ke.prototype.classList;ke.prototype.textContent;ke.prototype.innerHTML;var nw=ke;if(window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.noPatch&&window.ShadyDOM.Wrapper){class i extends window.ShadyDOM.Wrapper{}Object.getOwnPropertyNames(ke.prototype).forEach(t=>{t!="activeElement"&&(i.prototype[t]=ke.prototype[t])}),OI(i.prototype,["classList"]),nw=i,Object.defineProperties(pp.prototype,{localTarget:{get(){let t=this.event.currentTarget,e=t&&Mt(t).getOwnerRoot(),n=this.path;for(let r=0;r<n.length;r++){let o=n[r];if(Mt(o).getOwnerRoot()===e)return o}},configurable:!0},path:{get(){return window.ShadyDOM.composedPath(this.event)},configurable:!0}})}else Xj(ke.prototype,["cloneNode","appendChild","insertBefore","removeChild","replaceChild","setAttribute","removeAttribute","querySelector","querySelectorAll"]),OI(ke.prototype,["parentNode","firstChild","lastChild","nextSibling","previousSibling","firstElementChild","lastElementChild","nextElementSibling","previousElementSibling","childNodes","children","classList"]),Kj(ke.prototype,["textContent","innerHTML","className"]);var Mt=function(i){if(i=i||document,i instanceof nw||i instanceof pp)return i;let t=i.__domApi;return t||(i instanceof Event?t=new pp(i):t=new nw(i),i.__domApi=t),t};var rw=window.ShadyDOM,BI=window.ShadyCSS;function VI(i,t){return Ot(i).getRootNode()===t}function HI(i,t=!1){if(!rw||!BI||!rw.handlesDynamicScoping)return null;let e=BI.ScopingShim;if(!e)return null;let n=e.scopeForNode(i),r=Ot(i).getRootNode(),o=s=>{if(!VI(s,r))return;let a=Array.from(rw.nativeMethods.querySelectorAll.call(s,"*"));a.push(s);for(let l=0;l<a.length;l++){let c=a[l];if(!VI(c,r))continue;let u=e.currentScopeForNode(c);u!==n&&(u!==""&&e.unscopeNode(c,u),e.scopeNode(c,n))}};if(o(i),t){let s=new MutationObserver(a=>{for(let l=0;l<a.length;l++){let c=a[l];for(let u=0;u<c.addedNodes.length;u++){let h=c.addedNodes[u];h.nodeType===Node.ELEMENT_NODE&&o(h)}}});return s.observe(i,{childList:!0,subtree:!0}),s}else return null}var ow="disable-upgrade",sw=i=>{for(;i;){let t=Object.getOwnPropertyDescriptor(i,"observedAttributes");if(t)return t.get;i=Object.getPrototypeOf(i.prototype).constructor}return()=>[]},vyt=Ge(i=>{let t=rs(i),e=sw(t);class n extends t{constructor(){super(),this.__isUpgradeDisabled}static get observedAttributes(){return e.call(this).concat(ow)}_initializeProperties(){this.hasAttribute(ow)?this.__isUpgradeDisabled=!0:super._initializeProperties()}_enableProperties(){this.__isUpgradeDisabled||super._enableProperties()}_canApplyPropertyDefault(o){return super._canApplyPropertyDefault(o)&&!(this.__isUpgradeDisabled&&this._isPropertyPending(o))}attributeChangedCallback(o,s,a,l){o==ow?this.__isUpgradeDisabled&&a==null&&(super._initializeProperties(),this.__isUpgradeDisabled=!1,Ot(this).isConnected&&super.connectedCallback()):super.attributeChangedCallback(o,s,a,l)}connectedCallback(){this.__isUpgradeDisabled||super.connectedCallback()}disconnectedCallback(){this.__isUpgradeDisabled||super.disconnectedCallback()}}return n});var vg="disable-upgrade",Yj=window.ShadyCSS,Oe=Ge(i=>{let t=xg(rs(i)),e=Hm?t:PI(t),n=sw(e),r={x:"pan-x",y:"pan-y",none:"none",all:"auto"};class o extends e{constructor(){super(),this.isAttached,this.__boundListeners,this._debouncers,this.__isUpgradeDisabled,this.__needsAttributesAtConnected,this._legacyForceObservedAttributes}static get importMeta(){return this.prototype.importMeta}created(){}__attributeReaction(a,l,c){(this.__dataAttributes&&this.__dataAttributes[a]||a===vg)&&this.attributeChangedCallback(a,l,c,null)}setAttribute(a,l){if(Vh&&!this._legacyForceObservedAttributes){let c=this.getAttribute(a);super.setAttribute(a,l),this.__attributeReaction(a,c,String(l))}else super.setAttribute(a,l)}removeAttribute(a){if(Vh&&!this._legacyForceObservedAttributes){let l=this.getAttribute(a);super.removeAttribute(a),this.__attributeReaction(a,l,null)}else super.removeAttribute(a)}static get observedAttributes(){return Vh&&!this.prototype._legacyForceObservedAttributes?(this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))||(this.__observedAttributes=[],Vm(this.prototype)),this.__observedAttributes):n.call(this).concat(vg)}_enableProperties(){this.__isUpgradeDisabled||super._enableProperties()}_canApplyPropertyDefault(a){return super._canApplyPropertyDefault(a)&&!(this.__isUpgradeDisabled&&this._isPropertyPending(a))}connectedCallback(){this.__needsAttributesAtConnected&&this._takeAttributes(),this.__isUpgradeDisabled||(super.connectedCallback(),this.isAttached=!0,this.attached())}attached(){}disconnectedCallback(){this.__isUpgradeDisabled||(super.disconnectedCallback(),this.isAttached=!1,this.detached())}detached(){}attributeChangedCallback(a,l,c,u){l!==c&&(a==vg?this.__isUpgradeDisabled&&c==null&&(this._initializeProperties(),this.__isUpgradeDisabled=!1,Ot(this).isConnected&&this.connectedCallback()):(super.attributeChangedCallback(a,l,c,u),this.attributeChanged(a,l,c)))}attributeChanged(a,l,c){}_initializeProperties(){if(xo&&this.hasAttribute(vg))this.__isUpgradeDisabled=!0;else{let a=Object.getPrototypeOf(this);a.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",a))||(this._registered(),a.__hasRegisterFinished=!0),super._initializeProperties(),this.root=this,this.created(),Vh&&!this._legacyForceObservedAttributes&&(this.hasAttributes()?this._takeAttributes():this.parentNode||(this.__needsAttributesAtConnected=!0)),this._applyListeners()}}_takeAttributes(){let a=this.attributes;for(let l=0,c=a.length;l<c;l++){let u=a[l];this.__attributeReaction(u.name,null,u.value)}}_registered(){}ready(){this._ensureAttributes(),super.ready()}_ensureAttributes(){}_applyListeners(){}serialize(a){return this._serializeValue(a)}deserialize(a,l){return this._deserializeValue(a,l)}reflectPropertyToAttribute(a,l,c){this._propertyToAttribute(a,l,c)}serializeValueToAttribute(a,l,c){this._valueToNodeAttribute(c||this,a,l)}extend(a,l){if(!(a&&l))return a||l;let c=Object.getOwnPropertyNames(l);for(let u=0,h;u<c.length&&(h=c[u]);u++){let p=Object.getOwnPropertyDescriptor(l,h);p&&Object.defineProperty(a,h,p)}return a}mixin(a,l){for(let c in l)a[c]=l[c];return a}chainObject(a,l){return a&&l&&a!==l&&(a.__proto__=l),a}instanceTemplate(a){let l=this.constructor._contentForTemplate(a);return document.importNode(l,!0)}fire(a,l,c){c=c||{},l=l==null?{}:l;let u=new Event(a,{bubbles:c.bubbles===void 0?!0:c.bubbles,cancelable:Boolean(c.cancelable),composed:c.composed===void 0?!0:c.composed});u.detail=l;let h=c.node||this;return Ot(h).dispatchEvent(u),u}listen(a,l,c){a=a||this;let u=this.__boundListeners||(this.__boundListeners=new WeakMap),h=u.get(a);h||(h={},u.set(a,h));let p=l+c;h[p]||(h[p]=this._addMethodEventListenerToNode(a,l,c,this))}unlisten(a,l,c){a=a||this;let u=this.__boundListeners&&this.__boundListeners.get(a),h=l+c,p=u&&u[h];p&&(this._removeEventListenerFromNode(a,l,p),u[h]=null)}setScrollDirection(a,l){Ea(l||this,r[a]||"auto")}$$(a){return this.root.querySelector(a)}get domHost(){let a=Ot(this).getRootNode();return a instanceof DocumentFragment?a.host:a}distributeContent(){let l=Mt(this);window.ShadyDOM&&l.shadowRoot&&ShadyDOM.flush()}getEffectiveChildNodes(){return Mt(this).getEffectiveChildNodes()}queryDistributedElements(a){return Mt(this).queryDistributedElements(a)}getEffectiveChildren(){return this.getEffectiveChildNodes().filter(function(l){return l.nodeType===Node.ELEMENT_NODE})}getEffectiveTextContent(){let a=this.getEffectiveChildNodes(),l=[];for(let c=0,u;u=a[c];c++)u.nodeType!==Node.COMMENT_NODE&&l.push(u.textContent);return l.join("")}queryEffectiveChildren(a){let l=this.queryDistributedElements(a);return l&&l[0]}queryAllEffectiveChildren(a){return this.queryDistributedElements(a)}getContentChildNodes(a){let l=this.root.querySelector(a||"slot");return l?Mt(l).getDistributedNodes():[]}getContentChildren(a){return this.getContentChildNodes(a).filter(function(c){return c.nodeType===Node.ELEMENT_NODE})}isLightDescendant(a){let l=this;return l!==a&&Ot(l).contains(a)&&Ot(l).getRootNode()===Ot(a).getRootNode()}isLocalDescendant(a){return this.root===Ot(a).getRootNode()}scopeSubtree(a,l=!1){return HI(a,l)}getComputedStyleValue(a){return Yj.getComputedStyleValue(this,a)}debounce(a,l,c){return this._debouncers=this._debouncers||{},this._debouncers[a]=li.debounce(this._debouncers[a],c>0?is.after(c):Wn,l.bind(this))}isDebouncerActive(a){this._debouncers=this._debouncers||{};let l=this._debouncers[a];return!!(l&&l.isActive())}flushDebouncer(a){this._debouncers=this._debouncers||{};let l=this._debouncers[a];l&&l.flush()}cancelDebouncer(a){this._debouncers=this._debouncers||{};let l=this._debouncers[a];l&&l.cancel()}async(a,l){return l>0?is.run(a.bind(this),l):~Wn.run(a.bind(this))}cancelAsync(a){a<0?Wn.cancel(~a):is.cancel(a)}create(a,l){let c=document.createElement(a);if(l)if(c.setProperties)c.setProperties(l);else for(let u in l)c[u]=l[u];return c}elementMatches(a,l){return iw(l||this,a)}toggleAttribute(a,l){let c=this;return arguments.length===3&&(c=arguments[2]),arguments.length==1&&(l=!c.hasAttribute(a)),l?(Ot(c).setAttribute(a,""),!0):(Ot(c).removeAttribute(a),!1)}toggleClass(a,l,c){c=c||this,arguments.length==1&&(l=!c.classList.contains(a)),l?c.classList.add(a):c.classList.remove(a)}transform(a,l){l=l||this,l.style.webkitTransform=a,l.style.transform=a}translate3d(a,l,c,u){u=u||this,this.transform("translate3d("+a+","+l+","+c+")",u)}arrayDelete(a,l){let c;if(Array.isArray(a)){if(c=a.indexOf(l),c>=0)return a.splice(c,1)}else if(c=Un(this,a).indexOf(l),c>=0)return this.splice(a,c,1);return null}_logger(a,l){switch(Array.isArray(l)&&l.length===1&&Array.isArray(l[0])&&(l=l[0]),a){case"log":case"warn":case"error":console[a](...l)}}_log(...a){this._logger("log",a)}_warn(...a){this._logger("warn",a)}_error(...a){this._logger("error",a)}_logf(a,...l){return["[%s::%s]",this.is,a,...l]}}return o.prototype.is="",o});var Zj={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,listeners:!0,hostAttributes:!0},WI={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,behaviors:!0,_noAccessors:!0},Jj=Object.assign({listeners:!0,hostAttributes:!0,properties:!0,observers:!0},WI);function Qj(i,t,e){let n=i._noAccessors,r=Object.getOwnPropertyNames(i);for(let o=0;o<r.length;o++){let s=r[o];if(!(s in e))if(n)t[s]=i[s];else{let a=Object.getOwnPropertyDescriptor(i,s);a&&(a.configurable=!0,Object.defineProperty(t,s,a))}}}function tq(i,t,e){for(let n=0;n<t.length;n++)GI(i,t[n],e,Jj)}function GI(i,t,e,n){Qj(t,i,n);for(let r in Zj)t[r]&&(e[r]=e[r]||[],e[r].push(t[r]))}function jI(i,t,e){t=t||[];for(let n=i.length-1;n>=0;n--){let r=i[n];r?Array.isArray(r)?jI(r,t):t.indexOf(r)<0&&(!e||e.indexOf(r)<0)&&t.unshift(r):console.warn("behavior is null, check for missing or 404 import")}return t}function $I(i,t){for(let e in t){let n=i[e],r=t[e];!("value"in r)&&n&&"value"in n?i[e]=Object.assign({value:n.value},r):i[e]=r}}var UI=Oe(HTMLElement);function eq(i,t,e){let n,r={};class o extends t{static _finalizeClass(){if(!this.hasOwnProperty(JSCompiler_renameProperty("generatedFrom",this)))t._finalizeClass.call(this);else{if(n)for(let l=0,c;l<n.length;l++)c=n[l],c.properties&&this.createProperties(c.properties),c.observers&&this.createObservers(c.observers,c.properties);i.properties&&this.createProperties(i.properties),i.observers&&this.createObservers(i.observers,i.properties),this._prepareTemplate()}}static get properties(){let l={};if(n)for(let c=0;c<n.length;c++)$I(l,n[c].properties);return $I(l,i.properties),l}static get observers(){let l=[];if(n)for(let c=0,u;c<n.length;c++)u=n[c],u.observers&&(l=l.concat(u.observers));return i.observers&&(l=l.concat(i.observers)),l}created(){super.created();let l=r.created;if(l)for(let c=0;c<l.length;c++)l[c].call(this)}_registered(){let l=o.prototype;if(!l.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",l))){l.__hasRegisterFinished=!0,super._registered(),xo&&s(l);let c=Object.getPrototypeOf(this),u=r.beforeRegister;if(u)for(let h=0;h<u.length;h++)u[h].call(c);if(u=r.registered,u)for(let h=0;h<u.length;h++)u[h].call(c)}}_applyListeners(){super._applyListeners();let l=r.listeners;if(l)for(let c=0;c<l.length;c++){let u=l[c];if(u)for(let h in u)this._addMethodEventListenerToNode(this,h,u[h])}}_ensureAttributes(){let l=r.hostAttributes;if(l)for(let c=l.length-1;c>=0;c--){let u=l[c];for(let h in u)this._ensureAttribute(h,u[h])}super._ensureAttributes()}ready(){super.ready();let l=r.ready;if(l)for(let c=0;c<l.length;c++)l[c].call(this)}attached(){super.attached();let l=r.attached;if(l)for(let c=0;c<l.length;c++)l[c].call(this)}detached(){super.detached();let l=r.detached;if(l)for(let c=0;c<l.length;c++)l[c].call(this)}attributeChanged(l,c,u){super.attributeChanged();let h=r.attributeChanged;if(h)for(let p=0;p<h.length;p++)h[p].call(this,l,c,u)}}if(e){Array.isArray(e)||(e=[e]);let a=t.prototype.behaviors;n=jI(e,null,a),o.prototype.behaviors=a?a.concat(e):n}let s=a=>{n&&tq(a,n,r),GI(a,i,r,WI)};return xo||s(o.prototype),o.generatedFrom=i,o}var qI=function(i,t){i||console.warn("Polymer.Class requires `info` argument");let e=t?t(UI):UI;return e=eq(i,e,i.behaviors),e.is=e.prototype.is=i.is,e};var It=function(i){let t;return typeof i=="function"?t=i:t=It.Class(i),i._legacyForceObservedAttributes&&(t.prototype._legacyForceObservedAttributes=i._legacyForceObservedAttributes),customElements.define(t.is,t),t};It.Class=qI;function aw(i,t,e,n,r){let o;r&&(o=typeof e=="object"&&e!==null,o&&(n=i.__dataTemp[t]));let s=n!==e&&(n===n||e===e);return o&&s&&(i.__dataTemp[t]=e),s}var gc=Ge(i=>{class t extends i{_shouldPropertyChange(n,r,o){return aw(this,n,r,o,!0)}}return t}),bg=Ge(i=>{class t extends i{static get properties(){return{mutableData:Boolean}}_shouldPropertyChange(n,r,o){return aw(this,n,r,o,this.mutableData)}}return t});gc._mutablePropertyChange=aw;var lw=null;function cw(){return lw}cw.prototype=Object.create(HTMLTemplateElement.prototype,{constructor:{value:cw,writable:!0}});var KI=fa(cw),nq=gc(KI);function iq(i,t){lw=i,Object.setPrototypeOf(i,t.prototype),new t,lw=null}var rq=fa(class{});function uw(i,t){for(let e=0;e<t.length;e++){let n=t[e];if(Boolean(i)!=Boolean(n.__hideTemplateChildren__))if(n.nodeType===Node.TEXT_NODE)i?(n.__polymerTextContent__=n.textContent,n.textContent=""):n.textContent=n.__polymerTextContent__;else if(n.localName==="slot")if(i)n.__polymerReplaced__=document.createComment("hidden-slot"),Ot(Ot(n).parentNode).replaceChild(n.__polymerReplaced__,n);else{let r=n.__polymerReplaced__;r&&Ot(Ot(r).parentNode).replaceChild(n,r)}else n.style&&(i?(n.__polymerDisplay__=n.style.display,n.style.display="none"):n.style.display=n.__polymerDisplay__);n.__hideTemplateChildren__=i,n._showHideChildren&&n._showHideChildren(i)}}var Or=class extends rq{constructor(t){super(),this._configureProperties(t),this.root=this._stampTemplate(this.__dataHost);let e=[];this.children=e;for(let r=this.root.firstChild;r;r=r.nextSibling)e.push(r),r.__templatizeInstance=this;this.__templatizeOwner&&this.__templatizeOwner.__hideTemplateChildren__&&this._showHideChildren(!0);let n=this.__templatizeOptions;(t&&n.instanceProps||!n.instanceProps)&&this._enableProperties()}_configureProperties(t){if(this.__templatizeOptions.forwardHostProp)for(let n in this.__hostProps)this._setPendingProperty(n,this.__dataHost["_host_"+n]);for(let n in t)this._setPendingProperty(n,t[n])}forwardHostProp(t,e){this._setPendingPropertyOrPath(t,e,!1,!0)&&this.__dataHost._enqueueClient(this)}_addEventListenerToNode(t,e,n){if(this._methodHost&&this.__templatizeOptions.parentModel)this._methodHost._addEventListenerToNode(t,e,r=>{r.model=this,n(r)});else{let r=this.__dataHost.__dataHost;r&&r._addEventListenerToNode(t,e,n)}}_showHideChildren(t){uw(t,this.children)}_setUnmanagedPropertyToNode(t,e,n){t.__hideTemplateChildren__&&t.nodeType==Node.TEXT_NODE&&e=="textContent"?t.__polymerTextContent__=n:super._setUnmanagedPropertyToNode(t,e,n)}get parentModel(){let t=this.__parentModel;if(!t){let e;t=this;do t=t.__dataHost.__dataHost;while((e=t.__templatizeOptions)&&!e.parentModel);this.__parentModel=t}return t}dispatchEvent(t){return!0}};Or.prototype.__dataHost;Or.prototype.__templatizeOptions;Or.prototype._methodHost;Or.prototype.__templatizeOwner;Or.prototype.__hostProps;var oq=gc(Or);function XI(i){let t=i.__dataHost;return t&&t._methodHost||t}function sq(i,t,e){let n=e.mutableData?oq:Or;ps.mixin&&(n=ps.mixin(n));let r=class extends n{};return r.prototype.__templatizeOptions=e,r.prototype._bindTemplate(i),cq(r,i,t,e),r}function aq(i,t,e,n){let r=e.forwardHostProp;if(r&&t.hasHostProps){let o=i.localName=="template",s=t.templatizeTemplateClass;if(!s){if(o){let l=e.mutableData?nq:KI;class c extends l{}s=t.templatizeTemplateClass=c}else{let l=i.constructor;class c extends l{}s=t.templatizeTemplateClass=c}let a=t.hostProps;for(let l in a)s.prototype._addPropertyEffect("_host_"+l,s.prototype.PROPERTY_EFFECT_TYPES.PROPAGATE,{fn:lq(l,r)}),s.prototype._createNotifyingProperty("_host_"+l);Tm&&n&&pq(t,e,n)}if(i.__dataProto&&Object.assign(i.__data,i.__dataProto),o)iq(i,s),i.__dataTemp={},i.__dataPending=null,i.__dataOld=null,i._enableProperties();else{Object.setPrototypeOf(i,s.prototype);let a=t.hostProps;for(let l in a)if(l="_host_"+l,l in i){let c=i[l];delete i[l],i.__data[l]=c}}}}function lq(i,t){return function(n,r,o){t.call(n.__templatizeOwner,r.substring(6),o[r])}}function cq(i,t,e,n){let r=e.hostProps||{};for(let o in n.instanceProps){delete r[o];let s=n.notifyInstanceProp;s&&i.prototype._addPropertyEffect(o,i.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:uq(o,s)})}if(n.forwardHostProp&&t.__dataHost)for(let o in r)e.hasHostProps||(e.hasHostProps=!0),i.prototype._addPropertyEffect(o,i.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:hq()})}function uq(i,t){return function(n,r,o){t.call(n.__templatizeOwner,n,r,o[r])}}function hq(){return function(t,e,n){t.__dataHost._setPendingPropertyOrPath("_host_"+e,n[e],!0,!0)}}function ps(i,t,e){if(Bi&&!XI(i))throw new Error("strictTemplatePolicy: template owner not trusted");if(e=e||{},i.__templatizeOwner)throw new Error("A <template> can only be templatized once");i.__templatizeOwner=t;let r=(t?t.constructor:Or)._parseTemplate(i),o=r.templatizeInstanceClass;o||(o=sq(i,r,e),r.templatizeInstanceClass=o);let s=XI(i);aq(i,r,e,s);let a=class extends o{};return a.prototype._methodHost=s,a.prototype.__dataHost=i,a.prototype.__templatizeOwner=t,a.prototype.__hostProps=r.hostProps,a=a,a}function pq(i,t,e){let n=e.constructor._properties,{propertyEffects:r}=i,{instanceProps:o}=t;for(let s in r)if(!n[s]&&!(o&&o[s])){let a=r[s];for(let l=0;l<a.length;l++){let{part:c}=a[l].info;if(!(c.signature&&c.signature.static)){console.warn(`Property '${s}' used in template but not declared in 'properties'; attribute will not be observed.`);break}}}}function _g(i,t){let e;for(;t;)if(e=t.__dataHost?t:t.__templatizeInstance)if(e.__dataHost!=i)t=e.__dataHost;else return e;else t=Ot(t).parentNode;return null}var YI={templatize(i,t){this._templatizerTemplate=i,this.ctor=ps(i,this,{mutableData:Boolean(t),parentModel:this._parentModel,instanceProps:this._instanceProps,forwardHostProp:this._forwardHostPropV2,notifyInstanceProp:this._notifyInstancePropV2})},stamp(i){return new this.ctor(i)},modelForElement(i){return _g(this._templatizerTemplate,i)}};var ZI=!1;function xc(){if(xo&&!pa){if(!ZI){ZI=!0;let i=document.createElement("style");i.textContent="dom-bind,dom-if,dom-repeat{display:none;}",document.head.appendChild(i)}return!0}return!1}var fq=xg(bg(fa(HTMLElement))),hw=class extends fq{static get observedAttributes(){return["mutable-data"]}constructor(){if(super(),Bi)throw new Error("strictTemplatePolicy: dom-bind not allowed");this.root=null,this.$=null,this.__children=null}attributeChangedCallback(t,e,n,r){this.mutableData=!0}connectedCallback(){xc()||(this.style.display="none"),this.render()}disconnectedCallback(){this.__removeChildren()}__insertChildren(){Ot(Ot(this).parentNode).insertBefore(this.root,this)}__removeChildren(){if(this.__children)for(let t=0;t<this.__children.length;t++)this.root.appendChild(this.__children[t])}render(){let t;if(!this.__children){if(t=t||this.querySelector("template"),!t){let e=new MutationObserver(()=>{if(t=this.querySelector("template"),t)e.disconnect(),this.render();else throw new Error("dom-bind requires a <template> child")});e.observe(this,{childList:!0});return}this.root=this._stampTemplate(t),this.$=this.root.$,this.__children=[];for(let e=this.root.firstChild;e;e=e.nextSibling)this.__children[this.__children.length]=e;this._enableProperties()}this.__insertChildren(),this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}};customElements.define("dom-bind",hw);var dq=bg(ve),wg=class extends dq{static get is(){return"dom-repeat"}static get template(){return null}static get properties(){return{items:{type:Array},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},itemsIndexAs:{type:String,value:"itemsIndex"},sort:{type:Function,observer:"__sortChanged"},filter:{type:Function,observer:"__filterChanged"},observe:{type:String,observer:"__observeChanged"},delay:Number,renderedItemCount:{type:Number,notify:!Bh,readOnly:!0},initialCount:{type:Number},targetFramerate:{type:Number,value:20},_targetFrameTime:{type:Number,computed:"__computeFrameTime(targetFramerate)"},notifyDomChange:{type:Boolean},reuseChunkedInstances:{type:Boolean}}}static get observers(){return["__itemsChanged(items.*)"]}constructor(){super(),this.__instances=[],this.__renderDebouncer=null,this.__itemsIdxToInstIdx={},this.__chunkCount=null,this.__renderStartTime=null,this.__itemsArrayChanged=!1,this.__shouldMeasureChunk=!1,this.__shouldContinueChunking=!1,this.__chunkingId=0,this.__sortFn=null,this.__filterFn=null,this.__observePaths=null,this.__ctor=null,this.__isDetached=!0,this.template=null,this._templateInfo}disconnectedCallback(){super.disconnectedCallback(),this.__isDetached=!0;for(let t=0;t<this.__instances.length;t++)this.__detachInstance(t)}connectedCallback(){if(super.connectedCallback(),xc()||(this.style.display="none"),this.__isDetached){this.__isDetached=!1;let t=Ot(Ot(this).parentNode);for(let e=0;e<this.__instances.length;e++)this.__attachInstance(e,t)}}__ensureTemplatized(){if(!this.__ctor){let t=this,e=this.template=t._templateInfo?t:this.querySelector("template");if(!e){let r=new MutationObserver(()=>{if(this.querySelector("template"))r.disconnect(),this.__render();else throw new Error("dom-repeat requires a <template> child")});return r.observe(this,{childList:!0}),!1}let n={};n[this.as]=!0,n[this.indexAs]=!0,n[this.itemsIndexAs]=!0,this.__ctor=ps(e,this,{mutableData:this.mutableData,parentModel:!0,instanceProps:n,forwardHostProp:function(r,o){let s=this.__instances;for(let a=0,l;a<s.length&&(l=s[a]);a++)l.forwardHostProp(r,o)},notifyInstanceProp:function(r,o,s){if(Dm(this.as,o)){let a=r[this.itemsIndexAs];o==this.as&&(this.items[a]=s);let l=vo(this.as,`${JSCompiler_renameProperty("items",this)}.${a}`,o);this.notifyPath(l,s)}}})}return!0}__getMethodHost(){return this.__dataHost._methodHost||this.__dataHost}__functionFromPropertyValue(t){if(typeof t=="string"){let e=t,n=this.__getMethodHost();return function(){return n[e].apply(n,arguments)}}return t}__sortChanged(t){this.__sortFn=this.__functionFromPropertyValue(t),this.items&&this.__debounceRender(this.__render)}__filterChanged(t){this.__filterFn=this.__functionFromPropertyValue(t),this.items&&this.__debounceRender(this.__render)}__computeFrameTime(t){return Math.ceil(1e3/t)}__observeChanged(){this.__observePaths=this.observe&&this.observe.replace(".*",".").split(" ")}__handleObservedPaths(t){if(this.__sortFn||this.__filterFn){if(!t)this.__debounceRender(this.__render,this.delay);else if(this.__observePaths){let e=this.__observePaths;for(let n=0;n<e.length;n++)t.indexOf(e[n])===0&&this.__debounceRender(this.__render,this.delay)}}}__itemsChanged(t){this.items&&!Array.isArray(this.items)&&console.warn("dom-repeat expected array for `items`, found",this.items),this.__handleItemPath(t.path,t.value)||(t.path==="items"&&(this.__itemsArrayChanged=!0),this.__debounceRender(this.__render))}__debounceRender(t,e=0){this.__renderDebouncer=li.debounce(this.__renderDebouncer,e>0?is.after(e):Wn,t.bind(this)),hs(this.__renderDebouncer)}render(){this.__debounceRender(this.__render),fr()}__render(){if(!this.__ensureTemplatized())return;let t=this.items||[],e=this.__sortAndFilterItems(t),n=this.__calculateLimit(e.length);this.__updateInstances(t,n,e),this.initialCount&&(this.__shouldMeasureChunk||this.__shouldContinueChunking)&&(cancelAnimationFrame(this.__chunkingId),this.__chunkingId=requestAnimationFrame(()=>this.__continueChunking())),this._setRenderedItemCount(this.__instances.length),(!Bh||this.notifyDomChange)&&this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}__sortAndFilterItems(t){let e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=n;return this.__filterFn&&(e=e.filter((n,r,o)=>this.__filterFn(t[n],r,o))),this.__sortFn&&e.sort((n,r)=>this.__sortFn(t[n],t[r])),e}__calculateLimit(t){let e=t,n=this.__instances.length;if(this.initialCount){let r;!this.__chunkCount||this.__itemsArrayChanged&&!this.reuseChunkedInstances?(e=Math.min(t,this.initialCount),r=Math.max(e-n,0),this.__chunkCount=r||1):(r=Math.min(Math.max(t-n,0),this.__chunkCount),e=Math.min(n+r,t)),this.__shouldMeasureChunk=r===this.__chunkCount,this.__shouldContinueChunking=e<t,this.__renderStartTime=performance.now()}return this.__itemsArrayChanged=!1,e}__continueChunking(){if(this.__shouldMeasureChunk){let t=performance.now()-this.__renderStartTime,e=this._targetFrameTime/t;this.__chunkCount=Math.round(this.__chunkCount*e)||1}this.__shouldContinueChunking&&this.__debounceRender(this.__render)}__updateInstances(t,e,n){let r=this.__itemsIdxToInstIdx={},o;for(o=0;o<e;o++){let s=this.__instances[o],a=n[o],l=t[a];r[a]=o,s?(s._setPendingProperty(this.as,l),s._setPendingProperty(this.indexAs,o),s._setPendingProperty(this.itemsIndexAs,a),s._flushProperties()):this.__insertInstance(l,o,a)}for(let s=this.__instances.length-1;s>=o;s--)this.__detachAndRemoveInstance(s)}__detachInstance(t){let e=this.__instances[t],n=Ot(e.root);for(let r=0;r<e.children.length;r++){let o=e.children[r];n.appendChild(o)}return e}__attachInstance(t,e){let n=this.__instances[t];e.insertBefore(n.root,this)}__detachAndRemoveInstance(t){this.__detachInstance(t),this.__instances.splice(t,1)}__stampInstance(t,e,n){let r={};return r[this.as]=t,r[this.indexAs]=e,r[this.itemsIndexAs]=n,new this.__ctor(r)}__insertInstance(t,e,n){let r=this.__stampInstance(t,e,n),o=this.__instances[e+1],s=o?o.children[0]:this;return Ot(Ot(this).parentNode).insertBefore(r.root,s),this.__instances[e]=r,r}_showHideChildren(t){for(let e=0;e<this.__instances.length;e++)this.__instances[e]._showHideChildren(t)}__handleItemPath(t,e){let n=t.slice(6),r=n.indexOf("."),o=r<0?n:n.substring(0,r);if(o==parseInt(o,10)){let s=r<0?"":n.substring(r+1);this.__handleObservedPaths(s);let a=this.__itemsIdxToInstIdx[o],l=this.__instances[a];if(l){let c=this.as+(s?"."+s:"");l._setPendingPropertyOrPath(c,e,!1,!0),l._flushProperties()}return!0}}itemForElement(t){let e=this.modelForElement(t);return e&&e[this.as]}indexForElement(t){let e=this.modelForElement(t);return e&&e[this.indexAs]}modelForElement(t){return _g(this.template,t)}};customElements.define(wg.is,wg);var Sg=class extends ve{static get is(){return"dom-if"}static get template(){return null}static get properties(){return{if:{type:Boolean,observer:"__debounceRender"},restamp:{type:Boolean,observer:"__debounceRender"},notifyDomChange:{type:Boolean}}}constructor(){super(),this.__renderDebouncer=null,this._lastIf=!1,this.__hideTemplateChildren__=!1,this.__template,this._templateInfo}__debounceRender(){this.__renderDebouncer=li.debounce(this.__renderDebouncer,Wn,()=>this.__render()),hs(this.__renderDebouncer)}disconnectedCallback(){super.disconnectedCallback();let t=Ot(this).parentNode;(!t||t.nodeType==Node.DOCUMENT_FRAGMENT_NODE&&!Ot(t).host)&&this.__teardownInstance()}connectedCallback(){super.connectedCallback(),xc()||(this.style.display="none"),this.if&&this.__debounceRender()}__ensureTemplate(){if(!this.__template){let t=this,e=t._templateInfo?t:Ot(t).querySelector("template");if(!e){let n=new MutationObserver(()=>{if(Ot(this).querySelector("template"))n.disconnect(),this.__render();else throw new Error("dom-if requires a <template> child")});return n.observe(this,{childList:!0}),!1}this.__template=e}return!0}__ensureInstance(){let t=Ot(this).parentNode;if(this.__hasInstance()){let e=this.__getInstanceNodes();if(e&&e.length&&Ot(this).previousSibling!==e[e.length-1])for(let r=0,o;r<e.length&&(o=e[r]);r++)Ot(t).insertBefore(o,this)}else{if(!t||!this.__ensureTemplate())return!1;this.__createAndInsertInstance(t)}return!0}render(){fr()}__render(){if(this.if){if(!this.__ensureInstance())return}else this.restamp&&this.__teardownInstance();this._showHideChildren(),(!Bh||this.notifyDomChange)&&this.if!=this._lastIf&&(this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0})),this._lastIf=this.if)}__hasInstance(){}__getInstanceNodes(){}__createAndInsertInstance(t){}__teardownInstance(){}_showHideChildren(){}},pw=class extends Sg{constructor(){super(),this.__instance=null,this.__syncInfo=null}__hasInstance(){return Boolean(this.__instance)}__getInstanceNodes(){return this.__instance.templateInfo.childNodes}__createAndInsertInstance(t){let e=this.__dataHost||this;if(Bi&&!this.__dataHost)throw new Error("strictTemplatePolicy: template owner not trusted");let n=e._bindTemplate(this.__template,!0);n.runEffects=(r,o,s)=>{let a=this.__syncInfo;if(this.if)a&&(this.__syncInfo=null,this._showHideChildren(),o=Object.assign(a.changedProps,o)),r(o,s);else if(this.__instance)if(a||(a=this.__syncInfo={runEffects:r,changedProps:{}}),s)for(let l in o){let c=ur(l);a.changedProps[c]=this.__dataHost[c]}else Object.assign(a.changedProps,o)},this.__instance=e._stampTemplate(this.__template,n),Ot(t).insertBefore(this.__instance,this)}__syncHostProperties(){let t=this.__syncInfo;t&&(this.__syncInfo=null,t.runEffects(t.changedProps,!1))}__teardownInstance(){let t=this.__dataHost||this;this.__instance&&(t._removeBoundDom(this.__instance),this.__instance=null,this.__syncInfo=null)}_showHideChildren(){let t=this.__hideTemplateChildren__||!this.if;this.__instance&&Boolean(this.__instance.__hidden)!==t&&(this.__instance.__hidden=t,uw(t,this.__instance.templateInfo.childNodes)),t||this.__syncHostProperties()}},fw=class extends Sg{constructor(){super(),this.__ctor=null,this.__instance=null,this.__invalidProps=null}__hasInstance(){return Boolean(this.__instance)}__getInstanceNodes(){return this.__instance.children}__createAndInsertInstance(t){this.__ctor||(this.__ctor=ps(this.__template,this,{mutableData:!0,forwardHostProp:function(e,n){this.__instance&&(this.if?this.__instance.forwardHostProp(e,n):(this.__invalidProps=this.__invalidProps||Object.create(null),this.__invalidProps[ur(e)]=!0))}})),this.__instance=new this.__ctor,Ot(t).insertBefore(this.__instance.root,this)}__teardownInstance(){if(this.__instance){let t=this.__instance.children;if(t&&t.length){let e=Ot(t[0]).parentNode;if(e){e=Ot(e);for(let n=0,r;n<t.length&&(r=t[n]);n++)e.removeChild(r)}}this.__invalidProps=null,this.__instance=null}}__syncHostProperties(){let t=this.__invalidProps;if(t){this.__invalidProps=null;for(let e in t)this.__instance._setPendingProperty(e,this.__dataHost[e]);this.__instance._flushProperties()}}_showHideChildren(){let t=this.__hideTemplateChildren__||!this.if;this.__instance&&Boolean(this.__instance.__hidden)!==t&&(this.__instance.__hidden=t,this.__instance._showHideChildren(t)),t||this.__syncHostProperties()}},JI=Am?pw:fw;customElements.define(JI.is,JI);var mq=Ge(i=>{let t=rs(i);class e extends t{static get properties(){return{items:{type:Array},multi:{type:Boolean,value:!1},selected:{type:Object,notify:!0},selectedItem:{type:Object,notify:!0},toggle:{type:Boolean,value:!1}}}static get observers(){return["__updateSelection(multi, items.*)"]}constructor(){super(),this.__lastItems=null,this.__lastMulti=null,this.__selectedMap=null}__updateSelection(r,o){let s=o.path;if(s==JSCompiler_renameProperty("items",this)){let a=o.base||[],l=this.__lastItems,c=this.__lastMulti;if(r!==c&&this.clearSelection(),l){let u=yg(a,l);this.__applySplices(u)}this.__lastItems=a,this.__lastMulti=r}else if(o.path==`${JSCompiler_renameProperty("items",this)}.splices`)this.__applySplices(o.value.indexSplices);else{let a=s.slice(`${JSCompiler_renameProperty("items",this)}.`.length),l=parseInt(a,10);a.indexOf(".")<0&&a==l&&this.__deselectChangedIdx(l)}}__applySplices(r){let o=this.__selectedMap;for(let a=0;a<r.length;a++){let l=r[a];o.forEach((c,u)=>{c<l.index||(c>=l.index+l.removed.length?o.set(u,c+l.addedCount-l.removed.length):o.set(u,-1))});for(let c=0;c<l.addedCount;c++){let u=l.index+c;o.has(this.items[u])&&o.set(this.items[u],u)}}this.__updateLinks();let s=0;o.forEach((a,l)=>{a<0?(this.multi?this.splice(JSCompiler_renameProperty("selected",this),s,1):this.selected=this.selectedItem=null,o.delete(l)):s++})}__updateLinks(){if(this.__dataLinkedPaths={},this.multi){let r=0;this.__selectedMap.forEach(o=>{o>=0&&this.linkPaths(`${JSCompiler_renameProperty("items",this)}.${o}`,`${JSCompiler_renameProperty("selected",this)}.${r++}`)})}else this.__selectedMap.forEach(r=>{this.linkPaths(JSCompiler_renameProperty("selected",this),`${JSCompiler_renameProperty("items",this)}.${r}`),this.linkPaths(JSCompiler_renameProperty("selectedItem",this),`${JSCompiler_renameProperty("items",this)}.${r}`)})}clearSelection(){this.__dataLinkedPaths={},this.__selectedMap=new Map,this.selected=this.multi?[]:null,this.selectedItem=null}isSelected(r){return this.__selectedMap.has(r)}isIndexSelected(r){return this.isSelected(this.items[r])}__deselectChangedIdx(r){let o=this.__selectedIndexForItemIndex(r);if(o>=0){let s=0;this.__selectedMap.forEach((a,l)=>{o==s++&&this.deselect(l)})}}__selectedIndexForItemIndex(r){let o=this.__dataLinkedPaths[`${JSCompiler_renameProperty("items",this)}.${r}`];if(o)return parseInt(o.slice(`${JSCompiler_renameProperty("selected",this)}.`.length),10)}deselect(r){let o=this.__selectedMap.get(r);if(o>=0){this.__selectedMap.delete(r);let s;this.multi&&(s=this.__selectedIndexForItemIndex(o)),this.__updateLinks(),this.multi?this.splice(JSCompiler_renameProperty("selected",this),s,1):this.selected=this.selectedItem=null}}deselectIndex(r){this.deselect(this.items[r])}select(r){this.selectIndex(this.items.indexOf(r))}selectIndex(r){let o=this.items[r];this.isSelected(o)?this.toggle&&this.deselectIndex(r):(this.multi||this.__selectedMap.clear(),this.__selectedMap.set(o,r),this.__updateLinks(),this.multi?this.push(JSCompiler_renameProperty("selected",this),o):this.selected=this.selectedItem=o)}}return e});var gq=mq(ve),Cg=class extends gq{static get is(){return"array-selector"}static get template(){return null}};customElements.define(Cg.is,Cg);var Mg=new $i;window.ShadyCSS||(window.ShadyCSS={prepareTemplate(i,t,e){},prepareTemplateDom(i,t){},prepareTemplateStyles(i,t,e){},styleSubtree(i,t){Mg.processStyles(),np(i,t)},styleElement(i){Mg.processStyles()},styleDocument(i){Mg.processStyles(),np(document.body,i)},getComputedStyleValue(i,t){return og(i,t)},flushCustomStyles(){},nativeCss:lc,nativeShadow:Sa,cssBuild:us,disableRuntime:ig});window.ShadyCSS.CustomStyleInterface=Mg;var QI="include",xq=window.ShadyCSS.CustomStyleInterface,dw=class extends HTMLElement{constructor(){super(),this._style=null,xq.addCustomStyle(this)}getStyle(){if(this._style)return this._style;let t=this.querySelector("style");if(!t)return null;this._style=t;let e=t.getAttribute(QI);return e&&(t.removeAttribute(QI),t.textContent=F5(e)+t.textContent),this.ownerDocument!==window.document&&window.document.head.appendChild(this),this._style}};window.customElements.define("custom-style",dw);var tA;tA=gc._mutablePropertyChange;var eA={properties:{mutableData:Boolean},_shouldPropertyChange(i,t,e){return tA(this,i,t,e,this.mutableData)}};var fs=Oe(HTMLElement).prototype;var Eg=new Set,Br={properties:{_parentResizable:{type:Object,observer:"_parentResizableChanged"},_notifyingDescendant:{type:Boolean,value:!1}},listeners:{"iron-request-resize-notifications":"_onIronRequestResizeNotifications"},created:function(){this._interestedResizables=[],this._boundNotifyResize=this.notifyResize.bind(this),this._boundOnDescendantIronResize=this._onDescendantIronResize.bind(this)},attached:function(){this._requestResizeNotifications()},detached:function(){this._parentResizable?this._parentResizable.stopResizeNotificationsFor(this):(Eg.delete(this),window.removeEventListener("resize",this._boundNotifyResize)),this._parentResizable=null},notifyResize:function(){!this.isAttached||(this._interestedResizables.forEach(function(i){this.resizerShouldNotify(i)&&this._notifyDescendant(i)},this),this._fireResize())},assignParentResizable:function(i){this._parentResizable&&this._parentResizable.stopResizeNotificationsFor(this),this._parentResizable=i,i&&i._interestedResizables.indexOf(this)===-1&&(i._interestedResizables.push(this),i._subscribeIronResize(this))},stopResizeNotificationsFor:function(i){var t=this._interestedResizables.indexOf(i);t>-1&&(this._interestedResizables.splice(t,1),this._unsubscribeIronResize(i))},_subscribeIronResize:function(i){i.addEventListener("iron-resize",this._boundOnDescendantIronResize)},_unsubscribeIronResize:function(i){i.removeEventListener("iron-resize",this._boundOnDescendantIronResize)},resizerShouldNotify:function(i){return!0},_onDescendantIronResize:function(i){if(this._notifyingDescendant){i.stopPropagation();return}pa||this._fireResize()},_fireResize:function(){this.fire("iron-resize",null,{node:this,bubbles:!1})},_onIronRequestResizeNotifications:function(i){var t=Mt(i).rootTarget;t!==this&&(t.assignParentResizable(this),this._notifyDescendant(t),i.stopPropagation())},_parentResizableChanged:function(i){i&&window.removeEventListener("resize",this._boundNotifyResize)},_notifyDescendant:function(i){!this.isAttached||(this._notifyingDescendant=!0,i.notifyResize(),this._notifyingDescendant=!1)},_requestResizeNotifications:function(){if(!!this.isAttached)if(document.readyState==="loading"){var i=this._requestResizeNotifications.bind(this);document.addEventListener("readystatechange",function t(){document.removeEventListener("readystatechange",t),i()})}else this._findParent(),this._parentResizable?this._parentResizable._interestedResizables.forEach(function(t){t!==this&&t._findParent()},this):(Eg.forEach(function(t){t!==this&&t._findParent()},this),window.addEventListener("resize",this._boundNotifyResize),this.notifyResize())},_findParent:function(){this.assignParentResizable(null),this.fire("iron-request-resize-notifications",null,{node:this,bubbles:!0,cancelable:!0}),this._parentResizable?Eg.delete(this):Eg.add(this)}};It({_template:ut`
    <style>
      :host {
        display: block;
        transition-duration: var(--iron-collapse-transition-duration, 300ms);
        /* Safari 10 needs this property prefixed to correctly apply the custom property */
        -webkit-transition-duration: var(--iron-collapse-transition-duration, 300ms);
        overflow: visible;
      }

      :host(.iron-collapse-closed) {
        display: none;
      }

      :host(:not(.iron-collapse-opened)) {
        overflow: hidden;
      }
    </style>

    <slot></slot>
`,is:"iron-collapse",behaviors:[Br],properties:{horizontal:{type:Boolean,value:!1,observer:"_horizontalChanged"},opened:{type:Boolean,value:!1,notify:!0,observer:"_openedChanged"},transitioning:{type:Boolean,notify:!0,readOnly:!0},noAnimation:{type:Boolean},_desiredSize:{type:String,value:""}},get dimension(){return this.horizontal?"width":"height"},get _dimensionMax(){return this.horizontal?"maxWidth":"maxHeight"},get _dimensionMaxCss(){return this.horizontal?"max-width":"max-height"},hostAttributes:{role:"group","aria-hidden":"true"},listeners:{transitionend:"_onTransitionEnd"},toggle:function(){this.opened=!this.opened},show:function(){this.opened=!0},hide:function(){this.opened=!1},updateSize:function(i,t){i=i==="auto"?"":i;var e=t&&!this.noAnimation&&this.isAttached&&this._desiredSize!==i;if(this._desiredSize=i,this._updateTransition(!1),e){var n=this._calcSize();i===""&&(this.style[this._dimensionMax]="",i=this._calcSize()),this.style[this._dimensionMax]=n,this.scrollTop=this.scrollTop,this._updateTransition(!0),e=i!==n}this.style[this._dimensionMax]=i,e||this._transitionEnd()},enableTransition:function(i){fs._warn("`enableTransition()` is deprecated, use `noAnimation` instead."),this.noAnimation=!i},_updateTransition:function(i){this.style.transitionDuration=i&&!this.noAnimation?"":"0s"},_horizontalChanged:function(){this.style.transitionProperty=this._dimensionMaxCss;var i=this._dimensionMax==="maxWidth"?"maxHeight":"maxWidth";this.style[i]="",this.updateSize(this.opened?"auto":"0px",!1)},_openedChanged:function(){this.setAttribute("aria-hidden",!this.opened),this._setTransitioning(!0),this.toggleClass("iron-collapse-closed",!1),this.toggleClass("iron-collapse-opened",!1),this.updateSize(this.opened?"auto":"0px",!0),this.opened&&this.focus()},_transitionEnd:function(){this.style[this._dimensionMax]=this._desiredSize,this.toggleClass("iron-collapse-closed",!this.opened),this.toggleClass("iron-collapse-opened",this.opened),this._updateTransition(!1),this.notifyResize(),this._setTransitioning(!1)},_onTransitionEnd:function(i){Mt(i).rootTarget===this&&this._transitionEnd()},_calcSize:function(){return this.getBoundingClientRect()[this.dimension]+"px"}});var nA=ut`
/* Most common used flex styles*/
<dom-module id="iron-flex">
  <template>
    <style>
      .layout.horizontal,
      .layout.vertical {
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;
      }

      .layout.inline {
        display: -ms-inline-flexbox;
        display: -webkit-inline-flex;
        display: inline-flex;
      }

      .layout.horizontal {
        -ms-flex-direction: row;
        -webkit-flex-direction: row;
        flex-direction: row;
      }

      .layout.vertical {
        -ms-flex-direction: column;
        -webkit-flex-direction: column;
        flex-direction: column;
      }

      .layout.wrap {
        -ms-flex-wrap: wrap;
        -webkit-flex-wrap: wrap;
        flex-wrap: wrap;
      }

      .layout.no-wrap {
        -ms-flex-wrap: nowrap;
        -webkit-flex-wrap: nowrap;
        flex-wrap: nowrap;
      }

      .layout.center,
      .layout.center-center {
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
      }

      .layout.center-justified,
      .layout.center-center {
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
      }

      .flex {
        -ms-flex: 1 1 0.000000001px;
        -webkit-flex: 1;
        flex: 1;
        -webkit-flex-basis: 0.000000001px;
        flex-basis: 0.000000001px;
      }

      .flex-auto {
        -ms-flex: 1 1 auto;
        -webkit-flex: 1 1 auto;
        flex: 1 1 auto;
      }

      .flex-none {
        -ms-flex: none;
        -webkit-flex: none;
        flex: none;
      }
    </style>
  </template>
</dom-module>
/* Basic flexbox reverse styles */
<dom-module id="iron-flex-reverse">
  <template>
    <style>
      .layout.horizontal-reverse,
      .layout.vertical-reverse {
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;
      }

      .layout.horizontal-reverse {
        -ms-flex-direction: row-reverse;
        -webkit-flex-direction: row-reverse;
        flex-direction: row-reverse;
      }

      .layout.vertical-reverse {
        -ms-flex-direction: column-reverse;
        -webkit-flex-direction: column-reverse;
        flex-direction: column-reverse;
      }

      .layout.wrap-reverse {
        -ms-flex-wrap: wrap-reverse;
        -webkit-flex-wrap: wrap-reverse;
        flex-wrap: wrap-reverse;
      }
    </style>
  </template>
</dom-module>
/* Flexbox alignment */
<dom-module id="iron-flex-alignment">
  <template>
    <style>
      /**
       * Alignment in cross axis.
       */
      .layout.start {
        -ms-flex-align: start;
        -webkit-align-items: flex-start;
        align-items: flex-start;
      }

      .layout.center,
      .layout.center-center {
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
      }

      .layout.end {
        -ms-flex-align: end;
        -webkit-align-items: flex-end;
        align-items: flex-end;
      }

      .layout.baseline {
        -ms-flex-align: baseline;
        -webkit-align-items: baseline;
        align-items: baseline;
      }

      /**
       * Alignment in main axis.
       */
      .layout.start-justified {
        -ms-flex-pack: start;
        -webkit-justify-content: flex-start;
        justify-content: flex-start;
      }

      .layout.center-justified,
      .layout.center-center {
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
      }

      .layout.end-justified {
        -ms-flex-pack: end;
        -webkit-justify-content: flex-end;
        justify-content: flex-end;
      }

      .layout.around-justified {
        -ms-flex-pack: distribute;
        -webkit-justify-content: space-around;
        justify-content: space-around;
      }

      .layout.justified {
        -ms-flex-pack: justify;
        -webkit-justify-content: space-between;
        justify-content: space-between;
      }

      /**
       * Self alignment.
       */
      .self-start {
        -ms-align-self: flex-start;
        -webkit-align-self: flex-start;
        align-self: flex-start;
      }

      .self-center {
        -ms-align-self: center;
        -webkit-align-self: center;
        align-self: center;
      }

      .self-end {
        -ms-align-self: flex-end;
        -webkit-align-self: flex-end;
        align-self: flex-end;
      }

      .self-stretch {
        -ms-align-self: stretch;
        -webkit-align-self: stretch;
        align-self: stretch;
      }

      .self-baseline {
        -ms-align-self: baseline;
        -webkit-align-self: baseline;
        align-self: baseline;
      }

      /**
       * multi-line alignment in main axis.
       */
      .layout.start-aligned {
        -ms-flex-line-pack: start;  /* IE10 */
        -ms-align-content: flex-start;
        -webkit-align-content: flex-start;
        align-content: flex-start;
      }

      .layout.end-aligned {
        -ms-flex-line-pack: end;  /* IE10 */
        -ms-align-content: flex-end;
        -webkit-align-content: flex-end;
        align-content: flex-end;
      }

      .layout.center-aligned {
        -ms-flex-line-pack: center;  /* IE10 */
        -ms-align-content: center;
        -webkit-align-content: center;
        align-content: center;
      }

      .layout.between-aligned {
        -ms-flex-line-pack: justify;  /* IE10 */
        -ms-align-content: space-between;
        -webkit-align-content: space-between;
        align-content: space-between;
      }

      .layout.around-aligned {
        -ms-flex-line-pack: distribute;  /* IE10 */
        -ms-align-content: space-around;
        -webkit-align-content: space-around;
        align-content: space-around;
      }
    </style>
  </template>
</dom-module>
/* Non-flexbox positioning helper styles */
<dom-module id="iron-flex-factors">
  <template>
    <style>
      .flex,
      .flex-1 {
        -ms-flex: 1 1 0.000000001px;
        -webkit-flex: 1;
        flex: 1;
        -webkit-flex-basis: 0.000000001px;
        flex-basis: 0.000000001px;
      }

      .flex-2 {
        -ms-flex: 2;
        -webkit-flex: 2;
        flex: 2;
      }

      .flex-3 {
        -ms-flex: 3;
        -webkit-flex: 3;
        flex: 3;
      }

      .flex-4 {
        -ms-flex: 4;
        -webkit-flex: 4;
        flex: 4;
      }

      .flex-5 {
        -ms-flex: 5;
        -webkit-flex: 5;
        flex: 5;
      }

      .flex-6 {
        -ms-flex: 6;
        -webkit-flex: 6;
        flex: 6;
      }

      .flex-7 {
        -ms-flex: 7;
        -webkit-flex: 7;
        flex: 7;
      }

      .flex-8 {
        -ms-flex: 8;
        -webkit-flex: 8;
        flex: 8;
      }

      .flex-9 {
        -ms-flex: 9;
        -webkit-flex: 9;
        flex: 9;
      }

      .flex-10 {
        -ms-flex: 10;
        -webkit-flex: 10;
        flex: 10;
      }

      .flex-11 {
        -ms-flex: 11;
        -webkit-flex: 11;
        flex: 11;
      }

      .flex-12 {
        -ms-flex: 12;
        -webkit-flex: 12;
        flex: 12;
      }
    </style>
  </template>
</dom-module>
<dom-module id="iron-positioning">
  <template>
    <style>
      .block {
        display: block;
      }

      [hidden] {
        display: none !important;
      }

      .invisible {
        visibility: hidden !important;
      }

      .relative {
        position: relative;
      }

      .fit {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      }

      body.fullbleed {
        margin: 0;
        height: 100vh;
      }

      .scroll {
        -webkit-overflow-scrolling: touch;
        overflow: auto;
      }

      /* fixed position */
      .fixed-bottom,
      .fixed-left,
      .fixed-right,
      .fixed-top {
        position: fixed;
      }

      .fixed-top {
        top: 0;
        left: 0;
        right: 0;
      }

      .fixed-right {
        top: 0;
        right: 0;
        bottom: 0;
      }

      .fixed-bottom {
        right: 0;
        bottom: 0;
        left: 0;
      }

      .fixed-left {
        top: 0;
        bottom: 0;
        left: 0;
      }
    </style>
  </template>
</dom-module>
`;nA.setAttribute("style","display: none;");document.head.appendChild(nA.content);var iA=ut`
<custom-style>
  <style is="custom-style">
    [hidden] {
      display: none !important;
    }
  </style>
</custom-style>
<custom-style>
  <style is="custom-style">
    html {

      --layout: {
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;
      };

      --layout-inline: {
        display: -ms-inline-flexbox;
        display: -webkit-inline-flex;
        display: inline-flex;
      };

      --layout-horizontal: {
        @apply --layout;

        -ms-flex-direction: row;
        -webkit-flex-direction: row;
        flex-direction: row;
      };

      --layout-horizontal-reverse: {
        @apply --layout;

        -ms-flex-direction: row-reverse;
        -webkit-flex-direction: row-reverse;
        flex-direction: row-reverse;
      };

      --layout-vertical: {
        @apply --layout;

        -ms-flex-direction: column;
        -webkit-flex-direction: column;
        flex-direction: column;
      };

      --layout-vertical-reverse: {
        @apply --layout;

        -ms-flex-direction: column-reverse;
        -webkit-flex-direction: column-reverse;
        flex-direction: column-reverse;
      };

      --layout-wrap: {
        -ms-flex-wrap: wrap;
        -webkit-flex-wrap: wrap;
        flex-wrap: wrap;
      };

      --layout-wrap-reverse: {
        -ms-flex-wrap: wrap-reverse;
        -webkit-flex-wrap: wrap-reverse;
        flex-wrap: wrap-reverse;
      };

      --layout-flex-auto: {
        -ms-flex: 1 1 auto;
        -webkit-flex: 1 1 auto;
        flex: 1 1 auto;
      };

      --layout-flex-none: {
        -ms-flex: none;
        -webkit-flex: none;
        flex: none;
      };

      --layout-flex: {
        -ms-flex: 1 1 0.000000001px;
        -webkit-flex: 1;
        flex: 1;
        -webkit-flex-basis: 0.000000001px;
        flex-basis: 0.000000001px;
      };

      --layout-flex-2: {
        -ms-flex: 2;
        -webkit-flex: 2;
        flex: 2;
      };

      --layout-flex-3: {
        -ms-flex: 3;
        -webkit-flex: 3;
        flex: 3;
      };

      --layout-flex-4: {
        -ms-flex: 4;
        -webkit-flex: 4;
        flex: 4;
      };

      --layout-flex-5: {
        -ms-flex: 5;
        -webkit-flex: 5;
        flex: 5;
      };

      --layout-flex-6: {
        -ms-flex: 6;
        -webkit-flex: 6;
        flex: 6;
      };

      --layout-flex-7: {
        -ms-flex: 7;
        -webkit-flex: 7;
        flex: 7;
      };

      --layout-flex-8: {
        -ms-flex: 8;
        -webkit-flex: 8;
        flex: 8;
      };

      --layout-flex-9: {
        -ms-flex: 9;
        -webkit-flex: 9;
        flex: 9;
      };

      --layout-flex-10: {
        -ms-flex: 10;
        -webkit-flex: 10;
        flex: 10;
      };

      --layout-flex-11: {
        -ms-flex: 11;
        -webkit-flex: 11;
        flex: 11;
      };

      --layout-flex-12: {
        -ms-flex: 12;
        -webkit-flex: 12;
        flex: 12;
      };

      /* alignment in cross axis */

      --layout-start: {
        -ms-flex-align: start;
        -webkit-align-items: flex-start;
        align-items: flex-start;
      };

      --layout-center: {
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
      };

      --layout-end: {
        -ms-flex-align: end;
        -webkit-align-items: flex-end;
        align-items: flex-end;
      };

      --layout-baseline: {
        -ms-flex-align: baseline;
        -webkit-align-items: baseline;
        align-items: baseline;
      };

      /* alignment in main axis */

      --layout-start-justified: {
        -ms-flex-pack: start;
        -webkit-justify-content: flex-start;
        justify-content: flex-start;
      };

      --layout-center-justified: {
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
      };

      --layout-end-justified: {
        -ms-flex-pack: end;
        -webkit-justify-content: flex-end;
        justify-content: flex-end;
      };

      --layout-around-justified: {
        -ms-flex-pack: distribute;
        -webkit-justify-content: space-around;
        justify-content: space-around;
      };

      --layout-justified: {
        -ms-flex-pack: justify;
        -webkit-justify-content: space-between;
        justify-content: space-between;
      };

      --layout-center-center: {
        @apply --layout-center;
        @apply --layout-center-justified;
      };

      /* self alignment */

      --layout-self-start: {
        -ms-align-self: flex-start;
        -webkit-align-self: flex-start;
        align-self: flex-start;
      };

      --layout-self-center: {
        -ms-align-self: center;
        -webkit-align-self: center;
        align-self: center;
      };

      --layout-self-end: {
        -ms-align-self: flex-end;
        -webkit-align-self: flex-end;
        align-self: flex-end;
      };

      --layout-self-stretch: {
        -ms-align-self: stretch;
        -webkit-align-self: stretch;
        align-self: stretch;
      };

      --layout-self-baseline: {
        -ms-align-self: baseline;
        -webkit-align-self: baseline;
        align-self: baseline;
      };

      /* multi-line alignment in main axis */

      --layout-start-aligned: {
        -ms-flex-line-pack: start;  /* IE10 */
        -ms-align-content: flex-start;
        -webkit-align-content: flex-start;
        align-content: flex-start;
      };

      --layout-end-aligned: {
        -ms-flex-line-pack: end;  /* IE10 */
        -ms-align-content: flex-end;
        -webkit-align-content: flex-end;
        align-content: flex-end;
      };

      --layout-center-aligned: {
        -ms-flex-line-pack: center;  /* IE10 */
        -ms-align-content: center;
        -webkit-align-content: center;
        align-content: center;
      };

      --layout-between-aligned: {
        -ms-flex-line-pack: justify;  /* IE10 */
        -ms-align-content: space-between;
        -webkit-align-content: space-between;
        align-content: space-between;
      };

      --layout-around-aligned: {
        -ms-flex-line-pack: distribute;  /* IE10 */
        -ms-align-content: space-around;
        -webkit-align-content: space-around;
        align-content: space-around;
      };

      /*******************************
                Other Layout
      *******************************/

      --layout-block: {
        display: block;
      };

      --layout-invisible: {
        visibility: hidden !important;
      };

      --layout-relative: {
        position: relative;
      };

      --layout-fit: {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      };

      --layout-scroll: {
        -webkit-overflow-scrolling: touch;
        overflow: auto;
      };

      --layout-fullbleed: {
        margin: 0;
        height: 100vh;
      };

      /* fixed position */

      --layout-fixed-top: {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
      };

      --layout-fixed-right: {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
      };

      --layout-fixed-bottom: {
        position: fixed;
        right: 0;
        bottom: 0;
        left: 0;
      };

      --layout-fixed-left: {
        position: fixed;
        top: 0;
        bottom: 0;
        left: 0;
      };

    }
  </style>
</custom-style>`;iA.setAttribute("style","display: none;");document.head.appendChild(iA.content);var rA=document.createElement("style");rA.textContent="[hidden] { display: none !important; }";document.head.appendChild(rA);var Ln=class{constructor(t){Ln[" "](t),this.type=t&&t.type||"default",this.key=t&&t.key,t&&"value"in t&&(this.value=t.value)}get value(){var t=this.type,e=this.key;if(t&&e)return Ln.types[t]&&Ln.types[t][e]}set value(t){var e=this.type,n=this.key;e&&n&&(e=Ln.types[e]=Ln.types[e]||{},t==null?delete e[n]:e[n]=t)}get list(){var t=this.type;if(t){var e=Ln.types[this.type];return e?Object.keys(e).map(function(n){return yq[this.type][n]},this):[]}}byKey(t){return this.key=t,this.value}};Ln[" "]=function(){};Ln.types={};var yq=Ln.types;It({is:"iron-meta",properties:{type:{type:String,value:"default"},key:{type:String},value:{type:String,notify:!0},self:{type:Boolean,observer:"_selfChanged"},__meta:{type:Boolean,computed:"__computeMeta(type, key, value)"}},hostAttributes:{hidden:!0},__computeMeta:function(i,t,e){var n=new Ln({type:i,key:t});return e!==void 0&&e!==n.value?n.value=e:this.value!==n.value&&(this.value=n.value),n},get list(){return this.__meta&&this.__meta.list},_selfChanged:function(i){i&&(this.value=this)},byKey:function(i){return new Ln({type:this.type,key:i}).value}});It({_template:ut`
    <style>
      :host {
        @apply --layout-inline;
        @apply --layout-center-center;
        position: relative;

        vertical-align: middle;

        fill: var(--iron-icon-fill-color, currentcolor);
        stroke: var(--iron-icon-stroke-color, none);

        width: var(--iron-icon-width, 24px);
        height: var(--iron-icon-height, 24px);
        @apply --iron-icon;
      }

      :host([hidden]) {
        display: none;
      }
    </style>
`,is:"iron-icon",properties:{icon:{type:String},theme:{type:String},src:{type:String},_meta:{value:fs.create("iron-meta",{type:"iconset"})}},observers:["_updateIcon(_meta, isAttached)","_updateIcon(theme, isAttached)","_srcChanged(src, isAttached)","_iconChanged(icon, isAttached)"],_DEFAULT_ICONSET:"icons",_iconChanged:function(i){var t=(i||"").split(":");this._iconName=t.pop(),this._iconsetName=t.pop()||this._DEFAULT_ICONSET,this._updateIcon()},_srcChanged:function(i){this._updateIcon()},_usesIconset:function(){return this.icon||!this.src},_updateIcon:function(){this._usesIconset()?(this._img&&this._img.parentNode&&Mt(this.root).removeChild(this._img),this._iconName===""?this._iconset&&this._iconset.removeIcon(this):this._iconsetName&&this._meta&&(this._iconset=this._meta.byKey(this._iconsetName),this._iconset?(this._iconset.applyIcon(this,this._iconName,this.theme),this.unlisten(window,"iron-iconset-added","_updateIcon")):this.listen(window,"iron-iconset-added","_updateIcon"))):(this._iconset&&this._iconset.removeIcon(this),this._img||(this._img=document.createElement("img"),this._img.style.width="100%",this._img.style.height="100%",this._img.draggable=!1),this._img.src=this.src,Mt(this.root).appendChild(this._img))}});It({is:"iron-iconset-svg",properties:{name:{type:String,observer:"_nameChanged"},size:{type:Number,value:24},rtlMirroring:{type:Boolean,value:!1},useGlobalRtlAttribute:{type:Boolean,value:!1}},created:function(){this._meta=new Ln({type:"iconset",key:null,value:null})},attached:function(){this.style.display="none"},getIconNames:function(){return this._icons=this._createIconMap(),Object.keys(this._icons).map(function(i){return this.name+":"+i},this)},applyIcon:function(i,t){this.removeIcon(i);var e=this._cloneIcon(t,this.rtlMirroring&&this._targetIsRTL(i));if(e){var n=Mt(i.root||i);return n.insertBefore(e,n.childNodes[0]),i._svgIcon=e}return null},removeIcon:function(i){i._svgIcon&&(Mt(i.root||i).removeChild(i._svgIcon),i._svgIcon=null)},_targetIsRTL:function(i){if(this.__targetIsRTL==null)if(this.useGlobalRtlAttribute){var t=document.body&&document.body.hasAttribute("dir")?document.body:document.documentElement;this.__targetIsRTL=t.getAttribute("dir")==="rtl"}else i&&i.nodeType!==Node.ELEMENT_NODE&&(i=i.host),this.__targetIsRTL=i&&window.getComputedStyle(i).direction==="rtl";return this.__targetIsRTL},_nameChanged:function(){this._meta.value=null,this._meta.key=this.name,this._meta.value=this,this.async(function(){this.fire("iron-iconset-added",this,{node:window})})},_createIconMap:function(){var i=Object.create(null);return Mt(this).querySelectorAll("[id]").forEach(function(t){i[t.id]=t}),i},_cloneIcon:function(i,t){return this._icons=this._icons||this._createIconMap(),this._prepareSvgClone(this._icons[i],this.size,t)},_prepareSvgClone:function(i,t,e){if(i){var n=i.cloneNode(!0),r=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=n.getAttribute("viewBox")||"0 0 "+t+" "+t,s="pointer-events: none; display: block; width: 100%; height: 100%;";return e&&n.hasAttribute("mirror-in-rtl")&&(s+="-webkit-transform:scale(-1,1);transform:scale(-1,1);transform-origin:center;"),r.setAttribute("viewBox",o),r.setAttribute("preserveAspectRatio","xMidYMid meet"),r.setAttribute("focusable","false"),r.style.cssText=s,r.appendChild(n).removeAttribute("id"),r}return null}});var vq=ut`<iron-iconset-svg name="image" size="24">
<svg><defs>
<g id="add-a-photo"><path d="M3 4V1h2v3h3v2H5v3H3V6H0V4h3zm3 6V7h3V4h7l1.83 2H21c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V10h3zm7 9c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-3.2-5c0 1.77 1.43 3.2 3.2 3.2s3.2-1.43 3.2-3.2-1.43-3.2-3.2-3.2-3.2 1.43-3.2 3.2z"></path></g>
<g id="add-to-photos"><path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z"></path></g>
<g id="adjust"><path d="M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3-8c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3z"></path></g>
<g id="assistant"><path d="M19 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h4l3 3 3-3h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-5.12 10.88L12 17l-1.88-4.12L6 11l4.12-1.88L12 5l1.88 4.12L18 11l-4.12 1.88z"></path></g>
<g id="assistant-photo"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"></path></g>
<g id="audiotrack"><path d="M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3h-7z"></path></g>
<g id="blur-circular"><path d="M10 9c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zM7 9.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm3 7c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm-3-3c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm3-6c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zM14 9c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0-1.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zm3 6c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm0-4c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm2-3.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm0-3.5c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path></g>
<g id="blur-linear"><path d="M5 17.5c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5-1.5.67-1.5 1.5.67 1.5 1.5 1.5zM9 13c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0-4c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zM3 21h18v-2H3v2zM5 9.5c.83 0 1.5-.67 1.5-1.5S5.83 6.5 5 6.5 3.5 7.17 3.5 8 4.17 9.5 5 9.5zm0 4c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5-1.5.67-1.5 1.5.67 1.5 1.5 1.5zM9 17c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm8-.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zM3 3v2h18V3H3zm14 5.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zm0 4c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zM13 9c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0 4c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0 4c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1z"></path></g>
<g id="blur-off"><path d="M14 7c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm-.2 4.48l.2.02c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5-1.5.67-1.5 1.5l.02.2c.09.67.61 1.19 1.28 1.28zM14 3.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zm-4 0c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zm11 7c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zM10 7c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm8 8c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0-4c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0-4c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm-4 13.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM2.5 5.27l3.78 3.78L6 9c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1c0-.1-.03-.19-.06-.28l2.81 2.81c-.71.11-1.25.73-1.25 1.47 0 .83.67 1.5 1.5 1.5.74 0 1.36-.54 1.47-1.25l2.81 2.81c-.09-.03-.18-.06-.28-.06-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1c0-.1-.03-.19-.06-.28l3.78 3.78L20 20.23 3.77 4 2.5 5.27zM10 17c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm11-3.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM6 13c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zM3 9.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm7 11c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM6 17c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm-3-3.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5z"></path></g>
<g id="blur-on"><path d="M6 13c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0-8c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm-3 .5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM6 5c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm15 5.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zM14 7c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0-3.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zm-11 10c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm7 7c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm0-17c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zM10 7c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0 5.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm8 .5c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0-8c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0-4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm3 8.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM14 17c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 3.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm-4-12c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0 8.5c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm4-4.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-4c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"></path></g>
<g id="brightness-1"><circle cx="12" cy="12" r="10"></circle></g>
<g id="brightness-2"><path d="M10 2c-1.82 0-3.53.5-5 1.35C7.99 5.08 10 8.3 10 12s-2.01 6.92-5 8.65C6.47 21.5 8.18 22 10 22c5.52 0 10-4.48 10-10S15.52 2 10 2z"></path></g>
<g id="brightness-3"><path d="M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.06 7 9.54 0 4.48-2.94 8.27-7 9.54.95.3 1.95.46 3 .46 5.52 0 10-4.48 10-10S14.52 2 9 2z"></path></g>
<g id="brightness-4"><path d="M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6z"></path></g>
<g id="brightness-5"><path d="M20 15.31L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"></path></g>
<g id="brightness-6"><path d="M20 15.31L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69zM12 18V6c3.31 0 6 2.69 6 6s-2.69 6-6 6z"></path></g>
<g id="brightness-7"><path d="M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"></path></g>
<g id="broken-image"><path d="M21 5v6.59l-3-3.01-4 4.01-4-4-4 4-3-3.01V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2zm-3 6.42l3 3.01V19c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2v-6.58l3 2.99 4-4 4 4 4-3.99z"></path></g>
<g id="brush"><path d="M7 14c-1.66 0-3 1.34-3 3 0 1.31-1.16 2-2 2 .92 1.22 2.49 2 4 2 2.21 0 4-1.79 4-4 0-1.66-1.34-3-3-3zm13.71-9.37l-1.34-1.34c-.39-.39-1.02-.39-1.41 0L9 12.25 11.75 15l8.96-8.96c.39-.39.39-1.02 0-1.41z"></path></g>
<g id="burst-mode"><path d="M1 5h2v14H1zm4 0h2v14H5zm17 0H10c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1zM11 17l2.5-3.15L15.29 16l2.5-3.22L21 17H11z"></path></g>
<g id="camera"><path d="M9.4 10.5l4.77-8.26C13.47 2.09 12.75 2 12 2c-2.4 0-4.6.85-6.32 2.25l3.66 6.35.06-.1zM21.54 9c-.92-2.92-3.15-5.26-6-6.34L11.88 9h9.66zm.26 1h-7.49l.29.5 4.76 8.25C21 16.97 22 14.61 22 12c0-.69-.07-1.35-.2-2zM8.54 12l-3.9-6.75C3.01 7.03 2 9.39 2 12c0 .69.07 1.35.2 2h7.49l-1.15-2zm-6.08 3c.92 2.92 3.15 5.26 6 6.34L12.12 15H2.46zm11.27 0l-3.9 6.76c.7.15 1.42.24 2.17.24 2.4 0 4.6-.85 6.32-2.25l-3.66-6.35-.93 1.6z"></path></g>
<g id="camera-alt"><circle cx="12" cy="12" r="3.2"></circle><path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"></path></g>
<g id="camera-front"><path d="M10 20H5v2h5v2l3-3-3-3v2zm4 0v2h5v-2h-5zM12 8c1.1 0 2-.9 2-2s-.9-2-2-2-1.99.9-1.99 2S10.9 8 12 8zm5-8H7C5.9 0 5 .9 5 2v14c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V2c0-1.1-.9-2-2-2zM7 2h10v10.5c0-1.67-3.33-2.5-5-2.5s-5 .83-5 2.5V2z"></path></g>
<g id="camera-rear"><path d="M10 20H5v2h5v2l3-3-3-3v2zm4 0v2h5v-2h-5zm3-20H7C5.9 0 5 .9 5 2v14c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V2c0-1.1-.9-2-2-2zm-5 6c-1.11 0-2-.9-2-2s.89-2 1.99-2 2 .9 2 2C14 5.1 13.1 6 12 6z"></path></g>
<g id="camera-roll"><path d="M14 5c0-1.1-.9-2-2-2h-1V2c0-.55-.45-1-1-1H6c-.55 0-1 .45-1 1v1H4c-1.1 0-2 .9-2 2v15c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2h8V5h-8zm-2 13h-2v-2h2v2zm0-9h-2V7h2v2zm4 9h-2v-2h2v2zm0-9h-2V7h2v2zm4 9h-2v-2h2v2zm0-9h-2V7h2v2z"></path></g>
<g id="center-focus-strong"><path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm-7 7H3v4c0 1.1.9 2 2 2h4v-2H5v-4zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2V5zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2zm0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2v4z"></path></g>
<g id="center-focus-weak"><path d="M5 15H3v4c0 1.1.9 2 2 2h4v-2H5v-4zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2V5zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2zm0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2v4zM12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"></path></g>
<g id="collections"><path d="M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2zm-11-4l2.03 2.71L16 11l4 5H8l3-4zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6H2z"></path></g>
<g id="collections-bookmark"><path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 10l-2.5-1.5L15 12V4h5v8z"></path></g>
<g id="color-lens"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"></path></g>
<g id="colorize"><path d="M20.71 5.63l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"></path></g>
<g id="compare"><path d="M10 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h5v2h2V1h-2v2zm0 15H5l5-6v6zm9-15h-5v2h5v13l-5-6v9h5c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></g>
<g id="control-point"><path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"></path></g>
<g id="control-point-duplicate"><path d="M16 8h-2v3h-3v2h3v3h2v-3h3v-2h-3zM2 12c0-2.79 1.64-5.2 4.01-6.32V3.52C2.52 4.76 0 8.09 0 12s2.52 7.24 6.01 8.48v-2.16C3.64 17.2 2 14.79 2 12zm13-9c-4.96 0-9 4.04-9 9s4.04 9 9 9 9-4.04 9-9-4.04-9-9-9zm0 16c-3.86 0-7-3.14-7-7s3.14-7 7-7 7 3.14 7 7-3.14 7-7 7z"></path></g>
<g id="crop"><path d="M17 15h2V7c0-1.1-.9-2-2-2H9v2h8v8zM7 17V1H5v4H1v2h4v10c0 1.1.9 2 2 2h10v4h2v-4h4v-2H7z"></path></g>
<g id="crop-16-9"><path d="M19 6H5c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 10H5V8h14v8z"></path></g>
<g id="crop-3-2"><path d="M19 4H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H5V6h14v12z"></path></g>
<g id="crop-5-4"><path d="M19 5H5c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 12H5V7h14v10z"></path></g>
<g id="crop-7-5"><path d="M19 7H5c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2zm0 8H5V9h14v6z"></path></g>
<g id="crop-din"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"></path></g>
<g id="crop-free"><path d="M3 5v4h2V5h4V3H5c-1.1 0-2 .9-2 2zm2 10H3v4c0 1.1.9 2 2 2h4v-2H5v-4zm14 4h-4v2h4c1.1 0 2-.9 2-2v-4h-2v4zm0-16h-4v2h4v4h2V5c0-1.1-.9-2-2-2z"></path></g>
<g id="crop-landscape"><path d="M19 5H5c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 12H5V7h14v10z"></path></g>
<g id="crop-original"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zm-5.04-6.71l-2.75 3.54-1.96-2.36L6.5 17h11l-3.54-4.71z"></path></g>
<g id="crop-portrait"><path d="M17 3H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H7V5h10v14z"></path></g>
<g id="crop-rotate"><path d="M7.47 21.49C4.2 19.93 1.86 16.76 1.5 13H0c.51 6.16 5.66 11 11.95 11 .23 0 .44-.02.66-.03L8.8 20.15l-1.33 1.34zM12.05 0c-.23 0-.44.02-.66.04l3.81 3.81 1.33-1.33C19.8 4.07 22.14 7.24 22.5 11H24c-.51-6.16-5.66-11-11.95-11zM16 14h2V8c0-1.11-.9-2-2-2h-6v2h6v6zm-8 2V4H6v2H4v2h2v8c0 1.1.89 2 2 2h8v2h2v-2h2v-2H8z"></path></g>
<g id="crop-square"><path d="M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H6V6h12v12z"></path></g>
<g id="dehaze"><path d="M2 15.5v2h20v-2H2zm0-5v2h20v-2H2zm0-5v2h20v-2H2z"></path></g>
<g id="details"><path d="M3 4l9 16 9-16H3zm3.38 2h11.25L12 16 6.38 6z"></path></g>
<g id="edit"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></g>
<g id="exposure"><path d="M15 17v2h2v-2h2v-2h-2v-2h-2v2h-2v2h2zm5-15H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM5 5h6v2H5V5zm15 15H4L20 4v16z"></path></g>
<g id="exposure-neg-1"><path d="M4 11v2h8v-2H4zm15 7h-2V7.38L14 8.4V6.7L18.7 5h.3v13z"></path></g>
<g id="exposure-neg-2"><path d="M15.05 16.29l2.86-3.07c.38-.39.72-.79 1.04-1.18.32-.39.59-.78.82-1.17.23-.39.41-.78.54-1.17s.19-.79.19-1.18c0-.53-.09-1.02-.27-1.46-.18-.44-.44-.81-.78-1.11-.34-.31-.77-.54-1.26-.71-.51-.16-1.08-.24-1.72-.24-.69 0-1.31.11-1.85.32-.54.21-1 .51-1.36.88-.37.37-.65.8-.84 1.3-.18.47-.27.97-.28 1.5h2.14c.01-.31.05-.6.13-.87.09-.29.23-.54.4-.75.18-.21.41-.37.68-.49.27-.12.6-.18.96-.18.31 0 .58.05.81.15.23.1.43.25.59.43.16.18.28.4.37.65.08.25.13.52.13.81 0 .22-.03.43-.08.65-.06.22-.15.45-.29.7-.14.25-.32.53-.56.83-.23.3-.52.65-.88 1.03l-4.17 4.55V18H21v-1.71h-5.95zM2 11v2h8v-2H2z"></path></g>
<g id="exposure-plus-1"><path d="M10 7H8v4H4v2h4v4h2v-4h4v-2h-4V7zm10 11h-2V7.38L15 8.4V6.7L19.7 5h.3v13z"></path></g>
<g id="exposure-plus-2"><path d="M16.05 16.29l2.86-3.07c.38-.39.72-.79 1.04-1.18.32-.39.59-.78.82-1.17.23-.39.41-.78.54-1.17.13-.39.19-.79.19-1.18 0-.53-.09-1.02-.27-1.46-.18-.44-.44-.81-.78-1.11-.34-.31-.77-.54-1.26-.71-.51-.16-1.08-.24-1.72-.24-.69 0-1.31.11-1.85.32-.54.21-1 .51-1.36.88-.37.37-.65.8-.84 1.3-.18.47-.27.97-.28 1.5h2.14c.01-.31.05-.6.13-.87.09-.29.23-.54.4-.75.18-.21.41-.37.68-.49.27-.12.6-.18.96-.18.31 0 .58.05.81.15.23.1.43.25.59.43.16.18.28.4.37.65.08.25.13.52.13.81 0 .22-.03.43-.08.65-.06.22-.15.45-.29.7-.14.25-.32.53-.56.83-.23.3-.52.65-.88 1.03l-4.17 4.55V18H22v-1.71h-5.95zM8 7H6v4H2v2h4v4h2v-4h4v-2H8V7z"></path></g>
<g id="exposure-zero"><path d="M16.14 12.5c0 1-.1 1.85-.3 2.55-.2.7-.48 1.27-.83 1.7-.36.44-.79.75-1.3.95-.51.2-1.07.3-1.7.3-.62 0-1.18-.1-1.69-.3-.51-.2-.95-.51-1.31-.95-.36-.44-.65-1.01-.85-1.7-.2-.7-.3-1.55-.3-2.55v-2.04c0-1 .1-1.85.3-2.55.2-.7.48-1.26.84-1.69.36-.43.8-.74 1.31-.93C10.81 5.1 11.38 5 12 5c.63 0 1.19.1 1.7.29.51.19.95.5 1.31.93.36.43.64.99.84 1.69.2.7.3 1.54.3 2.55v2.04zm-2.11-2.36c0-.64-.05-1.18-.13-1.62-.09-.44-.22-.79-.4-1.06-.17-.27-.39-.46-.64-.58-.25-.13-.54-.19-.86-.19-.32 0-.61.06-.86.18s-.47.31-.64.58c-.17.27-.31.62-.4 1.06s-.13.98-.13 1.62v2.67c0 .64.05 1.18.14 1.62.09.45.23.81.4 1.09s.39.48.64.61.54.19.87.19c.33 0 .62-.06.87-.19s.46-.33.63-.61c.17-.28.3-.64.39-1.09.09-.45.13-.99.13-1.62v-2.66z"></path></g>
<g id="filter"><path d="M15.96 10.29l-2.75 3.54-1.96-2.36L8.5 15h11l-3.54-4.71zM3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm18-4H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14z"></path></g>
<g id="filter-1"><path d="M3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm11 10h2V5h-4v2h2v8zm7-14H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14z"></path></g>
<g id="filter-2"><path d="M3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm18-4H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14zm-4-4h-4v-2h2c1.1 0 2-.89 2-2V7c0-1.11-.9-2-2-2h-4v2h4v2h-2c-1.1 0-2 .89-2 2v4h6v-2z"></path></g>
<g id="filter-3"><path d="M21 1H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14zM3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm14 8v-1.5c0-.83-.67-1.5-1.5-1.5.83 0 1.5-.67 1.5-1.5V7c0-1.11-.9-2-2-2h-4v2h4v2h-2v2h2v2h-4v2h4c1.1 0 2-.89 2-2z"></path></g>
<g id="filter-4"><path d="M3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm12 10h2V5h-2v4h-2V5h-2v6h4v4zm6-14H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14z"></path></g>
<g id="filter-5"><path d="M21 1H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14zM3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm14 8v-2c0-1.11-.9-2-2-2h-2V7h4V5h-6v6h4v2h-4v2h4c1.1 0 2-.89 2-2z"></path></g>
<g id="filter-6"><path d="M3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm18-4H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14zm-8-2h2c1.1 0 2-.89 2-2v-2c0-1.11-.9-2-2-2h-2V7h4V5h-4c-1.1 0-2 .89-2 2v6c0 1.11.9 2 2 2zm0-4h2v2h-2v-2z"></path></g>
<g id="filter-7"><path d="M3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm18-4H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14zm-8-2l4-8V5h-6v2h4l-4 8h2z"></path></g>
<g id="filter-8"><path d="M3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm18-4H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14zm-8-2h2c1.1 0 2-.89 2-2v-1.5c0-.83-.67-1.5-1.5-1.5.83 0 1.5-.67 1.5-1.5V7c0-1.11-.9-2-2-2h-2c-1.1 0-2 .89-2 2v1.5c0 .83.67 1.5 1.5 1.5-.83 0-1.5.67-1.5 1.5V13c0 1.11.9 2 2 2zm0-8h2v2h-2V7zm0 4h2v2h-2v-2z"></path></g>
<g id="filter-9"><path d="M3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm18-4H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14zM15 5h-2c-1.1 0-2 .89-2 2v2c0 1.11.9 2 2 2h2v2h-4v2h4c1.1 0 2-.89 2-2V7c0-1.11-.9-2-2-2zm0 4h-2V7h2v2z"></path></g>
<g id="filter-9-plus"><path d="M3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm11 7V8c0-1.11-.9-2-2-2h-1c-1.1 0-2 .89-2 2v1c0 1.11.9 2 2 2h1v1H9v2h3c1.1 0 2-.89 2-2zm-3-3V8h1v1h-1zm10-8H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 8h-2V7h-2v2h-2v2h2v2h2v-2h2v6H7V3h14v6z"></path></g>
<g id="filter-b-and-w"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16l-7-8v8H5l7-8V5h7v14z"></path></g>
<g id="filter-center-focus"><path d="M5 15H3v4c0 1.1.9 2 2 2h4v-2H5v-4zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2V5zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2zm0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2v4zM12 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></g>
<g id="filter-drama"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.61 5.64 5.36 8.04 2.35 8.36 0 10.9 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM19 18H6c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4h2c0-2.76-1.86-5.08-4.4-5.78C8.61 6.88 10.2 6 12 6c3.03 0 5.5 2.47 5.5 5.5v.5H19c1.65 0 3 1.35 3 3s-1.35 3-3 3z"></path></g>
<g id="filter-frames"><path d="M20 4h-4l-4-4-4 4H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H4V6h4.52l3.52-3.5L15.52 6H20v14zM18 8H6v10h12"></path></g>
<g id="filter-hdr"><path d="M14 6l-3.75 5 2.85 3.8-1.6 1.2C9.81 13.75 7 10 7 10l-6 8h22L14 6z"></path></g>
<g id="filter-none"><path d="M3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm18-4H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14z"></path></g>
<g id="filter-tilt-shift"><path d="M11 4.07V2.05c-2.01.2-3.84 1-5.32 2.21L7.1 5.69c1.11-.86 2.44-1.44 3.9-1.62zm7.32.19C16.84 3.05 15.01 2.25 13 2.05v2.02c1.46.18 2.79.76 3.9 1.62l1.42-1.43zM19.93 11h2.02c-.2-2.01-1-3.84-2.21-5.32L18.31 7.1c.86 1.11 1.44 2.44 1.62 3.9zM5.69 7.1L4.26 5.68C3.05 7.16 2.25 8.99 2.05 11h2.02c.18-1.46.76-2.79 1.62-3.9zM4.07 13H2.05c.2 2.01 1 3.84 2.21 5.32l1.43-1.43c-.86-1.1-1.44-2.43-1.62-3.89zM15 12c0-1.66-1.34-3-3-3s-3 1.34-3 3 1.34 3 3 3 3-1.34 3-3zm3.31 4.9l1.43 1.43c1.21-1.48 2.01-3.32 2.21-5.32h-2.02c-.18 1.45-.76 2.78-1.62 3.89zM13 19.93v2.02c2.01-.2 3.84-1 5.32-2.21l-1.43-1.43c-1.1.86-2.43 1.44-3.89 1.62zm-7.32-.19C7.16 20.95 9 21.75 11 21.95v-2.02c-1.46-.18-2.79-.76-3.9-1.62l-1.42 1.43z"></path></g>
<g id="filter-vintage"><path d="M18.7 12.4c-.28-.16-.57-.29-.86-.4.29-.11.58-.24.86-.4 1.92-1.11 2.99-3.12 3-5.19-1.79-1.03-4.07-1.11-6 0-.28.16-.54.35-.78.54.05-.31.08-.63.08-.95 0-2.22-1.21-4.15-3-5.19C10.21 1.85 9 3.78 9 6c0 .32.03.64.08.95-.24-.2-.5-.39-.78-.55-1.92-1.11-4.2-1.03-6 0 0 2.07 1.07 4.08 3 5.19.28.16.57.29.86.4-.29.11-.58.24-.86.4-1.92 1.11-2.99 3.12-3 5.19 1.79 1.03 4.07 1.11 6 0 .28-.16.54-.35.78-.54-.05.32-.08.64-.08.96 0 2.22 1.21 4.15 3 5.19 1.79-1.04 3-2.97 3-5.19 0-.32-.03-.64-.08-.95.24.2.5.38.78.54 1.92 1.11 4.2 1.03 6 0-.01-2.07-1.08-4.08-3-5.19zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z"></path></g>
<g id="flare"><path d="M7 11H1v2h6v-2zm2.17-3.24L7.05 5.64 5.64 7.05l2.12 2.12 1.41-1.41zM13 1h-2v6h2V1zm5.36 6.05l-1.41-1.41-2.12 2.12 1.41 1.41 2.12-2.12zM17 11v2h6v-2h-6zm-5-2c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zm2.83 7.24l2.12 2.12 1.41-1.41-2.12-2.12-1.41 1.41zm-9.19.71l1.41 1.41 2.12-2.12-1.41-1.41-2.12 2.12zM11 23h2v-6h-2v6z"></path></g>
<g id="flash-auto"><path d="M3 2v12h3v9l7-12H9l4-9H3zm16 0h-2l-3.2 9h1.9l.7-2h3.2l.7 2h1.9L19 2zm-2.15 5.65L18 4l1.15 3.65h-2.3z"></path></g>
<g id="flash-off"><path d="M3.27 3L2 4.27l5 5V13h3v9l3.58-6.14L17.73 20 19 18.73 3.27 3zM17 10h-4l4-8H7v2.18l8.46 8.46L17 10z"></path></g>
<g id="flash-on"><path d="M7 2v11h3v9l7-12h-4l4-8z"></path></g>
<g id="flip"><path d="M15 21h2v-2h-2v2zm4-12h2V7h-2v2zM3 5v14c0 1.1.9 2 2 2h4v-2H5V5h4V3H5c-1.1 0-2 .9-2 2zm16-2v2h2c0-1.1-.9-2-2-2zm-8 20h2V1h-2v22zm8-6h2v-2h-2v2zM15 5h2V3h-2v2zm4 8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2z"></path></g>
<g id="gradient"><path d="M11 9h2v2h-2zm-2 2h2v2H9zm4 0h2v2h-2zm2-2h2v2h-2zM7 9h2v2H7zm12-6H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 18H7v-2h2v2zm4 0h-2v-2h2v2zm4 0h-2v-2h2v2zm2-7h-2v2h2v2h-2v-2h-2v2h-2v-2h-2v2H9v-2H7v2H5v-2h2v-2H5V5h14v6z"></path></g>
<g id="grain"><path d="M10 12c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM6 8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12-8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm-4 8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm4-4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-4-4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-4-4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></g>
<g id="grid-off"><path d="M8 4v1.45l2 2V4h4v4h-3.45l2 2H14v1.45l2 2V10h4v4h-3.45l2 2H20v1.45l2 2V4c0-1.1-.9-2-2-2H4.55l2 2H8zm8 0h4v4h-4V4zM1.27 1.27L0 2.55l2 2V20c0 1.1.9 2 2 2h15.46l2 2 1.27-1.27L1.27 1.27zM10 12.55L11.45 14H10v-1.45zm-6-6L5.45 8H4V6.55zM8 20H4v-4h4v4zm0-6H4v-4h3.45l.55.55V14zm6 6h-4v-4h3.45l.55.54V20zm2 0v-1.46L17.46 20H16z"></path></g>
<g id="grid-on"><path d="M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 20H4v-4h4v4zm0-6H4v-4h4v4zm0-6H4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4z"></path></g>
<g id="hdr-off"><path d="M17.5 15v-2h1.1l.9 2H21l-.9-2.1c.5-.2.9-.8.9-1.4v-1c0-.8-.7-1.5-1.5-1.5H16v4.9l1.1 1.1h.4zm0-4.5h2v1h-2v-1zm-4.5 0v.4l1.5 1.5v-1.9c0-.8-.7-1.5-1.5-1.5h-1.9l1.5 1.5h.4zm-3.5-1l-7-7-1.1 1L6.9 9h-.4v2h-2V9H3v6h1.5v-2.5h2V15H8v-4.9l1.5 1.5V15h3.4l7.6 7.6 1.1-1.1-12.1-12z"></path></g>
<g id="hdr-on"><path d="M21 11.5v-1c0-.8-.7-1.5-1.5-1.5H16v6h1.5v-2h1.1l.9 2H21l-.9-2.1c.5-.3.9-.8.9-1.4zm-1.5 0h-2v-1h2v1zm-13-.5h-2V9H3v6h1.5v-2.5h2V15H8V9H6.5v2zM13 9H9.5v6H13c.8 0 1.5-.7 1.5-1.5v-3c0-.8-.7-1.5-1.5-1.5zm0 4.5h-2v-3h2v3z"></path></g>
<g id="hdr-strong"><path d="M17 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zM5 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"></path></g>
<g id="hdr-weak"><path d="M5 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm12-2c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm0 10c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z"></path></g>
<g id="healing"><path d="M17.73 12.02l3.98-3.98c.39-.39.39-1.02 0-1.41l-4.34-4.34c-.39-.39-1.02-.39-1.41 0l-3.98 3.98L8 2.29C7.8 2.1 7.55 2 7.29 2c-.25 0-.51.1-.7.29L2.25 6.63c-.39.39-.39 1.02 0 1.41l3.98 3.98L2.25 16c-.39.39-.39 1.02 0 1.41l4.34 4.34c.39.39 1.02.39 1.41 0l3.98-3.98 3.98 3.98c.2.2.45.29.71.29.26 0 .51-.1.71-.29l4.34-4.34c.39-.39.39-1.02 0-1.41l-3.99-3.98zM12 9c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm-4.71 1.96L3.66 7.34l3.63-3.63 3.62 3.62-3.62 3.63zM10 13c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm2 2c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm2-4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2.66 9.34l-3.63-3.62 3.63-3.63 3.62 3.62-3.62 3.63z"></path></g>
<g id="image"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"></path></g>
<g id="image-aspect-ratio"><path d="M16 10h-2v2h2v-2zm0 4h-2v2h2v-2zm-8-4H6v2h2v-2zm4 0h-2v2h2v-2zm8-6H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V6h16v12z"></path></g>
<g id="iso"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5.5 7.5h2v-2H9v2h2V9H9v2H7.5V9h-2V7.5zM19 19H5L19 5v14zm-2-2v-1.5h-5V17h5z"></path></g>
<g id="landscape"><path d="M14 6l-3.75 5 2.85 3.8-1.6 1.2C9.81 13.75 7 10 7 10l-6 8h22L14 6z"></path></g>
<g id="leak-add"><path d="M6 3H3v3c1.66 0 3-1.34 3-3zm8 0h-2c0 4.97-4.03 9-9 9v2c6.08 0 11-4.93 11-11zm-4 0H8c0 2.76-2.24 5-5 5v2c3.87 0 7-3.13 7-7zm0 18h2c0-4.97 4.03-9 9-9v-2c-6.07 0-11 4.93-11 11zm8 0h3v-3c-1.66 0-3 1.34-3 3zm-4 0h2c0-2.76 2.24-5 5-5v-2c-3.87 0-7 3.13-7 7z"></path></g>
<g id="leak-remove"><path d="M10 3H8c0 .37-.04.72-.12 1.06l1.59 1.59C9.81 4.84 10 3.94 10 3zM3 4.27l2.84 2.84C5.03 7.67 4.06 8 3 8v2c1.61 0 3.09-.55 4.27-1.46L8.7 9.97C7.14 11.24 5.16 12 3 12v2c2.71 0 5.19-.99 7.11-2.62l2.5 2.5C10.99 15.81 10 18.29 10 21h2c0-2.16.76-4.14 2.03-5.69l1.43 1.43C14.55 17.91 14 19.39 14 21h2c0-1.06.33-2.03.89-2.84L19.73 21 21 19.73 4.27 3 3 4.27zM14 3h-2c0 1.5-.37 2.91-1.02 4.16l1.46 1.46C13.42 6.98 14 5.06 14 3zm5.94 13.12c.34-.08.69-.12 1.06-.12v-2c-.94 0-1.84.19-2.66.52l1.6 1.6zm-4.56-4.56l1.46 1.46C18.09 12.37 19.5 12 21 12v-2c-2.06 0-3.98.58-5.62 1.56z"></path></g>
<g id="lens"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"></path></g>
<g id="linked-camera"><circle cx="12" cy="14" r="3.2"></circle><path d="M16 3.33c2.58 0 4.67 2.09 4.67 4.67H22c0-3.31-2.69-6-6-6v1.33M16 6c1.11 0 2 .89 2 2h1.33c0-1.84-1.49-3.33-3.33-3.33V6"></path><path d="M17 9c0-1.11-.89-2-2-2V4H9L7.17 6H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9h-5zm-5 10c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"></path></g>
<g id="looks"><path d="M12 10c-3.86 0-7 3.14-7 7h2c0-2.76 2.24-5 5-5s5 2.24 5 5h2c0-3.86-3.14-7-7-7zm0-4C5.93 6 1 10.93 1 17h2c0-4.96 4.04-9 9-9s9 4.04 9 9h2c0-6.07-4.93-11-11-11z"></path></g>
<g id="looks-3"><path d="M19.01 3h-14c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4 7.5c0 .83-.67 1.5-1.5 1.5.83 0 1.5.67 1.5 1.5V15c0 1.11-.9 2-2 2h-4v-2h4v-2h-2v-2h2V9h-4V7h4c1.1 0 2 .89 2 2v1.5z"></path></g>
<g id="looks-4"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4 14h-2v-4H9V7h2v4h2V7h2v10z"></path></g>
<g id="looks-5"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4 6h-4v2h2c1.1 0 2 .89 2 2v2c0 1.11-.9 2-2 2H9v-2h4v-2H9V7h6v2z"></path></g>
<g id="looks-6"><path d="M11 15h2v-2h-2v2zm8-12H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4 6h-4v2h2c1.1 0 2 .89 2 2v2c0 1.11-.9 2-2 2h-2c-1.1 0-2-.89-2-2V9c0-1.11.9-2 2-2h4v2z"></path></g>
<g id="looks-one"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14h-2V9h-2V7h4v10z"></path></g>
<g id="looks-two"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4 8c0 1.11-.9 2-2 2h-2v2h4v2H9v-4c0-1.11.9-2 2-2h2V9H9V7h4c1.1 0 2 .89 2 2v2z"></path></g>
<g id="loupe"><path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.49 2 2 6.49 2 12s4.49 10 10 10h8c1.1 0 2-.9 2-2v-8c0-5.51-4.49-10-10-10zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"></path></g>
<g id="monochrome-photos"><path d="M20 5h-3.2L15 3H9L7.2 5H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 14h-8v-1c-2.8 0-5-2.2-5-5s2.2-5 5-5V7h8v12zm-3-6c0-2.8-2.2-5-5-5v1.8c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2V18c2.8 0 5-2.2 5-5zm-8.2 0c0 1.8 1.4 3.2 3.2 3.2V9.8c-1.8 0-3.2 1.4-3.2 3.2z"></path></g>
<g id="movie-creation"><path d="M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z"></path></g>
<g id="movie-filter"><path d="M18 4l2 3h-3l-2-3h-2l2 3h-3l-2-3H8l2 3H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4zm-6.75 11.25L10 18l-1.25-2.75L6 14l2.75-1.25L10 10l1.25 2.75L14 14l-2.75 1.25zm5.69-3.31L16 14l-.94-2.06L13 11l2.06-.94L16 8l.94 2.06L19 11l-2.06.94z"></path></g>
<g id="music-note"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"></path></g>
<g id="nature"><path d="M13 16.12c3.47-.41 6.17-3.36 6.17-6.95 0-3.87-3.13-7-7-7s-7 3.13-7 7c0 3.47 2.52 6.34 5.83 6.89V20H5v2h14v-2h-6v-3.88z"></path></g>
<g id="nature-people"><path d="M22.17 9.17c0-3.87-3.13-7-7-7s-7 3.13-7 7c0 3.47 2.52 6.34 5.83 6.89V20H6v-3h1v-4c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v4h1v5h16v-2h-3v-3.88c3.47-.41 6.17-3.36 6.17-6.95zM4.5 11c.83 0 1.5-.67 1.5-1.5S5.33 8 4.5 8 3 8.67 3 9.5 3.67 11 4.5 11z"></path></g>
<g id="navigate-before"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></g>
<g id="navigate-next"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></g>
<g id="palette"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"></path></g>
<g id="panorama"><path d="M23 18V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zM8.5 12.5l2.5 3.01L14.5 11l4.5 6H5l3.5-4.5z"></path></g>
<g id="panorama-fish-eye"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"></path></g>
<g id="panorama-horizontal"><path d="M20 6.54v10.91c-2.6-.77-5.28-1.16-8-1.16-2.72 0-5.4.39-8 1.16V6.54c2.6.77 5.28 1.16 8 1.16 2.72.01 5.4-.38 8-1.16M21.43 4c-.1 0-.2.02-.31.06C18.18 5.16 15.09 5.7 12 5.7c-3.09 0-6.18-.55-9.12-1.64-.11-.04-.22-.06-.31-.06-.34 0-.57.23-.57.63v14.75c0 .39.23.62.57.62.1 0 .2-.02.31-.06 2.94-1.1 6.03-1.64 9.12-1.64 3.09 0 6.18.55 9.12 1.64.11.04.21.06.31.06.33 0 .57-.23.57-.63V4.63c0-.4-.24-.63-.57-.63z"></path></g>
<g id="panorama-vertical"><path d="M19.94 21.12c-1.1-2.94-1.64-6.03-1.64-9.12 0-3.09.55-6.18 1.64-9.12.04-.11.06-.22.06-.31 0-.34-.23-.57-.63-.57H4.63c-.4 0-.63.23-.63.57 0 .1.02.2.06.31C5.16 5.82 5.71 8.91 5.71 12c0 3.09-.55 6.18-1.64 9.12-.05.11-.07.22-.07.31 0 .33.23.57.63.57h14.75c.39 0 .63-.24.63-.57-.01-.1-.03-.2-.07-.31zM6.54 20c.77-2.6 1.16-5.28 1.16-8 0-2.72-.39-5.4-1.16-8h10.91c-.77 2.6-1.16 5.28-1.16 8 0 2.72.39 5.4 1.16 8H6.54z"></path></g>
<g id="panorama-wide-angle"><path d="M12 6c2.45 0 4.71.2 7.29.64.47 1.78.71 3.58.71 5.36 0 1.78-.24 3.58-.71 5.36-2.58.44-4.84.64-7.29.64s-4.71-.2-7.29-.64C4.24 15.58 4 13.78 4 12c0-1.78.24-3.58.71-5.36C7.29 6.2 9.55 6 12 6m0-2c-2.73 0-5.22.24-7.95.72l-.93.16-.25.9C2.29 7.85 2 9.93 2 12s.29 4.15.87 6.22l.25.89.93.16c2.73.49 5.22.73 7.95.73s5.22-.24 7.95-.72l.93-.16.25-.89c.58-2.08.87-4.16.87-6.23s-.29-4.15-.87-6.22l-.25-.89-.93-.16C17.22 4.24 14.73 4 12 4z"></path></g>
<g id="photo"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"></path></g>
<g id="photo-album"><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4zm0 15l3-3.86 2.14 2.58 3-3.86L18 19H6z"></path></g>
<g id="photo-camera"><circle cx="12" cy="12" r="3.2"></circle><path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"></path></g>
<g id="photo-filter"><path d="M19.02 10v9H5V5h9V3H5.02c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-9h-2zM17 10l.94-2.06L20 7l-2.06-.94L17 4l-.94 2.06L14 7l2.06.94zm-3.75.75L12 8l-1.25 2.75L8 12l2.75 1.25L12 16l1.25-2.75L16 12z"></path></g>
<g id="photo-library"><path d="M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2zm-11-4l2.03 2.71L16 11l4 5H8l3-4zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6H2z"></path></g>
<g id="photo-size-select-actual"><path d="M21 3H3C2 3 1 4 1 5v14c0 1.1.9 2 2 2h18c1 0 2-1 2-2V5c0-1-1-2-2-2zM5 17l3.5-4.5 2.5 3.01L14.5 11l4.5 6H5z"></path></g>
<g id="photo-size-select-large"><path d="M21 15h2v2h-2v-2zm0-4h2v2h-2v-2zm2 8h-2v2c1 0 2-1 2-2zM13 3h2v2h-2V3zm8 4h2v2h-2V7zm0-4v2h2c0-1-1-2-2-2zM1 7h2v2H1V7zm16-4h2v2h-2V3zm0 16h2v2h-2v-2zM3 3C2 3 1 4 1 5h2V3zm6 0h2v2H9V3zM5 3h2v2H5V3zm-4 8v8c0 1.1.9 2 2 2h12V11H1zm2 8l2.5-3.21 1.79 2.15 2.5-3.22L13 19H3z"></path></g>
<g id="photo-size-select-small"><path d="M23 15h-2v2h2v-2zm0-4h-2v2h2v-2zm0 8h-2v2c1 0 2-1 2-2zM15 3h-2v2h2V3zm8 4h-2v2h2V7zm-2-4v2h2c0-1-1-2-2-2zM3 21h8v-6H1v4c0 1.1.9 2 2 2zM3 7H1v2h2V7zm12 12h-2v2h2v-2zm4-16h-2v2h2V3zm0 16h-2v2h2v-2zM3 3C2 3 1 4 1 5h2V3zm0 8H1v2h2v-2zm8-8H9v2h2V3zM7 3H5v2h2V3z"></path></g>
<g id="picture-as-pdf"><path d="M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5v1zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5v3zm4-3H19v1h1.5V11H19v2h-1.5V7h3v1.5zM9 9.5h1v-1H9v1zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm10 5.5h1v-3h-1v3z"></path></g>
<g id="portrait"><path d="M12 12.25c1.24 0 2.25-1.01 2.25-2.25S13.24 7.75 12 7.75 9.75 8.76 9.75 10s1.01 2.25 2.25 2.25zm4.5 4c0-1.5-3-2.25-4.5-2.25s-4.5.75-4.5 2.25V17h9v-.75zM19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"></path></g>
<g id="remove-red-eye"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></g>
<g id="rotate-90-degrees-ccw"><path d="M7.34 6.41L.86 12.9l6.49 6.48 6.49-6.48-6.5-6.49zM3.69 12.9l3.66-3.66L11 12.9l-3.66 3.66-3.65-3.66zm15.67-6.26C17.61 4.88 15.3 4 13 4V.76L8.76 5 13 9.24V6c1.79 0 3.58.68 4.95 2.05 2.73 2.73 2.73 7.17 0 9.9C16.58 19.32 14.79 20 13 20c-.97 0-1.94-.21-2.84-.61l-1.49 1.49C10.02 21.62 11.51 22 13 22c2.3 0 4.61-.88 6.36-2.64 3.52-3.51 3.52-9.21 0-12.72z"></path></g>
<g id="rotate-left"><path d="M7.11 8.53L5.7 7.11C4.8 8.27 4.24 9.61 4.07 11h2.02c.14-.87.49-1.72 1.02-2.47zM6.09 13H4.07c.17 1.39.72 2.73 1.62 3.89l1.41-1.42c-.52-.75-.87-1.59-1.01-2.47zm1.01 5.32c1.16.9 2.51 1.44 3.9 1.61V17.9c-.87-.15-1.71-.49-2.46-1.03L7.1 18.32zM13 4.07V1L8.45 5.55 13 10V6.09c2.84.48 5 2.94 5 5.91s-2.16 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93s-3.05-7.44-7-7.93z"></path></g>
<g id="rotate-right"><path d="M15.55 5.55L11 1v3.07C7.06 4.56 4 7.92 4 12s3.05 7.44 7 7.93v-2.02c-2.84-.48-5-2.94-5-5.91s2.16-5.43 5-5.91V10l4.55-4.45zM19.93 11c-.17-1.39-.72-2.73-1.62-3.89l-1.42 1.42c.54.75.88 1.6 1.02 2.47h2.02zM13 17.9v2.02c1.39-.17 2.74-.71 3.9-1.61l-1.44-1.44c-.75.54-1.59.89-2.46 1.03zm3.89-2.42l1.42 1.41c.9-1.16 1.45-2.5 1.62-3.89h-2.02c-.14.87-.48 1.72-1.02 2.48z"></path></g>
<g id="slideshow"><path d="M10 8v8l5-4-5-4zm9-5H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"></path></g>
<g id="straighten"><path d="M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 10H3V8h2v4h2V8h2v4h2V8h2v4h2V8h2v4h2V8h2v8z"></path></g>
<g id="style"><path d="M2.53 19.65l1.34.56v-9.03l-2.43 5.86c-.41 1.02.08 2.19 1.09 2.61zm19.5-3.7L17.07 3.98c-.31-.75-1.04-1.21-1.81-1.23-.26 0-.53.04-.79.15L7.1 5.95c-.75.31-1.21 1.03-1.23 1.8-.01.27.04.54.15.8l4.96 11.97c.31.76 1.05 1.22 1.83 1.23.26 0 .52-.05.77-.15l7.36-3.05c1.02-.42 1.51-1.59 1.09-2.6zM7.88 8.75c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-2 11c0 1.1.9 2 2 2h1.45l-3.45-8.34v6.34z"></path></g>
<g id="switch-camera"><path d="M20 4h-3.17L15 2H9L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 11.5V13H9v2.5L5.5 12 9 8.5V11h6V8.5l3.5 3.5-3.5 3.5z"></path></g>
<g id="switch-video"><path d="M18 9.5V6c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-3.5l4 4v-13l-4 4zm-5 6V13H7v2.5L3.5 12 7 8.5V11h6V8.5l3.5 3.5-3.5 3.5z"></path></g>
<g id="tag-faces"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"></path></g>
<g id="texture"><path d="M19.51 3.08L3.08 19.51c.09.34.27.65.51.9.25.24.56.42.9.51L20.93 4.49c-.19-.69-.73-1.23-1.42-1.41zM11.88 3L3 11.88v2.83L14.71 3h-2.83zM5 3c-1.1 0-2 .9-2 2v2l4-4H5zm14 18c.55 0 1.05-.22 1.41-.59.37-.36.59-.86.59-1.41v-2l-4 4h2zm-9.71 0h2.83L21 12.12V9.29L9.29 21z"></path></g>
<g id="timelapse"><path d="M16.24 7.76C15.07 6.59 13.54 6 12 6v6l-4.24 4.24c2.34 2.34 6.14 2.34 8.49 0 2.34-2.34 2.34-6.14-.01-8.48zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"></path></g>
<g id="timer"><path d="M15 1H9v2h6V1zm-4 13h2V8h-2v6zm8.03-6.61l1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61zM12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path></g>
<g id="timer-10"><path d="M0 7.72V9.4l3-1V18h2V6h-.25L0 7.72zm23.78 6.65c-.14-.28-.35-.53-.63-.74-.28-.21-.61-.39-1.01-.53s-.85-.27-1.35-.38c-.35-.07-.64-.15-.87-.23-.23-.08-.41-.16-.55-.25-.14-.09-.23-.19-.28-.3-.05-.11-.08-.24-.08-.39 0-.14.03-.28.09-.41.06-.13.15-.25.27-.34.12-.1.27-.18.45-.24s.4-.09.64-.09c.25 0 .47.04.66.11.19.07.35.17.48.29.13.12.22.26.29.42.06.16.1.32.1.49h1.95c0-.39-.08-.75-.24-1.09-.16-.34-.39-.63-.69-.88-.3-.25-.66-.44-1.09-.59C21.49 9.07 21 9 20.46 9c-.51 0-.98.07-1.39.21-.41.14-.77.33-1.06.57-.29.24-.51.52-.67.84-.16.32-.23.65-.23 1.01s.08.69.23.96c.15.28.36.52.64.73.27.21.6.38.98.53.38.14.81.26 1.27.36.39.08.71.17.95.26s.43.19.57.29c.13.1.22.22.27.34.05.12.07.25.07.39 0 .32-.13.57-.4.77-.27.2-.66.29-1.17.29-.22 0-.43-.02-.64-.08-.21-.05-.4-.13-.56-.24-.17-.11-.3-.26-.41-.44-.11-.18-.17-.41-.18-.67h-1.89c0 .36.08.71.24 1.05.16.34.39.65.7.93.31.27.69.49 1.15.66.46.17.98.25 1.58.25.53 0 1.01-.06 1.44-.19.43-.13.8-.31 1.11-.54.31-.23.54-.51.71-.83.17-.32.25-.67.25-1.06-.02-.4-.09-.74-.24-1.02zm-9.96-7.32c-.34-.4-.75-.7-1.23-.88-.47-.18-1.01-.27-1.59-.27-.58 0-1.11.09-1.59.27-.48.18-.89.47-1.23.88-.34.41-.6.93-.79 1.59-.18.65-.28 1.45-.28 2.39v1.92c0 .94.09 1.74.28 2.39.19.66.45 1.19.8 1.6.34.41.75.71 1.23.89.48.18 1.01.28 1.59.28.59 0 1.12-.09 1.59-.28.48-.18.88-.48 1.22-.89.34-.41.6-.94.78-1.6.18-.65.28-1.45.28-2.39v-1.92c0-.94-.09-1.74-.28-2.39-.18-.66-.44-1.19-.78-1.59zm-.92 6.17c0 .6-.04 1.11-.12 1.53-.08.42-.2.76-.36 1.02-.16.26-.36.45-.59.57-.23.12-.51.18-.82.18-.3 0-.58-.06-.82-.18s-.44-.31-.6-.57c-.16-.26-.29-.6-.38-1.02-.09-.42-.13-.93-.13-1.53v-2.5c0-.6.04-1.11.13-1.52.09-.41.21-.74.38-1 .16-.25.36-.43.6-.55.24-.11.51-.17.81-.17.31 0 .58.06.81.17.24.11.44.29.6.55.16.25.29.58.37.99.08.41.13.92.13 1.52v2.51z"></path></g>
<g id="timer-3"><path d="M11.61 12.97c-.16-.24-.36-.46-.62-.65-.25-.19-.56-.35-.93-.48.3-.14.57-.3.8-.5.23-.2.42-.41.57-.64.15-.23.27-.46.34-.71.08-.24.11-.49.11-.73 0-.55-.09-1.04-.28-1.46-.18-.42-.44-.77-.78-1.06-.33-.28-.73-.5-1.2-.64-.45-.13-.97-.2-1.53-.2-.55 0-1.06.08-1.52.24-.47.17-.87.4-1.2.69-.33.29-.6.63-.78 1.03-.2.39-.29.83-.29 1.29h1.98c0-.26.05-.49.14-.69.09-.2.22-.38.38-.52.17-.14.36-.25.58-.33.22-.08.46-.12.73-.12.61 0 1.06.16 1.36.47.3.31.44.75.44 1.32 0 .27-.04.52-.12.74-.08.22-.21.41-.38.57-.17.16-.38.28-.63.37-.25.09-.55.13-.89.13H6.72v1.57H7.9c.34 0 .64.04.91.11.27.08.5.19.69.35.19.16.34.36.44.61.1.24.16.54.16.87 0 .62-.18 1.09-.53 1.42-.35.33-.84.49-1.45.49-.29 0-.56-.04-.8-.13-.24-.08-.44-.2-.61-.36-.17-.16-.3-.34-.39-.56-.09-.22-.14-.46-.14-.72H4.19c0 .55.11 1.03.32 1.45.21.42.5.77.86 1.05s.77.49 1.24.63.96.21 1.48.21c.57 0 1.09-.08 1.58-.23.49-.15.91-.38 1.26-.68.36-.3.64-.66.84-1.1.2-.43.3-.93.3-1.48 0-.29-.04-.58-.11-.86-.08-.25-.19-.51-.35-.76zm9.26 1.4c-.14-.28-.35-.53-.63-.74-.28-.21-.61-.39-1.01-.53s-.85-.27-1.35-.38c-.35-.07-.64-.15-.87-.23-.23-.08-.41-.16-.55-.25-.14-.09-.23-.19-.28-.3-.05-.11-.08-.24-.08-.39s.03-.28.09-.41c.06-.13.15-.25.27-.34.12-.1.27-.18.45-.24s.4-.09.64-.09c.25 0 .47.04.66.11.19.07.35.17.48.29.13.12.22.26.29.42.06.16.1.32.1.49h1.95c0-.39-.08-.75-.24-1.09-.16-.34-.39-.63-.69-.88-.3-.25-.66-.44-1.09-.59-.43-.15-.92-.22-1.46-.22-.51 0-.98.07-1.39.21-.41.14-.77.33-1.06.57-.29.24-.51.52-.67.84-.16.32-.23.65-.23 1.01s.08.68.23.96c.15.28.37.52.64.73.27.21.6.38.98.53.38.14.81.26 1.27.36.39.08.71.17.95.26s.43.19.57.29c.13.1.22.22.27.34.05.12.07.25.07.39 0 .32-.13.57-.4.77-.27.2-.66.29-1.17.29-.22 0-.43-.02-.64-.08-.21-.05-.4-.13-.56-.24-.17-.11-.3-.26-.41-.44-.11-.18-.17-.41-.18-.67h-1.89c0 .36.08.71.24 1.05.16.34.39.65.7.93.31.27.69.49 1.15.66.46.17.98.25 1.58.25.53 0 1.01-.06 1.44-.19.43-.13.8-.31 1.11-.54.31-.23.54-.51.71-.83.17-.32.25-.67.25-1.06-.02-.4-.09-.74-.24-1.02z"></path></g>
<g id="timer-off"><path d="M19.04 4.55l-1.42 1.42C16.07 4.74 14.12 4 12 4c-1.83 0-3.53.55-4.95 1.48l1.46 1.46C9.53 6.35 10.73 6 12 6c3.87 0 7 3.13 7 7 0 1.27-.35 2.47-.94 3.49l1.45 1.45C20.45 16.53 21 14.83 21 13c0-2.12-.74-4.07-1.97-5.61l1.42-1.42-1.41-1.42zM15 1H9v2h6V1zm-4 8.44l2 2V8h-2v1.44zM3.02 4L1.75 5.27 4.5 8.03C3.55 9.45 3 11.16 3 13c0 4.97 4.02 9 9 9 1.84 0 3.55-.55 4.98-1.5l2.5 2.5 1.27-1.27-7.71-7.71L3.02 4zM12 20c-3.87 0-7-3.13-7-7 0-1.28.35-2.48.95-3.52l9.56 9.56c-1.03.61-2.23.96-3.51.96z"></path></g>
<g id="tonality"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93s3.05-7.44 7-7.93v15.86zm2-15.86c1.03.13 2 .45 2.87.93H13v-.93zM13 7h5.24c.25.31.48.65.68 1H13V7zm0 3h6.74c.08.33.15.66.19 1H13v-1zm0 9.93V19h2.87c-.87.48-1.84.8-2.87.93zM18.24 17H13v-1h5.92c-.2.35-.43.69-.68 1zm1.5-3H13v-1h6.93c-.04.34-.11.67-.19 1z"></path></g>
<g id="transform"><path d="M22 18v-2H8V4h2L7 1 4 4h2v2H2v2h4v8c0 1.1.9 2 2 2h8v2h-2l3 3 3-3h-2v-2h4zM10 8h6v6h2V8c0-1.1-.9-2-2-2h-6v2z"></path></g>
<g id="tune"><path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"></path></g>
<g id="view-comfy"><path d="M3 9h4V5H3v4zm0 5h4v-4H3v4zm5 0h4v-4H8v4zm5 0h4v-4h-4v4zM8 9h4V5H8v4zm5-4v4h4V5h-4zm5 9h4v-4h-4v4zM3 19h4v-4H3v4zm5 0h4v-4H8v4zm5 0h4v-4h-4v4zm5 0h4v-4h-4v4zm0-14v4h4V5h-4z"></path></g>
<g id="view-compact"><path d="M3 19h6v-7H3v7zm7 0h12v-7H10v7zM3 5v6h19V5H3z"></path></g>
<g id="vignette"><path d="M21 3H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-9 15c-4.42 0-8-2.69-8-6s3.58-6 8-6 8 2.69 8 6-3.58 6-8 6z"></path></g>
<g id="wb-auto"><path d="M6.85 12.65h2.3L8 9l-1.15 3.65zM22 7l-1.2 6.29L19.3 7h-1.6l-1.49 6.29L15 7h-.76C12.77 5.17 10.53 4 8 4c-4.42 0-8 3.58-8 8s3.58 8 8 8c3.13 0 5.84-1.81 7.15-4.43l.1.43H17l1.5-6.1L20 16h1.75l2.05-9H22zm-11.7 9l-.7-2H6.4l-.7 2H3.8L7 7h2l3.2 9h-1.9z"></path></g>
<g id="wb-cloudy"><path d="M19.36 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.64-4.96z"></path></g>
<g id="wb-incandescent"><path d="M3.55 18.54l1.41 1.41 1.79-1.8-1.41-1.41-1.79 1.8zM11 22.45h2V19.5h-2v2.95zM4 10.5H1v2h3v-2zm11-4.19V1.5H9v4.81C7.21 7.35 6 9.28 6 11.5c0 3.31 2.69 6 6 6s6-2.69 6-6c0-2.22-1.21-4.15-3-5.19zm5 4.19v2h3v-2h-3zm-2.76 7.66l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4z"></path></g>
<g id="wb-iridescent"><path d="M5 14.5h14v-6H5v6zM11 .55V3.5h2V.55h-2zm8.04 2.5l-1.79 1.79 1.41 1.41 1.8-1.79-1.42-1.41zM13 22.45V19.5h-2v2.95h2zm7.45-3.91l-1.8-1.79-1.41 1.41 1.79 1.8 1.42-1.42zM3.55 4.46l1.79 1.79 1.41-1.41-1.79-1.79-1.41 1.41zm1.41 15.49l1.79-1.8-1.41-1.41-1.79 1.79 1.41 1.42z"></path></g>
<g id="wb-sunny"><path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.79 1.42-1.41zM4 10.5H1v2h3v-2zm9-9.95h-2V3.5h2V.55zm7.45 3.91l-1.41-1.41-1.79 1.79 1.41 1.41 1.79-1.79zm-3.21 13.7l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zM20 10.5v2h3v-2h-3zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm-1 16.95h2V19.5h-2v2.95zm-7.45-3.91l1.41 1.41 1.79-1.8-1.41-1.41-1.79 1.8z"></path></g>
</defs></svg>
</iron-iconset-svg>`;document.head.appendChild(vq.content);var bq=ut`<iron-iconset-svg name="icons" size="24">
<svg><defs>
<g id="3d-rotation"><path d="M7.52 21.48C4.25 19.94 1.91 16.76 1.55 13H.05C.56 19.16 5.71 24 12 24l.66-.03-3.81-3.81-1.33 1.32zm.89-6.52c-.19 0-.37-.03-.52-.08-.16-.06-.29-.13-.4-.24-.11-.1-.2-.22-.26-.37-.06-.14-.09-.3-.09-.47h-1.3c0 .36.07.68.21.95.14.27.33.5.56.69.24.18.51.32.82.41.3.1.62.15.96.15.37 0 .72-.05 1.03-.15.32-.1.6-.25.83-.44s.42-.43.55-.72c.13-.29.2-.61.2-.97 0-.19-.02-.38-.07-.56-.05-.18-.12-.35-.23-.51-.1-.16-.24-.3-.4-.43-.17-.13-.37-.23-.61-.31.2-.09.37-.2.52-.33.15-.13.27-.27.37-.42.1-.15.17-.3.22-.46.05-.16.07-.32.07-.48 0-.36-.06-.68-.18-.96-.12-.28-.29-.51-.51-.69-.2-.19-.47-.33-.77-.43C9.1 8.05 8.76 8 8.39 8c-.36 0-.69.05-1 .16-.3.11-.57.26-.79.45-.21.19-.38.41-.51.67-.12.26-.18.54-.18.85h1.3c0-.17.03-.32.09-.45s.14-.25.25-.34c.11-.09.23-.17.38-.22.15-.05.3-.08.48-.08.4 0 .7.1.89.31.19.2.29.49.29.86 0 .18-.03.34-.08.49-.05.15-.14.27-.25.37-.11.1-.25.18-.41.24-.16.06-.36.09-.58.09H7.5v1.03h.77c.22 0 .42.02.6.07s.33.13.45.23c.12.11.22.24.29.4.07.16.1.35.1.57 0 .41-.12.72-.35.93-.23.23-.55.33-.95.33zm8.55-5.92c-.32-.33-.7-.59-1.14-.77-.43-.18-.92-.27-1.46-.27H12v8h2.3c.55 0 1.06-.09 1.51-.27.45-.18.84-.43 1.16-.76.32-.33.57-.73.74-1.19.17-.47.26-.99.26-1.57v-.4c0-.58-.09-1.1-.26-1.57-.18-.47-.43-.87-.75-1.2zm-.39 3.16c0 .42-.05.79-.14 1.13-.1.33-.24.62-.43.85-.19.23-.43.41-.71.53-.29.12-.62.18-.99.18h-.91V9.12h.97c.72 0 1.27.23 1.64.69.38.46.57 1.12.57 1.99v.4zM12 0l-.66.03 3.81 3.81 1.33-1.33c3.27 1.55 5.61 4.72 5.96 8.48h1.5C23.44 4.84 18.29 0 12 0z"></path></g>
<g id="accessibility"><path d="M12 2c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm9 7h-6v13h-2v-6h-2v6H9V9H3V7h18v2z"></path></g>
<g id="accessible"><circle cx="12" cy="4" r="2"></circle><path d="M19 13v-2c-1.54.02-3.09-.75-4.07-1.83l-1.29-1.43c-.17-.19-.38-.34-.61-.45-.01 0-.01-.01-.02-.01H13c-.35-.2-.75-.3-1.19-.26C10.76 7.11 10 8.04 10 9.09V15c0 1.1.9 2 2 2h5v5h2v-5.5c0-1.1-.9-2-2-2h-3v-3.45c1.29 1.07 3.25 1.94 5 1.95zm-6.17 5c-.41 1.16-1.52 2-2.83 2-1.66 0-3-1.34-3-3 0-1.31.84-2.41 2-2.83V12.1c-2.28.46-4 2.48-4 4.9 0 2.76 2.24 5 5 5 2.42 0 4.44-1.72 4.9-4h-2.07z"></path></g>
<g id="account-balance"><path d="M4 10v7h3v-7H4zm6 0v7h3v-7h-3zM2 22h19v-3H2v3zm14-12v7h3v-7h-3zm-4.5-9L2 6v2h19V6l-9.5-5z"></path></g>
<g id="account-balance-wallet"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"></path></g>
<g id="account-box"><path d="M3 5v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2H5c-1.11 0-2 .9-2 2zm12 4c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3zm-9 8c0-2 4-3.1 6-3.1s6 1.1 6 3.1v1H6v-1z"></path></g>
<g id="account-circle"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"></path></g>
<g id="add"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></g>
<g id="add-alert"><path d="M10.01 21.01c0 1.1.89 1.99 1.99 1.99s1.99-.89 1.99-1.99h-3.98zm8.87-4.19V11c0-3.25-2.25-5.97-5.29-6.69v-.72C13.59 2.71 12.88 2 12 2s-1.59.71-1.59 1.59v.72C7.37 5.03 5.12 7.75 5.12 11v5.82L3 18.94V20h18v-1.06l-2.12-2.12zM16 13.01h-3v3h-2v-3H8V11h3V8h2v3h3v2.01z"></path></g>
<g id="add-box"><path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"></path></g>
<g id="add-circle"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"></path></g>
<g id="add-circle-outline"><path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"></path></g>
<g id="add-shopping-cart"><path d="M11 9h2V6h3V4h-3V1h-2v3H8v2h3v3zm-4 9c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2zm-9.83-3.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.86-7.01L19.42 4h-.01l-1.1 2-2.76 5H8.53l-.13-.27L6.16 6l-.95-2-.94-2H1v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.13 0-.25-.11-.25-.25z"></path></g>
<g id="alarm"><path d="M22 5.72l-4.6-3.86-1.29 1.53 4.6 3.86L22 5.72zM7.88 3.39L6.6 1.86 2 5.71l1.29 1.53 4.59-3.85zM12.5 8H11v6l4.75 2.85.75-1.23-4-2.37V8zM12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9c4.97 0 9-4.03 9-9s-4.03-9-9-9zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path></g>
<g id="alarm-add"><path d="M7.88 3.39L6.6 1.86 2 5.71l1.29 1.53 4.59-3.85zM22 5.72l-4.6-3.86-1.29 1.53 4.6 3.86L22 5.72zM12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9c4.97 0 9-4.03 9-9s-4.03-9-9-9zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7zm1-11h-2v3H8v2h3v3h2v-3h3v-2h-3V9z"></path></g>
<g id="alarm-off"><path d="M12 6c3.87 0 7 3.13 7 7 0 .84-.16 1.65-.43 2.4l1.52 1.52c.58-1.19.91-2.51.91-3.92 0-4.97-4.03-9-9-9-1.41 0-2.73.33-3.92.91L9.6 6.43C10.35 6.16 11.16 6 12 6zm10-.28l-4.6-3.86-1.29 1.53 4.6 3.86L22 5.72zM2.92 2.29L1.65 3.57 2.98 4.9l-1.11.93 1.42 1.42 1.11-.94.8.8C3.83 8.69 3 10.75 3 13c0 4.97 4.02 9 9 9 2.25 0 4.31-.83 5.89-2.2l2.2 2.2 1.27-1.27L3.89 3.27l-.97-.98zm13.55 16.1C15.26 19.39 13.7 20 12 20c-3.87 0-7-3.13-7-7 0-1.7.61-3.26 1.61-4.47l9.86 9.86zM8.02 3.28L6.6 1.86l-.86.71 1.42 1.42.86-.71z"></path></g>
<g id="alarm-on"><path d="M22 5.72l-4.6-3.86-1.29 1.53 4.6 3.86L22 5.72zM7.88 3.39L6.6 1.86 2 5.71l1.29 1.53 4.59-3.85zM12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9c4.97 0 9-4.03 9-9s-4.03-9-9-9zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7zm-1.46-5.47L8.41 12.4l-1.06 1.06 3.18 3.18 6-6-1.06-1.06-4.93 4.95z"></path></g>
<g id="all-out"><path d="M16.21 4.16l4 4v-4zm4 12l-4 4h4zm-12 4l-4-4v4zm-4-12l4-4h-4zm12.95-.95c-2.73-2.73-7.17-2.73-9.9 0s-2.73 7.17 0 9.9 7.17 2.73 9.9 0 2.73-7.16 0-9.9zm-1.1 8.8c-2.13 2.13-5.57 2.13-7.7 0s-2.13-5.57 0-7.7 5.57-2.13 7.7 0 2.13 5.57 0 7.7z"></path></g>
<g id="android"><path d="M6 18c0 .55.45 1 1 1h1v3.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5V19h2v3.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5V19h1c.55 0 1-.45 1-1V8H6v10zM3.5 8C2.67 8 2 8.67 2 9.5v7c0 .83.67 1.5 1.5 1.5S5 17.33 5 16.5v-7C5 8.67 4.33 8 3.5 8zm17 0c-.83 0-1.5.67-1.5 1.5v7c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5v-7c0-.83-.67-1.5-1.5-1.5zm-4.97-5.84l1.3-1.3c.2-.2.2-.51 0-.71-.2-.2-.51-.2-.71 0l-1.48 1.48C13.85 1.23 12.95 1 12 1c-.96 0-1.86.23-2.66.63L7.85.15c-.2-.2-.51-.2-.71 0-.2.2-.2.51 0 .71l1.31 1.31C6.97 3.26 6 5.01 6 7h12c0-1.99-.97-3.75-2.47-4.84zM10 5H9V4h1v1zm5 0h-1V4h1v1z"></path></g>
<g id="announcement"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z"></path></g>
<g id="apps"><path d="M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z"></path></g>
<g id="archive"><path d="M20.54 5.23l-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.16.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.48-.17-.93-.46-1.27zM12 17.5L6.5 12H10v-2h4v2h3.5L12 17.5zM5.12 5l.81-1h12l.94 1H5.12z"></path></g>
<g id="arrow-back"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></g>
<g id="arrow-downward"><path d="M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"></path></g>
<g id="arrow-drop-down"><path d="M7 10l5 5 5-5z"></path></g>
<g id="arrow-drop-down-circle"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 12l-4-4h8l-4 4z"></path></g>
<g id="arrow-drop-up"><path d="M7 14l5-5 5 5z"></path></g>
<g id="arrow-forward"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"></path></g>
<g id="arrow-upward"><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"></path></g>
<g id="aspect-ratio"><path d="M19 12h-2v3h-3v2h5v-5zM7 9h3V7H5v5h2V9zm14-6H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16.01H3V4.99h18v14.02z"></path></g>
<g id="assessment"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path></g>
<g id="assignment"><path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"></path></g>
<g id="assignment-ind"><path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm0 4c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm6 12H6v-1.4c0-2 4-3.1 6-3.1s6 1.1 6 3.1V19z"></path></g>
<g id="assignment-late"><path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-6 15h-2v-2h2v2zm0-4h-2V8h2v6zm-1-9c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"></path></g>
<g id="assignment-return"><path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm4 12h-4v3l-5-5 5-5v3h4v4z"></path></g>
<g id="assignment-returned"><path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm0 15l-5-5h3V9h4v4h3l-5 5z"></path></g>
<g id="assignment-turned-in"><path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm-2 14l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"></path></g>
<g id="attachment"><path d="M2 12.5C2 9.46 4.46 7 7.5 7H18c2.21 0 4 1.79 4 4s-1.79 4-4 4H9.5C8.12 15 7 13.88 7 12.5S8.12 10 9.5 10H17v2H9.41c-.55 0-.55 1 0 1H18c1.1 0 2-.9 2-2s-.9-2-2-2H7.5C5.57 9 4 10.57 4 12.5S5.57 16 7.5 16H17v2H7.5C4.46 18 2 15.54 2 12.5z"></path></g>
<g id="autorenew"><path d="M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"></path></g>
<g id="backspace"><path d="M22 3H7c-.69 0-1.23.35-1.59.88L0 12l5.41 8.11c.36.53.9.89 1.59.89h15c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-3 12.59L17.59 17 14 13.41 10.41 17 9 15.59 12.59 12 9 8.41 10.41 7 14 10.59 17.59 7 19 8.41 15.41 12 19 15.59z"></path></g>
<g id="backup"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"></path></g>
<g id="block"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12zm8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8z"></path></g>
<g id="book"><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"></path></g>
<g id="bookmark"><path d="M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2z"></path></g>
<g id="bookmark-border"><path d="M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2zm0 15l-5-2.18L7 18V5h10v13z"></path></g>
<g id="bug-report"><path d="M20 8h-2.81c-.45-.78-1.07-1.45-1.82-1.96L17 4.41 15.59 3l-2.17 2.17C12.96 5.06 12.49 5 12 5c-.49 0-.96.06-1.41.17L8.41 3 7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20V8zm-6 8h-4v-2h4v2zm0-4h-4v-2h4v2z"></path></g>
<g id="build"><path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"></path></g>
<g id="cached"><path d="M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"></path></g>
<g id="camera-enhance"><path d="M9 3L7.17 5H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2h-3.17L15 3H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-1l1.25-2.75L16 13l-2.75-1.25L12 9l-1.25 2.75L8 13l2.75 1.25z"></path></g>
<g id="cancel"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"></path></g>
<g id="card-giftcard"><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z"></path></g>
<g id="card-membership"><path d="M20 2H4c-1.11 0-2 .89-2 2v11c0 1.11.89 2 2 2h4v5l4-2 4 2v-5h4c1.11 0 2-.89 2-2V4c0-1.11-.89-2-2-2zm0 13H4v-2h16v2zm0-5H4V4h16v6z"></path></g>
<g id="card-travel"><path d="M20 6h-3V4c0-1.11-.89-2-2-2H9c-1.11 0-2 .89-2 2v2H4c-1.11 0-2 .89-2 2v11c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zM9 4h6v2H9V4zm11 15H4v-2h16v2zm0-5H4V8h3v2h2V8h6v2h2V8h3v6z"></path></g>
<g id="change-history"><path d="M12 7.77L18.39 18H5.61L12 7.77M12 4L2 20h20L12 4z"></path></g>
<g id="check"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path></g>
<g id="check-box"><path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path></g>
<g id="check-box-outline-blank"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></g>
<g id="check-circle"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path></g>
<g id="chevron-left"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></g>
<g id="chevron-right"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></g>
<g id="chrome-reader-mode"><path d="M13 12h7v1.5h-7zm0-2.5h7V11h-7zm0 5h7V16h-7zM21 4H3c-1.1 0-2 .9-2 2v13c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 15h-9V6h9v13z"></path></g>
<g id="class"><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"></path></g>
<g id="clear"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></g>
<g id="close"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></g>
<g id="cloud"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"></path></g>
<g id="cloud-circle"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.5 14H8c-1.66 0-3-1.34-3-3s1.34-3 3-3l.14.01C8.58 8.28 10.13 7 12 7c2.21 0 4 1.79 4 4h.5c1.38 0 2.5 1.12 2.5 2.5S17.88 16 16.5 16z"></path></g>
<g id="cloud-done"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM10 17l-3.5-3.5 1.41-1.41L10 14.17 15.18 9l1.41 1.41L10 17z"></path></g>
<g id="cloud-download"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"></path></g>
<g id="cloud-off"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4c-1.48 0-2.85.43-4.01 1.17l1.46 1.46C10.21 6.23 11.08 6 12 6c3.04 0 5.5 2.46 5.5 5.5v.5H19c1.66 0 3 1.34 3 3 0 1.13-.64 2.11-1.56 2.62l1.45 1.45C23.16 18.16 24 16.68 24 15c0-2.64-2.05-4.78-4.65-4.96zM3 5.27l2.75 2.74C2.56 8.15 0 10.77 0 14c0 3.31 2.69 6 6 6h11.73l2 2L21 20.73 4.27 4 3 5.27zM7.73 10l8 8H6c-2.21 0-4-1.79-4-4s1.79-4 4-4h1.73z"></path></g>
<g id="cloud-queue"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM19 18H6c-2.21 0-4-1.79-4-4s1.79-4 4-4h.71C7.37 7.69 9.48 6 12 6c3.04 0 5.5 2.46 5.5 5.5v.5H19c1.66 0 3 1.34 3 3s-1.34 3-3 3z"></path></g>
<g id="cloud-upload"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"></path></g>
<g id="code"><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></g>
<g id="compare-arrows"><path d="M9.01 14H2v2h7.01v3L13 15l-3.99-4v3zm5.98-1v-3H22V8h-7.01V5L11 9l3.99 4z"></path></g>
<g id="content-copy"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></g>
<g id="content-cut"><path d="M9.64 7.64c.23-.5.36-1.05.36-1.64 0-2.21-1.79-4-4-4S2 3.79 2 6s1.79 4 4 4c.59 0 1.14-.13 1.64-.36L10 12l-2.36 2.36C7.14 14.13 6.59 14 6 14c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4c0-.59-.13-1.14-.36-1.64L12 14l7 7h3v-1L9.64 7.64zM6 8c-1.1 0-2-.89-2-2s.9-2 2-2 2 .89 2 2-.9 2-2 2zm0 12c-1.1 0-2-.89-2-2s.9-2 2-2 2 .89 2 2-.9 2-2 2zm6-7.5c-.28 0-.5-.22-.5-.5s.22-.5.5-.5.5.22.5.5-.22.5-.5.5zM19 3l-6 6 2 2 7-7V3z"></path></g>
<g id="content-paste"><path d="M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z"></path></g>
<g id="copyright"><path d="M10.08 10.86c.05-.33.16-.62.3-.87s.34-.46.59-.62c.24-.15.54-.22.91-.23.23.01.44.05.63.13.2.09.38.21.52.36s.25.33.34.53.13.42.14.64h1.79c-.02-.47-.11-.9-.28-1.29s-.4-.73-.7-1.01-.66-.5-1.08-.66-.88-.23-1.39-.23c-.65 0-1.22.11-1.7.34s-.88.53-1.2.92-.56.84-.71 1.36S8 11.29 8 11.87v.27c0 .58.08 1.12.23 1.64s.39.97.71 1.35.72.69 1.2.91 1.05.34 1.7.34c.47 0 .91-.08 1.32-.23s.77-.36 1.08-.63.56-.58.74-.94.29-.74.3-1.15h-1.79c-.01.21-.06.4-.15.58s-.21.33-.36.46-.32.23-.52.3c-.19.07-.39.09-.6.1-.36-.01-.66-.08-.89-.23-.25-.16-.45-.37-.59-.62s-.25-.55-.3-.88-.08-.67-.08-1v-.27c0-.35.03-.68.08-1.01zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"></path></g>
<g id="create"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></g>
<g id="create-new-folder"><path d="M20 6h-8l-2-2H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-1 8h-3v3h-2v-3h-3v-2h3V9h2v3h3v2z"></path></g>
<g id="credit-card"><path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"></path></g>
<g id="dashboard"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"></path></g>
<g id="date-range"><path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"></path></g>
<g id="delete"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></g>
<g id="delete-forever"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"></path></g>
<g id="delete-sweep"><path d="M15 16h4v2h-4zm0-8h7v2h-7zm0 4h6v2h-6zM3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3v10zM14 5h-3l-1-1H6L5 5H2v2h12z"></path></g>
<g id="description"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"></path></g>
<g id="dns"><path d="M20 13H4c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h16c.55 0 1-.45 1-1v-6c0-.55-.45-1-1-1zM7 19c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM20 3H4c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h16c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1zM7 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"></path></g>
<g id="done"><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"></path></g>
<g id="done-all"><path d="M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"></path></g>
<g id="donut-large"><path d="M11 5.08V2c-5 .5-9 4.81-9 10s4 9.5 9 10v-3.08c-3-.48-6-3.4-6-6.92s3-6.44 6-6.92zM18.97 11H22c-.47-5-4-8.53-9-9v3.08C16 5.51 18.54 8 18.97 11zM13 18.92V22c5-.47 8.53-4 9-9h-3.03c-.43 3-2.97 5.49-5.97 5.92z"></path></g>
<g id="donut-small"><path d="M11 9.16V2c-5 .5-9 4.79-9 10s4 9.5 9 10v-7.16c-1-.41-2-1.52-2-2.84s1-2.43 2-2.84zM14.86 11H22c-.48-4.75-4-8.53-9-9v7.16c1 .3 1.52.98 1.86 1.84zM13 14.84V22c5-.47 8.52-4.25 9-9h-7.14c-.34.86-.86 1.54-1.86 1.84z"></path></g>
<g id="drafts"><path d="M21.99 8c0-.72-.37-1.35-.94-1.7L12 1 2.95 6.3C2.38 6.65 2 7.28 2 8v10c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2l-.01-10zM12 13L3.74 7.84 12 3l8.26 4.84L12 13z"></path></g>
<g id="eject"><path d="M5 17h14v2H5zm7-12L5.33 15h13.34z"></path></g>
<g id="error"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"></path></g>
<g id="error-outline"><path d="M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"></path></g>
<g id="euro-symbol"><path d="M15 18.5c-2.51 0-4.68-1.42-5.76-3.5H15v-2H8.58c-.05-.33-.08-.66-.08-1s.03-.67.08-1H15V9H9.24C10.32 6.92 12.5 5.5 15 5.5c1.61 0 3.09.59 4.23 1.57L21 5.3C19.41 3.87 17.3 3 15 3c-3.92 0-7.24 2.51-8.48 6H3v2h3.06c-.04.33-.06.66-.06 1 0 .34.02.67.06 1H3v2h3.52c1.24 3.49 4.56 6 8.48 6 2.31 0 4.41-.87 6-2.3l-1.78-1.77c-1.13.98-2.6 1.57-4.22 1.57z"></path></g>
<g id="event"><path d="M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"></path></g>
<g id="event-seat"><path d="M4 18v3h3v-3h10v3h3v-6H4zm15-8h3v3h-3zM2 10h3v3H2zm15 3H7V5c0-1.1.9-2 2-2h6c1.1 0 2 .9 2 2v8z"></path></g>
<g id="exit-to-app"><path d="M10.09 15.59L11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67l-2.58 2.59zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></g>
<g id="expand-less"><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"></path></g>
<g id="expand-more"><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></g>
<g id="explore"><path d="M12 10.9c-.61 0-1.1.49-1.1 1.1s.49 1.1 1.1 1.1c.61 0 1.1-.49 1.1-1.1s-.49-1.1-1.1-1.1zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm2.19 12.19L6 18l3.81-8.19L18 6l-3.81 8.19z"></path></g>
<g id="extension"><path d="M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"></path></g>
<g id="face"><path d="M9 11.75c-.69 0-1.25.56-1.25 1.25s.56 1.25 1.25 1.25 1.25-.56 1.25-1.25-.56-1.25-1.25-1.25zm6 0c-.69 0-1.25.56-1.25 1.25s.56 1.25 1.25 1.25 1.25-.56 1.25-1.25-.56-1.25-1.25-1.25zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8 0-.29.02-.58.05-.86 2.36-1.05 4.23-2.98 5.21-5.37C11.07 8.33 14.05 10 17.42 10c.78 0 1.53-.09 2.25-.26.21.71.33 1.47.33 2.26 0 4.41-3.59 8-8 8z"></path></g>
<g id="favorite"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></g>
<g id="favorite-border"><path d="M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"></path></g>
<g id="feedback"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 12h-2v-2h2v2zm0-4h-2V6h2v4z"></path></g>
<g id="file-download"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"></path></g>
<g id="file-upload"><path d="M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"></path></g>
<g id="filter-list"><path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"></path></g>
<g id="find-in-page"><path d="M20 19.59V8l-6-6H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c.45 0 .85-.15 1.19-.4l-4.43-4.43c-.8.52-1.74.83-2.76.83-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5c0 1.02-.31 1.96-.83 2.75L20 19.59zM9 13c0 1.66 1.34 3 3 3s3-1.34 3-3-1.34-3-3-3-3 1.34-3 3z"></path></g>
<g id="find-replace"><path d="M11 6c1.38 0 2.63.56 3.54 1.46L12 10h6V4l-2.05 2.05C14.68 4.78 12.93 4 11 4c-3.53 0-6.43 2.61-6.92 6H6.1c.46-2.28 2.48-4 4.9-4zm5.64 9.14c.66-.9 1.12-1.97 1.28-3.14H15.9c-.46 2.28-2.48 4-4.9 4-1.38 0-2.63-.56-3.54-1.46L10 12H4v6l2.05-2.05C7.32 17.22 9.07 18 11 18c1.55 0 2.98-.51 4.14-1.36L20 21.49 21.49 20l-4.85-4.86z"></path></g>
<g id="fingerprint"><path d="M17.81 4.47c-.08 0-.16-.02-.23-.06C15.66 3.42 14 3 12.01 3c-1.98 0-3.86.47-5.57 1.41-.24.13-.54.04-.68-.2-.13-.24-.04-.55.2-.68C7.82 2.52 9.86 2 12.01 2c2.13 0 3.99.47 6.03 1.52.25.13.34.43.21.67-.09.18-.26.28-.44.28zM3.5 9.72c-.1 0-.2-.03-.29-.09-.23-.16-.28-.47-.12-.7.99-1.4 2.25-2.5 3.75-3.27C9.98 4.04 14 4.03 17.15 5.65c1.5.77 2.76 1.86 3.75 3.25.16.22.11.54-.12.7-.23.16-.54.11-.7-.12-.9-1.26-2.04-2.25-3.39-2.94-2.87-1.47-6.54-1.47-9.4.01-1.36.7-2.5 1.7-3.4 2.96-.08.14-.23.21-.39.21zm6.25 12.07c-.13 0-.26-.05-.35-.15-.87-.87-1.34-1.43-2.01-2.64-.69-1.23-1.05-2.73-1.05-4.34 0-2.97 2.54-5.39 5.66-5.39s5.66 2.42 5.66 5.39c0 .28-.22.5-.5.5s-.5-.22-.5-.5c0-2.42-2.09-4.39-4.66-4.39-2.57 0-4.66 1.97-4.66 4.39 0 1.44.32 2.77.93 3.85.64 1.15 1.08 1.64 1.85 2.42.19.2.19.51 0 .71-.11.1-.24.15-.37.15zm7.17-1.85c-1.19 0-2.24-.3-3.1-.89-1.49-1.01-2.38-2.65-2.38-4.39 0-.28.22-.5.5-.5s.5.22.5.5c0 1.41.72 2.74 1.94 3.56.71.48 1.54.71 2.54.71.24 0 .64-.03 1.04-.1.27-.05.53.13.58.41.05.27-.13.53-.41.58-.57.11-1.07.12-1.21.12zM14.91 22c-.04 0-.09-.01-.13-.02-1.59-.44-2.63-1.03-3.72-2.1-1.4-1.39-2.17-3.24-2.17-5.22 0-1.62 1.38-2.94 3.08-2.94 1.7 0 3.08 1.32 3.08 2.94 0 1.07.93 1.94 2.08 1.94s2.08-.87 2.08-1.94c0-3.77-3.25-6.83-7.25-6.83-2.84 0-5.44 1.58-6.61 4.03-.39.81-.59 1.76-.59 2.8 0 .78.07 2.01.67 3.61.1.26-.03.55-.29.64-.26.1-.55-.04-.64-.29-.49-1.31-.73-2.61-.73-3.96 0-1.2.23-2.29.68-3.24 1.33-2.79 4.28-4.6 7.51-4.6 4.55 0 8.25 3.51 8.25 7.83 0 1.62-1.38 2.94-3.08 2.94s-3.08-1.32-3.08-2.94c0-1.07-.93-1.94-2.08-1.94s-2.08.87-2.08 1.94c0 1.71.66 3.31 1.87 4.51.95.94 1.86 1.46 3.27 1.85.27.07.42.35.35.61-.05.23-.26.38-.47.38z"></path></g>
<g id="first-page"><path d="M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"></path></g>
<g id="flag"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"></path></g>
<g id="flight-land"><path d="M2.5 19h19v2h-19zm7.18-5.73l4.35 1.16 5.31 1.42c.8.21 1.62-.26 1.84-1.06.21-.8-.26-1.62-1.06-1.84l-5.31-1.42-2.76-9.02L10.12 2v8.28L5.15 8.95l-.93-2.32-1.45-.39v5.17l1.6.43 5.31 1.43z"></path></g>
<g id="flight-takeoff"><path d="M2.5 19h19v2h-19zm19.57-9.36c-.21-.8-1.04-1.28-1.84-1.06L14.92 10l-6.9-6.43-1.93.51 4.14 7.17-4.97 1.33-1.97-1.54-1.45.39 1.82 3.16.77 1.33 1.6-.43 5.31-1.42 4.35-1.16L21 11.49c.81-.23 1.28-1.05 1.07-1.85z"></path></g>
<g id="flip-to-back"><path d="M9 7H7v2h2V7zm0 4H7v2h2v-2zm0-8c-1.11 0-2 .9-2 2h2V3zm4 12h-2v2h2v-2zm6-12v2h2c0-1.1-.9-2-2-2zm-6 0h-2v2h2V3zM9 17v-2H7c0 1.1.89 2 2 2zm10-4h2v-2h-2v2zm0-4h2V7h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2zM5 7H3v12c0 1.1.89 2 2 2h12v-2H5V7zm10-2h2V3h-2v2zm0 12h2v-2h-2v2z"></path></g>
<g id="flip-to-front"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm2 4v-2H3c0 1.1.89 2 2 2zM3 9h2V7H3v2zm12 12h2v-2h-2v2zm4-18H9c-1.11 0-2 .9-2 2v10c0 1.1.89 2 2 2h10c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 12H9V5h10v10zm-8 6h2v-2h-2v2zm-4 0h2v-2H7v2z"></path></g>
<g id="folder"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"></path></g>
<g id="folder-open"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"></path></g>
<g id="folder-shared"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-5 3c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm4 8h-8v-1c0-1.33 2.67-2 4-2s4 .67 4 2v1z"></path></g>
<g id="font-download"><path d="M9.93 13.5h4.14L12 7.98zM20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-4.05 16.5l-1.14-3H9.17l-1.12 3H5.96l5.11-13h1.86l5.11 13h-2.09z"></path></g>
<g id="forward"><path d="M12 8V4l8 8-8 8v-4H4V8z"></path></g>
<g id="fullscreen"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"></path></g>
<g id="fullscreen-exit"><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"></path></g>
<g id="g-translate"><path d="M20 5h-9.12L10 2H4c-1.1 0-2 .9-2 2v13c0 1.1.9 2 2 2h7l1 3h8c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zM7.17 14.59c-2.25 0-4.09-1.83-4.09-4.09s1.83-4.09 4.09-4.09c1.04 0 1.99.37 2.74 1.07l.07.06-1.23 1.18-.06-.05c-.29-.27-.78-.59-1.52-.59-1.31 0-2.38 1.09-2.38 2.42s1.07 2.42 2.38 2.42c1.37 0 1.96-.87 2.12-1.46H7.08V9.91h3.95l.01.07c.04.21.05.4.05.61 0 2.35-1.61 4-3.92 4zm6.03-1.71c.33.6.74 1.18 1.19 1.7l-.54.53-.65-2.23zm.77-.76h-.99l-.31-1.04h3.99s-.34 1.31-1.56 2.74c-.52-.62-.89-1.23-1.13-1.7zM21 20c0 .55-.45 1-1 1h-7l2-2-.81-2.77.92-.92L17.79 18l.73-.73-2.71-2.68c.9-1.03 1.6-2.25 1.92-3.51H19v-1.04h-3.64V9h-1.04v1.04h-1.96L11.18 6H20c.55 0 1 .45 1 1v13z"></path></g>
<g id="gavel"><path d="M1 21h12v2H1zM5.245 8.07l2.83-2.827 14.14 14.142-2.828 2.828zM12.317 1l5.657 5.656-2.83 2.83-5.654-5.66zM3.825 9.485l5.657 5.657-2.828 2.828-5.657-5.657z"></path></g>
<g id="gesture"><path d="M4.59 6.89c.7-.71 1.4-1.35 1.71-1.22.5.2 0 1.03-.3 1.52-.25.42-2.86 3.89-2.86 6.31 0 1.28.48 2.34 1.34 2.98.75.56 1.74.73 2.64.46 1.07-.31 1.95-1.4 3.06-2.77 1.21-1.49 2.83-3.44 4.08-3.44 1.63 0 1.65 1.01 1.76 1.79-3.78.64-5.38 3.67-5.38 5.37 0 1.7 1.44 3.09 3.21 3.09 1.63 0 4.29-1.33 4.69-6.1H21v-2.5h-2.47c-.15-1.65-1.09-4.2-4.03-4.2-2.25 0-4.18 1.91-4.94 2.84-.58.73-2.06 2.48-2.29 2.72-.25.3-.68.84-1.11.84-.45 0-.72-.83-.36-1.92.35-1.09 1.4-2.86 1.85-3.52.78-1.14 1.3-1.92 1.3-3.28C8.95 3.69 7.31 3 6.44 3 5.12 3 3.97 4 3.72 4.25c-.36.36-.66.66-.88.93l1.75 1.71zm9.29 11.66c-.31 0-.74-.26-.74-.72 0-.6.73-2.2 2.87-2.76-.3 2.69-1.43 3.48-2.13 3.48z"></path></g>
<g id="get-app"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"></path></g>
<g id="gif"><path d="M11.5 9H13v6h-1.5zM9 9H6c-.6 0-1 .5-1 1v4c0 .5.4 1 1 1h3c.6 0 1-.5 1-1v-2H8.5v1.5h-2v-3H10V10c0-.5-.4-1-1-1zm10 1.5V9h-4.5v6H16v-2h2v-1.5h-2v-1z"></path></g>
<g id="grade"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></g>
<g id="group-work"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM8 17.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5zM9.5 8c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5S9.5 9.38 9.5 8zm6.5 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"></path></g>
<g id="help"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"></path></g>
<g id="help-outline"><path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"></path></g>
<g id="highlight-off"><path d="M14.59 8L12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"></path></g>
<g id="history"><path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"></path></g>
<g id="home"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></g>
<g id="hourglass-empty"><path d="M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5l-4-4V4h8v3.5l-4 4z"></path></g>
<g id="hourglass-full"><path d="M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6z"></path></g>
<g id="http"><path d="M4.5 11h-2V9H1v6h1.5v-2.5h2V15H6V9H4.5v2zm2.5-.5h1.5V15H10v-4.5h1.5V9H7v1.5zm5.5 0H14V15h1.5v-4.5H17V9h-4.5v1.5zm9-1.5H18v6h1.5v-2h2c.8 0 1.5-.7 1.5-1.5v-1c0-.8-.7-1.5-1.5-1.5zm0 2.5h-2v-1h2v1z"></path></g>
<g id="https"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"></path></g>
<g id="important-devices"><path d="M23 11.01L18 11c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h5c.55 0 1-.45 1-1v-9c0-.55-.45-.99-1-.99zM23 20h-5v-7h5v7zM20 2H2C.89 2 0 2.89 0 4v12c0 1.1.89 2 2 2h7v2H7v2h8v-2h-2v-2h2v-2H2V4h18v5h2V4c0-1.11-.9-2-2-2zm-8.03 7L11 6l-.97 3H7l2.47 1.76-.94 2.91 2.47-1.8 2.47 1.8-.94-2.91L15 9h-3.03z"></path></g>
<g id="inbox"><path d="M19 3H4.99c-1.11 0-1.98.89-1.98 2L3 19c0 1.1.88 2 1.99 2H19c1.1 0 2-.9 2-2V5c0-1.11-.9-2-2-2zm0 12h-4c0 1.66-1.35 3-3 3s-3-1.34-3-3H4.99V5H19v10z"></path></g>
<g id="indeterminate-check-box"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"></path></g>
<g id="info"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"></path></g>
<g id="info-outline"><path d="M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z"></path></g>
<g id="input"><path d="M21 3.01H3c-1.1 0-2 .9-2 2V9h2V4.99h18v14.03H3V15H1v4.01c0 1.1.9 1.98 2 1.98h18c1.1 0 2-.88 2-1.98v-14c0-1.11-.9-2-2-2zM11 16l4-4-4-4v3H1v2h10v3z"></path></g>
<g id="invert-colors"><path d="M17.66 7.93L12 2.27 6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58c2.05 0 4.1-.78 5.66-2.34 3.12-3.12 3.12-8.19 0-11.31zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"></path></g>
<g id="label"><path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"></path></g>
<g id="label-outline"><path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16zM16 17H5V7h11l3.55 5L16 17z"></path></g>
<g id="language"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"></path></g>
<g id="last-page"><path d="M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"></path></g>
<g id="launch"><path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></g>
<g id="lightbulb-outline"><path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6C7.8 12.16 7 10.63 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z"></path></g>
<g id="line-style"><path d="M3 16h5v-2H3v2zm6.5 0h5v-2h-5v2zm6.5 0h5v-2h-5v2zM3 20h2v-2H3v2zm4 0h2v-2H7v2zm4 0h2v-2h-2v2zm4 0h2v-2h-2v2zm4 0h2v-2h-2v2zM3 12h8v-2H3v2zm10 0h8v-2h-8v2zM3 4v4h18V4H3z"></path></g>
<g id="line-weight"><path d="M3 17h18v-2H3v2zm0 3h18v-1H3v1zm0-7h18v-3H3v3zm0-9v4h18V4H3z"></path></g>
<g id="link"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></g>
<g id="list"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"></path></g>
<g id="lock"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"></path></g>
<g id="lock-open"><path d="M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z"></path></g>
<g id="lock-outline"><path d="M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM8.9 6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2H8.9V6zM18 20H6V10h12v10z"></path></g>
<g id="low-priority"><path d="M14 5h8v2h-8zm0 5.5h8v2h-8zm0 5.5h8v2h-8zM2 11.5C2 15.08 4.92 18 8.5 18H9v2l3-3-3-3v2h-.5C6.02 16 4 13.98 4 11.5S6.02 7 8.5 7H12V5H8.5C4.92 5 2 7.92 2 11.5z"></path></g>
<g id="loyalty"><path d="M21.41 11.58l-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7zm11.77 8.27L13 19.54l-4.27-4.27C8.28 14.81 8 14.19 8 13.5c0-1.38 1.12-2.5 2.5-2.5.69 0 1.32.28 1.77.74l.73.72.73-.73c.45-.45 1.08-.73 1.77-.73 1.38 0 2.5 1.12 2.5 2.5 0 .69-.28 1.32-.73 1.77z"></path></g>
<g id="mail"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></g>
<g id="markunread"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></g>
<g id="markunread-mailbox"><path d="M20 6H10v6H8V4h6V0H6v6H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2z"></path></g>
<g id="menu"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></g>
<g id="more-horiz"><path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></g>
<g id="more-vert"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></g>
<g id="motorcycle"><path d="M19.44 9.03L15.41 5H11v2h3.59l2 2H5c-2.8 0-5 2.2-5 5s2.2 5 5 5c2.46 0 4.45-1.69 4.9-4h1.65l2.77-2.77c-.21.54-.32 1.14-.32 1.77 0 2.8 2.2 5 5 5s5-2.2 5-5c0-2.65-1.97-4.77-4.56-4.97zM7.82 15C7.4 16.15 6.28 17 5 17c-1.63 0-3-1.37-3-3s1.37-3 3-3c1.28 0 2.4.85 2.82 2H5v2h2.82zM19 17c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"></path></g>
<g id="move-to-inbox"><path d="M19 3H4.99c-1.11 0-1.98.9-1.98 2L3 19c0 1.1.88 2 1.99 2H19c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 12h-4c0 1.66-1.35 3-3 3s-3-1.34-3-3H4.99V5H19v10zm-3-5h-2V7h-4v3H8l4 4 4-4z"></path></g>
<g id="next-week"><path d="M20 7h-4V5c0-.55-.22-1.05-.59-1.41C15.05 3.22 14.55 3 14 3h-4c-1.1 0-2 .9-2 2v2H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2zM10 5h4v2h-4V5zm1 13.5l-1-1 3-3-3-3 1-1 4 4-4 4z"></path></g>
<g id="note-add"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3v2zm-3-7V3.5L18.5 9H13z"></path></g>
<g id="offline-pin"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm5 16H7v-2h10v2zm-6.7-4L7 10.7l1.4-1.4 1.9 1.9 5.3-5.3L17 7.3 10.3 14z"></path></g>
<g id="opacity"><path d="M17.66 8L12 2.35 6.34 8C4.78 9.56 4 11.64 4 13.64s.78 4.11 2.34 5.67 3.61 2.35 5.66 2.35 4.1-.79 5.66-2.35S20 15.64 20 13.64 19.22 9.56 17.66 8zM6 14c.01-2 .62-3.27 1.76-4.4L12 5.27l4.24 4.38C17.38 10.77 17.99 12 18 14H6z"></path></g>
<g id="open-in-browser"><path d="M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h4v-2H5V8h14v10h-4v2h4c1.1 0 2-.9 2-2V6c0-1.1-.89-2-2-2zm-7 6l-4 4h3v6h2v-6h3l-4-4z"></path></g>
<g id="open-in-new"><path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></g>
<g id="open-with"><path d="M10 9h4V6h3l-5-5-5 5h3v3zm-1 1H6V7l-5 5 5 5v-3h3v-4zm14 2l-5-5v3h-3v4h3v3l5-5zm-9 3h-4v3H7l5 5 5-5h-3v-3z"></path></g>
<g id="pageview"><path d="M11.5 9C10.12 9 9 10.12 9 11.5s1.12 2.5 2.5 2.5 2.5-1.12 2.5-2.5S12.88 9 11.5 9zM20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-3.21 14.21l-2.91-2.91c-.69.44-1.51.7-2.39.7C9.01 16 7 13.99 7 11.5S9.01 7 11.5 7 16 9.01 16 11.5c0 .88-.26 1.69-.7 2.39l2.91 2.9-1.42 1.42z"></path></g>
<g id="pan-tool"><path d="M23 5.5V20c0 2.2-1.8 4-4 4h-7.3c-1.08 0-2.1-.43-2.85-1.19L1 14.83s1.26-1.23 1.3-1.25c.22-.19.49-.29.79-.29.22 0 .42.06.6.16.04.01 4.31 2.46 4.31 2.46V4c0-.83.67-1.5 1.5-1.5S11 3.17 11 4v7h1V1.5c0-.83.67-1.5 1.5-1.5S15 .67 15 1.5V11h1V2.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5V11h1V5.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5z"></path></g>
<g id="payment"><path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"></path></g>
<g id="perm-camera-mic"><path d="M20 5h-3.17L15 3H9L7.17 5H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h7v-2.09c-2.83-.48-5-2.94-5-5.91h2c0 2.21 1.79 4 4 4s4-1.79 4-4h2c0 2.97-2.17 5.43-5 5.91V21h7c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-6 8c0 1.1-.9 2-2 2s-2-.9-2-2V9c0-1.1.9-2 2-2s2 .9 2 2v4z"></path></g>
<g id="perm-contact-calendar"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm6 12H6v-1c0-2 4-3.1 6-3.1s6 1.1 6 3.1v1z"></path></g>
<g id="perm-data-setting"><path d="M18.99 11.5c.34 0 .67.03 1 .07L20 0 0 20h11.56c-.04-.33-.07-.66-.07-1 0-4.14 3.36-7.5 7.5-7.5zm3.71 7.99c.02-.16.04-.32.04-.49 0-.17-.01-.33-.04-.49l1.06-.83c.09-.08.12-.21.06-.32l-1-1.73c-.06-.11-.19-.15-.31-.11l-1.24.5c-.26-.2-.54-.37-.85-.49l-.19-1.32c-.01-.12-.12-.21-.24-.21h-2c-.12 0-.23.09-.25.21l-.19 1.32c-.3.13-.59.29-.85.49l-1.24-.5c-.11-.04-.24 0-.31.11l-1 1.73c-.06.11-.04.24.06.32l1.06.83c-.02.16-.03.32-.03.49 0 .17.01.33.03.49l-1.06.83c-.09.08-.12.21-.06.32l1 1.73c.06.11.19.15.31.11l1.24-.5c.26.2.54.37.85.49l.19 1.32c.02.12.12.21.25.21h2c.12 0 .23-.09.25-.21l.19-1.32c.3-.13.59-.29.84-.49l1.25.5c.11.04.24 0 .31-.11l1-1.73c.06-.11.03-.24-.06-.32l-1.07-.83zm-3.71 1.01c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"></path></g>
<g id="perm-device-information"><path d="M13 7h-2v2h2V7zm0 4h-2v6h2v-6zm4-9.99L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14z"></path></g>
<g id="perm-identity"><path d="M12 5.9c1.16 0 2.1.94 2.1 2.1s-.94 2.1-2.1 2.1S9.9 9.16 9.9 8s.94-2.1 2.1-2.1m0 9c2.97 0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4z"></path></g>
<g id="perm-media"><path d="M2 6H0v5h.01L0 20c0 1.1.9 2 2 2h18v-2H2V6zm20-2h-8l-2-2H6c-1.1 0-1.99.9-1.99 2L4 16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7 15l4.5-6 3.5 4.51 2.5-3.01L21 15H7z"></path></g>
<g id="perm-phone-msg"><path d="M20 15.5c-1.25 0-2.45-.2-3.57-.57-.35-.11-.74-.03-1.02.24l-2.2 2.2c-2.83-1.44-5.15-3.75-6.59-6.58l2.2-2.21c.28-.27.36-.66.25-1.01C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.5c0-.55-.45-1-1-1zM12 3v10l3-3h6V3h-9z"></path></g>
<g id="perm-scan-wifi"><path d="M12 3C6.95 3 3.15 4.85 0 7.23L12 22 24 7.25C20.85 4.87 17.05 3 12 3zm1 13h-2v-6h2v6zm-2-8V6h2v2h-2z"></path></g>
<g id="pets"><circle cx="4.5" cy="9.5" r="2.5"></circle><circle cx="9" cy="5.5" r="2.5"></circle><circle cx="15" cy="5.5" r="2.5"></circle><circle cx="19.5" cy="9.5" r="2.5"></circle><path d="M17.34 14.86c-.87-1.02-1.6-1.89-2.48-2.91-.46-.54-1.05-1.08-1.75-1.32-.11-.04-.22-.07-.33-.09-.25-.04-.52-.04-.78-.04s-.53 0-.79.05c-.11.02-.22.05-.33.09-.7.24-1.28.78-1.75 1.32-.87 1.02-1.6 1.89-2.48 2.91-1.31 1.31-2.92 2.76-2.62 4.79.29 1.02 1.02 2.03 2.33 2.32.73.15 3.06-.44 5.54-.44h.18c2.48 0 4.81.58 5.54.44 1.31-.29 2.04-1.31 2.33-2.32.31-2.04-1.3-3.49-2.61-4.8z"></path></g>
<g id="picture-in-picture"><path d="M19 7h-8v6h8V7zm2-4H3c-1.1 0-2 .9-2 2v14c0 1.1.9 1.98 2 1.98h18c1.1 0 2-.88 2-1.98V5c0-1.1-.9-2-2-2zm0 16.01H3V4.98h18v14.03z"></path></g>
<g id="picture-in-picture-alt"><path d="M19 11h-8v6h8v-6zm4 8V4.98C23 3.88 22.1 3 21 3H3c-1.1 0-2 .88-2 1.98V19c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H3V4.97h18v14.05z"></path></g>
<g id="play-for-work"><path d="M11 5v5.59H7.5l4.5 4.5 4.5-4.5H13V5h-2zm-5 9c0 3.31 2.69 6 6 6s6-2.69 6-6h-2c0 2.21-1.79 4-4 4s-4-1.79-4-4H6z"></path></g>
<g id="polymer"><path d="M19 4h-4L7.11 16.63 4.5 12 9 4H5L.5 12 5 20h4l7.89-12.63L19.5 12 15 20h4l4.5-8z"></path></g>
<g id="power-settings-new"><path d="M13 3h-2v10h2V3zm4.83 2.17l-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83z"></path></g>
<g id="pregnant-woman"><path d="M9 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zm7 9c-.01-1.34-.83-2.51-2-3 0-1.66-1.34-3-3-3s-3 1.34-3 3v7h2v5h3v-5h3v-4z"></path></g>
<g id="print"><path d="M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"></path></g>
<g id="query-builder"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"></path></g>
<g id="question-answer"><path d="M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1zm-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1z"></path></g>
<g id="radio-button-checked"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"></path></g>
<g id="radio-button-unchecked"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"></path></g>
<g id="receipt"><path d="M18 17H6v-2h12v2zm0-4H6v-2h12v2zm0-4H6V7h12v2zM3 22l1.5-1.5L6 22l1.5-1.5L9 22l1.5-1.5L12 22l1.5-1.5L15 22l1.5-1.5L18 22l1.5-1.5L21 22V2l-1.5 1.5L18 2l-1.5 1.5L15 2l-1.5 1.5L12 2l-1.5 1.5L9 2 7.5 3.5 6 2 4.5 3.5 3 2v20z"></path></g>
<g id="record-voice-over"><circle cx="9" cy="9" r="4"></circle><path d="M9 15c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4zm7.76-9.64l-1.68 1.69c.84 1.18.84 2.71 0 3.89l1.68 1.69c2.02-2.02 2.02-5.07 0-7.27zM20.07 2l-1.63 1.63c2.77 3.02 2.77 7.56 0 10.74L20.07 16c3.9-3.89 3.91-9.95 0-14z"></path></g>
<g id="redeem"><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z"></path></g>
<g id="redo"><path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"></path></g>
<g id="refresh"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"></path></g>
<g id="remove"><path d="M19 13H5v-2h14v2z"></path></g>
<g id="remove-circle"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11H7v-2h10v2z"></path></g>
<g id="remove-circle-outline"><path d="M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"></path></g>
<g id="remove-shopping-cart"><path d="M22.73 22.73L2.77 2.77 2 2l-.73-.73L0 2.54l4.39 4.39 2.21 4.66-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h7.46l1.38 1.38c-.5.36-.83.95-.83 1.62 0 1.1.89 2 1.99 2 .67 0 1.26-.33 1.62-.84L21.46 24l1.27-1.27zM7.42 15c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h2.36l2 2H7.42zm8.13-2c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H6.54l9.01 9zM7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2z"></path></g>
<g id="reorder"><path d="M3 15h18v-2H3v2zm0 4h18v-2H3v2zm0-8h18V9H3v2zm0-6v2h18V5H3z"></path></g>
<g id="reply"><path d="M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z"></path></g>
<g id="reply-all"><path d="M7 8V5l-7 7 7 7v-3l-4-4 4-4zm6 1V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z"></path></g>
<g id="report"><path d="M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27L15.73 3zM12 17.3c-.72 0-1.3-.58-1.3-1.3 0-.72.58-1.3 1.3-1.3.72 0 1.3.58 1.3 1.3 0 .72-.58 1.3-1.3 1.3zm1-4.3h-2V7h2v6z"></path></g>
<g id="report-problem"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"></path></g>
<g id="restore"><path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"></path></g>
<g id="restore-page"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm-2 16c-2.05 0-3.81-1.24-4.58-3h1.71c.63.9 1.68 1.5 2.87 1.5 1.93 0 3.5-1.57 3.5-3.5S13.93 9.5 12 9.5c-1.35 0-2.52.78-3.1 1.9l1.6 1.6h-4V9l1.3 1.3C8.69 8.92 10.23 8 12 8c2.76 0 5 2.24 5 5s-2.24 5-5 5z"></path></g>
<g id="room"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"></path></g>
<g id="rounded-corner"><path d="M19 19h2v2h-2v-2zm0-2h2v-2h-2v2zM3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm0-4h2V3H3v2zm4 0h2V3H7v2zm8 16h2v-2h-2v2zm-4 0h2v-2h-2v2zm4 0h2v-2h-2v2zm-8 0h2v-2H7v2zm-4 0h2v-2H3v2zM21 8c0-2.76-2.24-5-5-5h-5v2h5c1.65 0 3 1.35 3 3v5h2V8z"></path></g>
<g id="rowing"><path d="M8.5 14.5L4 19l1.5 1.5L9 17h2l-2.5-2.5zM15 1c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 20.01L18 24l-2.99-3.01V19.5l-7.1-7.09c-.31.05-.61.07-.91.07v-2.16c1.66.03 3.61-.87 4.67-2.04l1.4-1.55c.19-.21.43-.38.69-.5.29-.14.62-.23.96-.23h.03C15.99 6.01 17 7.02 17 8.26v5.75c0 .84-.35 1.61-.92 2.16l-3.58-3.58v-2.27c-.63.52-1.43 1.02-2.29 1.39L16.5 18H18l3 3.01z"></path></g>
<g id="save"><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"></path></g>
<g id="schedule"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"></path></g>
<g id="search"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></g>
<g id="select-all"><path d="M3 5h2V3c-1.1 0-2 .9-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2c0-1.1-.9-2-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2zM7 17h10V7H7v10zm2-8h6v6H9V9z"></path></g>
<g id="send"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></g>
<g id="settings"><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"></path></g>
<g id="settings-applications"><path d="M12 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm7-7H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-1.75 9c0 .23-.02.46-.05.68l1.48 1.16c.13.11.17.3.08.45l-1.4 2.42c-.09.15-.27.21-.43.15l-1.74-.7c-.36.28-.76.51-1.18.69l-.26 1.85c-.03.17-.18.3-.35.3h-2.8c-.17 0-.32-.13-.35-.29l-.26-1.85c-.43-.18-.82-.41-1.18-.69l-1.74.7c-.16.06-.34 0-.43-.15l-1.4-2.42c-.09-.15-.05-.34.08-.45l1.48-1.16c-.03-.23-.05-.46-.05-.69 0-.23.02-.46.05-.68l-1.48-1.16c-.13-.11-.17-.3-.08-.45l1.4-2.42c.09-.15.27-.21.43-.15l1.74.7c.36-.28.76-.51 1.18-.69l.26-1.85c.03-.17.18-.3.35-.3h2.8c.17 0 .32.13.35.29l.26 1.85c.43.18.82.41 1.18.69l1.74-.7c.16-.06.34 0 .43.15l1.4 2.42c.09.15.05.34-.08.45l-1.48 1.16c.03.23.05.46.05.69z"></path></g>
<g id="settings-backup-restore"><path d="M14 12c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2 2-.9 2-2zm-2-9c-4.97 0-9 4.03-9 9H0l4 4 4-4H5c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.51 0-2.91-.49-4.06-1.3l-1.42 1.44C8.04 20.3 9.94 21 12 21c4.97 0 9-4.03 9-9s-4.03-9-9-9z"></path></g>
<g id="settings-bluetooth"><path d="M11 24h2v-2h-2v2zm-4 0h2v-2H7v2zm8 0h2v-2h-2v2zm2.71-18.29L12 0h-1v7.59L6.41 3 5 4.41 10.59 10 5 15.59 6.41 17 11 12.41V20h1l5.71-5.71-4.3-4.29 4.3-4.29zM13 3.83l1.88 1.88L13 7.59V3.83zm1.88 10.46L13 16.17v-3.76l1.88 1.88z"></path></g>
<g id="settings-brightness"><path d="M21 3H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16.01H3V4.99h18v14.02zM8 16h2.5l1.5 1.5 1.5-1.5H16v-2.5l1.5-1.5-1.5-1.5V8h-2.5L12 6.5 10.5 8H8v2.5L6.5 12 8 13.5V16zm4-7c1.66 0 3 1.34 3 3s-1.34 3-3 3V9z"></path></g>
<g id="settings-cell"><path d="M7 24h2v-2H7v2zm4 0h2v-2h-2v2zm4 0h2v-2h-2v2zM16 .01L8 0C6.9 0 6 .9 6 2v16c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V2c0-1.1-.9-1.99-2-1.99zM16 16H8V4h8v12z"></path></g>
<g id="settings-ethernet"><path d="M7.77 6.76L6.23 5.48.82 12l5.41 6.52 1.54-1.28L3.42 12l4.35-5.24zM7 13h2v-2H7v2zm10-2h-2v2h2v-2zm-6 2h2v-2h-2v2zm6.77-7.52l-1.54 1.28L20.58 12l-4.35 5.24 1.54 1.28L23.18 12l-5.41-6.52z"></path></g>
<g id="settings-input-antenna"><path d="M12 5c-3.87 0-7 3.13-7 7h2c0-2.76 2.24-5 5-5s5 2.24 5 5h2c0-3.87-3.13-7-7-7zm1 9.29c.88-.39 1.5-1.26 1.5-2.29 0-1.38-1.12-2.5-2.5-2.5S9.5 10.62 9.5 12c0 1.02.62 1.9 1.5 2.29v3.3L7.59 21 9 22.41l3-3 3 3L16.41 21 13 17.59v-3.3zM12 1C5.93 1 1 5.93 1 12h2c0-4.97 4.03-9 9-9s9 4.03 9 9h2c0-6.07-4.93-11-11-11z"></path></g>
<g id="settings-input-component"><path d="M5 2c0-.55-.45-1-1-1s-1 .45-1 1v4H1v6h6V6H5V2zm4 14c0 1.3.84 2.4 2 2.82V23h2v-4.18c1.16-.41 2-1.51 2-2.82v-2H9v2zm-8 0c0 1.3.84 2.4 2 2.82V23h2v-4.18C6.16 18.4 7 17.3 7 16v-2H1v2zM21 6V2c0-.55-.45-1-1-1s-1 .45-1 1v4h-2v6h6V6h-2zm-8-4c0-.55-.45-1-1-1s-1 .45-1 1v4H9v6h6V6h-2V2zm4 14c0 1.3.84 2.4 2 2.82V23h2v-4.18c1.16-.41 2-1.51 2-2.82v-2h-6v2z"></path></g>
<g id="settings-input-composite"><path d="M5 2c0-.55-.45-1-1-1s-1 .45-1 1v4H1v6h6V6H5V2zm4 14c0 1.3.84 2.4 2 2.82V23h2v-4.18c1.16-.41 2-1.51 2-2.82v-2H9v2zm-8 0c0 1.3.84 2.4 2 2.82V23h2v-4.18C6.16 18.4 7 17.3 7 16v-2H1v2zM21 6V2c0-.55-.45-1-1-1s-1 .45-1 1v4h-2v6h6V6h-2zm-8-4c0-.55-.45-1-1-1s-1 .45-1 1v4H9v6h6V6h-2V2zm4 14c0 1.3.84 2.4 2 2.82V23h2v-4.18c1.16-.41 2-1.51 2-2.82v-2h-6v2z"></path></g>
<g id="settings-input-hdmi"><path d="M18 7V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v3H5v6l3 6v3h8v-3l3-6V7h-1zM8 4h8v3h-2V5h-1v2h-2V5h-1v2H8V4z"></path></g>
<g id="settings-input-svideo"><path d="M8 11.5c0-.83-.67-1.5-1.5-1.5S5 10.67 5 11.5 5.67 13 6.5 13 8 12.33 8 11.5zm7-5c0-.83-.67-1.5-1.5-1.5h-3C9.67 5 9 5.67 9 6.5S9.67 8 10.5 8h3c.83 0 1.5-.67 1.5-1.5zM8.5 15c-.83 0-1.5.67-1.5 1.5S7.67 18 8.5 18s1.5-.67 1.5-1.5S9.33 15 8.5 15zM12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9zm5.5-11c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm-2 5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"></path></g>
<g id="settings-overscan"><path d="M12.01 5.5L10 8h4l-1.99-2.5zM18 10v4l2.5-1.99L18 10zM6 10l-2.5 2.01L6 14v-4zm8 6h-4l2.01 2.5L14 16zm7-13H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16.01H3V4.99h18v14.02z"></path></g>
<g id="settings-phone"><path d="M13 9h-2v2h2V9zm4 0h-2v2h2V9zm3 6.5c-1.25 0-2.45-.2-3.57-.57-.35-.11-.74-.03-1.02.24l-2.2 2.2c-2.83-1.44-5.15-3.75-6.59-6.58l2.2-2.21c.28-.27.36-.66.25-1.01C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.5c0-.55-.45-1-1-1zM19 9v2h2V9h-2z"></path></g>
<g id="settings-power"><path d="M7 24h2v-2H7v2zm4 0h2v-2h-2v2zm2-22h-2v10h2V2zm3.56 2.44l-1.45 1.45C16.84 6.94 18 8.83 18 11c0 3.31-2.69 6-6 6s-6-2.69-6-6c0-2.17 1.16-4.06 2.88-5.12L7.44 4.44C5.36 5.88 4 8.28 4 11c0 4.42 3.58 8 8 8s8-3.58 8-8c0-2.72-1.36-5.12-3.44-6.56zM15 24h2v-2h-2v2z"></path></g>
<g id="settings-remote"><path d="M15 9H9c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V10c0-.55-.45-1-1-1zm-3 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM7.05 6.05l1.41 1.41C9.37 6.56 10.62 6 12 6s2.63.56 3.54 1.46l1.41-1.41C15.68 4.78 13.93 4 12 4s-3.68.78-4.95 2.05zM12 0C8.96 0 6.21 1.23 4.22 3.22l1.41 1.41C7.26 3.01 9.51 2 12 2s4.74 1.01 6.36 2.64l1.41-1.41C17.79 1.23 15.04 0 12 0z"></path></g>
<g id="settings-voice"><path d="M7 24h2v-2H7v2zm5-11c1.66 0 2.99-1.34 2.99-3L15 4c0-1.66-1.34-3-3-3S9 2.34 9 4v6c0 1.66 1.34 3 3 3zm-1 11h2v-2h-2v2zm4 0h2v-2h-2v2zm4-14h-1.7c0 3-2.54 5.1-5.3 5.1S6.7 13 6.7 10H5c0 3.41 2.72 6.23 6 6.72V20h2v-3.28c3.28-.49 6-3.31 6-6.72z"></path></g>
<g id="shop"><path d="M16 6V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H2v13c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6h-6zm-6-2h4v2h-4V4zM9 18V9l7.5 4L9 18z"></path></g>
<g id="shop-two"><path d="M3 9H1v11c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2H3V9zm15-4V3c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H5v11c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5h-5zm-6-2h4v2h-4V3zm0 12V8l5.5 3-5.5 4z"></path></g>
<g id="shopping-basket"><path d="M17.21 9l-4.38-6.56c-.19-.28-.51-.42-.83-.42-.32 0-.64.14-.83.43L6.79 9H2c-.55 0-1 .45-1 1 0 .09.01.18.04.27l2.54 9.27c.23.84 1 1.46 1.92 1.46h13c.92 0 1.69-.62 1.93-1.46l2.54-9.27L23 10c0-.55-.45-1-1-1h-4.79zM9 9l3-4.4L15 9H9zm3 8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"></path></g>
<g id="shopping-cart"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"></path></g>
<g id="sort"><path d="M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z"></path></g>
<g id="speaker-notes"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 14H6v-2h2v2zm0-3H6V9h2v2zm0-3H6V6h2v2zm7 6h-5v-2h5v2zm3-3h-8V9h8v2zm0-3h-8V6h8v2z"></path></g>
<g id="speaker-notes-off"><path d="M10.54 11l-.54-.54L7.54 8 6 6.46 2.38 2.84 1.27 1.73 0 3l2.01 2.01L2 22l4-4h9l5.73 5.73L22 22.46 17.54 18l-7-7zM8 14H6v-2h2v2zm-2-3V9l2 2H6zm14-9H4.08L10 7.92V6h8v2h-7.92l1 1H18v2h-4.92l6.99 6.99C21.14 17.95 22 17.08 22 16V4c0-1.1-.9-2-2-2z"></path></g>
<g id="spellcheck"><path d="M12.45 16h2.09L9.43 3H7.57L2.46 16h2.09l1.12-3h5.64l1.14 3zm-6.02-5L8.5 5.48 10.57 11H6.43zm15.16.59l-8.09 8.09L9.83 16l-1.41 1.41 5.09 5.09L23 13l-1.41-1.41z"></path></g>
<g id="star"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></g>
<g id="star-border"><path d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"></path></g>
<g id="star-half"><path d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4V6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"></path></g>
<g id="stars"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm4.24 16L12 15.45 7.77 18l1.12-4.81-3.73-3.23 4.92-.42L12 5l1.92 4.53 4.92.42-3.73 3.23L16.23 18z"></path></g>
<g id="store"><path d="M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"></path></g>
<g id="subdirectory-arrow-left"><path d="M11 9l1.42 1.42L8.83 14H18V4h2v12H8.83l3.59 3.58L11 21l-6-6 6-6z"></path></g>
<g id="subdirectory-arrow-right"><path d="M19 15l-6 6-1.42-1.42L15.17 16H4V4h2v10h9.17l-3.59-3.58L13 9l6 6z"></path></g>
<g id="subject"><path d="M14 17H4v2h10v-2zm6-8H4v2h16V9zM4 15h16v-2H4v2zM4 5v2h16V5H4z"></path></g>
<g id="supervisor-account"><path d="M16.5 12c1.38 0 2.49-1.12 2.49-2.5S17.88 7 16.5 7C15.12 7 14 8.12 14 9.5s1.12 2.5 2.5 2.5zM9 11c1.66 0 2.99-1.34 2.99-3S10.66 5 9 5C7.34 5 6 6.34 6 8s1.34 3 3 3zm7.5 3c-1.83 0-5.5.92-5.5 2.75V19h11v-2.25c0-1.83-3.67-2.75-5.5-2.75zM9 13c-2.33 0-7 1.17-7 3.5V19h7v-2.25c0-.85.33-2.34 2.37-3.47C10.5 13.1 9.66 13 9 13z"></path></g>
<g id="swap-horiz"><path d="M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"></path></g>
<g id="swap-vert"><path d="M16 17.01V10h-2v7.01h-3L15 21l4-3.99h-3zM9 3L5 6.99h3V14h2V6.99h3L9 3z"></path></g>
<g id="swap-vertical-circle"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM6.5 9L10 5.5 13.5 9H11v4H9V9H6.5zm11 6L14 18.5 10.5 15H13v-4h2v4h2.5z"></path></g>
<g id="system-update-alt"><path d="M12 16.5l4-4h-3v-9h-2v9H8l4 4zm9-13h-6v1.99h6v14.03H3V5.49h6V3.5H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2v-14c0-1.1-.9-2-2-2z"></path></g>
<g id="tab"><path d="M21 3H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H3V5h10v4h8v10z"></path></g>
<g id="tab-unselected"><path d="M1 9h2V7H1v2zm0 4h2v-2H1v2zm0-8h2V3c-1.1 0-2 .9-2 2zm8 16h2v-2H9v2zm-8-4h2v-2H1v2zm2 4v-2H1c0 1.1.9 2 2 2zM21 3h-8v6h10V5c0-1.1-.9-2-2-2zm0 14h2v-2h-2v2zM9 5h2V3H9v2zM5 21h2v-2H5v2zM5 5h2V3H5v2zm16 16c1.1 0 2-.9 2-2h-2v2zm0-8h2v-2h-2v2zm-8 8h2v-2h-2v2zm4 0h2v-2h-2v2z"></path></g>
<g id="text-format"><path d="M5 17v2h14v-2H5zm4.5-4.2h5l.9 2.2h2.1L12.75 4h-1.5L6.5 15h2.1l.9-2.2zM12 5.98L13.87 11h-3.74L12 5.98z"></path></g>
<g id="theaters"><path d="M18 3v2h-2V3H8v2H6V3H4v18h2v-2h2v2h8v-2h2v2h2V3h-2zM8 17H6v-2h2v2zm0-4H6v-2h2v2zm0-4H6V7h2v2zm10 8h-2v-2h2v2zm0-4h-2v-2h2v2zm0-4h-2V7h2v2z"></path></g>
<g id="thumb-down"><path d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v1.91l.01.01L1 14c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z"></path></g>
<g id="thumb-up"><path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-1.91l-.01-.01L23 10z"></path></g>
<g id="thumbs-up-down"><path d="M12 6c0-.55-.45-1-1-1H5.82l.66-3.18.02-.23c0-.31-.13-.59-.33-.8L5.38 0 .44 4.94C.17 5.21 0 5.59 0 6v6.5c0 .83.67 1.5 1.5 1.5h6.75c.62 0 1.15-.38 1.38-.91l2.26-5.29c.07-.17.11-.36.11-.55V6zm10.5 4h-6.75c-.62 0-1.15.38-1.38.91l-2.26 5.29c-.07.17-.11.36-.11.55V18c0 .55.45 1 1 1h5.18l-.66 3.18-.02.24c0 .31.13.59.33.8l.79.78 4.94-4.94c.27-.27.44-.65.44-1.06v-6.5c0-.83-.67-1.5-1.5-1.5z"></path></g>
<g id="timeline"><path d="M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2z"></path></g>
<g id="toc"><path d="M3 9h14V7H3v2zm0 4h14v-2H3v2zm0 4h14v-2H3v2zm16 0h2v-2h-2v2zm0-10v2h2V7h-2zm0 6h2v-2h-2v2z"></path></g>
<g id="today"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"></path></g>
<g id="toll"><path d="M15 4c-4.42 0-8 3.58-8 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zM3 12c0-2.61 1.67-4.83 4-5.65V4.26C3.55 5.15 1 8.27 1 12s2.55 6.85 6 7.74v-2.09c-2.33-.82-4-3.04-4-5.65z"></path></g>
<g id="touch-app"><path d="M9 11.24V7.5C9 6.12 10.12 5 11.5 5S14 6.12 14 7.5v3.74c1.21-.81 2-2.18 2-3.74C16 5.01 13.99 3 11.5 3S7 5.01 7 7.5c0 1.56.79 2.93 2 3.74zm9.84 4.63l-4.54-2.26c-.17-.07-.35-.11-.54-.11H13v-6c0-.83-.67-1.5-1.5-1.5S10 6.67 10 7.5v10.74l-3.43-.72c-.08-.01-.15-.03-.24-.03-.31 0-.59.13-.79.33l-.79.8 4.94 4.94c.27.27.65.44 1.06.44h6.79c.75 0 1.33-.55 1.44-1.28l.75-5.27c.01-.07.02-.14.02-.2 0-.62-.38-1.16-.91-1.38z"></path></g>
<g id="track-changes"><path d="M19.07 4.93l-1.41 1.41C19.1 7.79 20 9.79 20 12c0 4.42-3.58 8-8 8s-8-3.58-8-8c0-4.08 3.05-7.44 7-7.93v2.02C8.16 6.57 6 9.03 6 12c0 3.31 2.69 6 6 6s6-2.69 6-6c0-1.66-.67-3.16-1.76-4.24l-1.41 1.41C15.55 9.9 16 10.9 16 12c0 2.21-1.79 4-4 4s-4-1.79-4-4c0-1.86 1.28-3.41 3-3.86v2.14c-.6.35-1 .98-1 1.72 0 1.1.9 2 2 2s2-.9 2-2c0-.74-.4-1.38-1-1.72V2h-1C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10c0-2.76-1.12-5.26-2.93-7.07z"></path></g>
<g id="translate"><path d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></g>
<g id="trending-down"><path d="M16 18l2.29-2.29-4.88-4.88-4 4L2 7.41 3.41 6l6 6 4-4 6.3 6.29L22 12v6z"></path></g>
<g id="trending-flat"><path d="M22 12l-4-4v3H3v2h15v3z"></path></g>
<g id="trending-up"><path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"></path></g>
<g id="turned-in"><path d="M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2z"></path></g>
<g id="turned-in-not"><path d="M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2zm0 15l-5-2.18L7 18V5h10v13z"></path></g>
<g id="unarchive"><path d="M20.55 5.22l-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.15.55L3.46 5.22C3.17 5.57 3 6.01 3 6.5V19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.49-.17-.93-.45-1.28zM12 9.5l5.5 5.5H14v2h-4v-2H6.5L12 9.5zM5.12 5l.82-1h12l.93 1H5.12z"></path></g>
<g id="undo"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"></path></g>
<g id="unfold-less"><path d="M7.41 18.59L8.83 20 12 16.83 15.17 20l1.41-1.41L12 14l-4.59 4.59zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10l4.59-4.59z"></path></g>
<g id="unfold-more"><path d="M12 5.83L15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9 12 5.83zm0 12.34L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15 12 18.17z"></path></g>
<g id="update"><path d="M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79 2.73 2.71 7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58 3.51-3.47 9.14-3.47 12.65 0L21 3v7.12zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8h1.5z"></path></g>
<g id="verified-user"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"></path></g>
<g id="view-agenda"><path d="M20 13H3c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h17c.55 0 1-.45 1-1v-6c0-.55-.45-1-1-1zm0-10H3c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h17c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1z"></path></g>
<g id="view-array"><path d="M4 18h3V5H4v13zM18 5v13h3V5h-3zM8 18h9V5H8v13z"></path></g>
<g id="view-carousel"><path d="M7 19h10V4H7v15zm-5-2h4V6H2v11zM18 6v11h4V6h-4z"></path></g>
<g id="view-column"><path d="M10 18h5V5h-5v13zm-6 0h5V5H4v13zM16 5v13h5V5h-5z"></path></g>
<g id="view-day"><path d="M2 21h19v-3H2v3zM20 8H3c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h17c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zM2 3v3h19V3H2z"></path></g>
<g id="view-headline"><path d="M4 15h16v-2H4v2zm0 4h16v-2H4v2zm0-8h16V9H4v2zm0-6v2h16V5H4z"></path></g>
<g id="view-list"><path d="M4 14h4v-4H4v4zm0 5h4v-4H4v4zM4 9h4V5H4v4zm5 5h12v-4H9v4zm0 5h12v-4H9v4zM9 5v4h12V5H9z"></path></g>
<g id="view-module"><path d="M4 11h5V5H4v6zm0 7h5v-6H4v6zm6 0h5v-6h-5v6zm6 0h5v-6h-5v6zm-6-7h5V5h-5v6zm6-6v6h5V5h-5z"></path></g>
<g id="view-quilt"><path d="M10 18h5v-6h-5v6zm-6 0h5V5H4v13zm12 0h5v-6h-5v6zM10 5v6h11V5H10z"></path></g>
<g id="view-stream"><path d="M4 18h17v-6H4v6zM4 5v6h17V5H4z"></path></g>
<g id="view-week"><path d="M6 5H3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1zm14 0h-3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1zm-7 0h-3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1z"></path></g>
<g id="visibility"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></g>
<g id="visibility-off"><path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"></path></g>
<g id="warning"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"></path></g>
<g id="watch-later"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm4.2 14.2L11 13V7h1.5v5.2l4.5 2.7-.8 1.3z"></path></g>
<g id="weekend"><path d="M21 10c-1.1 0-2 .9-2 2v3H5v-3c0-1.1-.9-2-2-2s-2 .9-2 2v5c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2v-5c0-1.1-.9-2-2-2zm-3-5H6c-1.1 0-2 .9-2 2v2.15c1.16.41 2 1.51 2 2.82V14h12v-2.03c0-1.3.84-2.4 2-2.82V7c0-1.1-.9-2-2-2z"></path></g>
<g id="work"><path d="M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-6 0h-4V4h4v2z"></path></g>
<g id="youtube-searched-for"><path d="M17.01 14h-.8l-.27-.27c.98-1.14 1.57-2.61 1.57-4.23 0-3.59-2.91-6.5-6.5-6.5s-6.5 3-6.5 6.5H2l3.84 4 4.16-4H6.51C6.51 7 8.53 5 11.01 5s4.5 2.01 4.5 4.5c0 2.48-2.02 4.5-4.5 4.5-.65 0-1.26-.14-1.82-.38L7.71 15.1c.97.57 2.09.9 3.3.9 1.61 0 3.08-.59 4.22-1.57l.27.27v.79l5.01 4.99L22 19l-4.99-5z"></path></g>
<g id="zoom-in"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zm2.5-4h-2v2H9v-2H7V9h2V7h1v2h2v1z"></path></g>
<g id="zoom-out"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z"></path></g>
</defs></svg>
</iron-iconset-svg>`;document.head.appendChild(bq.content);var oA={"U+0008":"backspace","U+0009":"tab","U+001B":"esc","U+0020":"space","U+007F":"del"},_q={8:"backspace",9:"tab",13:"enter",27:"esc",33:"pageup",34:"pagedown",35:"end",36:"home",32:"space",37:"left",38:"up",39:"right",40:"down",46:"del",106:"*"},sA={shift:"shiftKey",ctrl:"ctrlKey",alt:"altKey",meta:"metaKey"},wq=/[a-z0-9*]/,Sq=/U\+/,Cq=/^arrow/,Mq=/^space(bar)?/,Eq=/^escape$/;function aA(i,t){var e="";if(i){var n=i.toLowerCase();n===" "||Mq.test(n)?e="space":Eq.test(n)?e="esc":n.length==1?(!t||wq.test(n))&&(e=n):Cq.test(n)?e=n.replace("arrow",""):n=="multiply"?e="*":e=n}return e}function Tq(i){var t="";return i&&(i in oA?t=oA[i]:Sq.test(i)?(i=parseInt(i.replace("U+","0x"),16),t=String.fromCharCode(i).toLowerCase()):t=i.toLowerCase()),t}function Iq(i){var t="";return Number(i)&&(i>=65&&i<=90?t=String.fromCharCode(32+i):i>=112&&i<=123?t="f"+(i-112+1):i>=48&&i<=57?t=String(i-48):i>=96&&i<=105?t=String(i-96):t=_q[i]),t}function Aq(i,t){return i.key?aA(i.key,t):i.detail&&i.detail.key?aA(i.detail.key,t):Tq(i.keyIdentifier)||Iq(i.keyCode)||""}function lA(i,t){var e=Aq(t,i.hasModifiers);return e===i.key&&(!i.hasModifiers||!!t.shiftKey==!!i.shiftKey&&!!t.ctrlKey==!!i.ctrlKey&&!!t.altKey==!!i.altKey&&!!t.metaKey==!!i.metaKey)}function kq(i){return i.length===1?{combo:i,key:i,event:"keydown"}:i.split("+").reduce(function(t,e){var n=e.split(":"),r=n[0],o=n[1];return r in sA?(t[sA[r]]=!0,t.hasModifiers=!0):(t.key=r,t.event=o||"keydown"),t},{combo:i.split(":").shift()})}function cA(i){return i.trim().split(" ").map(function(t){return kq(t)})}var jn={properties:{keyEventTarget:{type:Object,value:function(){return this}},stopKeyboardEventPropagation:{type:Boolean,value:!1},_boundKeyHandlers:{type:Array,value:function(){return[]}},_imperativeKeyBindings:{type:Object,value:function(){return{}}}},observers:["_resetKeyEventListeners(keyEventTarget, _boundKeyHandlers)"],keyBindings:{},registered:function(){this._prepKeyBindings()},attached:function(){this._listenKeyEventListeners()},detached:function(){this._unlistenKeyEventListeners()},addOwnKeyBinding:function(i,t){this._imperativeKeyBindings[i]=t,this._prepKeyBindings(),this._resetKeyEventListeners()},removeOwnKeyBindings:function(){this._imperativeKeyBindings={},this._prepKeyBindings(),this._resetKeyEventListeners()},keyboardEventMatchesKeys:function(i,t){for(var e=cA(t),n=0;n<e.length;++n)if(lA(e[n],i))return!0;return!1},_collectKeyBindings:function(){var i=this.behaviors.map(function(t){return t.keyBindings});return i.indexOf(this.keyBindings)===-1&&i.push(this.keyBindings),i},_prepKeyBindings:function(){this._keyBindings={},this._collectKeyBindings().forEach(function(e){for(var n in e)this._addKeyBinding(n,e[n])},this);for(var i in this._imperativeKeyBindings)this._addKeyBinding(i,this._imperativeKeyBindings[i]);for(var t in this._keyBindings)this._keyBindings[t].sort(function(e,n){var r=e[0].hasModifiers,o=n[0].hasModifiers;return r===o?0:r?-1:1})},_addKeyBinding:function(i,t){cA(i).forEach(function(e){this._keyBindings[e.event]=this._keyBindings[e.event]||[],this._keyBindings[e.event].push([e,t])},this)},_resetKeyEventListeners:function(){this._unlistenKeyEventListeners(),this.isAttached&&this._listenKeyEventListeners()},_listenKeyEventListeners:function(){!this.keyEventTarget||Object.keys(this._keyBindings).forEach(function(i){var t=this._keyBindings[i],e=this._onKeyBindingEvent.bind(this,t);this._boundKeyHandlers.push([this.keyEventTarget,i,e]),this.keyEventTarget.addEventListener(i,e)},this)},_unlistenKeyEventListeners:function(){for(var i,t,e,n;this._boundKeyHandlers.length;)i=this._boundKeyHandlers.pop(),t=i[0],e=i[1],n=i[2],t.removeEventListener(e,n)},_onKeyBindingEvent:function(i,t){if(this.stopKeyboardEventPropagation&&t.stopPropagation(),!t.defaultPrevented)for(var e=0;e<i.length;e++){var n=i[e][0],r=i[e][1];if(lA(n,t)&&(this._triggerKeyHandler(n,r,t),t.defaultPrevented))return}},_triggerKeyHandler:function(i,t,e){var n=Object.create(i);n.keyboardEvent=e;var r=new CustomEvent(i.event,{detail:n,cancelable:!0});this[t].call(this,r),r.defaultPrevented&&e.preventDefault()}};var uA={properties:{scrollTarget:{type:HTMLElement,value:function(){return this._defaultScrollTarget}}},observers:["_scrollTargetChanged(scrollTarget, isAttached)"],_shouldHaveListener:!0,_scrollTargetChanged:function(i,t){var e;if(this._oldScrollTarget&&(this._toggleScrollListener(!1,this._oldScrollTarget),this._oldScrollTarget=null),!!t)if(i==="document")this.scrollTarget=this._doc;else if(typeof i=="string"){var n=this.domHost;this.scrollTarget=n&&n.$?n.$[i]:Mt(this.ownerDocument).querySelector("#"+i)}else this._isValidScrollTarget()&&(this._oldScrollTarget=i,this._toggleScrollListener(this._shouldHaveListener,i))},_scrollHandler:function(){},get _defaultScrollTarget(){return this._doc},get _doc(){return this.ownerDocument.documentElement},get _scrollTop(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.pageYOffset:this.scrollTarget.scrollTop:0},get _scrollLeft(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.pageXOffset:this.scrollTarget.scrollLeft:0},set _scrollTop(i){this.scrollTarget===this._doc?window.scrollTo(window.pageXOffset,i):this._isValidScrollTarget()&&(this.scrollTarget.scrollTop=i)},set _scrollLeft(i){this.scrollTarget===this._doc?window.scrollTo(i,window.pageYOffset):this._isValidScrollTarget()&&(this.scrollTarget.scrollLeft=i)},scroll:function(i,t){var e;typeof i=="object"?(e=i.left,t=i.top):e=i,e=e||0,t=t||0,this.scrollTarget===this._doc?window.scrollTo(e,t):this._isValidScrollTarget()&&(this.scrollTarget.scrollLeft=e,this.scrollTarget.scrollTop=t)},get _scrollTargetWidth(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.innerWidth:this.scrollTarget.offsetWidth:0},get _scrollTargetHeight(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.innerHeight:this.scrollTarget.offsetHeight:0},_isValidScrollTarget:function(){return this.scrollTarget instanceof HTMLElement},_toggleScrollListener:function(i,t){var e=t===this._doc?window:t;i?this._boundScrollHandler||(this._boundScrollHandler=this._scrollHandler.bind(this),e.addEventListener("scroll",this._boundScrollHandler)):this._boundScrollHandler&&(e.removeEventListener("scroll",this._boundScrollHandler),this._boundScrollHandler=null)},toggleScrollListener:function(i){this._shouldHaveListener=i,this._toggleScrollListener(i,this.scrollTarget)}};var hA=navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/),Rq=hA&&hA[1]>=8,pA=3,fA="-10000px",fp=-100;It({_template:ut`
    <style>
      :host {
        display: block;
      }

      @media only screen and (-webkit-max-device-pixel-ratio: 1) {
        :host {
          will-change: transform;
        }
      }

      #items {
        @apply --iron-list-items-container;
        position: relative;
      }

      :host(:not([grid])) #items > ::slotted(*) {
        width: 100%;
      }

      #items > ::slotted(*) {
        box-sizing: border-box;
        margin: 0;
        position: absolute;
        top: 0;
        will-change: transform;
      }
    </style>

    <array-selector id="selector" items="{{items}}" selected="{{selectedItems}}" selected-item="{{selectedItem}}"></array-selector>

    <div id="items">
      <slot></slot>
    </div>
`,is:"iron-list",properties:{items:{type:Array},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},selectedAs:{type:String,value:"selected"},grid:{type:Boolean,value:!1,reflectToAttribute:!0,observer:"_gridChanged"},selectionEnabled:{type:Boolean,value:!1},selectedItem:{type:Object,notify:!0},selectedItems:{type:Object,notify:!0},multiSelection:{type:Boolean,value:!1},scrollOffset:{type:Number,value:0}},observers:["_itemsChanged(items.*)","_selectionEnabledChanged(selectionEnabled)","_multiSelectionChanged(multiSelection)","_setOverflow(scrollTarget, scrollOffset)"],behaviors:[YI,Br,uA,eA],_ratio:.5,_scrollerPaddingTop:0,_scrollPosition:0,_physicalSize:0,_physicalAverage:0,_physicalAverageCount:0,_physicalTop:0,_virtualCount:0,_estScrollHeight:0,_scrollHeight:0,_viewportHeight:0,_viewportWidth:0,_physicalItems:null,_physicalSizes:null,_firstVisibleIndexVal:null,_lastVisibleIndexVal:null,_maxPages:2,_focusedItem:null,_focusedVirtualIndex:-1,_focusedPhysicalIndex:-1,_offscreenFocusedItem:null,_focusBackfillItem:null,_itemsPerRow:1,_itemWidth:0,_rowHeight:0,_templateCost:0,_parentModel:!0,get _physicalBottom(){return this._physicalTop+this._physicalSize},get _scrollBottom(){return this._scrollPosition+this._viewportHeight},get _virtualEnd(){return this._virtualStart+this._physicalCount-1},get _hiddenContentSize(){var i=this.grid?this._physicalRows*this._rowHeight:this._physicalSize;return i-this._viewportHeight},get _itemsParent(){return Mt(Mt(this._userTemplate).parentNode)},get _maxScrollTop(){return this._estScrollHeight-this._viewportHeight+this._scrollOffset},get _maxVirtualStart(){var i=this._convertIndexToCompleteRow(this._virtualCount);return Math.max(0,i-this._physicalCount)},set _virtualStart(i){i=this._clamp(i,0,this._maxVirtualStart),this.grid&&(i=i-i%this._itemsPerRow),this._virtualStartVal=i},get _virtualStart(){return this._virtualStartVal||0},set _physicalStart(i){i=i%this._physicalCount,i<0&&(i=this._physicalCount+i),this.grid&&(i=i-i%this._itemsPerRow),this._physicalStartVal=i},get _physicalStart(){return this._physicalStartVal||0},get _physicalEnd(){return(this._physicalStart+this._physicalCount-1)%this._physicalCount},set _physicalCount(i){this._physicalCountVal=i},get _physicalCount(){return this._physicalCountVal||0},get _optPhysicalSize(){return this._viewportHeight===0?1/0:this._viewportHeight*this._maxPages},get _isVisible(){return Boolean(this.offsetWidth||this.offsetHeight)},get firstVisibleIndex(){var i=this._firstVisibleIndexVal;if(i==null){var t=this._physicalTop+this._scrollOffset;i=this._iterateItems(function(e,n){if(t+=this._getPhysicalSizeIncrement(e),t>this._scrollPosition)return this.grid?n-n%this._itemsPerRow:n;if(this.grid&&this._virtualCount-1===n)return n-n%this._itemsPerRow})||0,this._firstVisibleIndexVal=i}return i},get lastVisibleIndex(){var i=this._lastVisibleIndexVal;if(i==null){if(this.grid)i=Math.min(this._virtualCount,this.firstVisibleIndex+this._estRowsInView*this._itemsPerRow-1);else{var t=this._physicalTop+this._scrollOffset;this._iterateItems(function(e,n){t<this._scrollBottom&&(i=n),t+=this._getPhysicalSizeIncrement(e)})}this._lastVisibleIndexVal=i}return i},get _defaultScrollTarget(){return this},get _virtualRowCount(){return Math.ceil(this._virtualCount/this._itemsPerRow)},get _estRowsInView(){return Math.ceil(this._viewportHeight/this._rowHeight)},get _physicalRows(){return Math.ceil(this._physicalCount/this._itemsPerRow)},get _scrollOffset(){return this._scrollerPaddingTop+this.scrollOffset},ready:function(){this.addEventListener("focus",this._didFocus.bind(this),!0)},attached:function(){this._debounce("_render",this._render,Yl),this.listen(this,"iron-resize","_resizeHandler"),this.listen(this,"keydown","_keydownHandler")},detached:function(){this.unlisten(this,"iron-resize","_resizeHandler"),this.unlisten(this,"keydown","_keydownHandler")},_setOverflow:function(i){this.style.webkitOverflowScrolling=i===this?"touch":"",this.style.overflowY=i===this?"auto":"",this._lastVisibleIndexVal=null,this._firstVisibleIndexVal=null,this._debounce("_render",this._render,Yl)},updateViewportBoundaries:function(){var i=window.getComputedStyle(this);this._scrollerPaddingTop=this.scrollTarget===this?0:parseInt(i["padding-top"],10),this._isRTL=Boolean(i.direction==="rtl"),this._viewportWidth=this.$.items.offsetWidth,this._viewportHeight=this._scrollTargetHeight,this.grid&&this._updateGridMetrics()},_scrollHandler:function(){var i=Math.max(0,Math.min(this._maxScrollTop,this._scrollTop)),t=i-this._scrollPosition,e=t>=0;if(this._scrollPosition=i,this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,Math.abs(t)>this._physicalSize&&this._physicalSize>0){t=t-this._scrollOffset;var n=Math.round(t/this._physicalAverage)*this._itemsPerRow;this._virtualStart=this._virtualStart+n,this._physicalStart=this._physicalStart+n,this._physicalTop=Math.min(Math.floor(this._virtualStart/this._itemsPerRow)*this._physicalAverage,this._scrollPosition),this._update()}else if(this._physicalCount>0){var r=this._getReusables(e);e?(this._physicalTop=r.physicalTop,this._virtualStart=this._virtualStart+r.indexes.length,this._physicalStart=this._physicalStart+r.indexes.length):(this._virtualStart=this._virtualStart-r.indexes.length,this._physicalStart=this._physicalStart-r.indexes.length),this._update(r.indexes,e?null:r.indexes),this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,0),Wn)}},_getReusables:function(i){var t,e,n,r,o=[],s=this._hiddenContentSize*this._ratio,a=this._virtualStart,l=this._virtualEnd,c=this._physicalCount,u=this._physicalTop+this._scrollOffset,h=this._physicalBottom+this._scrollOffset,p=this._scrollPosition,f=this._scrollBottom;for(i?(t=this._physicalStart,e=this._physicalEnd,n=p-u):(t=this._physicalEnd,e=this._physicalStart,n=h-f);r=this._getPhysicalSizeIncrement(t),n=n-r,!(o.length>=c||n<=s);)if(i){if(l+o.length+1>=this._virtualCount||u+r>=p-this._scrollOffset)break;o.push(t),u=u+r,t=(t+1)%c}else{if(a-o.length<=0||u+this._physicalSize-r<=f)break;o.push(t),u=u-r,t=t===0?c-1:t-1}return{indexes:o,physicalTop:u-this._scrollOffset}},_update:function(i,t){if(!(i&&i.length===0||this._physicalCount===0)){if(this._manageFocus(),this._assignModels(i),this._updateMetrics(i),t)for(;t.length;){var e=t.pop();this._physicalTop-=this._getPhysicalSizeIncrement(e)}this._positionItems(),this._updateScrollerSize()}},_createPool:function(i){this._ensureTemplatized();var t,e,n=new Array(i);for(t=0;t<i;t++)e=this.stamp(null),n[t]=e.root.querySelector("*"),this._itemsParent.appendChild(e.root);return n},_isClientFull:function(){return this._scrollBottom!=0&&this._physicalBottom-1>=this._scrollBottom&&this._physicalTop<=this._scrollPosition},_increasePoolIfNeeded:function(i){var t=this._clamp(this._physicalCount+i,pA,this._virtualCount-this._virtualStart);if(t=this._convertIndexToCompleteRow(t),this.grid){var e=t%this._itemsPerRow;e&&t-e<=this._physicalCount&&(t+=this._itemsPerRow),t-=e}var n=t-this._physicalCount,r=Math.round(this._physicalCount*.5);if(!(n<0)){if(n>0){var o=window.performance.now();[].push.apply(this._physicalItems,this._createPool(n));for(var s=0;s<n;s++)this._physicalSizes.push(0);this._physicalCount=this._physicalCount+n,this._physicalStart>this._physicalEnd&&this._isIndexRendered(this._focusedVirtualIndex)&&this._getPhysicalIndex(this._focusedVirtualIndex)<this._physicalEnd&&(this._physicalStart=this._physicalStart+n),this._update(),this._templateCost=(window.performance.now()-o)/n,r=Math.round(this._physicalCount*.5)}this._virtualEnd>=this._virtualCount-1||r===0||(this._isClientFull()?this._physicalSize<this._optPhysicalSize&&this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,this._clamp(Math.round(50/this._templateCost),1,r)),H5):this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,r),Wn))}},_render:function(){if(!(!this.isAttached||!this._isVisible))if(this._physicalCount!==0){var i=this._getReusables(!0);this._physicalTop=i.physicalTop,this._virtualStart=this._virtualStart+i.indexes.length,this._physicalStart=this._physicalStart+i.indexes.length,this._update(i.indexes),this._update(),this._increasePoolIfNeeded(0)}else this._virtualCount>0&&(this.updateViewportBoundaries(),this._increasePoolIfNeeded(pA))},_ensureTemplatized:function(){if(!this.ctor){this._userTemplate=this.queryEffectiveChildren("template"),this._userTemplate||console.warn("iron-list requires a template to be provided in light-dom");var i={};i.__key__=!0,i[this.as]=!0,i[this.indexAs]=!0,i[this.selectedAs]=!0,i.tabIndex=!0,this._instanceProps=i,this.templatize(this._userTemplate,this.mutableData)}},_gridChanged:function(i,t){typeof t!="undefined"&&(this.notifyResize(),fr(),i&&this._updateGridMetrics())},_itemsChanged:function(i){if(i.path==="items")this._virtualStart=0,this._physicalTop=0,this._virtualCount=this.items?this.items.length:0,this._physicalIndexForKey={},this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,this._physicalCount=this._physicalCount||0,this._physicalItems=this._physicalItems||[],this._physicalSizes=this._physicalSizes||[],this._physicalStart=0,this._scrollTop>this._scrollOffset&&this._resetScrollPosition(0),this._removeFocusedItem(),this._debounce("_render",this._render,Yl);else if(i.path==="items.splices"){this._adjustVirtualIndex(i.value.indexSplices),this._virtualCount=this.items?this.items.length:0;var t=i.value.indexSplices.some(function(r){return r.addedCount>0||r.removed.length>0});if(t){var e=this._getActiveElement();this.contains(e)&&e.blur()}var n=i.value.indexSplices.some(function(r){return r.index+r.addedCount>=this._virtualStart&&r.index<=this._virtualEnd},this);(!this._isClientFull()||n)&&this._debounce("_render",this._render,Yl)}else i.path!=="items.length"&&this._forwardItemPath(i.path,i.value)},_forwardItemPath:function(i,t){i=i.slice(6);var e=i.indexOf(".");e===-1&&(e=i.length);var n,r,o,s=this.modelForElement(this._offscreenFocusedItem),a=parseInt(i.substring(0,e),10);n=this._isIndexRendered(a),n?(r=this._getPhysicalIndex(a),o=this.modelForElement(this._physicalItems[r])):s&&(o=s),!(!o||o[this.indexAs]!==a)&&(i=i.substring(e+1),i=this.as+(i?"."+i:""),o._setPendingPropertyOrPath(i,t,!1,!0),o._flushProperties&&o._flushProperties(),n&&(this._updateMetrics([r]),this._positionItems(),this._updateScrollerSize()))},_adjustVirtualIndex:function(i){i.forEach(function(t){if(t.removed.forEach(this._removeItem,this),t.index<this._virtualStart){var e=Math.max(t.addedCount-t.removed.length,t.index-this._virtualStart);this._virtualStart=this._virtualStart+e,this._focusedVirtualIndex>=0&&(this._focusedVirtualIndex=this._focusedVirtualIndex+e)}},this)},_removeItem:function(i){this.$.selector.deselect(i),this._focusedItem&&this.modelForElement(this._focusedItem)[this.as]===i&&this._removeFocusedItem()},_iterateItems:function(i,t){var e,n,r,o;if(arguments.length===2&&t){for(o=0;o<t.length;o++)if(e=t[o],n=this._computeVidx(e),(r=i.call(this,e,n))!=null)return r}else{for(e=this._physicalStart,n=this._virtualStart;e<this._physicalCount;e++,n++)if((r=i.call(this,e,n))!=null)return r;for(e=0;e<this._physicalStart;e++,n++)if((r=i.call(this,e,n))!=null)return r}},_computeVidx:function(i){return i>=this._physicalStart?this._virtualStart+(i-this._physicalStart):this._virtualStart+(this._physicalCount-this._physicalStart)+i},_assignModels:function(i){this._iterateItems(function(t,e){var n=this._physicalItems[t],r=this.items&&this.items[e];if(r!=null){var o=this.modelForElement(n);o.__key__=null,this._forwardProperty(o,this.as,r),this._forwardProperty(o,this.selectedAs,this.$.selector.isSelected(r)),this._forwardProperty(o,this.indexAs,e),this._forwardProperty(o,"tabIndex",this._focusedVirtualIndex===e?0:-1),this._physicalIndexForKey[o.__key__]=t,o._flushProperties&&o._flushProperties(!0),n.removeAttribute("hidden")}else n.setAttribute("hidden","")},i)},_updateMetrics:function(i){fr();var t=0,e=0,n=this._physicalAverageCount,r=this._physicalAverage;this._iterateItems(function(o,s){e+=this._physicalSizes[o],this._physicalSizes[o]=this._physicalItems[o].offsetHeight,t+=this._physicalSizes[o],this._physicalAverageCount+=this._physicalSizes[o]?1:0},i),this.grid?(this._updateGridMetrics(),this._physicalSize=Math.ceil(this._physicalCount/this._itemsPerRow)*this._rowHeight):(e=this._itemsPerRow===1?e:Math.ceil(this._physicalCount/this._itemsPerRow)*this._rowHeight,this._physicalSize=this._physicalSize+t-e,this._itemsPerRow=1),this._physicalAverageCount!==n&&(this._physicalAverage=Math.round((r*n+t)/this._physicalAverageCount))},_updateGridMetrics:function(){this._itemWidth=this._physicalCount>0?this._physicalItems[0].getBoundingClientRect().width:200,this._rowHeight=this._physicalCount>0?this._physicalItems[0].offsetHeight:200,this._itemsPerRow=this._itemWidth?Math.floor(this._viewportWidth/this._itemWidth):this._itemsPerRow},_positionItems:function(){this._adjustScrollPosition();var i=this._physicalTop;if(this.grid){var t=this._itemsPerRow*this._itemWidth,e=(this._viewportWidth-t)/2;this._iterateItems(function(n,r){var o=r%this._itemsPerRow,s=Math.floor(o*this._itemWidth+e);this._isRTL&&(s=s*-1),this.translate3d(s+"px",i+"px",0,this._physicalItems[n]),this._shouldRenderNextRow(r)&&(i+=this._rowHeight)})}else{let n=[];this._iterateItems(function(r,o){let s=this._physicalItems[r];this.translate3d(0,i+"px",0,s),i+=this._physicalSizes[r];let a=s.id;a&&n.push(a)}),n.length&&this.setAttribute("aria-owns",n.join(" "))}},_getPhysicalSizeIncrement:function(i){return this.grid?this._computeVidx(i)%this._itemsPerRow!==this._itemsPerRow-1?0:this._rowHeight:this._physicalSizes[i]},_shouldRenderNextRow:function(i){return i%this._itemsPerRow===this._itemsPerRow-1},_adjustScrollPosition:function(){var i=this._virtualStart===0?this._physicalTop:Math.min(this._scrollPosition+this._physicalTop,0);if(i!==0){this._physicalTop=this._physicalTop-i;var t=this._scrollPosition;!Rq&&t>0&&this._resetScrollPosition(t-i)}},_resetScrollPosition:function(i){this.scrollTarget&&i>=0&&(this._scrollTop=i,this._scrollPosition=this._scrollTop)},_updateScrollerSize:function(i){this.grid?this._estScrollHeight=this._virtualRowCount*this._rowHeight:this._estScrollHeight=this._physicalBottom+Math.max(this._virtualCount-this._physicalCount-this._virtualStart,0)*this._physicalAverage,i=i||this._scrollHeight===0,i=i||this._scrollPosition>=this._estScrollHeight-this._physicalSize,i=i||this.grid&&this.$.items.style.height<this._estScrollHeight,(i||Math.abs(this._estScrollHeight-this._scrollHeight)>=this._viewportHeight)&&(this.$.items.style.height=this._estScrollHeight+"px",this._scrollHeight=this._estScrollHeight)},scrollToItem:function(i){return this.scrollToIndex(this.items.indexOf(i))},scrollToIndex:function(i){if(!(typeof i!="number"||i<0||i>this.items.length-1)&&(fr(),this._physicalCount!==0)){i=this._clamp(i,0,this._virtualCount-1),(!this._isIndexRendered(i)||i>=this._maxVirtualStart)&&(this._virtualStart=this.grid?i-this._itemsPerRow*2:i-1),this._manageFocus(),this._assignModels(),this._updateMetrics(),this._physicalTop=Math.floor(this._virtualStart/this._itemsPerRow)*this._physicalAverage;for(var t=this._physicalStart,e=this._virtualStart,n=0,r=this._hiddenContentSize;e<i&&n<=r;)n=n+this._getPhysicalSizeIncrement(t),t=(t+1)%this._physicalCount,e++;this._updateScrollerSize(!0),this._positionItems(),this._resetScrollPosition(this._physicalTop+this._scrollOffset+n),this._increasePoolIfNeeded(0),this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null}},_resetAverage:function(){this._physicalAverage=0,this._physicalAverageCount=0},_resizeHandler:function(){this._debounce("_render",function(){this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,this._isVisible?(this.updateViewportBoundaries(),this.toggleScrollListener(!0),this._resetAverage(),this._render()):this.toggleScrollListener(!1)},Yl)},selectItem:function(i){return this.selectIndex(this.items.indexOf(i))},selectIndex:function(i){if(!(i<0||i>=this._virtualCount)){if(!this.multiSelection&&this.selectedItem&&this.clearSelection(),this._isIndexRendered(i)){var t=this.modelForElement(this._physicalItems[this._getPhysicalIndex(i)]);t&&(t[this.selectedAs]=!0),this.updateSizeForIndex(i)}this.$.selector.selectIndex(i)}},deselectItem:function(i){return this.deselectIndex(this.items.indexOf(i))},deselectIndex:function(i){if(!(i<0||i>=this._virtualCount)){if(this._isIndexRendered(i)){var t=this.modelForElement(this._physicalItems[this._getPhysicalIndex(i)]);t[this.selectedAs]=!1,this.updateSizeForIndex(i)}this.$.selector.deselectIndex(i)}},toggleSelectionForItem:function(i){return this.toggleSelectionForIndex(this.items.indexOf(i))},toggleSelectionForIndex:function(i){var t=this.$.selector.isIndexSelected?this.$.selector.isIndexSelected(i):this.$.selector.isSelected(this.items[i]);t?this.deselectIndex(i):this.selectIndex(i)},clearSelection:function(){this._iterateItems(function(i,t){this.modelForElement(this._physicalItems[i])[this.selectedAs]=!1}),this.$.selector.clearSelection()},_selectionEnabledChanged:function(i){var t=i?this.listen:this.unlisten;t.call(this,this,"tap","_selectionHandler")},_selectionHandler:function(i){var t=this.modelForElement(i.target);if(!!t){var e,n,r=Mt(i).path[0],o=this._getActiveElement(),s=this._physicalItems[this._getPhysicalIndex(t[this.indexAs])];r.localName==="input"||r.localName==="button"||r.localName==="select"||(e=t.tabIndex,t.tabIndex=fp,n=o?o.tabIndex:-1,t.tabIndex=e,!(o&&s!==o&&s.contains(o)&&n!==fp)&&this.toggleSelectionForItem(t[this.as]))}},_multiSelectionChanged:function(i){this.clearSelection(),this.$.selector.multi=i},updateSizeForItem:function(i){return this.updateSizeForIndex(this.items.indexOf(i))},updateSizeForIndex:function(i){return this._isIndexRendered(i)&&(this._updateMetrics([this._getPhysicalIndex(i)]),this._positionItems()),null},_manageFocus:function(){var i=this._focusedVirtualIndex;i>=0&&i<this._virtualCount?this._isIndexRendered(i)?this._restoreFocusedItem():this._createFocusBackfillItem():this._virtualCount>0&&this._physicalCount>0&&(this._focusedPhysicalIndex=this._physicalStart,this._focusedVirtualIndex=this._virtualStart,this._focusedItem=this._physicalItems[this._physicalStart])},_convertIndexToCompleteRow:function(i){return this._itemsPerRow=this._itemsPerRow||1,this.grid?Math.ceil(i/this._itemsPerRow)*this._itemsPerRow:i},_isIndexRendered:function(i){return i>=this._virtualStart&&i<=this._virtualEnd},_isIndexVisible:function(i){return i>=this.firstVisibleIndex&&i<=this.lastVisibleIndex},_getPhysicalIndex:function(i){return(this._physicalStart+(i-this._virtualStart))%this._physicalCount},focusItem:function(i){this._focusPhysicalItem(i)},_focusPhysicalItem:function(i){if(!(i<0||i>=this._virtualCount)){this._restoreFocusedItem(),this._isIndexRendered(i)||this.scrollToIndex(i);var t=this._physicalItems[this._getPhysicalIndex(i)],e=this.modelForElement(t),n;e.tabIndex=fp,t.tabIndex===fp&&(n=t),n||(n=Mt(t).querySelector('[tabindex="'+fp+'"]')),e.tabIndex=0,this._focusedVirtualIndex=i,n&&n.focus()}},_removeFocusedItem:function(){this._offscreenFocusedItem&&this._itemsParent.removeChild(this._offscreenFocusedItem),this._offscreenFocusedItem=null,this._focusBackfillItem=null,this._focusedItem=null,this._focusedVirtualIndex=-1,this._focusedPhysicalIndex=-1},_createFocusBackfillItem:function(){var i=this._focusedPhysicalIndex;if(!(this._offscreenFocusedItem||this._focusedVirtualIndex<0)){if(!this._focusBackfillItem){var t=this.stamp(null);this._focusBackfillItem=t.root.querySelector("*"),this._itemsParent.appendChild(t.root)}this._offscreenFocusedItem=this._physicalItems[i],this.modelForElement(this._offscreenFocusedItem).tabIndex=0,this._physicalItems[i]=this._focusBackfillItem,this._focusedPhysicalIndex=i,this.translate3d(0,fA,0,this._offscreenFocusedItem)}},_restoreFocusedItem:function(){if(!(!this._offscreenFocusedItem||this._focusedVirtualIndex<0)){this._assignModels();var i=this._focusedPhysicalIndex=this._getPhysicalIndex(this._focusedVirtualIndex),t=this._physicalItems[i];if(!!t){var e=this.modelForElement(t),n=this.modelForElement(this._offscreenFocusedItem);e[this.as]===n[this.as]?(this._focusBackfillItem=t,e.tabIndex=-1,this._physicalItems[i]=this._offscreenFocusedItem,this.translate3d(0,fA,0,this._focusBackfillItem)):(this._removeFocusedItem(),this._focusBackfillItem=null),this._offscreenFocusedItem=null}}},_didFocus:function(i){var t=this.modelForElement(i.target),e=this.modelForElement(this._focusedItem),n=this._offscreenFocusedItem!==null,r=this._focusedVirtualIndex;!t||(e===t?this._isIndexVisible(r)||this.scrollToIndex(r):(this._restoreFocusedItem(),e&&(e.tabIndex=-1),t.tabIndex=0,r=t[this.indexAs],this._focusedVirtualIndex=r,this._focusedPhysicalIndex=this._getPhysicalIndex(r),this._focusedItem=this._physicalItems[this._focusedPhysicalIndex],n&&!this._offscreenFocusedItem&&this._update()))},_keydownHandler:function(i){switch(i.keyCode){case 40:this._focusedVirtualIndex<this._virtualCount-1&&i.preventDefault(),this._focusPhysicalItem(this._focusedVirtualIndex+(this.grid?this._itemsPerRow:1));break;case 39:this.grid&&this._focusPhysicalItem(this._focusedVirtualIndex+(this._isRTL?-1:1));break;case 38:this._focusedVirtualIndex>0&&i.preventDefault(),this._focusPhysicalItem(this._focusedVirtualIndex-(this.grid?this._itemsPerRow:1));break;case 37:this.grid&&this._focusPhysicalItem(this._focusedVirtualIndex+(this._isRTL?1:-1));break;case 13:this._focusPhysicalItem(this._focusedVirtualIndex),this.selectionEnabled&&this._selectionHandler(i);break}},_clamp:function(i,t,e){return Math.min(e,Math.max(t,i))},_debounce:function(i,t,e){this._debouncers=this._debouncers||{},this._debouncers[i]=li.debounce(this._debouncers[i],e,t.bind(this)),hs(this._debouncers[i])},_forwardProperty:function(i,t,e){i._setPendingProperty(t,e)},_forwardHostPropV2:function(i,t){(this._physicalItems||[]).concat([this._offscreenFocusedItem,this._focusBackfillItem]).forEach(function(e){e&&this.modelForElement(e).forwardHostProp(i,t)},this)},_notifyInstancePropV2:function(i,t,e){if(Dm(this.as,t)){var n=i[this.indexAs];t==this.as&&(this.items[n]=e),this.notifyPath(vo(this.as,"items."+n,t),e)}},_getStampedChildren:function(){return this._physicalItems},_forwardInstancePath:function(i,t,e){t.indexOf(this.as+".")===0&&this.notifyPath("items."+i.__key__+"."+t.slice(this.as.length+1),e)},_forwardParentPath:function(i,t){(this._physicalItems||[]).concat([this._offscreenFocusedItem,this._focusBackfillItem]).forEach(function(e){e&&this.modelForElement(e).notifyPath(i,t)},this)},_forwardParentProp:function(i,t){(this._physicalItems||[]).concat([this._offscreenFocusedItem,this._focusBackfillItem]).forEach(function(e){e&&(this.modelForElement(e)[i]=t)},this)},_getActiveElement:function(){var i=this._itemsParent.node.domHost;return Mt(i?i.root:document).activeElement}});var Tg=class{constructor(t){this.selection=[],this.selectCallback=t}get(){return this.multi?this.selection.slice():this.selection[0]}clear(t){this.selection.slice().forEach(function(e){(!t||t.indexOf(e)<0)&&this.setItemSelected(e,!1)},this)}isSelected(t){return this.selection.indexOf(t)>=0}setItemSelected(t,e){if(t!=null&&e!==this.isSelected(t)){if(e)this.selection.push(t);else{var n=this.selection.indexOf(t);n>=0&&this.selection.splice(n,1)}this.selectCallback&&this.selectCallback(t,e)}}select(t){this.multi?this.toggle(t):this.get()!==t&&(this.setItemSelected(this.get(),!1),this.setItemSelected(t,!0))}toggle(t){this.setItemSelected(t,!this.isSelected(t))}};var Vr={properties:{attrForSelected:{type:String,value:null},selected:{type:String,notify:!0},selectedItem:{type:Object,readOnly:!0,notify:!0},activateEvent:{type:String,value:"tap",observer:"_activateEventChanged"},selectable:String,selectedClass:{type:String,value:"iron-selected"},selectedAttribute:{type:String,value:null},fallbackSelection:{type:String,value:null},items:{type:Array,readOnly:!0,notify:!0,value:function(){return[]}},_excludedLocalNames:{type:Object,value:function(){return{template:1,"dom-bind":1,"dom-if":1,"dom-repeat":1}}}},observers:["_updateAttrForSelected(attrForSelected)","_updateSelected(selected)","_checkFallback(fallbackSelection)"],created:function(){this._bindFilterItem=this._filterItem.bind(this),this._selection=new Tg(this._applySelection.bind(this))},attached:function(){this._observer=this._observeItems(this),this._addListener(this.activateEvent)},detached:function(){this._observer&&Mt(this).unobserveNodes(this._observer),this._removeListener(this.activateEvent)},indexOf:function(i){return this.items?this.items.indexOf(i):-1},select:function(i){this.selected=i},selectPrevious:function(){var i=this.items.length,t=i-1;this.selected!==void 0&&(t=(Number(this._valueToIndex(this.selected))-1+i)%i),this.selected=this._indexToValue(t)},selectNext:function(){var i=0;this.selected!==void 0&&(i=(Number(this._valueToIndex(this.selected))+1)%this.items.length),this.selected=this._indexToValue(i)},selectIndex:function(i){this.select(this._indexToValue(i))},forceSynchronousItemUpdate:function(){this._observer&&typeof this._observer.flush=="function"?this._observer.flush():this._updateItems()},get _shouldUpdateSelection(){return this.selected!=null},_checkFallback:function(){this._updateSelected()},_addListener:function(i){this.listen(this,i,"_activateHandler")},_removeListener:function(i){this.unlisten(this,i,"_activateHandler")},_activateEventChanged:function(i,t){this._removeListener(t),this._addListener(i)},_updateItems:function(){var i=Mt(this).queryDistributedElements(this.selectable||"*");i=Array.prototype.filter.call(i,this._bindFilterItem),this._setItems(i)},_updateAttrForSelected:function(){this.selectedItem&&(this.selected=this._valueForItem(this.selectedItem))},_updateSelected:function(){this._selectSelected(this.selected)},_selectSelected:function(i){if(!!this.items){var t=this._valueToItem(this.selected);t?this._selection.select(t):this._selection.clear(),this.fallbackSelection&&this.items.length&&this._selection.get()===void 0&&(this.selected=this.fallbackSelection)}},_filterItem:function(i){return!this._excludedLocalNames[i.localName]},_valueToItem:function(i){return i==null?null:this.items[this._valueToIndex(i)]},_valueToIndex:function(i){if(this.attrForSelected){for(var t=0,e;e=this.items[t];t++)if(this._valueForItem(e)==i)return t}else return Number(i)},_indexToValue:function(i){if(this.attrForSelected){var t=this.items[i];if(t)return this._valueForItem(t)}else return i},_valueForItem:function(i){if(!i)return null;if(!this.attrForSelected){var t=this.indexOf(i);return t===-1?null:t}var e=i[ns(this.attrForSelected)];return e!=null?e:i.getAttribute(this.attrForSelected)},_applySelection:function(i,t){this.selectedClass&&this.toggleClass(this.selectedClass,t,i),this.selectedAttribute&&this.toggleAttribute(this.selectedAttribute,t,i),this._selectionChange(),this.fire("iron-"+(t?"select":"deselect"),{item:i})},_selectionChange:function(){this._setSelectedItem(this._selection.get())},_observeItems:function(i){return Mt(i).observeNodes(function(t){this._updateItems(),this._updateSelected(),this.fire("iron-items-changed",t,{bubbles:!1,cancelable:!1})})},_activateHandler:function(i){for(var t=i.target,e=this.items;t&&t!=this;){var n=e.indexOf(t);if(n>=0){var r=this._indexToValue(n);this._itemActivate(r,t);return}t=t.parentNode}},_itemActivate:function(i,t){this.fire("iron-activate",{selected:i,item:t},{cancelable:!0}).defaultPrevented||this.select(i)}};It({_template:ut`
    <style>
      :host {
        display: block;
      }

      :host > ::slotted(:not(slot):not(.iron-selected)) {
        display: none !important;
      }
    </style>

    <slot></slot>
`,is:"iron-pages",behaviors:[Br,Vr],properties:{activateEvent:{type:String,value:null}},observers:["_selectedPageChanged(selected)"],_selectedPageChanged:function(i,t){this.async(this.notifyResize)}});var dA=ut`
<custom-style>
  <style is="custom-style">
    html {

      --shadow-transition: {
        transition: box-shadow 0.28s cubic-bezier(0.4, 0, 0.2, 1);
      };

      --shadow-none: {
        box-shadow: none;
      };

      /* from http://codepen.io/shyndman/pen/c5394ddf2e8b2a5c9185904b57421cdb */

      --shadow-elevation-2dp: {
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
                    0 1px 5px 0 rgba(0, 0, 0, 0.12),
                    0 3px 1px -2px rgba(0, 0, 0, 0.2);
      };

      --shadow-elevation-3dp: {
        box-shadow: 0 3px 4px 0 rgba(0, 0, 0, 0.14),
                    0 1px 8px 0 rgba(0, 0, 0, 0.12),
                    0 3px 3px -2px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-4dp: {
        box-shadow: 0 4px 5px 0 rgba(0, 0, 0, 0.14),
                    0 1px 10px 0 rgba(0, 0, 0, 0.12),
                    0 2px 4px -1px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-6dp: {
        box-shadow: 0 6px 10px 0 rgba(0, 0, 0, 0.14),
                    0 1px 18px 0 rgba(0, 0, 0, 0.12),
                    0 3px 5px -1px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-8dp: {
        box-shadow: 0 8px 10px 1px rgba(0, 0, 0, 0.14),
                    0 3px 14px 2px rgba(0, 0, 0, 0.12),
                    0 5px 5px -3px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-12dp: {
        box-shadow: 0 12px 16px 1px rgba(0, 0, 0, 0.14),
                    0 4px 22px 3px rgba(0, 0, 0, 0.12),
                    0 6px 7px -4px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-16dp: {
        box-shadow: 0 16px 24px 2px rgba(0, 0, 0, 0.14),
                    0  6px 30px 5px rgba(0, 0, 0, 0.12),
                    0  8px 10px -5px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-24dp: {
        box-shadow: 0 24px 38px 3px rgba(0, 0, 0, 0.14),
                    0 9px 46px 8px rgba(0, 0, 0, 0.12),
                    0 11px 15px -7px rgba(0, 0, 0, 0.4);
      };
    }
  </style>
</custom-style>`;dA.setAttribute("style","display: none;");document.head.appendChild(dA.content);var mA=ut`
<dom-module id="paper-material-styles">
  <template>
    <style>
      html {
        --paper-material: {
          display: block;
          position: relative;
        };
        --paper-material-elevation-1: {
          @apply --shadow-elevation-2dp;
        };
        --paper-material-elevation-2: {
          @apply --shadow-elevation-4dp;
        };
        --paper-material-elevation-3: {
          @apply --shadow-elevation-6dp;
        };
        --paper-material-elevation-4: {
          @apply --shadow-elevation-8dp;
        };
        --paper-material-elevation-5: {
          @apply --shadow-elevation-16dp;
        };
      }
      .paper-material {
        @apply --paper-material;
      }
      .paper-material[elevation="1"] {
        @apply --paper-material-elevation-1;
      }
      .paper-material[elevation="2"] {
        @apply --paper-material-elevation-2;
      }
      .paper-material[elevation="3"] {
        @apply --paper-material-elevation-3;
      }
      .paper-material[elevation="4"] {
        @apply --paper-material-elevation-4;
      }
      .paper-material[elevation="5"] {
        @apply --paper-material-elevation-5;
      }

      /* Duplicate the styles because of https://github.com/webcomponents/shadycss/issues/193 */
      :host {
        --paper-material: {
          display: block;
          position: relative;
        };
        --paper-material-elevation-1: {
          @apply --shadow-elevation-2dp;
        };
        --paper-material-elevation-2: {
          @apply --shadow-elevation-4dp;
        };
        --paper-material-elevation-3: {
          @apply --shadow-elevation-6dp;
        };
        --paper-material-elevation-4: {
          @apply --shadow-elevation-8dp;
        };
        --paper-material-elevation-5: {
          @apply --shadow-elevation-16dp;
        };
      }
      :host(.paper-material) {
        @apply --paper-material;
      }
      :host(.paper-material[elevation="1"]) {
        @apply --paper-material-elevation-1;
      }
      :host(.paper-material[elevation="2"]) {
        @apply --paper-material-elevation-2;
      }
      :host(.paper-material[elevation="3"]) {
        @apply --paper-material-elevation-3;
      }
      :host(.paper-material[elevation="4"]) {
        @apply --paper-material-elevation-4;
      }
      :host(.paper-material[elevation="5"]) {
        @apply --paper-material-elevation-5;
      }
    </style>
  </template>
</dom-module>`;mA.setAttribute("style","display: none;");document.head.appendChild(mA.content);var vn={properties:{focused:{type:Boolean,value:!1,notify:!0,readOnly:!0,reflectToAttribute:!0},disabled:{type:Boolean,value:!1,notify:!0,observer:"_disabledChanged",reflectToAttribute:!0},_oldTabIndex:{type:String},_boundFocusBlurHandler:{type:Function,value:function(){return this._focusBlurHandler.bind(this)}}},observers:["_changedControlState(focused, disabled)"],ready:function(){this.addEventListener("focus",this._boundFocusBlurHandler,!0),this.addEventListener("blur",this._boundFocusBlurHandler,!0)},_focusBlurHandler:function(i){this._setFocused(i.type==="focus")},_disabledChanged:function(i,t){this.setAttribute("aria-disabled",i?"true":"false"),this.style.pointerEvents=i?"none":"",i?(this._oldTabIndex=this.getAttribute("tabindex"),this._setFocused(!1),this.tabIndex=-1,this.blur()):this._oldTabIndex!==void 0&&(this._oldTabIndex===null?this.removeAttribute("tabindex"):this.setAttribute("tabindex",this._oldTabIndex))},_changedControlState:function(){this._controlStateChanged&&this._controlStateChanged()}};var yc={properties:{pressed:{type:Boolean,readOnly:!0,value:!1,reflectToAttribute:!0,observer:"_pressedChanged"},toggles:{type:Boolean,value:!1,reflectToAttribute:!0},active:{type:Boolean,value:!1,notify:!0,reflectToAttribute:!0},pointerDown:{type:Boolean,readOnly:!0,value:!1},receivedFocusFromKeyboard:{type:Boolean,readOnly:!0},ariaActiveAttribute:{type:String,value:"aria-pressed",observer:"_ariaActiveAttributeChanged"}},listeners:{down:"_downHandler",up:"_upHandler",tap:"_tapHandler"},observers:["_focusChanged(focused)","_activeChanged(active, ariaActiveAttribute)"],keyBindings:{"enter:keydown":"_asyncClick","space:keydown":"_spaceKeyDownHandler","space:keyup":"_spaceKeyUpHandler"},_mouseEventRe:/^mouse/,_tapHandler:function(){this.toggles?this._userActivate(!this.active):this.active=!1},_focusChanged:function(i){this._detectKeyboardFocus(i),i||this._setPressed(!1)},_detectKeyboardFocus:function(i){this._setReceivedFocusFromKeyboard(!this.pointerDown&&i)},_userActivate:function(i){this.active!==i&&(this.active=i,this.fire("change"))},_downHandler:function(i){this._setPointerDown(!0),this._setPressed(!0),this._setReceivedFocusFromKeyboard(!1)},_upHandler:function(){this._setPointerDown(!1),this._setPressed(!1)},_spaceKeyDownHandler:function(i){var t=i.detail.keyboardEvent,e=Mt(t).localTarget;this.isLightDescendant(e)||(t.preventDefault(),t.stopImmediatePropagation(),this._setPressed(!0))},_spaceKeyUpHandler:function(i){var t=i.detail.keyboardEvent,e=Mt(t).localTarget;this.isLightDescendant(e)||(this.pressed&&this._asyncClick(),this._setPressed(!1))},_asyncClick:function(){this.async(function(){this.click()},1)},_pressedChanged:function(i){this._changedButtonState()},_ariaActiveAttributeChanged:function(i,t){t&&t!=i&&this.hasAttribute(t)&&this.removeAttribute(t)},_activeChanged:function(i,t){this.toggles?this.setAttribute(this.ariaActiveAttribute,i?"true":"false"):this.removeAttribute(this.ariaActiveAttribute),this._changedButtonState()},_controlStateChanged:function(){this.disabled?this._setPressed(!1):this._changedButtonState()},_changedButtonState:function(){this._buttonStateChanged&&this._buttonStateChanged()}},Hr=[jn,yc];var $r={distance:function(i,t,e,n){var r=i-e,o=t-n;return Math.sqrt(r*r+o*o)},now:window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now};function gA(i){this.element=i,this.width=this.boundingRect.width,this.height=this.boundingRect.height,this.size=Math.max(this.width,this.height)}gA.prototype={get boundingRect(){return this.element.getBoundingClientRect()},furthestCornerDistanceFrom:function(i,t){var e=$r.distance(i,t,0,0),n=$r.distance(i,t,this.width,0),r=$r.distance(i,t,0,this.height),o=$r.distance(i,t,this.width,this.height);return Math.max(e,n,r,o)}};function Ta(i){this.element=i,this.color=window.getComputedStyle(i).color,this.wave=document.createElement("div"),this.waveContainer=document.createElement("div"),this.wave.style.backgroundColor=this.color,this.wave.classList.add("wave"),this.waveContainer.classList.add("wave-container"),Mt(this.waveContainer).appendChild(this.wave),this.resetInteractionState()}Ta.MAX_RADIUS=300;Ta.prototype={get recenters(){return this.element.recenters},get center(){return this.element.center},get mouseDownElapsed(){var i;return this.mouseDownStart?(i=$r.now()-this.mouseDownStart,this.mouseUpStart&&(i-=this.mouseUpElapsed),i):0},get mouseUpElapsed(){return this.mouseUpStart?$r.now()-this.mouseUpStart:0},get mouseDownElapsedSeconds(){return this.mouseDownElapsed/1e3},get mouseUpElapsedSeconds(){return this.mouseUpElapsed/1e3},get mouseInteractionSeconds(){return this.mouseDownElapsedSeconds+this.mouseUpElapsedSeconds},get initialOpacity(){return this.element.initialOpacity},get opacityDecayVelocity(){return this.element.opacityDecayVelocity},get radius(){var i=this.containerMetrics.width*this.containerMetrics.width,t=this.containerMetrics.height*this.containerMetrics.height,e=Math.min(Math.sqrt(i+t),Ta.MAX_RADIUS)*1.1+5,n=1.1-.2*(e/Ta.MAX_RADIUS),r=this.mouseInteractionSeconds/n,o=e*(1-Math.pow(80,-r));return Math.abs(o)},get opacity(){return this.mouseUpStart?Math.max(0,this.initialOpacity-this.mouseUpElapsedSeconds*this.opacityDecayVelocity):this.initialOpacity},get outerOpacity(){var i=this.mouseUpElapsedSeconds*.3,t=this.opacity;return Math.max(0,Math.min(i,t))},get isOpacityFullyDecayed(){return this.opacity<.01&&this.radius>=Math.min(this.maxRadius,Ta.MAX_RADIUS)},get isRestingAtMaxRadius(){return this.opacity>=this.initialOpacity&&this.radius>=Math.min(this.maxRadius,Ta.MAX_RADIUS)},get isAnimationComplete(){return this.mouseUpStart?this.isOpacityFullyDecayed:this.isRestingAtMaxRadius},get translationFraction(){return Math.min(1,this.radius/this.containerMetrics.size*2/Math.sqrt(2))},get xNow(){return this.xEnd?this.xStart+this.translationFraction*(this.xEnd-this.xStart):this.xStart},get yNow(){return this.yEnd?this.yStart+this.translationFraction*(this.yEnd-this.yStart):this.yStart},get isMouseDown(){return this.mouseDownStart&&!this.mouseUpStart},resetInteractionState:function(){this.maxRadius=0,this.mouseDownStart=0,this.mouseUpStart=0,this.xStart=0,this.yStart=0,this.xEnd=0,this.yEnd=0,this.slideDistance=0,this.containerMetrics=new gA(this.element)},draw:function(){var i,t,e;this.wave.style.opacity=this.opacity,i=this.radius/(this.containerMetrics.size/2),t=this.xNow-this.containerMetrics.width/2,e=this.yNow-this.containerMetrics.height/2,this.waveContainer.style.webkitTransform="translate("+t+"px, "+e+"px)",this.waveContainer.style.transform="translate3d("+t+"px, "+e+"px, 0)",this.wave.style.webkitTransform="scale("+i+","+i+")",this.wave.style.transform="scale3d("+i+","+i+",1)"},downAction:function(i){var t=this.containerMetrics.width/2,e=this.containerMetrics.height/2;this.resetInteractionState(),this.mouseDownStart=$r.now(),this.center?(this.xStart=t,this.yStart=e,this.slideDistance=$r.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)):(this.xStart=i?i.detail.x-this.containerMetrics.boundingRect.left:this.containerMetrics.width/2,this.yStart=i?i.detail.y-this.containerMetrics.boundingRect.top:this.containerMetrics.height/2),this.recenters&&(this.xEnd=t,this.yEnd=e,this.slideDistance=$r.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)),this.maxRadius=this.containerMetrics.furthestCornerDistanceFrom(this.xStart,this.yStart),this.waveContainer.style.top=(this.containerMetrics.height-this.containerMetrics.size)/2+"px",this.waveContainer.style.left=(this.containerMetrics.width-this.containerMetrics.size)/2+"px",this.waveContainer.style.width=this.containerMetrics.size+"px",this.waveContainer.style.height=this.containerMetrics.size+"px"},upAction:function(i){!this.isMouseDown||(this.mouseUpStart=$r.now())},remove:function(){Mt(Mt(this.waveContainer).parentNode).removeChild(this.waveContainer)}};It({_template:ut`
    <style>
      :host {
        display: block;
        position: absolute;
        border-radius: inherit;
        overflow: hidden;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;

        /* See PolymerElements/paper-behaviors/issues/34. On non-Chrome browsers,
         * creating a node (with a position:absolute) in the middle of an event
         * handler "interrupts" that event handler (which happens when the
         * ripple is created on demand) */
        pointer-events: none;
      }

      :host([animating]) {
        /* This resolves a rendering issue in Chrome (as of 40) where the
           ripple is not properly clipped by its parent (which may have
           rounded corners). See: http://jsbin.com/temexa/4

           Note: We only apply this style conditionally. Otherwise, the browser
           will create a new compositing layer for every ripple element on the
           page, and that would be bad. */
        -webkit-transform: translate(0, 0);
        transform: translate3d(0, 0, 0);
      }

      #background,
      #waves,
      .wave-container,
      .wave {
        pointer-events: none;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      #background,
      .wave {
        opacity: 0;
      }

      #waves,
      .wave {
        overflow: hidden;
      }

      .wave-container,
      .wave {
        border-radius: 50%;
      }

      :host(.circle) #background,
      :host(.circle) #waves {
        border-radius: 50%;
      }

      :host(.circle) .wave-container {
        overflow: hidden;
      }
    </style>

    <div id="background"></div>
    <div id="waves"></div>
`,is:"paper-ripple",behaviors:[jn],properties:{initialOpacity:{type:Number,value:.25},opacityDecayVelocity:{type:Number,value:.8},recenters:{type:Boolean,value:!1},center:{type:Boolean,value:!1},ripples:{type:Array,value:function(){return[]}},animating:{type:Boolean,readOnly:!0,reflectToAttribute:!0,value:!1},holdDown:{type:Boolean,value:!1,observer:"_holdDownChanged"},noink:{type:Boolean,value:!1},_animating:{type:Boolean},_boundAnimate:{type:Function,value:function(){return this.animate.bind(this)}}},get target(){return this.keyEventTarget},keyBindings:{"enter:keydown":"_onEnterKeydown","space:keydown":"_onSpaceKeydown","space:keyup":"_onSpaceKeyup"},attached:function(){Mt(this).parentNode.nodeType==11?this.keyEventTarget=Mt(this).getOwnerRoot().host:this.keyEventTarget=Mt(this).parentNode;var i=this.keyEventTarget;this.listen(i,"up","uiUpAction"),this.listen(i,"down","uiDownAction")},detached:function(){this.unlisten(this.keyEventTarget,"up","uiUpAction"),this.unlisten(this.keyEventTarget,"down","uiDownAction"),this.keyEventTarget=null},get shouldKeepAnimating(){for(var i=0;i<this.ripples.length;++i)if(!this.ripples[i].isAnimationComplete)return!0;return!1},simulatedRipple:function(){this.downAction(null),this.async(function(){this.upAction()},1)},uiDownAction:function(i){this.noink||this.downAction(i)},downAction:function(i){if(!(this.holdDown&&this.ripples.length>0)){var t=this.addRipple();t.downAction(i),this._animating||(this._animating=!0,this.animate())}},uiUpAction:function(i){this.noink||this.upAction(i)},upAction:function(i){this.holdDown||(this.ripples.forEach(function(t){t.upAction(i)}),this._animating=!0,this.animate())},onAnimationComplete:function(){this._animating=!1,this.$.background.style.backgroundColor="",this.fire("transitionend")},addRipple:function(){var i=new Ta(this);return Mt(this.$.waves).appendChild(i.waveContainer),this.$.background.style.backgroundColor=i.color,this.ripples.push(i),this._setAnimating(!0),i},removeRipple:function(i){var t=this.ripples.indexOf(i);t<0||(this.ripples.splice(t,1),i.remove(),this.ripples.length||this._setAnimating(!1))},animate:function(){if(!!this._animating){var i,t;for(i=0;i<this.ripples.length;++i)t=this.ripples[i],t.draw(),this.$.background.style.opacity=t.outerOpacity,t.isOpacityFullyDecayed&&!t.isRestingAtMaxRadius&&this.removeRipple(t);!this.shouldKeepAnimating&&this.ripples.length===0?this.onAnimationComplete():window.requestAnimationFrame(this._boundAnimate)}},animateRipple:function(){return this.animate()},_onEnterKeydown:function(){this.uiDownAction(),this.async(this.uiUpAction,1)},_onSpaceKeydown:function(){this.uiDownAction()},_onSpaceKeyup:function(){this.uiUpAction()},_holdDownChanged:function(i,t){t!==void 0&&(i?this.downAction():this.upAction())}});var dr={properties:{noink:{type:Boolean,observer:"_noinkChanged"},_rippleContainer:{type:Object}},_buttonStateChanged:function(){this.focused&&this.ensureRipple()},_downHandler:function(i){yc._downHandler.call(this,i),this.pressed&&this.ensureRipple(i)},ensureRipple:function(i){if(!this.hasRipple()){this._ripple=this._createRipple(),this._ripple.noink=this.noink;var t=this._rippleContainer||this.root;if(t&&Mt(t).appendChild(this._ripple),i){var e=Mt(this._rippleContainer||this),n=Mt(i).rootTarget;e.deepContains(n)&&this._ripple.uiDownAction(i)}}},getRipple:function(){return this.ensureRipple(),this._ripple},hasRipple:function(){return Boolean(this._ripple)},_createRipple:function(){var i=document.createElement("paper-ripple");return i},_noinkChanged:function(i){this.hasRipple()&&(this._ripple.noink=i)}};var mw={properties:{elevation:{type:Number,reflectToAttribute:!0,readOnly:!0}},observers:["_calculateElevation(focused, disabled, active, pressed, receivedFocusFromKeyboard)","_computeKeyboardClass(receivedFocusFromKeyboard)"],hostAttributes:{role:"button",tabindex:"0",animated:!0},_calculateElevation:function(){var i=1;this.disabled?i=0:this.active||this.pressed?i=4:this.receivedFocusFromKeyboard&&(i=3),this._setElevation(i)},_computeKeyboardClass:function(i){this.toggleClass("keyboard-focus",i)},_spaceKeyDownHandler:function(i){yc._spaceKeyDownHandler.call(this,i),this.hasRipple()&&this.getRipple().ripples.length<1&&this._ripple.uiDownAction()},_spaceKeyUpHandler:function(i){yc._spaceKeyUpHandler.call(this,i),this.hasRipple()&&this._ripple.uiUpAction()}},xA=[Hr,vn,dr,mw];var yA=ut`
  <style include="paper-material-styles">
    /* Need to specify the same specificity as the styles imported from paper-material. */
    :host {
      @apply --layout-inline;
      @apply --layout-center-center;
      position: relative;
      box-sizing: border-box;
      min-width: 5.14em;
      margin: 0 0.29em;
      background: transparent;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
      -webkit-tap-highlight-color: transparent;
      font: inherit;
      text-transform: uppercase;
      outline-width: 0;
      border-radius: 3px;
      -moz-user-select: none;
      -ms-user-select: none;
      -webkit-user-select: none;
      user-select: none;
      cursor: pointer;
      z-index: 0;
      padding: 0.7em 0.57em;

      @apply --paper-font-common-base;
      @apply --paper-button;
    }

    :host([elevation="1"]) {
      @apply --paper-material-elevation-1;
    }

    :host([elevation="2"]) {
      @apply --paper-material-elevation-2;
    }

    :host([elevation="3"]) {
      @apply --paper-material-elevation-3;
    }

    :host([elevation="4"]) {
      @apply --paper-material-elevation-4;
    }

    :host([elevation="5"]) {
      @apply --paper-material-elevation-5;
    }

    :host([hidden]) {
      display: none !important;
    }

    :host([raised].keyboard-focus) {
      font-weight: bold;
      @apply --paper-button-raised-keyboard-focus;
    }

    :host(:not([raised]).keyboard-focus) {
      font-weight: bold;
      @apply --paper-button-flat-keyboard-focus;
    }

    :host([disabled]) {
      background: none;
      color: #a8a8a8;
      cursor: auto;
      pointer-events: none;

      @apply --paper-button-disabled;
    }

    :host([disabled][raised]) {
      background: #eaeaea;
    }


    :host([animated]) {
      @apply --shadow-transition;
    }

    paper-ripple {
      color: var(--paper-button-ink-color);
    }
  </style>

  <slot></slot>`;yA.setAttribute("strip-whitespace","");It({_template:yA,is:"paper-button",behaviors:[xA],properties:{raised:{type:Boolean,reflectToAttribute:!0,value:!1,observer:"_calculateElevation"}},_calculateElevation:function(){this.raised?mw._calculateElevation.apply(this):this._setElevation(0)}});var vA=ut`
<custom-style>
  <style is="custom-style">
    html {

      /* Material Design color palette for Google products */

      --google-red-100: #f4c7c3;
      --google-red-300: #e67c73;
      --google-red-500: #db4437;
      --google-red-700: #c53929;

      --google-blue-100: #c6dafc;
      --google-blue-300: #7baaf7;
      --google-blue-500: #4285f4;
      --google-blue-700: #3367d6;

      --google-green-100: #b7e1cd;
      --google-green-300: #57bb8a;
      --google-green-500: #0f9d58;
      --google-green-700: #0b8043;

      --google-yellow-100: #fce8b2;
      --google-yellow-300: #f7cb4d;
      --google-yellow-500: #f4b400;
      --google-yellow-700: #f09300;

      --google-grey-100: #f5f5f5;
      --google-grey-300: #e0e0e0;
      --google-grey-500: #9e9e9e;
      --google-grey-700: #616161;

      /* Material Design color palette from online spec document */

      --paper-red-50: #ffebee;
      --paper-red-100: #ffcdd2;
      --paper-red-200: #ef9a9a;
      --paper-red-300: #e57373;
      --paper-red-400: #ef5350;
      --paper-red-500: #f44336;
      --paper-red-600: #e53935;
      --paper-red-700: #d32f2f;
      --paper-red-800: #c62828;
      --paper-red-900: #b71c1c;
      --paper-red-a100: #ff8a80;
      --paper-red-a200: #ff5252;
      --paper-red-a400: #ff1744;
      --paper-red-a700: #d50000;

      --paper-pink-50: #fce4ec;
      --paper-pink-100: #f8bbd0;
      --paper-pink-200: #f48fb1;
      --paper-pink-300: #f06292;
      --paper-pink-400: #ec407a;
      --paper-pink-500: #e91e63;
      --paper-pink-600: #d81b60;
      --paper-pink-700: #c2185b;
      --paper-pink-800: #ad1457;
      --paper-pink-900: #880e4f;
      --paper-pink-a100: #ff80ab;
      --paper-pink-a200: #ff4081;
      --paper-pink-a400: #f50057;
      --paper-pink-a700: #c51162;

      --paper-purple-50: #f3e5f5;
      --paper-purple-100: #e1bee7;
      --paper-purple-200: #ce93d8;
      --paper-purple-300: #ba68c8;
      --paper-purple-400: #ab47bc;
      --paper-purple-500: #9c27b0;
      --paper-purple-600: #8e24aa;
      --paper-purple-700: #7b1fa2;
      --paper-purple-800: #6a1b9a;
      --paper-purple-900: #4a148c;
      --paper-purple-a100: #ea80fc;
      --paper-purple-a200: #e040fb;
      --paper-purple-a400: #d500f9;
      --paper-purple-a700: #aa00ff;

      --paper-deep-purple-50: #ede7f6;
      --paper-deep-purple-100: #d1c4e9;
      --paper-deep-purple-200: #b39ddb;
      --paper-deep-purple-300: #9575cd;
      --paper-deep-purple-400: #7e57c2;
      --paper-deep-purple-500: #673ab7;
      --paper-deep-purple-600: #5e35b1;
      --paper-deep-purple-700: #512da8;
      --paper-deep-purple-800: #4527a0;
      --paper-deep-purple-900: #311b92;
      --paper-deep-purple-a100: #b388ff;
      --paper-deep-purple-a200: #7c4dff;
      --paper-deep-purple-a400: #651fff;
      --paper-deep-purple-a700: #6200ea;

      --paper-indigo-50: #e8eaf6;
      --paper-indigo-100: #c5cae9;
      --paper-indigo-200: #9fa8da;
      --paper-indigo-300: #7986cb;
      --paper-indigo-400: #5c6bc0;
      --paper-indigo-500: #3f51b5;
      --paper-indigo-600: #3949ab;
      --paper-indigo-700: #303f9f;
      --paper-indigo-800: #283593;
      --paper-indigo-900: #1a237e;
      --paper-indigo-a100: #8c9eff;
      --paper-indigo-a200: #536dfe;
      --paper-indigo-a400: #3d5afe;
      --paper-indigo-a700: #304ffe;

      --paper-blue-50: #e3f2fd;
      --paper-blue-100: #bbdefb;
      --paper-blue-200: #90caf9;
      --paper-blue-300: #64b5f6;
      --paper-blue-400: #42a5f5;
      --paper-blue-500: #2196f3;
      --paper-blue-600: #1e88e5;
      --paper-blue-700: #1976d2;
      --paper-blue-800: #1565c0;
      --paper-blue-900: #0d47a1;
      --paper-blue-a100: #82b1ff;
      --paper-blue-a200: #448aff;
      --paper-blue-a400: #2979ff;
      --paper-blue-a700: #2962ff;

      --paper-light-blue-50: #e1f5fe;
      --paper-light-blue-100: #b3e5fc;
      --paper-light-blue-200: #81d4fa;
      --paper-light-blue-300: #4fc3f7;
      --paper-light-blue-400: #29b6f6;
      --paper-light-blue-500: #03a9f4;
      --paper-light-blue-600: #039be5;
      --paper-light-blue-700: #0288d1;
      --paper-light-blue-800: #0277bd;
      --paper-light-blue-900: #01579b;
      --paper-light-blue-a100: #80d8ff;
      --paper-light-blue-a200: #40c4ff;
      --paper-light-blue-a400: #00b0ff;
      --paper-light-blue-a700: #0091ea;

      --paper-cyan-50: #e0f7fa;
      --paper-cyan-100: #b2ebf2;
      --paper-cyan-200: #80deea;
      --paper-cyan-300: #4dd0e1;
      --paper-cyan-400: #26c6da;
      --paper-cyan-500: #00bcd4;
      --paper-cyan-600: #00acc1;
      --paper-cyan-700: #0097a7;
      --paper-cyan-800: #00838f;
      --paper-cyan-900: #006064;
      --paper-cyan-a100: #84ffff;
      --paper-cyan-a200: #18ffff;
      --paper-cyan-a400: #00e5ff;
      --paper-cyan-a700: #00b8d4;

      --paper-teal-50: #e0f2f1;
      --paper-teal-100: #b2dfdb;
      --paper-teal-200: #80cbc4;
      --paper-teal-300: #4db6ac;
      --paper-teal-400: #26a69a;
      --paper-teal-500: #009688;
      --paper-teal-600: #00897b;
      --paper-teal-700: #00796b;
      --paper-teal-800: #00695c;
      --paper-teal-900: #004d40;
      --paper-teal-a100: #a7ffeb;
      --paper-teal-a200: #64ffda;
      --paper-teal-a400: #1de9b6;
      --paper-teal-a700: #00bfa5;

      --paper-green-50: #e8f5e9;
      --paper-green-100: #c8e6c9;
      --paper-green-200: #a5d6a7;
      --paper-green-300: #81c784;
      --paper-green-400: #66bb6a;
      --paper-green-500: #4caf50;
      --paper-green-600: #43a047;
      --paper-green-700: #388e3c;
      --paper-green-800: #2e7d32;
      --paper-green-900: #1b5e20;
      --paper-green-a100: #b9f6ca;
      --paper-green-a200: #69f0ae;
      --paper-green-a400: #00e676;
      --paper-green-a700: #00c853;

      --paper-light-green-50: #f1f8e9;
      --paper-light-green-100: #dcedc8;
      --paper-light-green-200: #c5e1a5;
      --paper-light-green-300: #aed581;
      --paper-light-green-400: #9ccc65;
      --paper-light-green-500: #8bc34a;
      --paper-light-green-600: #7cb342;
      --paper-light-green-700: #689f38;
      --paper-light-green-800: #558b2f;
      --paper-light-green-900: #33691e;
      --paper-light-green-a100: #ccff90;
      --paper-light-green-a200: #b2ff59;
      --paper-light-green-a400: #76ff03;
      --paper-light-green-a700: #64dd17;

      --paper-lime-50: #f9fbe7;
      --paper-lime-100: #f0f4c3;
      --paper-lime-200: #e6ee9c;
      --paper-lime-300: #dce775;
      --paper-lime-400: #d4e157;
      --paper-lime-500: #cddc39;
      --paper-lime-600: #c0ca33;
      --paper-lime-700: #afb42b;
      --paper-lime-800: #9e9d24;
      --paper-lime-900: #827717;
      --paper-lime-a100: #f4ff81;
      --paper-lime-a200: #eeff41;
      --paper-lime-a400: #c6ff00;
      --paper-lime-a700: #aeea00;

      --paper-yellow-50: #fffde7;
      --paper-yellow-100: #fff9c4;
      --paper-yellow-200: #fff59d;
      --paper-yellow-300: #fff176;
      --paper-yellow-400: #ffee58;
      --paper-yellow-500: #ffeb3b;
      --paper-yellow-600: #fdd835;
      --paper-yellow-700: #fbc02d;
      --paper-yellow-800: #f9a825;
      --paper-yellow-900: #f57f17;
      --paper-yellow-a100: #ffff8d;
      --paper-yellow-a200: #ffff00;
      --paper-yellow-a400: #ffea00;
      --paper-yellow-a700: #ffd600;

      --paper-amber-50: #fff8e1;
      --paper-amber-100: #ffecb3;
      --paper-amber-200: #ffe082;
      --paper-amber-300: #ffd54f;
      --paper-amber-400: #ffca28;
      --paper-amber-500: #ffc107;
      --paper-amber-600: #ffb300;
      --paper-amber-700: #ffa000;
      --paper-amber-800: #ff8f00;
      --paper-amber-900: #ff6f00;
      --paper-amber-a100: #ffe57f;
      --paper-amber-a200: #ffd740;
      --paper-amber-a400: #ffc400;
      --paper-amber-a700: #ffab00;

      --paper-orange-50: #fff3e0;
      --paper-orange-100: #ffe0b2;
      --paper-orange-200: #ffcc80;
      --paper-orange-300: #ffb74d;
      --paper-orange-400: #ffa726;
      --paper-orange-500: #ff9800;
      --paper-orange-600: #fb8c00;
      --paper-orange-700: #f57c00;
      --paper-orange-800: #ef6c00;
      --paper-orange-900: #e65100;
      --paper-orange-a100: #ffd180;
      --paper-orange-a200: #ffab40;
      --paper-orange-a400: #ff9100;
      --paper-orange-a700: #ff6500;

      --paper-deep-orange-50: #fbe9e7;
      --paper-deep-orange-100: #ffccbc;
      --paper-deep-orange-200: #ffab91;
      --paper-deep-orange-300: #ff8a65;
      --paper-deep-orange-400: #ff7043;
      --paper-deep-orange-500: #ff5722;
      --paper-deep-orange-600: #f4511e;
      --paper-deep-orange-700: #e64a19;
      --paper-deep-orange-800: #d84315;
      --paper-deep-orange-900: #bf360c;
      --paper-deep-orange-a100: #ff9e80;
      --paper-deep-orange-a200: #ff6e40;
      --paper-deep-orange-a400: #ff3d00;
      --paper-deep-orange-a700: #dd2c00;

      --paper-brown-50: #efebe9;
      --paper-brown-100: #d7ccc8;
      --paper-brown-200: #bcaaa4;
      --paper-brown-300: #a1887f;
      --paper-brown-400: #8d6e63;
      --paper-brown-500: #795548;
      --paper-brown-600: #6d4c41;
      --paper-brown-700: #5d4037;
      --paper-brown-800: #4e342e;
      --paper-brown-900: #3e2723;

      --paper-grey-50: #fafafa;
      --paper-grey-100: #f5f5f5;
      --paper-grey-200: #eeeeee;
      --paper-grey-300: #e0e0e0;
      --paper-grey-400: #bdbdbd;
      --paper-grey-500: #9e9e9e;
      --paper-grey-600: #757575;
      --paper-grey-700: #616161;
      --paper-grey-800: #424242;
      --paper-grey-900: #212121;

      --paper-blue-grey-50: #eceff1;
      --paper-blue-grey-100: #cfd8dc;
      --paper-blue-grey-200: #b0bec5;
      --paper-blue-grey-300: #90a4ae;
      --paper-blue-grey-400: #78909c;
      --paper-blue-grey-500: #607d8b;
      --paper-blue-grey-600: #546e7a;
      --paper-blue-grey-700: #455a64;
      --paper-blue-grey-800: #37474f;
      --paper-blue-grey-900: #263238;

      /* opacity for dark text on a light background */
      --dark-divider-opacity: 0.12;
      --dark-disabled-opacity: 0.38; /* or hint text or icon */
      --dark-secondary-opacity: 0.54;
      --dark-primary-opacity: 0.87;

      /* opacity for light text on a dark background */
      --light-divider-opacity: 0.12;
      --light-disabled-opacity: 0.3; /* or hint text or icon */
      --light-secondary-opacity: 0.7;
      --light-primary-opacity: 1.0;

    }

  </style>
</custom-style>
`;vA.setAttribute("style","display: none;");document.head.appendChild(vA.content);var bA=ut`
<custom-style>
  <style is="custom-style">
    html {
      /*
       * You can use these generic variables in your elements for easy theming.
       * For example, if all your elements use \`--primary-text-color\` as its main
       * color, then switching from a light to a dark theme is just a matter of
       * changing the value of \`--primary-text-color\` in your application.
       */
      --primary-text-color: var(--light-theme-text-color);
      --primary-background-color: var(--light-theme-background-color);
      --secondary-text-color: var(--light-theme-secondary-color);
      --disabled-text-color: var(--light-theme-disabled-color);
      --divider-color: var(--light-theme-divider-color);
      --error-color: var(--paper-deep-orange-a700);

      /*
       * Primary and accent colors. Also see color.js for more colors.
       */
      --primary-color: var(--paper-indigo-500);
      --light-primary-color: var(--paper-indigo-100);
      --dark-primary-color: var(--paper-indigo-700);

      --accent-color: var(--paper-pink-a200);
      --light-accent-color: var(--paper-pink-a100);
      --dark-accent-color: var(--paper-pink-a400);


      /*
       * Material Design Light background theme
       */
      --light-theme-background-color: #ffffff;
      --light-theme-base-color: #000000;
      --light-theme-text-color: var(--paper-grey-900);
      --light-theme-secondary-color: #737373;  /* for secondary text and icons */
      --light-theme-disabled-color: #9b9b9b;  /* disabled/hint text */
      --light-theme-divider-color: #dbdbdb;

      /*
       * Material Design Dark background theme
       */
      --dark-theme-background-color: var(--paper-grey-900);
      --dark-theme-base-color: #ffffff;
      --dark-theme-text-color: #ffffff;
      --dark-theme-secondary-color: #bcbcbc;  /* for secondary text and icons */
      --dark-theme-disabled-color: #646464;  /* disabled/hint text */
      --dark-theme-divider-color: #3c3c3c;

      /*
       * Deprecated values because of their confusing names.
       */
      --text-primary-color: var(--dark-theme-text-color);
      --default-primary-color: var(--primary-color);
    }
  </style>
</custom-style>`;bA.setAttribute("style","display: none;");document.head.appendChild(bA.content);var Ur={properties:{name:{type:String},value:{notify:!0,type:String},required:{type:Boolean,value:!1}},attached:function(){},detached:function(){}};var gw=null,Wr={properties:{validator:{type:String},invalid:{notify:!0,reflectToAttribute:!0,type:Boolean,value:!1,observer:"_invalidChanged"}},registered:function(){gw=new Ln({type:"validator"})},_invalidChanged:function(){this.invalid?this.setAttribute("aria-invalid","true"):this.removeAttribute("aria-invalid")},get _validator(){return gw&&gw.byKey(this.validator)},hasValidator:function(){return this._validator!=null},validate:function(i){return i===void 0&&this.value!==void 0?this.invalid=!this._getValidity(this.value):this.invalid=!this._getValidity(i),!this.invalid},_getValidity:function(i){return this.hasValidator()?this._validator.validate(i):!0}};var xw={properties:{checked:{type:Boolean,value:!1,reflectToAttribute:!0,notify:!0,observer:"_checkedChanged"},toggles:{type:Boolean,value:!0,reflectToAttribute:!0},value:{type:String,value:"on",observer:"_valueChanged"}},observers:["_requiredChanged(required)"],created:function(){this._hasIronCheckedElementBehavior=!0},_getValidity:function(i){return this.disabled||!this.required||this.checked},_requiredChanged:function(){this.required?this.setAttribute("aria-required","true"):this.removeAttribute("aria-required")},_checkedChanged:function(){this.active=this.checked,this.fire("iron-change")},_valueChanged:function(){(this.value===void 0||this.value===null)&&(this.value="on")}},_A=[Ur,Wr,xw];var dp={observers:["_focusedChanged(receivedFocusFromKeyboard)"],_focusedChanged:function(i){i&&this.ensureRipple(),this.hasRipple()&&(this._ripple.holdDown=i)},_createRipple:function(){var i=dr._createRipple();return i.id="ink",i.setAttribute("center",""),i.classList.add("circle"),i}},vc=[Hr,vn,dr,dp];var Pq={_checkedChanged:function(){xw._checkedChanged.call(this),this.hasRipple()&&(this.checked?this._ripple.setAttribute("checked",""):this._ripple.removeAttribute("checked"))},_buttonStateChanged:function(){dr._buttonStateChanged.call(this),!this.disabled&&this.isAttached&&(this.checked=this.active)}},bc=[vc,_A,Pq];var wA=ut`<style>
  :host {
    display: inline-block;
    white-space: nowrap;
    cursor: pointer;
    --calculated-paper-checkbox-size: var(--paper-checkbox-size, 18px);
    /* -1px is a sentinel for the default and is replaced in \`attached\`. */
    --calculated-paper-checkbox-ink-size: var(--paper-checkbox-ink-size, -1px);
    @apply --paper-font-common-base;
    line-height: 0;
    -webkit-tap-highlight-color: transparent;
  }

  :host([hidden]) {
    display: none !important;
  }

  :host(:focus) {
    outline: none;
  }

  .hidden {
    display: none;
  }

  #checkboxContainer {
    display: inline-block;
    position: relative;
    width: var(--calculated-paper-checkbox-size);
    height: var(--calculated-paper-checkbox-size);
    min-width: var(--calculated-paper-checkbox-size);
    margin: var(--paper-checkbox-margin, initial);
    vertical-align: var(--paper-checkbox-vertical-align, middle);
    background-color: var(--paper-checkbox-unchecked-background-color, transparent);
  }

  #ink {
    position: absolute;

    /* Center the ripple in the checkbox by negative offsetting it by
     * (inkWidth - rippleWidth) / 2 */
    top: calc(0px - (var(--calculated-paper-checkbox-ink-size) - var(--calculated-paper-checkbox-size)) / 2);
    left: calc(0px - (var(--calculated-paper-checkbox-ink-size) - var(--calculated-paper-checkbox-size)) / 2);
    width: var(--calculated-paper-checkbox-ink-size);
    height: var(--calculated-paper-checkbox-ink-size);
    color: var(--paper-checkbox-unchecked-ink-color, var(--primary-text-color));
    opacity: 0.6;
    pointer-events: none;
  }

  #ink:dir(rtl) {
    right: calc(0px - (var(--calculated-paper-checkbox-ink-size) - var(--calculated-paper-checkbox-size)) / 2);
    left: auto;
  }

  #ink[checked] {
    color: var(--paper-checkbox-checked-ink-color, var(--primary-color));
  }

  #checkbox {
    position: relative;
    box-sizing: border-box;
    height: 100%;
    border: solid 2px;
    border-color: var(--paper-checkbox-unchecked-color, var(--primary-text-color));
    border-radius: 2px;
    pointer-events: none;
    -webkit-transition: background-color 140ms, border-color 140ms;
    transition: background-color 140ms, border-color 140ms;

    -webkit-transition-duration: var(--paper-checkbox-animation-duration, 140ms);
    transition-duration: var(--paper-checkbox-animation-duration, 140ms);
  }

  /* checkbox checked animations */
  #checkbox.checked #checkmark {
    -webkit-animation: checkmark-expand 140ms ease-out forwards;
    animation: checkmark-expand 140ms ease-out forwards;

    -webkit-animation-duration: var(--paper-checkbox-animation-duration, 140ms);
    animation-duration: var(--paper-checkbox-animation-duration, 140ms);
  }

  @-webkit-keyframes checkmark-expand {
    0% {
      -webkit-transform: scale(0, 0) rotate(45deg);
    }
    100% {
      -webkit-transform: scale(1, 1) rotate(45deg);
    }
  }

  @keyframes checkmark-expand {
    0% {
      transform: scale(0, 0) rotate(45deg);
    }
    100% {
      transform: scale(1, 1) rotate(45deg);
    }
  }

  #checkbox.checked {
    background-color: var(--paper-checkbox-checked-color, var(--primary-color));
    border-color: var(--paper-checkbox-checked-color, var(--primary-color));
  }

  #checkmark {
    position: absolute;
    width: 36%;
    height: 70%;
    border-style: solid;
    border-top: none;
    border-left: none;
    border-right-width: calc(2/15 * var(--calculated-paper-checkbox-size));
    border-bottom-width: calc(2/15 * var(--calculated-paper-checkbox-size));
    border-color: var(--paper-checkbox-checkmark-color, white);
    -webkit-transform-origin: 97% 86%;
    transform-origin: 97% 86%;
    box-sizing: content-box; /* protect against page-level box-sizing */
  }

  #checkmark:dir(rtl) {
    -webkit-transform-origin: 50% 14%;
    transform-origin: 50% 14%;
  }

  /* label */
  #checkboxLabel {
    position: relative;
    display: inline-block;
    vertical-align: middle;
    padding-left: var(--paper-checkbox-label-spacing, 8px);
    white-space: normal;
    line-height: normal;
    color: var(--paper-checkbox-label-color, var(--primary-text-color));
    @apply --paper-checkbox-label;
  }

  :host([checked]) #checkboxLabel {
    color: var(--paper-checkbox-label-checked-color, var(--paper-checkbox-label-color, var(--primary-text-color)));
    @apply --paper-checkbox-label-checked;
  }

  #checkboxLabel:dir(rtl) {
    padding-right: var(--paper-checkbox-label-spacing, 8px);
    padding-left: 0;
  }

  #checkboxLabel[hidden] {
    display: none;
  }

  /* disabled state */

  :host([disabled]) #checkbox {
    opacity: 0.5;
    border-color: var(--paper-checkbox-unchecked-color, var(--primary-text-color));
  }

  :host([disabled][checked]) #checkbox {
    background-color: var(--paper-checkbox-unchecked-color, var(--primary-text-color));
    opacity: 0.5;
  }

  :host([disabled]) #checkboxLabel  {
    opacity: 0.65;
  }

  /* invalid state */
  #checkbox.invalid:not(.checked) {
    border-color: var(--paper-checkbox-error-color, var(--error-color));
  }
</style>

<div id="checkboxContainer">
  <div id="checkbox" class$="[[_computeCheckboxClass(checked, invalid)]]">
    <div id="checkmark" class$="[[_computeCheckmarkClass(checked)]]"></div>
  </div>
</div>

<div id="checkboxLabel"><slot></slot></div>`;wA.setAttribute("strip-whitespace","");It({_template:wA,is:"paper-checkbox",behaviors:[bc],hostAttributes:{role:"checkbox","aria-checked":!1,tabindex:0},properties:{ariaActiveAttribute:{type:String,value:"aria-checked"}},attached:function(){fc(this,function(){var i=this.getComputedStyleValue("--calculated-paper-checkbox-ink-size").trim();if(i==="-1px"){var t=this.getComputedStyleValue("--calculated-paper-checkbox-size").trim(),e="px",n=t.match(/[A-Za-z]+$/);n!==null&&(e=n[0]);var r=parseFloat(t),o=8/3*r;e==="px"&&(o=Math.floor(o),o%2!==r%2&&o++),this.updateStyles({"--paper-checkbox-ink-size":o+e})}})},_computeCheckboxClass:function(i,t){var e="";return i&&(e+="checked "),t&&(e+="invalid"),e},_computeCheckmarkClass:function(i){return i?"":"hidden"},_createRipple:function(){return this._rippleContainer=this.$.checkboxContainer,dp._createRipple.call(this)}});if(!window.polymerSkipLoadingFontRoboto){let i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.crossOrigin="anonymous",i.href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,300,300italic,400italic,500,500italic,700,700italic",document.head.appendChild(i)}var SA=ut`<custom-style>
  <style is="custom-style">
    html {

      /* Shared Styles */
      --paper-font-common-base: {
        font-family: 'Roboto', 'Noto', sans-serif;
        -webkit-font-smoothing: antialiased;
      };

      --paper-font-common-code: {
        font-family: 'Roboto Mono', 'Consolas', 'Menlo', monospace;
        -webkit-font-smoothing: antialiased;
      };

      --paper-font-common-expensive-kerning: {
        text-rendering: optimizeLegibility;
      };

      --paper-font-common-nowrap: {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      };

      /* Material Font Styles */

      --paper-font-display4: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 112px;
        font-weight: 300;
        letter-spacing: -.044em;
        line-height: 120px;
      };

      --paper-font-display3: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 56px;
        font-weight: 400;
        letter-spacing: -.026em;
        line-height: 60px;
      };

      --paper-font-display2: {
        @apply --paper-font-common-base;

        font-size: 45px;
        font-weight: 400;
        letter-spacing: -.018em;
        line-height: 48px;
      };

      --paper-font-display1: {
        @apply --paper-font-common-base;

        font-size: 34px;
        font-weight: 400;
        letter-spacing: -.01em;
        line-height: 40px;
      };

      --paper-font-headline: {
        @apply --paper-font-common-base;

        font-size: 24px;
        font-weight: 400;
        letter-spacing: -.012em;
        line-height: 32px;
      };

      --paper-font-title: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 20px;
        font-weight: 500;
        line-height: 28px;
      };

      --paper-font-subhead: {
        @apply --paper-font-common-base;

        font-size: 16px;
        font-weight: 400;
        line-height: 24px;
      };

      --paper-font-body2: {
        @apply --paper-font-common-base;

        font-size: 14px;
        font-weight: 500;
        line-height: 24px;
      };

      --paper-font-body1: {
        @apply --paper-font-common-base;

        font-size: 14px;
        font-weight: 400;
        line-height: 20px;
      };

      --paper-font-caption: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 12px;
        font-weight: 400;
        letter-spacing: 0.011em;
        line-height: 20px;
      };

      --paper-font-menu: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 13px;
        font-weight: 500;
        line-height: 24px;
      };

      --paper-font-button: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 14px;
        font-weight: 500;
        letter-spacing: 0.018em;
        line-height: 24px;
        text-transform: uppercase;
      };

      --paper-font-code2: {
        @apply --paper-font-common-code;

        font-size: 14px;
        font-weight: 700;
        line-height: 20px;
      };

      --paper-font-code1: {
        @apply --paper-font-common-code;

        font-size: 14px;
        font-weight: 500;
        line-height: 20px;
      };

    }

  </style>
</custom-style>`;SA.setAttribute("style","display: none;");document.head.appendChild(SA.content);var yw=document.createElement("template");yw.setAttribute("style","display: none;");yw.innerHTML=`<dom-module id="paper-dialog-shared-styles">
  <template>
    <style>
      :host {
        display: block;
        margin: 24px 40px;

        background: var(--paper-dialog-background-color, var(--primary-background-color));
        color: var(--paper-dialog-color, var(--primary-text-color));

        @apply --paper-font-body1;
        @apply --shadow-elevation-16dp;
        @apply --paper-dialog;
      }

      :host > ::slotted(*) {
        margin-top: 20px;
        padding: 0 24px;
      }

      :host > ::slotted(.no-padding) {
        padding: 0;
      }

      
      :host > ::slotted(*:first-child) {
        margin-top: 24px;
      }

      :host > ::slotted(*:last-child) {
        margin-bottom: 24px;
      }

      /* In 1.x, this selector was \`:host > ::content h2\`. In 2.x <slot> allows
      to select direct children only, which increases the weight of this
      selector, so we have to re-define first-child/last-child margins below. */
      :host > ::slotted(h2) {
        position: relative;
        margin: 0;

        @apply --paper-font-title;
        @apply --paper-dialog-title;
      }

      /* Apply mixin again, in case it sets margin-top. */
      :host > ::slotted(h2:first-child) {
        margin-top: 24px;
        @apply --paper-dialog-title;
      }

      /* Apply mixin again, in case it sets margin-bottom. */
      :host > ::slotted(h2:last-child) {
        margin-bottom: 24px;
        @apply --paper-dialog-title;
      }

      :host > ::slotted(.paper-dialog-buttons),
      :host > ::slotted(.buttons) {
        position: relative;
        padding: 8px 8px 8px 24px;
        margin: 0;

        color: var(--paper-dialog-button-color, var(--primary-color));

        @apply --layout-horizontal;
        @apply --layout-end-justified;
      }
    </style>
  </template>
</dom-module>`;document.head.appendChild(yw.content);var CA={properties:{animationConfig:{type:Object},entryAnimation:{observer:"_entryAnimationChanged",type:String},exitAnimation:{observer:"_exitAnimationChanged",type:String}},_entryAnimationChanged:function(){this.animationConfig=this.animationConfig||{},this.animationConfig.entry=[{name:this.entryAnimation,node:this}]},_exitAnimationChanged:function(){this.animationConfig=this.animationConfig||{},this.animationConfig.exit=[{name:this.exitAnimation,node:this}]},_copyProperties:function(i,t){for(var e in t)i[e]=t[e]},_cloneConfig:function(i){var t={isClone:!0};return this._copyProperties(t,i),t},_getAnimationConfigRecursive:function(i,t,e){if(!!this.animationConfig){if(this.animationConfig.value&&typeof this.animationConfig.value=="function"){this._warn(this._logf("playAnimation","Please put 'animationConfig' inside of your components 'properties' object instead of outside of it."));return}var n;if(i?n=this.animationConfig[i]:n=this.animationConfig,Array.isArray(n)||(n=[n]),n)for(var r,o=0;r=n[o];o++)if(r.animatable)r.animatable._getAnimationConfigRecursive(r.type||i,t,e);else if(r.id){var s=t[r.id];s?(s.isClone||(t[r.id]=this._cloneConfig(s),s=t[r.id]),this._copyProperties(s,r)):t[r.id]=r}else e.push(r)}},getAnimationConfig:function(i){var t={},e=[];this._getAnimationConfigRecursive(i,t,e);for(var n in t)e.push(t[n]);return e}};var Nq={_configureAnimations:function(i){var t=[],e=[];if(i.length>0)for(let r,o=0;r=i[o];o++){let s=document.createElement(r.name);if(s.isNeonAnimation){let a=null;s.configure||(s.configure=function(l){return null}),a=s.configure(r),e.push({result:a,config:r,neonAnimation:s})}else console.warn(this.is+":",r.name,"not found!")}for(var n=0;n<e.length;n++){let r=e[n].result,o=e[n].config,s=e[n].neonAnimation;try{typeof r.cancel!="function"&&(r=document.timeline.play(r))}catch(a){r=null,console.warn("Couldnt play","(",o.name,").",a)}r&&t.push({neonAnimation:s,config:o,animation:r})}return t},_shouldComplete:function(i){for(var t=!0,e=0;e<i.length;e++)if(i[e].animation.playState!="finished"){t=!1;break}return t},_complete:function(i){for(var t=0;t<i.length;t++)i[t].neonAnimation.complete(i[t].config);for(var t=0;t<i.length;t++)i[t].animation.cancel()},playAnimation:function(i,t){var e=this.getAnimationConfig(i);if(!!e){this._active=this._active||{},this._active[i]&&(this._complete(this._active[i]),delete this._active[i]);var n=this._configureAnimations(e);if(n.length==0){this.fire("neon-animation-finish",t,{bubbles:!1});return}this._active[i]=n;for(var r=0;r<n.length;r++)n[r].animation.onfinish=function(){this._shouldComplete(n)&&(this._complete(n),delete this._active[i],this.fire("neon-animation-finish",t,{bubbles:!1}))}.bind(this)}},cancelAnimation:function(){for(var i in this._active){var t=this._active[i];for(var e in t)t[e].animation.cancel()}this._active={}}},Ig=[CA,Nq];var Ag,Lq=()=>{if(Ag!==void 0)return Ag;let i=document.createElement("div");Object.assign(i.style,{overflow:"auto",position:"fixed",left:"0px",top:"0px",maxWidth:"100px",maxHeight:"100px"});let t=document.createElement("div");return t.style.width="200px",t.style.height="200px",i.appendChild(t),document.body.appendChild(i),Ag=Math.abs(i.offsetWidth-100)>1?i.offsetWidth-i.clientWidth:0,document.body.removeChild(i),Ag},MA={properties:{sizingTarget:{type:Object,value:function(){return this}},fitInto:{type:Object,value:window},noOverlap:{type:Boolean},positionTarget:{type:Element},horizontalAlign:{type:String},verticalAlign:{type:String},dynamicAlign:{type:Boolean},horizontalOffset:{type:Number,value:0,notify:!0},verticalOffset:{type:Number,value:0,notify:!0},autoFitOnAttach:{type:Boolean,value:!1},expandSizingTargetForScrollbars:{type:Boolean,value:!1},_fitInfo:{type:Object}},get _fitWidth(){var i;return this.fitInto===window?i=this.fitInto.innerWidth:i=this.fitInto.getBoundingClientRect().width,i},get _fitHeight(){var i;return this.fitInto===window?i=this.fitInto.innerHeight:i=this.fitInto.getBoundingClientRect().height,i},get _fitLeft(){var i;return this.fitInto===window?i=0:i=this.fitInto.getBoundingClientRect().left,i},get _fitTop(){var i;return this.fitInto===window?i=0:i=this.fitInto.getBoundingClientRect().top,i},get _defaultPositionTarget(){var i=Mt(this).parentNode;return i&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(i=i.host),i},get _localeHorizontalAlign(){if(this._isRTL){if(this.horizontalAlign==="right")return"left";if(this.horizontalAlign==="left")return"right"}return this.horizontalAlign},get __shouldPosition(){return(this.horizontalAlign||this.verticalAlign)&&this.positionTarget},get _isRTL(){return typeof this._memoizedIsRTL=="undefined"&&(this._memoizedIsRTL=window.getComputedStyle(this).direction=="rtl"),this._memoizedIsRTL},attached:function(){this.positionTarget=this.positionTarget||this._defaultPositionTarget,this.autoFitOnAttach&&(window.getComputedStyle(this).display==="none"?setTimeout(function(){this.fit()}.bind(this)):(window.ShadyDOM&&ShadyDOM.flush(),this.fit()))},detached:function(){this.__deferredFit&&(clearTimeout(this.__deferredFit),this.__deferredFit=null)},fit:function(){this.position(),this.constrain(),this.center()},_discoverInfo:function(){if(!this._fitInfo){var i=window.getComputedStyle(this),t=window.getComputedStyle(this.sizingTarget);this._fitInfo={inlineStyle:{top:this.style.top||"",left:this.style.left||"",position:this.style.position||""},sizerInlineStyle:{maxWidth:this.sizingTarget.style.maxWidth||"",maxHeight:this.sizingTarget.style.maxHeight||"",boxSizing:this.sizingTarget.style.boxSizing||""},positionedBy:{vertically:i.top!=="auto"?"top":i.bottom!=="auto"?"bottom":null,horizontally:i.left!=="auto"?"left":i.right!=="auto"?"right":null},sizedBy:{height:t.maxHeight!=="none",width:t.maxWidth!=="none",minWidth:parseInt(t.minWidth,10)||0,minHeight:parseInt(t.minHeight,10)||0},margin:{top:parseInt(i.marginTop,10)||0,right:parseInt(i.marginRight,10)||0,bottom:parseInt(i.marginBottom,10)||0,left:parseInt(i.marginLeft,10)||0}}}},resetFit:function(){var i=this._fitInfo||{};for(var t in i.sizerInlineStyle)this.sizingTarget.style[t]=i.sizerInlineStyle[t];for(var t in i.inlineStyle)this.style[t]=i.inlineStyle[t];this._fitInfo=null},refit:function(){var i=this.sizingTarget.scrollLeft,t=this.sizingTarget.scrollTop;this.resetFit(),this.fit(),this.sizingTarget.scrollLeft=i,this.sizingTarget.scrollTop=t},position:function(){if(!this.__shouldPosition)return;this._discoverInfo(),window.ShadyDOM&&window.ShadyDOM.flush(),this.style.position="fixed",this.sizingTarget.style.boxSizing="border-box",this.style.left="0px",this.style.top="0px";var i=this.getBoundingClientRect(),t=this.__getNormalizedRect(this.positionTarget),e=this.__getNormalizedRect(this.fitInto);let n,r,o,s;this.expandSizingTargetForScrollbars&&(n=this.sizingTarget.offsetWidth,r=this.sizingTarget.offsetHeight,o=this.sizingTarget.clientWidth,s=this.sizingTarget.clientHeight);var a=this._fitInfo.margin,l={width:i.width+a.left+a.right,height:i.height+a.top+a.bottom},c=this.__getPosition(this._localeHorizontalAlign,this.verticalAlign,l,i,t,e),u=c.left+a.left,h=c.top+a.top,p=Math.min(e.right-a.right,u+i.width),f=Math.min(e.bottom-a.bottom,h+i.height);u=Math.max(e.left+a.left,Math.min(u,p-this._fitInfo.sizedBy.minWidth)),h=Math.max(e.top+a.top,Math.min(h,f-this._fitInfo.sizedBy.minHeight));let d=Math.max(p-u,this._fitInfo.sizedBy.minWidth),m=Math.max(f-h,this._fitInfo.sizedBy.minHeight);this.sizingTarget.style.maxWidth=d+"px",this.sizingTarget.style.maxHeight=m+"px";let x=u-i.left,g=h-i.top;if(this.style.left=`${x}px`,this.style.top=`${g}px`,this.expandSizingTargetForScrollbars){let y=this.sizingTarget.offsetHeight,b=this.sizingTarget.clientHeight,v=r-s,S=y-b-v;if(S>0){let R=e.height-a.top-a.bottom,P=Math.min(R,m+S);this.sizingTarget.style.maxHeight=`${P}px`;let D=this.sizingTarget.offsetHeight,F=D-y,z;c.verticalAlign==="top"?z=g:c.verticalAlign==="middle"?z=g-F/2:c.verticalAlign==="bottom"&&(z=g-F),z=Math.max(e.top+a.top,Math.min(z,e.bottom-a.bottom-D)),this.style.top=`${z}px`}let E=this.sizingTarget.offsetWidth,M=this.sizingTarget.clientWidth,N=n-o,w=E-M-N;if(w>0){let R=Lq(),P=e.width-a.left-a.right,D=Math.min(P,d+w-R);this.sizingTarget.style.maxWidth=`${D}px`;let F=this.sizingTarget.offsetWidth+R,z=F-E,V;c.horizontalAlign==="left"?V=x:c.horizontalAlign==="center"?V=x-z/2:c.horizontalAlign==="right"&&(V=x-z),V=Math.max(e.left+a.left,Math.min(V,e.right-a.right-F)),this.style.left=`${V}px`}}},constrain:function(){if(!this.__shouldPosition){this._discoverInfo();var i=this._fitInfo;i.positionedBy.vertically||(this.style.position="fixed",this.style.top="0px"),i.positionedBy.horizontally||(this.style.position="fixed",this.style.left="0px"),this.sizingTarget.style.boxSizing="border-box";var t=this.getBoundingClientRect();i.sizedBy.height||this.__sizeDimension(t,i.positionedBy.vertically,"top","bottom","Height"),i.sizedBy.width||this.__sizeDimension(t,i.positionedBy.horizontally,"left","right","Width")}},_sizeDimension:function(i,t,e,n,r){this.__sizeDimension(i,t,e,n,r)},__sizeDimension:function(i,t,e,n,r){var o=this._fitInfo,s=this.__getNormalizedRect(this.fitInto),a=r==="Width"?s.width:s.height,l=t===n,c=l?a-i[n]:i[e],u=o.margin[l?e:n],h="offset"+r,p=this[h]-this.sizingTarget[h];this.sizingTarget.style["max"+r]=a-u-c-p+"px"},center:function(){if(!this.__shouldPosition){this._discoverInfo();var i=this._fitInfo.positionedBy;if(!(i.vertically&&i.horizontally)){this.style.position="fixed",i.vertically||(this.style.top="0px"),i.horizontally||(this.style.left="0px");var t=this.getBoundingClientRect(),e=this.__getNormalizedRect(this.fitInto);if(!i.vertically){var n=e.top-t.top+(e.height-t.height)/2;this.style.top=n+"px"}if(!i.horizontally){var r=e.left-t.left+(e.width-t.width)/2;this.style.left=r+"px"}}}},__getNormalizedRect:function(i){return i===document.documentElement||i===window?{top:0,left:0,width:window.innerWidth,height:window.innerHeight,right:window.innerWidth,bottom:window.innerHeight}:i.getBoundingClientRect()},__getOffscreenArea:function(i,t,e){var n=Math.min(0,i.top)+Math.min(0,e.bottom-(i.top+t.height)),r=Math.min(0,i.left)+Math.min(0,e.right-(i.left+t.width));return Math.abs(n)*t.width+Math.abs(r)*t.height},__getPosition:function(i,t,e,n,r,o){var s=[{verticalAlign:"top",horizontalAlign:"left",top:r.top+this.verticalOffset,left:r.left+this.horizontalOffset},{verticalAlign:"top",horizontalAlign:"right",top:r.top+this.verticalOffset,left:r.right-e.width-this.horizontalOffset},{verticalAlign:"bottom",horizontalAlign:"left",top:r.bottom-e.height-this.verticalOffset,left:r.left+this.horizontalOffset},{verticalAlign:"bottom",horizontalAlign:"right",top:r.bottom-e.height-this.verticalOffset,left:r.right-e.width-this.horizontalOffset}];if(this.noOverlap){for(var a=0,l=s.length;a<l;a++){var c={};for(var u in s[a])c[u]=s[a][u];s.push(c)}s[0].top=s[1].top+=r.height,s[2].top=s[3].top-=r.height,s[4].left=s[6].left+=r.width,s[5].left=s[7].left-=r.width}t=t==="auto"?null:t,i=i==="auto"?null:i,(!i||i==="center")&&(s.push({verticalAlign:"top",horizontalAlign:"center",top:r.top+this.verticalOffset+(this.noOverlap?r.height:0),left:r.left-n.width/2+r.width/2+this.horizontalOffset}),s.push({verticalAlign:"bottom",horizontalAlign:"center",top:r.bottom-e.height-this.verticalOffset-(this.noOverlap?r.height:0),left:r.left-n.width/2+r.width/2+this.horizontalOffset})),(!t||t==="middle")&&(s.push({verticalAlign:"middle",horizontalAlign:"left",top:r.top-n.height/2+r.height/2+this.verticalOffset,left:r.left+this.horizontalOffset+(this.noOverlap?r.width:0)}),s.push({verticalAlign:"middle",horizontalAlign:"right",top:r.top-n.height/2+r.height/2+this.verticalOffset,left:r.right-e.width-this.horizontalOffset-(this.noOverlap?r.width:0)})),t==="middle"&&i==="center"&&s.push({verticalAlign:"middle",horizontalAlign:"center",top:r.top-n.height/2+r.height/2+this.verticalOffset,left:r.left-n.width/2+r.width/2+this.horizontalOffset});for(var h,a=0;a<s.length;a++){var p=s[a],f=p.verticalAlign===t,d=p.horizontalAlign===i;if(!this.dynamicAlign&&!this.noOverlap&&f&&d){h=p;break}var m=(!t||f)&&(!i||d);if(!(!this.dynamicAlign&&!m)){if(p.offscreenArea=this.__getOffscreenArea(p,e,o),p.offscreenArea===0&&m){h=p;break}h=h||p;var x=p.offscreenArea-h.offscreenArea;(x<0||x===0&&(f||d))&&(h=p)}}return h}};var _c=Element.prototype,kg=_c.matches||_c.matchesSelector||_c.mozMatchesSelector||_c.msMatchesSelector||_c.oMatchesSelector||_c.webkitMatchesSelector,vw=class{getTabbableNodes(t){var e=[],n=this._collectTabbableNodes(t,e);return n?this._sortByTabIndex(e):e}isFocusable(t){return kg.call(t,"input, select, textarea, button, object")?kg.call(t,":not([disabled])"):kg.call(t,"a[href], area[href], iframe, [tabindex], [contentEditable]")}isTabbable(t){return this.isFocusable(t)&&kg.call(t,':not([tabindex="-1"])')&&this._isVisible(t)}_normalizedTabIndex(t){if(this.isFocusable(t)){var e=t.getAttribute("tabindex")||0;return Number(e)}return-1}_collectTabbableNodes(t,e){if(t.nodeType!==Node.ELEMENT_NODE)return!1;var n=t;if(!this._isVisible(n))return!1;var r=this._normalizedTabIndex(n),o=r>0;r>=0&&e.push(n);var s;n.localName==="content"||n.localName==="slot"?s=Mt(n).getDistributedNodes():s=Mt(n.root||n).children;for(var a=0;a<s.length;a++)o=this._collectTabbableNodes(s[a],e)||o;return o}_isVisible(t){var e=t.style;return e.visibility!=="hidden"&&e.display!=="none"?(e=window.getComputedStyle(t),e.visibility!=="hidden"&&e.display!=="none"):!1}_sortByTabIndex(t){var e=t.length;if(e<2)return t;var n=Math.ceil(e/2),r=this._sortByTabIndex(t.slice(0,n)),o=this._sortByTabIndex(t.slice(n));return this._mergeSortByTabIndex(r,o)}_mergeSortByTabIndex(t,e){for(var n=[];t.length>0&&e.length>0;)this._hasLowerTabOrder(t[0],e[0])?n.push(e.shift()):n.push(t.shift());return n.concat(t,e)}_hasLowerTabOrder(t,e){var n=Math.max(t.tabIndex,0),r=Math.max(e.tabIndex,0);return n===0||r===0?r>n:n>r}},EA=new vw;It({_template:ut`
    <style>
      :host {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: var(--iron-overlay-backdrop-background-color, #000);
        opacity: 0;
        transition: opacity 0.2s;
        pointer-events: none;
        @apply --iron-overlay-backdrop;
      }

      :host(.opened) {
        opacity: var(--iron-overlay-backdrop-opacity, 0.6);
        pointer-events: auto;
        @apply --iron-overlay-backdrop-opened;
      }
    </style>

    <slot></slot>
`,is:"iron-overlay-backdrop",properties:{opened:{reflectToAttribute:!0,type:Boolean,value:!1,observer:"_openedChanged"}},listeners:{transitionend:"_onTransitionend"},created:function(){this.__openedRaf=null},attached:function(){this.opened&&this._openedChanged(this.opened)},prepare:function(){this.opened&&!this.parentNode&&Mt(document.body).appendChild(this)},open:function(){this.opened=!0},close:function(){this.opened=!1},complete:function(){!this.opened&&this.parentNode===document.body&&Mt(this.parentNode).removeChild(this)},_onTransitionend:function(i){i&&i.target===this&&this.complete()},_openedChanged:function(i){if(i)this.prepare();else{var t=window.getComputedStyle(this);(t.transitionDuration==="0s"||t.opacity==0)&&this.complete()}!this.isAttached||(this.__openedRaf&&(window.cancelAnimationFrame(this.__openedRaf),this.__openedRaf=null),this.scrollTop=this.scrollTop,this.__openedRaf=window.requestAnimationFrame(function(){this.__openedRaf=null,this.toggleClass("opened",this.opened)}.bind(this)))}});var bw=class{constructor(){this._overlays=[],this._minimumZ=101,this._backdropElement=null,gg(document.documentElement,"tap",function(){}),document.addEventListener("tap",this._onCaptureClick.bind(this),!0),document.addEventListener("focus",this._onCaptureFocus.bind(this),!0),document.addEventListener("keydown",this._onCaptureKeyDown.bind(this),!0)}get backdropElement(){return this._backdropElement||(this._backdropElement=document.createElement("iron-overlay-backdrop")),this._backdropElement}get deepActiveElement(){var t=document.activeElement;for((!t||!(t instanceof Element))&&(t=document.body);t.root&&Mt(t.root).activeElement;)t=Mt(t.root).activeElement;return t}_bringOverlayAtIndexToFront(t){var e=this._overlays[t];if(!!e){var n=this._overlays.length-1,r=this._overlays[n];if(r&&this._shouldBeBehindOverlay(e,r)&&n--,!(t>=n)){var o=Math.max(this.currentOverlayZ(),this._minimumZ);for(this._getZ(e)<=o&&this._applyOverlayZ(e,o);t<n;)this._overlays[t]=this._overlays[t+1],t++;this._overlays[n]=e}}}addOrRemoveOverlay(t){t.opened?this.addOverlay(t):this.removeOverlay(t)}addOverlay(t){var e=this._overlays.indexOf(t);if(e>=0){this._bringOverlayAtIndexToFront(e),this.trackBackdrop();return}var n=this._overlays.length,r=this._overlays[n-1],o=Math.max(this._getZ(r),this._minimumZ),s=this._getZ(t);if(r&&this._shouldBeBehindOverlay(t,r)){this._applyOverlayZ(r,o),n--;var a=this._overlays[n-1];o=Math.max(this._getZ(a),this._minimumZ)}s<=o&&this._applyOverlayZ(t,o),this._overlays.splice(n,0,t),this.trackBackdrop()}removeOverlay(t){var e=this._overlays.indexOf(t);e!==-1&&(this._overlays.splice(e,1),this.trackBackdrop())}currentOverlay(){var t=this._overlays.length-1;return this._overlays[t]}currentOverlayZ(){return this._getZ(this.currentOverlay())}ensureMinimumZ(t){this._minimumZ=Math.max(this._minimumZ,t)}focusOverlay(){var t=this.currentOverlay();t&&t._applyFocus()}trackBackdrop(){var t=this._overlayWithBackdrop();!t&&!this._backdropElement||(this.backdropElement.style.zIndex=this._getZ(t)-1,this.backdropElement.opened=!!t,this.backdropElement.prepare())}getBackdrops(){for(var t=[],e=0;e<this._overlays.length;e++)this._overlays[e].withBackdrop&&t.push(this._overlays[e]);return t}backdropZ(){return this._getZ(this._overlayWithBackdrop())-1}_overlayWithBackdrop(){for(var t=this._overlays.length-1;t>=0;t--)if(this._overlays[t].withBackdrop)return this._overlays[t]}_getZ(t){var e=this._minimumZ;if(t){var n=Number(t.style.zIndex||window.getComputedStyle(t).zIndex);n===n&&(e=n)}return e}_setZ(t,e){t.style.zIndex=e}_applyOverlayZ(t,e){this._setZ(t,e+2)}_overlayInPath(t){t=t||[];for(var e=0;e<t.length;e++)if(t[e]._manager===this)return t[e]}_onCaptureClick(t){var e=this._overlays.length-1;if(e!==-1)for(var n=Mt(t).path,r;(r=this._overlays[e])&&this._overlayInPath(n)!==r&&(r._onCaptureClick(t),r.allowClickThrough);)e--}_onCaptureFocus(t){var e=this.currentOverlay();e&&e._onCaptureFocus(t)}_onCaptureKeyDown(t){var e=this.currentOverlay();e&&(jn.keyboardEventMatchesKeys(t,"esc")?e._onCaptureEsc(t):jn.keyboardEventMatchesKeys(t,"tab")&&e._onCaptureTab(t))}_shouldBeBehindOverlay(t,e){return!t.alwaysOnTop&&e.alwaysOnTop}},TA=new bw;var Pg={pageX:0,pageY:0},IA=null,_w=[],Ng=["wheel","mousewheel","DOMMouseScroll","touchstart","touchmove"],Rg,ww;function AA(i){Gr.indexOf(i)>=0||(Gr.length===0&&zq(),Gr.push(i),ww=Gr[Gr.length-1],RA=[],PA=[])}function kA(i){var t=Gr.indexOf(i);t!==-1&&(Gr.splice(t,1),ww=Gr[Gr.length-1],RA=[],PA=[],Gr.length===0&&Fq())}var Gr=[],RA=null,PA=null;function Dq(i){if(i.cancelable&&Oq(i)&&i.preventDefault(),i.targetTouches){var t=i.targetTouches[0];Pg.pageX=t.pageX,Pg.pageY=t.pageY}}function zq(){Rg=Rg||Dq.bind(void 0);for(var i=0,t=Ng.length;i<t;i++)document.addEventListener(Ng[i],Rg,{capture:!0,passive:!1})}function Fq(){for(var i=0,t=Ng.length;i<t;i++)document.removeEventListener(Ng[i],Rg,{capture:!0,passive:!1})}function Oq(i){var t=Mt(i).rootTarget;if(i.type!=="touchmove"&&IA!==t&&(IA=t,_w=Bq(Mt(i).path)),!_w.length)return!0;if(i.type==="touchstart")return!1;var e=Hq(i);return!Vq(_w,e.deltaX,e.deltaY)}function Bq(i){for(var t=[],e=i.indexOf(ww),n=0;n<=e;n++)if(i[n].nodeType===Node.ELEMENT_NODE){var r=i[n],o=r.style;o.overflow!=="scroll"&&o.overflow!=="auto"&&(o=window.getComputedStyle(r)),(o.overflow==="scroll"||o.overflow==="auto")&&t.push(r)}return t}function Vq(i,t,e){if(!(!t&&!e))for(var n=Math.abs(e)>=Math.abs(t),r=0;r<i.length;r++){var o=i[r],s=!1;if(n?s=e<0?o.scrollTop>0:o.scrollTop<o.scrollHeight-o.clientHeight:s=t<0?o.scrollLeft>0:o.scrollLeft<o.scrollWidth-o.clientWidth,s)return o}}function Hq(i){var t={deltaX:i.deltaX,deltaY:i.deltaY};if(!("deltaX"in i)){if("wheelDeltaX"in i&&"wheelDeltaY"in i)t.deltaX=-i.wheelDeltaX,t.deltaY=-i.wheelDeltaY;else if("wheelDelta"in i)t.deltaX=0,t.deltaY=-i.wheelDelta;else if("axis"in i)t.deltaX=i.axis===1?i.detail:0,t.deltaY=i.axis===2?i.detail:0;else if(i.targetTouches){var e=i.targetTouches[0];t.deltaX=Pg.pageX-e.pageX,t.deltaY=Pg.pageY-e.pageY}}return t}var ds={properties:{opened:{observer:"_openedChanged",type:Boolean,value:!1,notify:!0},canceled:{observer:"_canceledChanged",readOnly:!0,type:Boolean,value:!1},withBackdrop:{observer:"_withBackdropChanged",type:Boolean},noAutoFocus:{type:Boolean,value:!1},noCancelOnEscKey:{type:Boolean,value:!1},noCancelOnOutsideClick:{type:Boolean,value:!1},closingReason:{type:Object},restoreFocusOnClose:{type:Boolean,value:!1},allowClickThrough:{type:Boolean},alwaysOnTop:{type:Boolean},scrollAction:{type:String},_manager:{type:Object,value:TA},_focusedChild:{type:Object}},listeners:{"iron-resize":"_onIronResize"},observers:["__updateScrollObservers(isAttached, opened, scrollAction)"],get backdropElement(){return this._manager.backdropElement},get _focusNode(){return this._focusedChild||Mt(this).querySelector("[autofocus]")||this},get _focusableNodes(){return EA.getTabbableNodes(this)},ready:function(){this.__isAnimating=!1,this.__shouldRemoveTabIndex=!1,this.__firstFocusableNode=this.__lastFocusableNode=null,this.__rafs={},this.__restoreFocusNode=null,this.__scrollTop=this.__scrollLeft=null,this.__onCaptureScroll=this.__onCaptureScroll.bind(this),this.__rootNodes=null,this._ensureSetup()},attached:function(){this.opened&&this._openedChanged(this.opened),this._observer=Mt(this).observeNodes(this._onNodesChange)},detached:function(){this._observer&&Mt(this).unobserveNodes(this._observer),this._observer=null;for(var i in this.__rafs)this.__rafs[i]!==null&&cancelAnimationFrame(this.__rafs[i]);this.__rafs={},this._manager.removeOverlay(this),this.__isAnimating&&(this.opened?this._finishRenderOpened():(this._applyFocus(),this._finishRenderClosed()))},toggle:function(){this._setCanceled(!1),this.opened=!this.opened},open:function(){this._setCanceled(!1),this.opened=!0},close:function(){this._setCanceled(!1),this.opened=!1},cancel:function(i){var t=this.fire("iron-overlay-canceled",i,{cancelable:!0});t.defaultPrevented||(this._setCanceled(!0),this.opened=!1)},invalidateTabbables:function(){this.__firstFocusableNode=this.__lastFocusableNode=null},_ensureSetup:function(){this._overlaySetup||(this._overlaySetup=!0,this.style.outline="none",this.style.display="none")},_openedChanged:function(i){i?this.removeAttribute("aria-hidden"):this.setAttribute("aria-hidden","true"),this.isAttached&&(this.__isAnimating=!0,this.__deraf("__openedChanged",this.__openedChanged))},_canceledChanged:function(){this.closingReason=this.closingReason||{},this.closingReason.canceled=this.canceled},_withBackdropChanged:function(){this.withBackdrop&&!this.hasAttribute("tabindex")?(this.setAttribute("tabindex","-1"),this.__shouldRemoveTabIndex=!0):this.__shouldRemoveTabIndex&&(this.removeAttribute("tabindex"),this.__shouldRemoveTabIndex=!1),this.opened&&this.isAttached&&this._manager.trackBackdrop()},_prepareRenderOpened:function(){this.__restoreFocusNode=this._manager.deepActiveElement,this._preparePositioning(),this.refit(),this._finishPositioning(),this.noAutoFocus&&document.activeElement===this._focusNode&&(this._focusNode.blur(),this.__restoreFocusNode.focus())},_renderOpened:function(){this._finishRenderOpened()},_renderClosed:function(){this._finishRenderClosed()},_finishRenderOpened:function(){this.notifyResize(),this.__isAnimating=!1,this.fire("iron-overlay-opened")},_finishRenderClosed:function(){this.style.display="none",this.style.zIndex="",this.notifyResize(),this.__isAnimating=!1,this.fire("iron-overlay-closed",this.closingReason)},_preparePositioning:function(){this.style.transition=this.style.webkitTransition="none",this.style.transform=this.style.webkitTransform="none",this.style.display=""},_finishPositioning:function(){this.style.display="none",this.scrollTop=this.scrollTop,this.style.transition=this.style.webkitTransition="",this.style.transform=this.style.webkitTransform="",this.style.display="",this.scrollTop=this.scrollTop},_applyFocus:function(){if(this.opened)this.noAutoFocus||this._focusNode.focus();else{if(this.restoreFocusOnClose&&this.__restoreFocusNode){var i=this._manager.deepActiveElement;(i===document.body||Uq(this,i))&&this.__restoreFocusNode.focus()}this.__restoreFocusNode=null,this._focusNode.blur(),this._focusedChild=null}},_onCaptureClick:function(i){this.noCancelOnOutsideClick||this.cancel(i)},_onCaptureFocus:function(i){if(!!this.withBackdrop){var t=Mt(i).path;t.indexOf(this)===-1?(i.stopPropagation(),this._applyFocus()):this._focusedChild=t[0]}},_onCaptureEsc:function(i){this.noCancelOnEscKey||this.cancel(i)},_onCaptureTab:function(i){if(!!this.withBackdrop){this.__ensureFirstLastFocusables();var t=i.shiftKey,e=t?this.__firstFocusableNode:this.__lastFocusableNode,n=t?this.__lastFocusableNode:this.__firstFocusableNode,r=!1;if(e===n)r=!0;else{var o=this._manager.deepActiveElement;r=o===e||o===this}r&&(i.preventDefault(),this._focusedChild=n,this._applyFocus())}},_onIronResize:function(){this.opened&&!this.__isAnimating&&this.__deraf("refit",this.refit)},_onNodesChange:function(){this.opened&&!this.__isAnimating&&(this.invalidateTabbables(),this.notifyResize())},__ensureFirstLastFocusables:function(){var i=this._focusableNodes;this.__firstFocusableNode=i[0],this.__lastFocusableNode=i[i.length-1]},__openedChanged:function(){this.opened?(this._prepareRenderOpened(),this._manager.addOverlay(this),this._applyFocus(),this._renderOpened()):(this._manager.removeOverlay(this),this._applyFocus(),this._renderClosed())},__deraf:function(i,t){var e=this.__rafs;e[i]!==null&&cancelAnimationFrame(e[i]),e[i]=requestAnimationFrame(function(){e[i]=null,t.call(this)}.bind(this))},__updateScrollObservers:function(i,t,e){!i||!t||!this.__isValidScrollAction(e)?(kA(this),this.__removeScrollListeners()):(e==="lock"&&(this.__saveScrollPosition(),AA(this)),this.__addScrollListeners())},__addScrollListeners:function(){if(!this.__rootNodes){if(this.__rootNodes=[],pa)for(var i=this;i;)i.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&i.host&&this.__rootNodes.push(i),i=i.host||i.assignedSlot||i.parentNode;this.__rootNodes.push(document)}this.__rootNodes.forEach(function(t){t.addEventListener("scroll",this.__onCaptureScroll,{capture:!0,passive:!0})},this)},__removeScrollListeners:function(){this.__rootNodes&&this.__rootNodes.forEach(function(i){i.removeEventListener("scroll",this.__onCaptureScroll,{capture:!0,passive:!0})},this),this.isAttached||(this.__rootNodes=null)},__isValidScrollAction:function(i){return i==="lock"||i==="refit"||i==="cancel"},__onCaptureScroll:function(i){if(!this.__isAnimating&&!(Mt(i).path.indexOf(this)>=0))switch(this.scrollAction){case"lock":this.__restoreScrollPosition();break;case"refit":this.__deraf("refit",this.refit);break;case"cancel":this.cancel(i);break}},__saveScrollPosition:function(){document.scrollingElement?(this.__scrollTop=document.scrollingElement.scrollTop,this.__scrollLeft=document.scrollingElement.scrollLeft):(this.__scrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this.__scrollLeft=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft))},__restoreScrollPosition:function(){document.scrollingElement?(document.scrollingElement.scrollTop=this.__scrollTop,document.scrollingElement.scrollLeft=this.__scrollLeft):(document.documentElement.scrollTop=document.body.scrollTop=this.__scrollTop,document.documentElement.scrollLeft=document.body.scrollLeft=this.__scrollLeft)}},$q=i=>i.assignedSlot||i.parentNode||i.host,Uq=(i,t)=>{for(let e=t;e;e=$q(e))if(e===i)return!0;return!1},wc=[MA,Br,ds];var Sw={hostAttributes:{role:"dialog",tabindex:"-1"},properties:{modal:{type:Boolean,value:!1},__readied:{type:Boolean,value:!1}},observers:["_modalChanged(modal, __readied)"],listeners:{tap:"_onDialogClick"},ready:function(){this.__prevNoCancelOnOutsideClick=this.noCancelOnOutsideClick,this.__prevNoCancelOnEscKey=this.noCancelOnEscKey,this.__prevWithBackdrop=this.withBackdrop,this.__readied=!0},_modalChanged:function(i,t){!t||(i?(this.__prevNoCancelOnOutsideClick=this.noCancelOnOutsideClick,this.__prevNoCancelOnEscKey=this.noCancelOnEscKey,this.__prevWithBackdrop=this.withBackdrop,this.noCancelOnOutsideClick=!0,this.noCancelOnEscKey=!0,this.withBackdrop=!0):(this.noCancelOnOutsideClick=this.noCancelOnOutsideClick&&this.__prevNoCancelOnOutsideClick,this.noCancelOnEscKey=this.noCancelOnEscKey&&this.__prevNoCancelOnEscKey,this.withBackdrop=this.withBackdrop&&this.__prevWithBackdrop))},_updateClosingReasonConfirmed:function(i){this.closingReason=this.closingReason||{},this.closingReason.confirmed=i},_onDialogClick:function(i){for(var t=Mt(i).path,e=0,n=t.indexOf(this);e<n;e++){var r=t[e];if(r.hasAttribute&&(r.hasAttribute("dialog-dismiss")||r.hasAttribute("dialog-confirm"))){this._updateClosingReasonConfirmed(r.hasAttribute("dialog-confirm")),this.close(),i.stopPropagation();break}}}},NA=[wc,Sw];It({_template:ut`
    <style include="paper-dialog-shared-styles"></style>
    <slot></slot>
`,is:"paper-dialog",behaviors:[NA,Ig],listeners:{"neon-animation-finish":"_onNeonAnimationFinish"},_renderOpened:function(){this.cancelAnimation(),this.playAnimation("entry")},_renderClosed:function(){this.cancelAnimation(),this.playAnimation("exit")},_onNeonAnimationFinish:function(){this.opened?this._finishRenderOpened():this._finishRenderClosed()}});It({_template:ut`
    <style>

      :host {
        display: block;
        @apply --layout-relative;
      }

      :host(.is-scrolled:not(:first-child))::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: var(--divider-color);
      }

      :host(.can-scroll:not(.scrolled-to-bottom):not(:last-child))::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: var(--divider-color);
      }

      .scrollable {
        padding: 0 24px;

        @apply --layout-scroll;
        @apply --paper-dialog-scrollable;
      }

      .fit {
        @apply --layout-fit;
      }
    </style>

    <div id="scrollable" class="scrollable" on-scroll="updateScrollState">
      <slot></slot>
    </div>
`,is:"paper-dialog-scrollable",properties:{dialogElement:{type:Object}},get scrollTarget(){return this.$.scrollable},ready:function(){this._ensureTarget(),this.classList.add("no-padding")},attached:function(){this._ensureTarget(),requestAnimationFrame(this.updateScrollState.bind(this))},updateScrollState:function(){this.toggleClass("is-scrolled",this.scrollTarget.scrollTop>0),this.toggleClass("can-scroll",this.scrollTarget.offsetHeight<this.scrollTarget.scrollHeight),this.toggleClass("scrolled-to-bottom",this.scrollTarget.scrollTop+this.scrollTarget.offsetHeight>=this.scrollTarget.scrollHeight)},_ensureTarget:function(){this.dialogElement=this.dialogElement||this.parentElement,this.dialogElement&&this.dialogElement.behaviors&&this.dialogElement.behaviors.indexOf(Sw)>=0?(this.dialogElement.sizingTarget=this.scrollTarget,this.scrollTarget.classList.remove("fit")):this.dialogElement&&this.scrollTarget.classList.add("fit")}});var Ui=It({_template:ut`
    <style>
      :host {
        display: inline-block;
        position: fixed;
        clip: rect(0px,0px,0px,0px);
      }
    </style>
    <div aria-live$="[[mode]]">[[_text]]</div>
`,is:"iron-a11y-announcer",properties:{mode:{type:String,value:"polite"},timeout:{type:Number,value:150},_text:{type:String,value:""}},created:function(){Ui.instance||(Ui.instance=this),document.addEventListener("iron-announce",this._onIronAnnounce.bind(this))},announce:function(i){this._text="",this.async(function(){this._text=i},this.timeout)},_onIronAnnounce:function(i){i.detail&&i.detail.text&&this.announce(i.detail.text)}});Ui.instance=null;Ui.requestAvailability=function(){Ui.instance||(Ui.instance=document.createElement("iron-a11y-announcer")),document.body?document.body.appendChild(Ui.instance):document.addEventListener("load",function(){document.body.appendChild(Ui.instance)})};It({_template:ut`
    <style>
      :host {
        display: inline-block;
      }
    </style>
    <slot id="content"></slot>
`,is:"iron-input",behaviors:[Wr],properties:{bindValue:{type:String,value:""},value:{type:String,computed:"_computeValue(bindValue)"},allowedPattern:{type:String},autoValidate:{type:Boolean,value:!1},_inputElement:Object},observers:["_bindValueChanged(bindValue, _inputElement)"],listeners:{input:"_onInput",keypress:"_onKeypress"},created:function(){Ui.requestAvailability(),this._previousValidInput="",this._patternAlreadyChecked=!1},attached:function(){this._observer=Mt(this).observeNodes(function(i){this._initSlottedInput()}.bind(this))},detached:function(){this._observer&&(Mt(this).unobserveNodes(this._observer),this._observer=null)},get inputElement(){return this._inputElement},_initSlottedInput:function(){this._inputElement=this.getEffectiveChildren()[0],this.inputElement&&this.inputElement.value&&(this.bindValue=this.inputElement.value),this.fire("iron-input-ready")},get _patternRegExp(){var i;if(this.allowedPattern)i=new RegExp(this.allowedPattern);else switch(this.inputElement.type){case"number":i=/[0-9.,e-]/;break}return i},_bindValueChanged:function(i,t){!t||(i===void 0?t.value=null:i!==t.value&&(this.inputElement.value=i),this.autoValidate&&this.validate(),this.fire("bind-value-changed",{value:i}))},_onInput:function(){if(this.allowedPattern&&!this._patternAlreadyChecked){var i=this._checkPatternValidity();i||(this._announceInvalidCharacter("Invalid string of characters not entered."),this.inputElement.value=this._previousValidInput)}this.bindValue=this._previousValidInput=this.inputElement.value,this._patternAlreadyChecked=!1},_isPrintable:function(i){var t=i.keyCode==8||i.keyCode==9||i.keyCode==13||i.keyCode==27,e=i.keyCode==19||i.keyCode==20||i.keyCode==45||i.keyCode==46||i.keyCode==144||i.keyCode==145||i.keyCode>32&&i.keyCode<41||i.keyCode>111&&i.keyCode<124;return!t&&!(i.charCode==0&&e)},_onKeypress:function(i){if(!(!this.allowedPattern&&this.inputElement.type!=="number")){var t=this._patternRegExp;if(!!t&&!(i.metaKey||i.ctrlKey||i.altKey)){this._patternAlreadyChecked=!0;var e=String.fromCharCode(i.charCode);this._isPrintable(i)&&!t.test(e)&&(i.preventDefault(),this._announceInvalidCharacter("Invalid character "+e+" not entered."))}}},_checkPatternValidity:function(){var i=this._patternRegExp;if(!i)return!0;for(var t=0;t<this.inputElement.value.length;t++)if(!i.test(this.inputElement.value[t]))return!1;return!0},validate:function(){if(!this.inputElement)return this.invalid=!1,!0;var i=this.inputElement.checkValidity();return i&&(this.required&&this.bindValue===""?i=!1:this.hasValidator()&&(i=Wr.validate.call(this,this.bindValue))),this.invalid=!i,this.fire("iron-input-validate"),i},_announceInvalidCharacter:function(i){this.fire("iron-announce",{text:i})},_computeValue:function(i){return i}});var Lg={attached:function(){this.fire("addon-attached")},update:function(i){}};It({_template:ut`
    <style>
      :host {
        display: inline-block;
        float: right;

        @apply --paper-font-caption;
        @apply --paper-input-char-counter;
      }

      :host([hidden]) {
        display: none !important;
      }

      :host(:dir(rtl)) {
        float: left;
      }
    </style>

    <span>[[_charCounterStr]]</span>
`,is:"paper-input-char-counter",behaviors:[Lg],properties:{_charCounterStr:{type:String,value:"0"}},update:function(i){if(!!i.inputElement){i.value=i.value||"";var t=i.value.toString().length.toString();i.inputElement.hasAttribute("maxlength")&&(t+="/"+i.inputElement.getAttribute("maxlength")),this._charCounterStr=t}}});var LA=ut`
<custom-style>
  <style is="custom-style">
    html {
      --paper-input-container-shared-input-style: {
        position: relative; /* to make a stacking context */
        outline: none;
        box-shadow: none;
        padding: 0;
        margin: 0;
        width: 100%;
        max-width: 100%;
        background: transparent;
        border: none;
        color: var(--paper-input-container-input-color, var(--primary-text-color));
        -webkit-appearance: none;
        text-align: inherit;
        vertical-align: var(--paper-input-container-input-align, bottom);

        @apply --paper-font-subhead;
      };
    }
  </style>
</custom-style>
`;LA.setAttribute("style","display: none;");document.head.appendChild(LA.content);It({_template:ut`
    <style>
      :host {
        display: block;
        padding: 8px 0;
        @apply --paper-input-container;
      }

      :host([inline]) {
        display: inline-block;
      }

      :host([disabled]) {
        pointer-events: none;
        opacity: 0.33;

        @apply --paper-input-container-disabled;
      }

      :host([hidden]) {
        display: none !important;
      }

      [hidden] {
        display: none !important;
      }

      .floated-label-placeholder {
        @apply --paper-font-caption;
      }

      .underline {
        height: 2px;
        position: relative;
      }

      .focused-line {
        @apply --layout-fit;
        border-bottom: 2px solid var(--paper-input-container-focus-color, var(--primary-color));

        -webkit-transform-origin: center center;
        transform-origin: center center;
        -webkit-transform: scale3d(0,1,1);
        transform: scale3d(0,1,1);

        @apply --paper-input-container-underline-focus;
      }

      .underline.is-highlighted .focused-line {
        -webkit-transform: none;
        transform: none;
        -webkit-transition: -webkit-transform 0.25s;
        transition: transform 0.25s;

        @apply --paper-transition-easing;
      }

      .underline.is-invalid .focused-line {
        border-color: var(--paper-input-container-invalid-color, var(--error-color));
        -webkit-transform: none;
        transform: none;
        -webkit-transition: -webkit-transform 0.25s;
        transition: transform 0.25s;

        @apply --paper-transition-easing;
      }

      .unfocused-line {
        @apply --layout-fit;
        border-bottom: 1px solid var(--paper-input-container-color, var(--secondary-text-color));
        @apply --paper-input-container-underline;
      }

      :host([disabled]) .unfocused-line {
        border-bottom: 1px dashed;
        border-color: var(--paper-input-container-color, var(--secondary-text-color));
        @apply --paper-input-container-underline-disabled;
      }

      .input-wrapper {
        @apply --layout-horizontal;
        @apply --layout-center;
        position: relative;
      }

      .input-content {
        @apply --layout-flex-auto;
        @apply --layout-relative;
        max-width: 100%;
      }

      .input-content ::slotted(label),
      .input-content ::slotted(.paper-input-label) {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        font: inherit;
        color: var(--paper-input-container-color, var(--secondary-text-color));
        -webkit-transition: -webkit-transform 0.25s, width 0.25s;
        transition: transform 0.25s, width 0.25s;
        -webkit-transform-origin: left top;
        transform-origin: left top;
        /* Fix for safari not focusing 0-height date/time inputs with -webkit-apperance: none; */
        min-height: 1px;

        @apply --paper-font-common-nowrap;
        @apply --paper-font-subhead;
        @apply --paper-input-container-label;
        @apply --paper-transition-easing;
      }


      .input-content ::slotted(label):before,
      .input-content ::slotted(.paper-input-label):before {
        @apply --paper-input-container-label-before;
      }

      .input-content ::slotted(label):after,
      .input-content ::slotted(.paper-input-label):after {
        @apply --paper-input-container-label-after;
      }

      .input-content.label-is-floating ::slotted(label),
      .input-content.label-is-floating ::slotted(.paper-input-label) {
        -webkit-transform: translateY(-75%) scale(0.75);
        transform: translateY(-75%) scale(0.75);

        /* Since we scale to 75/100 of the size, we actually have 100/75 of the
        original space now available */
        width: 133%;

        @apply --paper-input-container-label-floating;
      }

      :host(:dir(rtl)) .input-content.label-is-floating ::slotted(label),
      :host(:dir(rtl)) .input-content.label-is-floating ::slotted(.paper-input-label) {
        right: 0;
        left: auto;
        -webkit-transform-origin: right top;
        transform-origin: right top;
      }

      .input-content.label-is-highlighted ::slotted(label),
      .input-content.label-is-highlighted ::slotted(.paper-input-label) {
        color: var(--paper-input-container-focus-color, var(--primary-color));

        @apply --paper-input-container-label-focus;
      }

      .input-content.is-invalid ::slotted(label),
      .input-content.is-invalid ::slotted(.paper-input-label) {
        color: var(--paper-input-container-invalid-color, var(--error-color));
      }

      .input-content.label-is-hidden ::slotted(label),
      .input-content.label-is-hidden ::slotted(.paper-input-label) {
        visibility: hidden;
      }

      .input-content ::slotted(input),
      .input-content ::slotted(iron-input),
      .input-content ::slotted(textarea),
      .input-content ::slotted(iron-autogrow-textarea),
      .input-content ::slotted(.paper-input-input) {
        @apply --paper-input-container-shared-input-style;
        /* The apply shim doesn't apply the nested color custom property,
          so we have to re-apply it here. */
        color: var(--paper-input-container-input-color, var(--primary-text-color));
        @apply --paper-input-container-input;
      }

      .input-content ::slotted(input)::-webkit-outer-spin-button,
      .input-content ::slotted(input)::-webkit-inner-spin-button {
        @apply --paper-input-container-input-webkit-spinner;
      }

      .input-content.focused ::slotted(input),
      .input-content.focused ::slotted(iron-input),
      .input-content.focused ::slotted(textarea),
      .input-content.focused ::slotted(iron-autogrow-textarea),
      .input-content.focused ::slotted(.paper-input-input) {
        @apply --paper-input-container-input-focus;
      }

      .input-content.is-invalid ::slotted(input),
      .input-content.is-invalid ::slotted(iron-input),
      .input-content.is-invalid ::slotted(textarea),
      .input-content.is-invalid ::slotted(iron-autogrow-textarea),
      .input-content.is-invalid ::slotted(.paper-input-input) {
        @apply --paper-input-container-input-invalid;
      }

      .prefix ::slotted(*) {
        display: inline-block;
        @apply --paper-font-subhead;
        @apply --layout-flex-none;
        @apply --paper-input-prefix;
      }

      .suffix ::slotted(*) {
        display: inline-block;
        @apply --paper-font-subhead;
        @apply --layout-flex-none;

        @apply --paper-input-suffix;
      }

      /* Firefox sets a min-width on the input, which can cause layout issues */
      .input-content ::slotted(input) {
        min-width: 0;
      }

      .input-content ::slotted(textarea) {
        resize: none;
      }

      .add-on-content {
        position: relative;
      }

      .add-on-content.is-invalid ::slotted(*) {
        color: var(--paper-input-container-invalid-color, var(--error-color));
      }

      .add-on-content.is-highlighted ::slotted(*) {
        color: var(--paper-input-container-focus-color, var(--primary-color));
      }
    </style>

    <div class="floated-label-placeholder" aria-hidden="true" hidden="[[noLabelFloat]]">&nbsp;</div>

    <div class="input-wrapper">
      <span class="prefix"><slot name="prefix"></slot></span>

      <div class$="[[_computeInputContentClass(noLabelFloat,alwaysFloatLabel,focused,invalid,_inputHasContent)]]" id="labelAndInputContainer">
        <slot name="label"></slot>
        <slot name="input"></slot>
      </div>

      <span class="suffix"><slot name="suffix"></slot></span>
    </div>

    <div class$="[[_computeUnderlineClass(focused,invalid)]]">
      <div class="unfocused-line"></div>
      <div class="focused-line"></div>
    </div>

    <div class$="[[_computeAddOnContentClass(focused,invalid)]]">
      <slot name="add-on"></slot>
    </div>
`,is:"paper-input-container",properties:{noLabelFloat:{type:Boolean,value:!1},alwaysFloatLabel:{type:Boolean,value:!1},attrForValue:{type:String,value:"bind-value"},autoValidate:{type:Boolean,value:!1},invalid:{observer:"_invalidChanged",type:Boolean,value:!1},focused:{readOnly:!0,type:Boolean,value:!1,notify:!0},_addons:{type:Array},_inputHasContent:{type:Boolean,value:!1},_inputSelector:{type:String,value:"input,iron-input,textarea,.paper-input-input"},_boundOnFocus:{type:Function,value:function(){return this._onFocus.bind(this)}},_boundOnBlur:{type:Function,value:function(){return this._onBlur.bind(this)}},_boundOnInput:{type:Function,value:function(){return this._onInput.bind(this)}},_boundValueChanged:{type:Function,value:function(){return this._onValueChanged.bind(this)}}},listeners:{"addon-attached":"_onAddonAttached","iron-input-validate":"_onIronInputValidate"},get _valueChangedEvent(){return this.attrForValue+"-changed"},get _propertyForValue(){return ns(this.attrForValue)},get _inputElement(){return Mt(this).querySelector(this._inputSelector)},get _inputElementValue(){return this._inputElement[this._propertyForValue]||this._inputElement.value},ready:function(){this.__isFirstValueUpdate=!0,this._addons||(this._addons=[]),this.addEventListener("focus",this._boundOnFocus,!0),this.addEventListener("blur",this._boundOnBlur,!0)},attached:function(){this.attrForValue?this._inputElement.addEventListener(this._valueChangedEvent,this._boundValueChanged):this.addEventListener("input",this._onInput),this._inputElementValue&&this._inputElementValue!=""?this._handleValueAndAutoValidate(this._inputElement):this._handleValue(this._inputElement)},_onAddonAttached:function(i){this._addons||(this._addons=[]);var t=i.target;this._addons.indexOf(t)===-1&&(this._addons.push(t),this.isAttached&&this._handleValue(this._inputElement))},_onFocus:function(){this._setFocused(!0)},_onBlur:function(){this._setFocused(!1),this._handleValueAndAutoValidate(this._inputElement)},_onInput:function(i){this._handleValueAndAutoValidate(i.target)},_onValueChanged:function(i){var t=i.target;this.__isFirstValueUpdate&&(this.__isFirstValueUpdate=!1,t.value===void 0||t.value==="")||this._handleValueAndAutoValidate(i.target)},_handleValue:function(i){var t=this._inputElementValue;t||t===0||i.type==="number"&&!i.checkValidity()?this._inputHasContent=!0:this._inputHasContent=!1,this.updateAddons({inputElement:i,value:t,invalid:this.invalid})},_handleValueAndAutoValidate:function(i){if(this.autoValidate&&i){var t;i.validate?t=i.validate(this._inputElementValue):t=i.checkValidity(),this.invalid=!t}this._handleValue(i)},_onIronInputValidate:function(i){this.invalid=this._inputElement.invalid},_invalidChanged:function(){this._addons&&this.updateAddons({invalid:this.invalid})},updateAddons:function(i){for(var t,e=0;t=this._addons[e];e++)t.update(i)},_computeInputContentClass:function(i,t,e,n,r){var o="input-content";if(i)r&&(o+=" label-is-hidden"),n&&(o+=" is-invalid");else{var s=this.querySelector("label");t||r?(o+=" label-is-floating",this.$.labelAndInputContainer.style.position="static",n?o+=" is-invalid":e&&(o+=" label-is-highlighted")):(s&&(this.$.labelAndInputContainer.style.position="relative"),n&&(o+=" is-invalid"))}return e&&(o+=" focused"),o},_computeUnderlineClass:function(i,t){var e="underline";return t?e+=" is-invalid":i&&(e+=" is-highlighted"),e},_computeAddOnContentClass:function(i,t){var e="add-on-content";return t?e+=" is-invalid":i&&(e+=" is-highlighted"),e}});It({_template:ut`
    <style>
      :host {
        display: inline-block;
        visibility: hidden;

        color: var(--paper-input-container-invalid-color, var(--error-color));

        @apply --paper-font-caption;
        @apply --paper-input-error;
        position: absolute;
        left:0;
        right:0;
      }

      :host([invalid]) {
        visibility: visible;
      }

      #a11yWrapper {
        visibility: hidden;
      }

      :host([invalid]) #a11yWrapper {
        visibility: visible;
      }
    </style>

    <!--
    If the paper-input-error element is directly referenced by an
    \`aria-describedby\` attribute, such as when used as a paper-input add-on,
    then applying \`visibility: hidden;\` to the paper-input-error element itself
    does not hide the error.

    For more information, see:
    https://www.w3.org/TR/accname-1.1/#mapping_additional_nd_description
    -->
    <div id="a11yWrapper">
      <slot></slot>
    </div>
`,is:"paper-input-error",behaviors:[Lg],properties:{invalid:{readOnly:!0,reflectToAttribute:!0,type:Boolean}},update:function(i){this._setInvalid(i.invalid)}});var Sc={};Sc.NextLabelID=1;Sc.NextAddonID=1;Sc.NextInputID=1;var Wq={properties:{label:{type:String},value:{notify:!0,type:String},disabled:{type:Boolean,value:!1},invalid:{type:Boolean,value:!1,notify:!0},allowedPattern:{type:String},type:{type:String},list:{type:String},pattern:{type:String},required:{type:Boolean,value:!1},errorMessage:{type:String},charCounter:{type:Boolean,value:!1},noLabelFloat:{type:Boolean,value:!1},alwaysFloatLabel:{type:Boolean,value:!1},autoValidate:{type:Boolean,value:!1},validator:{type:String},autocomplete:{type:String,value:"off"},autofocus:{type:Boolean,observer:"_autofocusChanged"},inputmode:{type:String},minlength:{type:Number},maxlength:{type:Number},min:{type:String},max:{type:String},step:{type:String},name:{type:String},placeholder:{type:String,value:""},readonly:{type:Boolean,value:!1},size:{type:Number},autocapitalize:{type:String,value:"none"},autocorrect:{type:String,value:"off"},autosave:{type:String},results:{type:Number},accept:{type:String},multiple:{type:Boolean},_ariaDescribedBy:{type:String,value:""},_ariaLabelledBy:{type:String,value:""},_inputId:{type:String,value:""}},listeners:{"addon-attached":"_onAddonAttached"},keyBindings:{"shift+tab:keydown":"_onShiftTabDown"},hostAttributes:{tabindex:0},get inputElement(){return this.$||(this.$={}),this.$.input||(this._generateInputId(),this.$.input=this.$$("#"+this._inputId)),this.$.input},get _focusableElement(){return this.inputElement},created:function(){this._typesThatHaveText=["date","datetime","datetime-local","month","time","week","file"]},attached:function(){this._updateAriaLabelledBy(),!ve&&this.inputElement&&this._typesThatHaveText.indexOf(this.inputElement.type)!==-1&&(this.alwaysFloatLabel=!0)},_appendStringWithSpace:function(i,t){return i?i=i+" "+t:i=t,i},_onAddonAttached:function(i){var t=Mt(i).rootTarget;if(t.id)this._ariaDescribedBy=this._appendStringWithSpace(this._ariaDescribedBy,t.id);else{var e="paper-input-add-on-"+Sc.NextAddonID++;t.id=e,this._ariaDescribedBy=this._appendStringWithSpace(this._ariaDescribedBy,e)}},validate:function(){return this.inputElement.validate()},_focusBlurHandler:function(i){vn._focusBlurHandler.call(this,i),this.focused&&!this._shiftTabPressed&&this._focusableElement&&this._focusableElement.focus()},_onShiftTabDown:function(i){var t=this.getAttribute("tabindex");this._shiftTabPressed=!0,this.setAttribute("tabindex","-1"),this.async(function(){this.setAttribute("tabindex",t),this._shiftTabPressed=!1},1)},_handleAutoValidate:function(){this.autoValidate&&this.validate()},updateValueAndPreserveCaret:function(i){try{var t=this.inputElement.selectionStart;this.value=i,this.inputElement.selectionStart=t,this.inputElement.selectionEnd=t}catch(e){this.value=i}},_computeAlwaysFloatLabel:function(i,t){return t||i},_updateAriaLabelledBy:function(){var i=Mt(this.root).querySelector("label");if(!i){this._ariaLabelledBy="";return}var t;i.id?t=i.id:(t="paper-input-label-"+Sc.NextLabelID++,i.id=t),this._ariaLabelledBy=t},_generateInputId:function(){(!this._inputId||this._inputId==="")&&(this._inputId="input-"+Sc.NextInputID++)},_onChange:function(i){this.shadowRoot&&this.fire(i.type,{sourceEvent:i},{node:this,bubbles:i.bubbles,cancelable:i.cancelable})},_autofocusChanged:function(){if(this.autofocus&&this._focusableElement){var i=document.activeElement,t=i instanceof HTMLElement,e=t&&i!==document.body&&i!==document.documentElement;e||this._focusableElement.focus()}}},Dg=[vn,jn,Wq];It({is:"paper-input",_template:ut`
    <style>
      :host {
        display: block;
      }

      :host([focused]) {
        outline: none;
      }

      :host([hidden]) {
        display: none !important;
      }

      input {
        /* Firefox sets a min-width on the input, which can cause layout issues */
        min-width: 0;
      }

      /* In 1.x, the <input> is distributed to paper-input-container, which styles it.
      In 2.x the <iron-input> is distributed to paper-input-container, which styles
      it, but in order for this to work correctly, we need to reset some
      of the native input's properties to inherit (from the iron-input) */
      iron-input > input {
        @apply --paper-input-container-shared-input-style;
        font-family: inherit;
        font-weight: inherit;
        font-size: inherit;
        letter-spacing: inherit;
        word-spacing: inherit;
        line-height: inherit;
        text-shadow: inherit;
        color: inherit;
        cursor: inherit;
      }

      input:disabled {
        @apply --paper-input-container-input-disabled;
      }

      input::-webkit-outer-spin-button,
      input::-webkit-inner-spin-button {
        @apply --paper-input-container-input-webkit-spinner;
      }

      input::-webkit-clear-button {
        @apply --paper-input-container-input-webkit-clear;
      }

      input::-webkit-calendar-picker-indicator {
        @apply --paper-input-container-input-webkit-calendar-picker-indicator;
      }

      input::-webkit-input-placeholder {
        color: var(--paper-input-container-color, var(--secondary-text-color));
      }

      input:-moz-placeholder {
        color: var(--paper-input-container-color, var(--secondary-text-color));
      }

      input::-moz-placeholder {
        color: var(--paper-input-container-color, var(--secondary-text-color));
      }

      input::-ms-clear {
        @apply --paper-input-container-ms-clear;
      }

      input::-ms-reveal {
        @apply --paper-input-container-ms-reveal;
      }

      input:-ms-input-placeholder {
        color: var(--paper-input-container-color, var(--secondary-text-color));
      }

      label {
        pointer-events: none;
      }
    </style>

    <paper-input-container id="container" no-label-float="[[noLabelFloat]]" always-float-label="[[_computeAlwaysFloatLabel(alwaysFloatLabel,placeholder)]]" auto-validate$="[[autoValidate]]" disabled$="[[disabled]]" invalid="[[invalid]]">

      <slot name="prefix" slot="prefix"></slot>

      <label hidden$="[[!label]]" aria-hidden="true" for$="[[_inputId]]" slot="label">[[label]]</label>

      <!-- Need to bind maxlength so that the paper-input-char-counter works correctly -->
      <iron-input bind-value="{{value}}" slot="input" class="input-element" id$="[[_inputId]]" maxlength$="[[maxlength]]" allowed-pattern="[[allowedPattern]]" invalid="{{invalid}}" validator="[[validator]]">
        <input aria-labelledby$="[[_ariaLabelledBy]]" aria-describedby$="[[_ariaDescribedBy]]" disabled$="[[disabled]]" title$="[[title]]" type$="[[type]]" pattern$="[[pattern]]" required$="[[required]]" autocomplete$="[[autocomplete]]" autofocus$="[[autofocus]]" inputmode$="[[inputmode]]" minlength$="[[minlength]]" maxlength$="[[maxlength]]" min$="[[min]]" max$="[[max]]" step$="[[step]]" name$="[[name]]" placeholder$="[[placeholder]]" readonly$="[[readonly]]" list$="[[list]]" size$="[[size]]" autocapitalize$="[[autocapitalize]]" autocorrect$="[[autocorrect]]" on-change="_onChange" tabindex$="[[tabIndex]]" autosave$="[[autosave]]" results$="[[results]]" accept$="[[accept]]" multiple$="[[multiple]]" role$="[[inputRole]]" aria-haspopup$="[[inputAriaHaspopup]]">
      </iron-input>

      <slot name="suffix" slot="suffix"></slot>

      <template is="dom-if" if="[[errorMessage]]">
        <paper-input-error aria-live="assertive" slot="add-on">[[errorMessage]]</paper-input-error>
      </template>

      <template is="dom-if" if="[[charCounter]]">
        <paper-input-char-counter slot="add-on"></paper-input-char-counter>
      </template>

    </paper-input-container>
  `,behaviors:[Dg,Ur],properties:{value:{type:String},inputRole:{type:String,value:void 0},inputAriaHaspopup:{type:String,value:void 0}},get _focusableElement(){return this.inputElement._inputElement},listeners:{"iron-input-ready":"_onIronInputReady"},_onIronInputReady:function(){this.$.nativeInput||(this.$.nativeInput=this.$$("input")),this.inputElement&&this._typesThatHaveText.indexOf(this.$.nativeInput.type)!==-1&&(this.alwaysFloatLabel=!0),this.inputElement.bindValue&&this.$.container._handleValueAndAutoValidate(this.inputElement)}});It({_template:ut`
    <style>
      :host {
        position: fixed;
      }

      #contentWrapper ::slotted(*) {
        overflow: auto;
      }

      #contentWrapper.animating ::slotted(*) {
        overflow: hidden;
        pointer-events: none;
      }
    </style>

    <div id="contentWrapper">
      <slot id="content" name="dropdown-content"></slot>
    </div>
`,is:"iron-dropdown",behaviors:[vn,jn,wc,Ig],properties:{horizontalAlign:{type:String,value:"left",reflectToAttribute:!0},verticalAlign:{type:String,value:"top",reflectToAttribute:!0},openAnimationConfig:{type:Object},closeAnimationConfig:{type:Object},focusTarget:{type:Object},noAnimations:{type:Boolean,value:!1},allowOutsideScroll:{type:Boolean,value:!1,observer:"_allowOutsideScrollChanged"}},listeners:{"neon-animation-finish":"_onNeonAnimationFinish"},observers:["_updateOverlayPosition(positionTarget, verticalAlign, horizontalAlign, verticalOffset, horizontalOffset)"],get containedElement(){for(var i=Mt(this.$.content).getDistributedNodes(),t=0,e=i.length;t<e;t++)if(i[t].nodeType===Node.ELEMENT_NODE)return i[t]},ready:function(){this.scrollAction||(this.scrollAction=this.allowOutsideScroll?"refit":"lock"),this._readied=!0},attached:function(){(!this.sizingTarget||this.sizingTarget===this)&&(this.sizingTarget=this.containedElement||this)},detached:function(){this.cancelAnimation()},_openedChanged:function(){this.opened&&this.disabled?this.cancel():(this.cancelAnimation(),this._updateAnimationConfig(),ds._openedChanged.apply(this,arguments))},_renderOpened:function(){!this.noAnimations&&this.animationConfig.open?(this.$.contentWrapper.classList.add("animating"),this.playAnimation("open")):ds._renderOpened.apply(this,arguments)},_renderClosed:function(){!this.noAnimations&&this.animationConfig.close?(this.$.contentWrapper.classList.add("animating"),this.playAnimation("close")):ds._renderClosed.apply(this,arguments)},_onNeonAnimationFinish:function(){this.$.contentWrapper.classList.remove("animating"),this.opened?this._finishRenderOpened():this._finishRenderClosed()},_updateAnimationConfig:function(){for(var i=this.containedElement,t=[].concat(this.openAnimationConfig||[]).concat(this.closeAnimationConfig||[]),e=0;e<t.length;e++)t[e].node=i;this.animationConfig={open:this.openAnimationConfig,close:this.closeAnimationConfig}},_updateOverlayPosition:function(){this.isAttached&&this.notifyResize()},_allowOutsideScrollChanged:function(i){!this._readied||(i?(!this.scrollAction||this.scrollAction==="lock")&&(this.scrollAction="refit"):this.scrollAction="lock")},_applyFocus:function(){var i=this.focusTarget||this.containedElement;i&&this.opened&&!this.noAutoFocus?i.focus():ds._applyFocus.apply(this,arguments)}});var To={properties:{animationTiming:{type:Object,value:function(){return{duration:500,easing:"cubic-bezier(0.4, 0, 0.2, 1)",fill:"both"}}}},isNeonAnimation:!0,created:function(){document.body.animate||console.warn("No web animations detected. This element will not function without a web animations polyfill.")},timingFromConfig:function(i){if(i.timing)for(var t in i.timing)this.animationTiming[t]=i.timing[t];return this.animationTiming},setPrefixedProperty:function(i,t,e){for(var n={transform:["webkitTransform"],transformOrigin:["mozTransformOrigin","webkitTransformOrigin"]},r=n[t],o,s=0;o=r[s];s++)i.style[o]=e;i.style[t]=e},complete:function(i){}};It({is:"fade-in-animation",behaviors:[To],configure:function(i){var t=i.node;return this._effect=new KeyframeEffect(t,[{opacity:"0"},{opacity:"1"}],this.timingFromConfig(i)),this._effect}});It({is:"fade-out-animation",behaviors:[To],configure:function(i){var t=i.node;return this._effect=new KeyframeEffect(t,[{opacity:"1"},{opacity:"0"}],this.timingFromConfig(i)),this._effect}});It({is:"paper-menu-grow-height-animation",_template:null,behaviors:[To],configure:function(i){var t=i.node,e=t.getBoundingClientRect(),n=e.height;return this._effect=new KeyframeEffect(t,[{height:n/2+"px"},{height:n+"px"}],this.timingFromConfig(i)),this._effect}});It({is:"paper-menu-grow-width-animation",_template:null,behaviors:[To],configure:function(i){var t=i.node,e=t.getBoundingClientRect(),n=e.width;return this._effect=new KeyframeEffect(t,[{width:n/2+"px"},{width:n+"px"}],this.timingFromConfig(i)),this._effect}});It({is:"paper-menu-shrink-width-animation",_template:null,behaviors:[To],configure:function(i){var t=i.node,e=t.getBoundingClientRect(),n=e.width;return this._effect=new KeyframeEffect(t,[{width:n+"px"},{width:n-n/20+"px"}],this.timingFromConfig(i)),this._effect}});It({is:"paper-menu-shrink-height-animation",_template:null,behaviors:[To],configure:function(i){var t=i.node,e=t.getBoundingClientRect(),n=e.height;return this.setPrefixedProperty(t,"transformOrigin","0 0"),this._effect=new KeyframeEffect(t,[{height:n+"px",transform:"translateY(0)"},{height:n/2+"px",transform:"translateY(-20px)"}],this.timingFromConfig(i)),this._effect}});var mp={ANIMATION_CUBIC_BEZIER:"cubic-bezier(.3,.95,.5,1)",MAX_ANIMATION_TIME_MS:400},Gq=It({_template:ut`
    <style>
      :host {
        display: inline-block;
        position: relative;
        padding: 8px;
        outline: none;

        @apply --paper-menu-button;
      }

      :host([disabled]) {
        cursor: auto;
        color: var(--disabled-text-color);

        @apply --paper-menu-button-disabled;
      }

      iron-dropdown {
        @apply --paper-menu-button-dropdown;
      }

      .dropdown-content {
        @apply --shadow-elevation-2dp;

        position: relative;
        border-radius: 2px;
        background-color: var(--paper-menu-button-dropdown-background, var(--primary-background-color));

        @apply --paper-menu-button-content;
      }

      :host([vertical-align="top"]) .dropdown-content {
        margin-bottom: 20px;
        margin-top: -10px;
        top: 10px;
      }

      :host([vertical-align="bottom"]) .dropdown-content {
        bottom: 10px;
        margin-bottom: -10px;
        margin-top: 20px;
      }

      #trigger {
        cursor: pointer;
      }
    </style>

    <div id="trigger" on-tap="toggle">
      <slot name="dropdown-trigger"></slot>
    </div>

    <iron-dropdown id="dropdown" opened="{{opened}}" horizontal-align="[[horizontalAlign]]" vertical-align="[[verticalAlign]]" dynamic-align="[[dynamicAlign]]" horizontal-offset="[[horizontalOffset]]" vertical-offset="[[verticalOffset]]" no-overlap="[[noOverlap]]" open-animation-config="[[openAnimationConfig]]" close-animation-config="[[closeAnimationConfig]]" no-animations="[[noAnimations]]" focus-target="[[_dropdownContent]]" allow-outside-scroll="[[allowOutsideScroll]]" restore-focus-on-close="[[restoreFocusOnClose]]" on-iron-overlay-canceled="__onIronOverlayCanceled" expand-sizing-target-for-scrollbars="[[expandSizingTargetForScrollbars]]">
      <div slot="dropdown-content" class="dropdown-content">
        <slot id="content" name="dropdown-content"></slot>
      </div>
    </iron-dropdown>
`,is:"paper-menu-button",behaviors:[jn,vn],properties:{opened:{type:Boolean,value:!1,notify:!0,observer:"_openedChanged"},horizontalAlign:{type:String,value:"left",reflectToAttribute:!0},verticalAlign:{type:String,value:"top",reflectToAttribute:!0},dynamicAlign:{type:Boolean},horizontalOffset:{type:Number,value:0,notify:!0},verticalOffset:{type:Number,value:0,notify:!0},noOverlap:{type:Boolean},noAnimations:{type:Boolean,value:!1},ignoreSelect:{type:Boolean,value:!1},closeOnActivate:{type:Boolean,value:!1},openAnimationConfig:{type:Object,value:function(){return[{name:"fade-in-animation",timing:{delay:100,duration:200}},{name:"paper-menu-grow-width-animation",timing:{delay:100,duration:150,easing:mp.ANIMATION_CUBIC_BEZIER}},{name:"paper-menu-grow-height-animation",timing:{delay:100,duration:275,easing:mp.ANIMATION_CUBIC_BEZIER}}]}},closeAnimationConfig:{type:Object,value:function(){return[{name:"fade-out-animation",timing:{duration:150}},{name:"paper-menu-shrink-width-animation",timing:{delay:100,duration:50,easing:mp.ANIMATION_CUBIC_BEZIER}},{name:"paper-menu-shrink-height-animation",timing:{duration:200,easing:"ease-in"}}]}},allowOutsideScroll:{type:Boolean,value:!1},restoreFocusOnClose:{type:Boolean,value:!0},expandSizingTargetForScrollbars:{type:Boolean,value:!1},_dropdownContent:{type:Object}},hostAttributes:{role:"group","aria-haspopup":"true"},listeners:{"iron-activate":"_onIronActivate","iron-select":"_onIronSelect"},get contentElement(){for(var i=Mt(this.$.content).getDistributedNodes(),t=0,e=i.length;t<e;t++)if(i[t].nodeType===Node.ELEMENT_NODE)return i[t]},toggle:function(){this.opened?this.close():this.open()},open:function(){this.disabled||this.$.dropdown.open()},close:function(){this.$.dropdown.close()},_onIronSelect:function(i){this.ignoreSelect||this.close()},_onIronActivate:function(i){this.closeOnActivate&&this.close()},_openedChanged:function(i,t){i?(this._dropdownContent=this.contentElement,this.fire("paper-dropdown-open")):t!=null&&this.fire("paper-dropdown-close")},_disabledChanged:function(i){vn._disabledChanged.apply(this,arguments),i&&this.opened&&this.close()},__onIronOverlayCanceled:function(i){var t=i.detail,e=this.$.trigger,n=Mt(t).path;n.indexOf(e)>-1&&i.preventDefault()}});Object.keys(mp).forEach(function(i){Gq[i]=mp[i]});var Cw=document.createElement("template");Cw.setAttribute("style","display: none;");Cw.innerHTML=`<iron-iconset-svg name="paper-dropdown-menu" size="24">
<svg><defs>
<g id="arrow-drop-down"><path d="M7 10l5 5 5-5z"></path></g>
</defs></svg>
</iron-iconset-svg>`;document.head.appendChild(Cw.content);var Mw=document.createElement("template");Mw.setAttribute("style","display: none;");Mw.innerHTML=`<dom-module id="paper-dropdown-menu-shared-styles">
  <template>
    <style>
      :host {
        display: inline-block;
        position: relative;
        text-align: left;

        /* NOTE(cdata): Both values are needed, since some phones require the
         * value to be \`transparent\`.
         */
        -webkit-tap-highlight-color: rgba(0,0,0,0);
        -webkit-tap-highlight-color: transparent;

        --paper-input-container-input: {
          overflow: hidden;
          white-space: nowrap;
          text-overflow: ellipsis;
          max-width: 100%;
          box-sizing: border-box;
          cursor: pointer;
        };

        @apply --paper-dropdown-menu;
      }

      /* paper-dropdown-menu and paper-dropdown-menu-light both delegate focus
       * to other internal elements which manage focus styling. */
      :host(:focus) {
        outline: none;
      }

      :host(:dir(rtl)) {
        text-align: right;

        @apply(--paper-dropdown-menu);
      }

      :host([disabled]) {
        @apply --paper-dropdown-menu-disabled;
      }

      :host([noink]) paper-ripple {
        display: none;
      }

      :host([no-label-float]) paper-ripple {
        top: 8px;
      }

      paper-ripple {
        top: 12px;
        left: 0px;
        bottom: 8px;
        right: 0px;

        @apply --paper-dropdown-menu-ripple;
      }

      paper-menu-button {
        display: block;
        padding: 0;

        @apply --paper-dropdown-menu-button;
      }

      paper-input {
        @apply --paper-dropdown-menu-input;
      }

      iron-icon {
        color: var(--disabled-text-color);

        @apply --paper-dropdown-menu-icon;
      }
    </style>
  </template>
</dom-module>`;document.head.appendChild(Mw.content);var jq=Oe(HTMLElement);It({_template:ut`
    <style include="paper-dropdown-menu-shared-styles"></style>

    <paper-menu-button id="menuButton" vertical-align="[[verticalAlign]]" horizontal-align="[[horizontalAlign]]" dynamic-align="[[dynamicAlign]]" vertical-offset="[[_computeMenuVerticalOffset(noLabelFloat, verticalOffset)]]" disabled="[[disabled]]" no-animations="[[noAnimations]]" on-iron-select="_onIronSelect" on-iron-deselect="_onIronDeselect" opened="{{opened}}" close-on-activate allow-outside-scroll="[[allowOutsideScroll]]" restore-focus-on-close="[[restoreFocusOnClose]]" expand-sizing-target-for-scrollbars="[[expandSizingTargetForScrollbars]]">
      <!-- support hybrid mode: user might be using paper-menu-button 1.x which distributes via <content> -->
      <div class="dropdown-trigger" slot="dropdown-trigger">
        <paper-ripple></paper-ripple>
        <!-- paper-input has type="text" for a11y, do not remove -->
        <paper-input id="input" type="text" invalid="[[invalid]]" readonly disabled="[[disabled]]" value="[[value]]" placeholder="[[placeholder]]" error-message="[[errorMessage]]" always-float-label="[[alwaysFloatLabel]]" no-label-float="[[noLabelFloat]]" label="[[label]]" input-role="button" input-aria-haspopup="listbox" autocomplete="off">
          <!-- support hybrid mode: user might be using paper-input 1.x which distributes via <content> -->
          <iron-icon icon="paper-dropdown-menu:arrow-drop-down" suffix slot="suffix"></iron-icon>
        </paper-input>
      </div>
      <slot id="content" name="dropdown-content" slot="dropdown-content"></slot>
    </paper-menu-button>
`,is:"paper-dropdown-menu",behaviors:[Hr,vn,Ur,Wr],properties:{selectedItemLabel:{type:String,notify:!0,readOnly:!0},selectedItem:{type:Object,notify:!0,readOnly:!0},value:{type:String,notify:!0},label:{type:String},placeholder:{type:String},errorMessage:{type:String},opened:{type:Boolean,notify:!0,value:!1,observer:"_openedChanged"},allowOutsideScroll:{type:Boolean,value:!1},noLabelFloat:{type:Boolean,value:!1,reflectToAttribute:!0},alwaysFloatLabel:{type:Boolean,value:!1},noAnimations:{type:Boolean,value:!1},horizontalAlign:{type:String,value:"right"},verticalAlign:{type:String,value:"top"},verticalOffset:Number,dynamicAlign:{type:Boolean},restoreFocusOnClose:{type:Boolean,value:!0},expandSizingTargetForScrollbars:{type:Boolean,value:!1}},listeners:{tap:"_onTap"},keyBindings:{"up down":"open",esc:"close"},observers:["_selectedItemChanged(selectedItem)"],_attachDom(i){let t=Ot(this);return t.attachShadow({mode:"open",delegatesFocus:!0,shadyUpgradeFragment:i}),t.shadowRoot.appendChild(i),jq.prototype._attachDom.call(this,i)},focus(){this.$.input._focusableElement.focus()},attached:function(){var i=this.contentElement;i&&i.selectedItem&&this._setSelectedItem(i.selectedItem)},get contentElement(){for(var i=Mt(this.$.content).getDistributedNodes(),t=0,e=i.length;t<e;t++)if(i[t].nodeType===Node.ELEMENT_NODE)return i[t]},open:function(){this.$.menuButton.open()},close:function(){this.$.menuButton.close()},_onIronSelect:function(i){this._setSelectedItem(i.detail.item)},_onIronDeselect:function(i){this._setSelectedItem(null)},_onTap:function(i){EI(i)===this&&this.open()},_selectedItemChanged:function(i){var t="";i?t=i.label||i.getAttribute("label")||i.textContent.trim():t="",this.value=t,this._setSelectedItemLabel(t)},_computeMenuVerticalOffset:function(i,t){return t||(i?-4:8)},_getValidity:function(i){return this.disabled||!this.required||this.required&&!!this.value},_openedChanged:function(){var i=this.opened?"true":"false",t=this.contentElement;t&&t.setAttribute("aria-expanded",i)}});var Ew=1,DA=2,zg={outerScroll:{scroll:!0},shadowMode:{standard:DA,waterfall:Ew,"waterfall-tall":Ew},tallMode:{"waterfall-tall":!0}};It({_template:ut`
    <style>
      :host {
        @apply --layout-vertical;
        position: relative;
        height: 100%;
        @apply --paper-header-panel;
      }

      #mainContainer {
        @apply --layout-flex;
        position: relative;
        overflow-y: auto;
        overflow-x: hidden;
        -webkit-overflow-scrolling: touch;
      }

      #mainPanel {
        @apply --layout-vertical;
        @apply --layout-flex;
        position: relative;
        min-height: 0;
        @apply --paper-header-panel-body;
      }

      #mainContainer {
        @apply --paper-header-panel-container;
      }

      /*
       * mode: scroll
       */
      :host([mode=scroll]) #mainContainer {
        @apply --paper-header-panel-scroll-container;
        overflow: visible;
      }

      :host([mode=scroll]) {
        overflow-y: auto;
        overflow-x: hidden;
        -webkit-overflow-scrolling: touch;
      }

      /*
       * mode: cover
       */
      :host([mode=cover]) #mainContainer {
        @apply --paper-header-panel-cover-container;
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      }

      :host([mode=cover]) #mainPanel {
        position: static;
      }

      /*
       * mode: standard
       */
      :host([mode=standard]) #mainContainer {
        @apply --paper-header-panel-standard-container;
      }

      /*
       * mode: seamed
       */
      :host([mode=seamed]) #mainContainer {
        @apply --paper-header-panel-seamed-container;
      }


      /*
       * mode: waterfall
       */
      :host([mode=waterfall]) #mainContainer {
        @apply --paper-header-panel-waterfall-container;
      }

      /*
       * mode: waterfall-tall
       */
      :host([mode=waterfall-tall]) #mainContainer {
        @apply --paper-header-panel-waterfall-tall-container;
      }

      #dropShadow {
        transition: opacity 0.5s;
        height: 6px;
        box-shadow: inset 0px 5px 6px -3px rgba(0, 0, 0, 0.4);
        @apply --paper-header-panel-shadow;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        opacity: 0;
        pointer-events: none;
      }

      #dropShadow.has-shadow {
        opacity: 1;
      }

      #mainContainer > ::slotted(.fit) {
        @apply --layout-fit;
      }

    </style>

    <slot id="headerSlot" name="header"></slot>

    <div id="mainPanel">
      <div id="mainContainer" class\$="[[_computeMainContainerClass(mode)]]">
        <slot></slot>
      </div>
      <div id="dropShadow"></div>
    </div>
`,is:"paper-header-panel",properties:{mode:{type:String,value:"standard",observer:"_modeChanged",reflectToAttribute:!0},shadow:{type:Boolean,value:!1},tallClass:{type:String,value:"tall"},atTop:{type:Boolean,value:!0,notify:!0,readOnly:!0,reflectToAttribute:!0}},observers:["_computeDropShadowHidden(atTop, mode, shadow)"],attached:function(){this._addListener(),this._keepScrollingState()},detached:function(){this._removeListener()},ready:function(){this.scrollHandler=this._scroll.bind(this),console.warn(this.is,"is deprecated. Please use app-layout instead!")},get header(){return Mt(this.$.headerSlot).getDistributedNodes()[0]},get scroller(){return this._getScrollerForMode(this.mode)},get visibleShadow(){return this.$.dropShadow.classList.contains("has-shadow")},_computeDropShadowHidden:function(i,t,e){var n=zg.shadowMode[t];this.shadow?this.toggleClass("has-shadow",!0,this.$.dropShadow):n===DA?this.toggleClass("has-shadow",!0,this.$.dropShadow):n===Ew&&!i?this.toggleClass("has-shadow",!0,this.$.dropShadow):this.toggleClass("has-shadow",!1,this.$.dropShadow)},_computeMainContainerClass:function(i){var t={};return t.flex=i!=="cover",Object.keys(t).filter(function(e){return t[e]}).join(" ")},_addListener:function(){this.scroller.addEventListener("scroll",this.scrollHandler)},_removeListener:function(){this.scroller.removeEventListener("scroll",this.scrollHandler)},_modeChanged:function(i,t){var e=zg,n=this.header,r=200;n&&(e.tallMode[t]&&!e.tallMode[i]?(n.classList.remove(this.tallClass),this.async(function(){n.classList.remove("animate")},r)):this.toggleClass("animate",e.tallMode[i],n)),this._keepScrollingState()},_keepScrollingState:function(){var i=this.scroller,t=this.header;this._setAtTop(i.scrollTop===0),t&&this.tallClass&&zg.tallMode[this.mode]&&this.toggleClass(this.tallClass,this.atTop||t.classList.contains(this.tallClass)&&i.scrollHeight<this.offsetHeight,t)},_scroll:function(){this._keepScrollingState(),this.fire("content-scroll",{target:this.scroller},{bubbles:!1})},_getScrollerForMode:function(i){return zg.outerScroll[i]?this:this.$.mainContainer}});It({is:"paper-icon-button",_template:ut`
    <style>
      :host {
        display: inline-block;
        position: relative;
        padding: 8px;
        outline: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        cursor: pointer;
        z-index: 0;
        line-height: 1;

        width: 40px;
        height: 40px;

        /*
          NOTE: Both values are needed, since some phones require the value to
          be \`transparent\`.
        */
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        -webkit-tap-highlight-color: transparent;

        /* Because of polymer/2558, this style has lower specificity than * */
        box-sizing: border-box !important;

        @apply --paper-icon-button;
      }

      :host #ink {
        color: var(--paper-icon-button-ink-color, var(--primary-text-color));
        opacity: 0.6;
      }

      :host([disabled]) {
        color: var(--paper-icon-button-disabled-text, var(--disabled-text-color));
        pointer-events: none;
        cursor: auto;

        @apply --paper-icon-button-disabled;
      }

      :host([hidden]) {
        display: none !important;
      }

      :host(:hover) {
        @apply --paper-icon-button-hover;
      }

      iron-icon {
        --iron-icon-width: 100%;
        --iron-icon-height: 100%;
      }
    </style>

    <iron-icon id="icon" src="[[src]]" icon="[[icon]]"
               alt$="[[alt]]"></iron-icon>
  `,hostAttributes:{role:"button",tabindex:"0"},behaviors:[vc],registered:function(){this._template.setAttribute("strip-whitespace","")},properties:{src:{type:String},icon:{type:String},alt:{type:String,observer:"_altChanged"}},_altChanged:function(i,t){var e=this.getAttribute("aria-label");(!e||t==e)&&this.setAttribute("aria-label",i)}});It({_template:ut`
    <style>
      :host {
        display: inline-block;
        position: relative;
        width: 400px;
        border: 1px solid;
        padding: 2px;
        -moz-appearance: textarea;
        -webkit-appearance: textarea;
        overflow: hidden;
      }

      .mirror-text {
        visibility: hidden;
        word-wrap: break-word;
        @apply --iron-autogrow-textarea;
      }

      .fit {
        @apply --layout-fit;
      }

      textarea {
        position: relative;
        outline: none;
        border: none;
        resize: none;
        background: inherit;
        color: inherit;
        /* see comments in template */
        width: 100%;
        height: 100%;
        font-size: inherit;
        font-family: inherit;
        line-height: inherit;
        text-align: inherit;
        @apply --iron-autogrow-textarea;
      }

      textarea::-webkit-input-placeholder {
        @apply --iron-autogrow-textarea-placeholder;
      }

      textarea:-moz-placeholder {
        @apply --iron-autogrow-textarea-placeholder;
      }

      textarea::-moz-placeholder {
        @apply --iron-autogrow-textarea-placeholder;
      }

      textarea:-ms-input-placeholder {
        @apply --iron-autogrow-textarea-placeholder;
      }
    </style>

    <!-- the mirror sizes the input/textarea so it grows with typing -->
    <!-- use &#160; instead &nbsp; of to allow this element to be used in XHTML -->
    <div id="mirror" class="mirror-text" aria-hidden="true">&nbsp;</div>

    <!-- size the input/textarea with a div, because the textarea has intrinsic size in ff -->
    <div class="textarea-container fit">
      <textarea id="textarea" name$="[[name]]" aria-label$="[[label]]" autocomplete$="[[autocomplete]]" autofocus$="[[autofocus]]" autocapitalize$="[[autocapitalize]]" inputmode$="[[inputmode]]" placeholder$="[[placeholder]]" readonly$="[[readonly]]" required$="[[required]]" disabled$="[[disabled]]" rows$="[[rows]]" minlength$="[[minlength]]" maxlength$="[[maxlength]]"></textarea>
    </div>
`,is:"iron-autogrow-textarea",behaviors:[Wr,vn],properties:{value:{observer:"_valueChanged",type:String,notify:!0},bindValue:{observer:"_bindValueChanged",type:String,notify:!0},rows:{type:Number,value:1,observer:"_updateCached"},maxRows:{type:Number,value:0,observer:"_updateCached"},autocomplete:{type:String,value:"off"},autofocus:{type:Boolean,value:!1},autocapitalize:{type:String,value:"none"},inputmode:{type:String},placeholder:{type:String},readonly:{type:String},required:{type:Boolean},minlength:{type:Number},maxlength:{type:Number},label:{type:String}},listeners:{input:"_onInput"},get textarea(){return this.$.textarea},get selectionStart(){return this.$.textarea.selectionStart},get selectionEnd(){return this.$.textarea.selectionEnd},set selectionStart(i){this.$.textarea.selectionStart=i},set selectionEnd(i){this.$.textarea.selectionEnd=i},attached:function(){var i=navigator.userAgent.match(/iP(?:[oa]d|hone)/)&&!navigator.userAgent.match(/OS 1[3456789]/);i&&(this.$.textarea.style.marginLeft="-3px")},validate:function(){var i=this.$.textarea.validity.valid;return i&&(this.required&&this.value===""?i=!1:this.hasValidator()&&(i=Wr.validate.call(this,this.value))),this.invalid=!i,this.fire("iron-input-validate"),i},_bindValueChanged:function(i){this.value=i},_valueChanged:function(i){var t=this.textarea;!t||(t.value!==i&&(t.value=i||i===0?i:""),this.bindValue=i,this.$.mirror.innerHTML=this._valueForMirror(),this.fire("bind-value-changed",{value:this.bindValue}))},_onInput:function(i){var t=Mt(i).path;this.value=t?t[0].value:i.target.value},_constrain:function(i){var t;for(i=i||[""],this.maxRows>0&&i.length>this.maxRows?t=i.slice(0,this.maxRows):t=i.slice(0);this.rows>0&&t.length<this.rows;)t.push("");return t.join("<br/>")+"&#160;"},_valueForMirror:function(){var i=this.textarea;if(!!i)return this.tokens=i&&i.value?i.value.replace(/&/gm,"&amp;").replace(/"/gm,"&quot;").replace(/'/gm,"&#39;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").split(`
`):[""],this._constrain(this.tokens)},_updateCached:function(){this.$.mirror.innerHTML=this._constrain(this.tokens)}});It({_template:ut`
    <style>
      :host {
        display: block;
      }

      :host([hidden]) {
        display: none !important;
      }

      label {
        pointer-events: none;
      }
    </style>

    <paper-input-container no-label-float$="[[noLabelFloat]]" always-float-label="[[_computeAlwaysFloatLabel(alwaysFloatLabel,placeholder)]]" auto-validate$="[[autoValidate]]" disabled$="[[disabled]]" invalid="[[invalid]]">

      <label hidden$="[[!label]]" aria-hidden="true" for$="[[_inputId]]" slot="label">[[label]]</label>

      <iron-autogrow-textarea class="paper-input-input" slot="input" id$="[[_inputId]]" aria-labelledby$="[[_ariaLabelledBy]]" aria-describedby$="[[_ariaDescribedBy]]" bind-value="{{value}}" invalid="{{invalid}}" validator$="[[validator]]" disabled$="[[disabled]]" autocomplete$="[[autocomplete]]" autofocus$="[[autofocus]]" inputmode$="[[inputmode]]" name$="[[name]]" placeholder$="[[placeholder]]" readonly$="[[readonly]]" required$="[[required]]" minlength$="[[minlength]]" maxlength$="[[maxlength]]" autocapitalize$="[[autocapitalize]]" rows$="[[rows]]" max-rows$="[[maxRows]]" on-change="_onChange"></iron-autogrow-textarea>

      <template is="dom-if" if="[[errorMessage]]">
        <paper-input-error aria-live="assertive" slot="add-on">[[errorMessage]]</paper-input-error>
      </template>

      <template is="dom-if" if="[[charCounter]]">
        <paper-input-char-counter slot="add-on"></paper-input-char-counter>
      </template>

    </paper-input-container>
`,is:"paper-textarea",behaviors:[Dg,Ur],properties:{_ariaLabelledBy:{observer:"_ariaLabelledByChanged",type:String},_ariaDescribedBy:{observer:"_ariaDescribedByChanged",type:String},value:{type:String},rows:{type:Number,value:1},maxRows:{type:Number,value:0}},get selectionStart(){return this.$.input.textarea.selectionStart},set selectionStart(i){this.$.input.textarea.selectionStart=i},get selectionEnd(){return this.$.input.textarea.selectionEnd},set selectionEnd(i){this.$.input.textarea.selectionEnd=i},_ariaLabelledByChanged:function(i){this._focusableElement.setAttribute("aria-labelledby",i)},_ariaDescribedByChanged:function(i){this._focusableElement.setAttribute("aria-describedby",i)},get _focusableElement(){return this.inputElement.textarea}});var Tw=document.createElement("template");Tw.setAttribute("style","display: none;");Tw.innerHTML=`<dom-module id="paper-item-shared-styles">
  <template>
    <style>
      :host, .paper-item {
        display: block;
        position: relative;
        min-height: var(--paper-item-min-height, 48px);
        padding: 0px 16px;
      }

      .paper-item {
        @apply --paper-font-subhead;
        border:none;
        outline: none;
        background: white;
        width: 100%;
        text-align: left;
      }

      :host([hidden]), .paper-item[hidden] {
        display: none !important;
      }

      :host(.iron-selected), .paper-item.iron-selected {
        font-weight: var(--paper-item-selected-weight, bold);

        @apply --paper-item-selected;
      }

      :host([disabled]), .paper-item[disabled] {
        color: var(--paper-item-disabled-color, var(--disabled-text-color));

        @apply --paper-item-disabled;
      }

      :host(:focus), .paper-item:focus {
        position: relative;
        outline: 0;

        @apply --paper-item-focused;
      }

      :host(:focus):before, .paper-item:focus:before {
        @apply --layout-fit;

        background: currentColor;
        content: '';
        opacity: var(--dark-divider-opacity);
        pointer-events: none;

        @apply --paper-item-focused-before;
      }
    </style>
  </template>
</dom-module>`;document.head.appendChild(Tw.content);var qq={hostAttributes:{role:"option",tabindex:"0"}},Fg=[Hr,vn,qq];It({_template:ut`
    <style include="paper-item-shared-styles">
      :host {
        @apply --layout-horizontal;
        @apply --layout-center;
        @apply --paper-font-subhead;

        @apply --paper-item;
      }
    </style>
    <slot></slot>
`,is:"paper-item",behaviors:[Fg]});It({_template:ut`
    <style>
      :host {
        overflow: hidden; /* needed for text-overflow: ellipsis to work on ff */
        @apply --layout-vertical;
        @apply --layout-center-justified;
        @apply --layout-flex;
      }

      :host([two-line]) {
        min-height: var(--paper-item-body-two-line-min-height, 72px);
      }

      :host([three-line]) {
        min-height: var(--paper-item-body-three-line-min-height, 88px);
      }

      :host > ::slotted(*) {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      :host > ::slotted([secondary]) {
        @apply --paper-font-body1;

        color: var(--paper-item-body-secondary-color, var(--secondary-text-color));

        @apply --paper-item-body-secondary;
      }
    </style>

    <slot></slot>
`,is:"paper-item-body"});It({_template:ut`
    <style include="paper-item-shared-styles"></style>
    <style>
      :host {
        @apply --layout-horizontal;
        @apply --layout-center;
        @apply --paper-font-subhead;

        @apply --paper-item;
        @apply --paper-icon-item;
      }

      .content-icon {
        @apply --layout-horizontal;
        @apply --layout-center;

        width: var(--paper-item-icon-width, 56px);
        @apply --paper-item-icon;
      }
    </style>

    <div id="contentIcon" class="content-icon">
      <slot name="item-icon"></slot>
    </div>
    <slot></slot>
`,is:"paper-icon-item",behaviors:[Fg]});var Iw={properties:{multi:{type:Boolean,value:!1,observer:"multiChanged"},selectedValues:{type:Array,notify:!0,value:function(){return[]}},selectedItems:{type:Array,readOnly:!0,notify:!0,value:function(){return[]}}},observers:["_updateSelected(selectedValues.splices)"],select:function(i){this.multi?this._toggleSelected(i):this.selected=i},multiChanged:function(i){this._selection.multi=i,this._updateSelected()},get _shouldUpdateSelection(){return this.selected!=null||this.selectedValues!=null&&this.selectedValues.length},_updateAttrForSelected:function(){this.multi?this.selectedItems&&this.selectedItems.length>0&&(this.selectedValues=this.selectedItems.map(function(i){return this._indexToValue(this.indexOf(i))},this).filter(function(i){return i!=null},this)):Vr._updateAttrForSelected.apply(this)},_updateSelected:function(){this.multi?this._selectMulti(this.selectedValues):this._selectSelected(this.selected)},_selectMulti:function(i){i=i||[];var t=(this._valuesToItems(i)||[]).filter(function(r){return r!=null});this._selection.clear(t);for(var e=0;e<t.length;e++)this._selection.setItemSelected(t[e],!0);if(this.fallbackSelection&&!this._selection.get().length){var n=this._valueToItem(this.fallbackSelection);n&&this.select(this.fallbackSelection)}},_selectionChange:function(){var i=this._selection.get();this.multi?(this._setSelectedItems(i),this._setSelectedItem(i.length?i[0]:null)):i!=null?(this._setSelectedItems([i]),this._setSelectedItem(i)):(this._setSelectedItems([]),this._setSelectedItem(null))},_toggleSelected:function(i){var t=this.selectedValues.indexOf(i),e=t<0;e?this.push("selectedValues",i):this.splice("selectedValues",t,1)},_valuesToItems:function(i){return i==null?null:i.map(function(t){return this._valueToItem(t)},this)}},zA=[Vr,Iw];var Ia={properties:{focusedItem:{observer:"_focusedItemChanged",readOnly:!0,type:Object},attrForItemTitle:{type:String},disabled:{type:Boolean,value:!1,observer:"_disabledChanged"}},_MODIFIER_KEYS:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Hyper","Meta","NumLock","OS","ScrollLock","Shift","Super","Symbol","SymbolLock"],_SEARCH_RESET_TIMEOUT_MS:1e3,_previousTabIndex:0,hostAttributes:{role:"menu"},observers:["_updateMultiselectable(multi)"],listeners:{focus:"_onFocus",keydown:"_onKeydown","iron-items-changed":"_onIronItemsChanged"},keyBindings:{up:"_onUpKey",down:"_onDownKey",esc:"_onEscKey","shift+tab:keydown":"_onShiftTabDown"},attached:function(){this._resetTabindices()},select:function(i){this._defaultFocusAsync&&(this.cancelAsync(this._defaultFocusAsync),this._defaultFocusAsync=null);var t=this._valueToItem(i);t&&t.hasAttribute("disabled")||(this._setFocusedItem(t),Iw.select.apply(this,arguments))},_resetTabindices:function(){var i=this.multi?this.selectedItems&&this.selectedItems[0]:this.selectedItem;this.items.forEach(function(t){t.setAttribute("tabindex",t===i?"0":"-1"),t.setAttribute("aria-selected",this._selection.isSelected(t))},this)},_updateMultiselectable:function(i){i?this.setAttribute("aria-multiselectable","true"):this.removeAttribute("aria-multiselectable")},_focusWithKeyboardEvent:function(i){if(this._MODIFIER_KEYS.indexOf(i.key)===-1){this.cancelDebouncer("_clearSearchText");var t=this._searchText||"",e=i.key&&i.key.length==1?i.key:String.fromCharCode(i.keyCode);t+=e.toLocaleLowerCase();for(var n=t.length,r=0,o;o=this.items[r];r++)if(!o.hasAttribute("disabled")){var s=this.attrForItemTitle||"textContent",a=(o[s]||o.getAttribute(s)||"").trim();if(!(a.length<n)&&a.slice(0,n).toLocaleLowerCase()==t){this._setFocusedItem(o);break}}this._searchText=t,this.debounce("_clearSearchText",this._clearSearchText,this._SEARCH_RESET_TIMEOUT_MS)}},_clearSearchText:function(){this._searchText=""},_focusPrevious:function(){for(var i=this.items.length,t=Number(this.indexOf(this.focusedItem)),e=1;e<i+1;e++){var n=this.items[(t-e+i)%i];if(!n.hasAttribute("disabled")){var r=Mt(n).getOwnerRoot()||document;if(this._setFocusedItem(n),Mt(r).activeElement==n)return}}},_focusNext:function(){for(var i=this.items.length,t=Number(this.indexOf(this.focusedItem)),e=1;e<i+1;e++){var n=this.items[(t+e)%i];if(!n.hasAttribute("disabled")){var r=Mt(n).getOwnerRoot()||document;if(this._setFocusedItem(n),Mt(r).activeElement==n)return}}},_applySelection:function(i,t){t?i.setAttribute("aria-selected","true"):i.setAttribute("aria-selected","false"),Vr._applySelection.apply(this,arguments)},_focusedItemChanged:function(i,t){t&&t.setAttribute("tabindex","-1"),i&&!i.hasAttribute("disabled")&&!this.disabled&&(i.setAttribute("tabindex","0"),i.focus())},_onIronItemsChanged:function(i){i.detail.addedNodes.length&&this._resetTabindices()},_onShiftTabDown:function(i){var t=this.getAttribute("tabindex");Ia._shiftTabPressed=!0,this._setFocusedItem(null),this.setAttribute("tabindex","-1"),this.async(function(){this.setAttribute("tabindex",t),Ia._shiftTabPressed=!1},1)},_onFocus:function(i){if(!Ia._shiftTabPressed){var t=Mt(i).rootTarget;t!==this&&typeof t.tabIndex!="undefined"&&!this.isLightDescendant(t)||(this._defaultFocusAsync=this.async(function(){var e=this.multi?this.selectedItems&&this.selectedItems[0]:this.selectedItem;this._setFocusedItem(null),e?this._setFocusedItem(e):this.items[0]&&this._focusNext()}))}},_onUpKey:function(i){this._focusPrevious(),i.detail.keyboardEvent.preventDefault()},_onDownKey:function(i){this._focusNext(),i.detail.keyboardEvent.preventDefault()},_onEscKey:function(i){var t=this.focusedItem;t&&t.blur()},_onKeydown:function(i){this.keyboardEventMatchesKeys(i,"up down esc")||this._focusWithKeyboardEvent(i),i.stopPropagation()},_activateHandler:function(i){Vr._activateHandler.call(this,i),i.stopPropagation()},_disabledChanged:function(i){i?(this._previousTabIndex=this.hasAttribute("tabindex")?this.tabIndex:0,this.removeAttribute("tabindex")):this.hasAttribute("tabindex")||this.setAttribute("tabindex",this._previousTabIndex)}};Ia._shiftTabPressed=!1;var Og=[zA,jn,Ia];It({_template:ut`
    <style>
      :host {
        display: block;
        padding: 8px 0;

        background: var(--paper-listbox-background-color, var(--primary-background-color));
        color: var(--paper-listbox-color, var(--primary-text-color));

        @apply --paper-listbox;
      }
    </style>

    <slot></slot>
`,is:"paper-listbox",behaviors:[Og],hostAttributes:{role:"listbox"}});var FA=ut`
<dom-module id="paper-material-shared-styles">
  <template>
    <style>
      :host {
        display: block;
        position: relative;
      }

      :host([elevation="1"]) {
        @apply --shadow-elevation-2dp;
      }

      :host([elevation="2"]) {
        @apply --shadow-elevation-4dp;
      }

      :host([elevation="3"]) {
        @apply --shadow-elevation-6dp;
      }

      :host([elevation="4"]) {
        @apply --shadow-elevation-8dp;
      }

      :host([elevation="5"]) {
        @apply --shadow-elevation-16dp;
      }
    </style>
  </template>
</dom-module>
`;FA.setAttribute("style","display: none;");document.body.appendChild(FA.content);It({_template:ut`
    <style include="paper-material-shared-styles"></style>
    <style>
      :host([animated]) {
        @apply --shadow-transition;
      }
      :host {
        @apply --paper-material;
      }
    </style>

    <slot></slot>
`,is:"paper-material",properties:{elevation:{type:Number,reflectToAttribute:!0,value:1},animated:{type:Boolean,reflectToAttribute:!0,value:!1}}});var Bg={properties:{value:{type:Number,value:0,notify:!0,reflectToAttribute:!0},min:{type:Number,value:0,notify:!0},max:{type:Number,value:100,notify:!0},step:{type:Number,value:1,notify:!0},ratio:{type:Number,value:0,readOnly:!0,notify:!0}},observers:["_update(value, min, max, step)"],_calcRatio:function(i){return(this._clampValue(i)-this.min)/(this.max-this.min)},_clampValue:function(i){return Math.min(this.max,Math.max(this.min,this._calcStep(i)))},_calcStep:function(i){if(i=parseFloat(i),!this.step)return i;var t=Math.round((i-this.min)/this.step);return this.step<1?t/(1/this.step)+this.min:t*this.step+this.min},_validateValue:function(){var i=this._clampValue(this.value);return this.value=this.oldValue=isNaN(i)?this.oldValue:i,this.value!==i},_update:function(){this._validateValue(),this._setRatio(this._calcRatio(this.value)*100)}};It({_template:ut`
    <style>
      :host {
        display: block;
        width: 200px;
        position: relative;
        overflow: hidden;
      }

      :host([hidden]), [hidden] {
        display: none !important;
      }

      #progressContainer {
        @apply --paper-progress-container;
        position: relative;
      }

      #progressContainer,
      /* the stripe for the indeterminate animation*/
      .indeterminate::after {
        height: var(--paper-progress-height, 4px);
      }

      #primaryProgress,
      #secondaryProgress,
      .indeterminate::after {
        @apply --layout-fit;
      }

      #progressContainer,
      .indeterminate::after {
        background: var(--paper-progress-container-color, var(--google-grey-300));
      }

      :host(.transiting) #primaryProgress,
      :host(.transiting) #secondaryProgress {
        -webkit-transition-property: -webkit-transform;
        transition-property: transform;

        /* Duration */
        -webkit-transition-duration: var(--paper-progress-transition-duration, 0.08s);
        transition-duration: var(--paper-progress-transition-duration, 0.08s);

        /* Timing function */
        -webkit-transition-timing-function: var(--paper-progress-transition-timing-function, ease);
        transition-timing-function: var(--paper-progress-transition-timing-function, ease);

        /* Delay */
        -webkit-transition-delay: var(--paper-progress-transition-delay, 0s);
        transition-delay: var(--paper-progress-transition-delay, 0s);
      }

      #primaryProgress,
      #secondaryProgress {
        @apply --layout-fit;
        -webkit-transform-origin: left center;
        transform-origin: left center;
        -webkit-transform: scaleX(0);
        transform: scaleX(0);
        will-change: transform;
      }

      #primaryProgress {
        background: var(--paper-progress-active-color, var(--google-green-500));
      }

      #secondaryProgress {
        background: var(--paper-progress-secondary-color, var(--google-green-100));
      }

      :host([disabled]) #primaryProgress {
        background: var(--paper-progress-disabled-active-color, var(--google-grey-500));
      }

      :host([disabled]) #secondaryProgress {
        background: var(--paper-progress-disabled-secondary-color, var(--google-grey-300));
      }

      :host(:not([disabled])) #primaryProgress.indeterminate {
        -webkit-transform-origin: right center;
        transform-origin: right center;
        -webkit-animation: indeterminate-bar var(--paper-progress-indeterminate-cycle-duration, 2s) linear infinite;
        animation: indeterminate-bar var(--paper-progress-indeterminate-cycle-duration, 2s) linear infinite;
      }

      :host(:not([disabled])) #primaryProgress.indeterminate::after {
        content: "";
        -webkit-transform-origin: center center;
        transform-origin: center center;

        -webkit-animation: indeterminate-splitter var(--paper-progress-indeterminate-cycle-duration, 2s) linear infinite;
        animation: indeterminate-splitter var(--paper-progress-indeterminate-cycle-duration, 2s) linear infinite;
      }

      @-webkit-keyframes indeterminate-bar {
        0% {
          -webkit-transform: scaleX(1) translateX(-100%);
        }
        50% {
          -webkit-transform: scaleX(1) translateX(0%);
        }
        75% {
          -webkit-transform: scaleX(1) translateX(0%);
          -webkit-animation-timing-function: cubic-bezier(.28,.62,.37,.91);
        }
        100% {
          -webkit-transform: scaleX(0) translateX(0%);
        }
      }

      @-webkit-keyframes indeterminate-splitter {
        0% {
          -webkit-transform: scaleX(.75) translateX(-125%);
        }
        30% {
          -webkit-transform: scaleX(.75) translateX(-125%);
          -webkit-animation-timing-function: cubic-bezier(.42,0,.6,.8);
        }
        90% {
          -webkit-transform: scaleX(.75) translateX(125%);
        }
        100% {
          -webkit-transform: scaleX(.75) translateX(125%);
        }
      }

      @keyframes indeterminate-bar {
        0% {
          transform: scaleX(1) translateX(-100%);
        }
        50% {
          transform: scaleX(1) translateX(0%);
        }
        75% {
          transform: scaleX(1) translateX(0%);
          animation-timing-function: cubic-bezier(.28,.62,.37,.91);
        }
        100% {
          transform: scaleX(0) translateX(0%);
        }
      }

      @keyframes indeterminate-splitter {
        0% {
          transform: scaleX(.75) translateX(-125%);
        }
        30% {
          transform: scaleX(.75) translateX(-125%);
          animation-timing-function: cubic-bezier(.42,0,.6,.8);
        }
        90% {
          transform: scaleX(.75) translateX(125%);
        }
        100% {
          transform: scaleX(.75) translateX(125%);
        }
      }
    </style>

    <div id="progressContainer">
      <div id="secondaryProgress" hidden\$="[[_hideSecondaryProgress(secondaryRatio)]]"></div>
      <div id="primaryProgress"></div>
    </div>
`,is:"paper-progress",behaviors:[Bg],properties:{secondaryProgress:{type:Number,value:0},secondaryRatio:{type:Number,value:0,readOnly:!0},indeterminate:{type:Boolean,value:!1,observer:"_toggleIndeterminate"},disabled:{type:Boolean,value:!1,reflectToAttribute:!0,observer:"_disabledChanged"}},observers:["_progressChanged(secondaryProgress, value, min, max, indeterminate)"],hostAttributes:{role:"progressbar"},_toggleIndeterminate:function(i){this.toggleClass("indeterminate",i,this.$.primaryProgress)},_transformProgress:function(i,t){var e="scaleX("+t/100+")";i.style.transform=i.style.webkitTransform=e},_mainRatioChanged:function(i){this._transformProgress(this.$.primaryProgress,i)},_progressChanged:function(i,t,e,n,r){i=this._clampValue(i),t=this._clampValue(t);var o=this._calcRatio(i)*100,s=this._calcRatio(t)*100;this._setSecondaryRatio(o),this._transformProgress(this.$.secondaryProgress,o),this._transformProgress(this.$.primaryProgress,s),this.secondaryProgress=i,r?this.removeAttribute("aria-valuenow"):this.setAttribute("aria-valuenow",t),this.setAttribute("aria-valuemin",e),this.setAttribute("aria-valuemax",n)},_disabledChanged:function(i){this.setAttribute("aria-disabled",i?"true":"false")},_hideSecondaryProgress:function(i){return i===0}});var OA=ut`
<style>
  :host {
    display: inline-block;
    line-height: 0;
    white-space: nowrap;
    cursor: pointer;
    @apply --paper-font-common-base;
    --calculated-paper-radio-button-size: var(--paper-radio-button-size, 16px);
    /* -1px is a sentinel for the default and is replace in \`attached\`. */
    --calculated-paper-radio-button-ink-size: var(--paper-radio-button-ink-size, -1px);
  }

  :host(:focus) {
    outline: none;
  }

  #radioContainer {
    @apply --layout-inline;
    @apply --layout-center-center;
    position: relative;
    width: var(--calculated-paper-radio-button-size);
    height: var(--calculated-paper-radio-button-size);
    vertical-align: middle;

    @apply --paper-radio-button-radio-container;
  }

  #ink {
    position: absolute;
    top: 50%;
    left: 50%;
    right: auto;
    width: var(--calculated-paper-radio-button-ink-size);
    height: var(--calculated-paper-radio-button-ink-size);
    color: var(--paper-radio-button-unchecked-ink-color, var(--primary-text-color));
    opacity: 0.6;
    pointer-events: none;
    -webkit-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
  }

  #ink[checked] {
    color: var(--paper-radio-button-checked-ink-color, var(--primary-color));
  }

  #offRadio, #onRadio {
    position: absolute;
    box-sizing: border-box;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: 50%;
  }

  #offRadio {
    border: 2px solid var(--paper-radio-button-unchecked-color, var(--primary-text-color));
    background-color: var(--paper-radio-button-unchecked-background-color, transparent);
    transition: border-color 0.28s;
  }

  #onRadio {
    background-color: var(--paper-radio-button-checked-color, var(--primary-color));
    -webkit-transform: scale(0);
    transform: scale(0);
    transition: -webkit-transform ease 0.28s;
    transition: transform ease 0.28s;
    will-change: transform;
  }

  :host([checked]) #offRadio {
    border-color: var(--paper-radio-button-checked-color, var(--primary-color));
  }

  :host([checked]) #onRadio {
    -webkit-transform: scale(0.5);
    transform: scale(0.5);
  }

  #radioLabel {
    line-height: normal;
    position: relative;
    display: inline-block;
    vertical-align: middle;
    margin-left: var(--paper-radio-button-label-spacing, 10px);
    white-space: normal;
    color: var(--paper-radio-button-label-color, var(--primary-text-color));

    @apply --paper-radio-button-label;
  }

  :host([checked]) #radioLabel {
    @apply --paper-radio-button-label-checked;
  }

  #radioLabel:dir(rtl) {
    margin-left: 0;
    margin-right: var(--paper-radio-button-label-spacing, 10px);
  }

  #radioLabel[hidden] {
    display: none;
  }

  /* disabled state */

  :host([disabled]) #offRadio {
    border-color: var(--paper-radio-button-unchecked-color, var(--primary-text-color));
    opacity: 0.5;
  }

  :host([disabled][checked]) #onRadio {
    background-color: var(--paper-radio-button-unchecked-color, var(--primary-text-color));
    opacity: 0.5;
  }

  :host([disabled]) #radioLabel {
    /* slightly darker than the button, so that it's readable */
    opacity: 0.65;
  }
</style>

<div id="radioContainer">
  <div id="offRadio"></div>
  <div id="onRadio"></div>
</div>

<div id="radioLabel"><slot></slot></div>`;OA.setAttribute("strip-whitespace","");It({_template:OA,is:"paper-radio-button",behaviors:[bc],hostAttributes:{role:"radio","aria-checked":!1,tabindex:0},properties:{ariaActiveAttribute:{type:String,value:"aria-checked"}},ready:function(){this._rippleContainer=this.$.radioContainer},attached:function(){fc(this,function(){var i=this.getComputedStyleValue("--calculated-paper-radio-button-ink-size").trim();if(i==="-1px"){var t=parseFloat(this.getComputedStyleValue("--calculated-paper-radio-button-size").trim()),e=Math.floor(3*t);e%2!==t%2&&e++,this.updateStyles({"--paper-radio-button-ink-size":e+"px"})}})}});var Vg={hostAttributes:{role:"menubar"},keyBindings:{left:"_onLeftKey",right:"_onRightKey"},_onUpKey:function(i){this.focusedItem.click(),i.detail.keyboardEvent.preventDefault()},_onDownKey:function(i){this.focusedItem.click(),i.detail.keyboardEvent.preventDefault()},get _isRTL(){return window.getComputedStyle(this).direction==="rtl"},_onLeftKey:function(i){this._isRTL?this._focusNext():this._focusPrevious(),i.detail.keyboardEvent.preventDefault()},_onRightKey:function(i){this._isRTL?this._focusPrevious():this._focusNext(),i.detail.keyboardEvent.preventDefault()},_onKeydown:function(i){this.keyboardEventMatchesKeys(i,"up down left right esc")||this._focusWithKeyboardEvent(i)}},Hg=[Og,Vg];It({_template:ut`
    <style>
      :host {
        display: inline-block;
      }

      :host ::slotted(*) {
        padding: var(--paper-radio-group-item-padding, 12px);
      }
    </style>

    <slot></slot>
`,is:"paper-radio-group",behaviors:[Hg],hostAttributes:{role:"radiogroup"},properties:{attrForSelected:{type:String,value:"name"},selectedAttribute:{type:String,value:"checked"},selectable:{type:String,value:"paper-radio-button"},allowEmptySelection:{type:Boolean,value:!1}},select:function(i){var t=this._valueToItem(i);if(!(t&&t.hasAttribute("disabled"))){if(this.selected){var e=this._valueToItem(this.selected);if(this.selected==i)if(this.allowEmptySelection)i="";else{e&&(e.checked=!0);return}e&&(e.checked=!1)}Vr.select.apply(this,[i]),this.fire("paper-radio-group-changed")}},_activateFocusedItem:function(){this._itemActivate(this._valueForItem(this.focusedItem),this.focusedItem)},_onUpKey:function(i){this._focusPrevious(),i.preventDefault(),this._activateFocusedItem()},_onDownKey:function(i){this._focusNext(),i.preventDefault(),this._activateFocusedItem()},_onLeftKey:function(i){Vg._onLeftKey.apply(this,arguments),this._activateFocusedItem()},_onRightKey:function(i){Vg._onRightKey.apply(this,arguments),this._activateFocusedItem()}});var BA=ut`
  <style>
    :host {
      @apply --layout;
      @apply --layout-justified;
      @apply --layout-center;
      width: 200px;
      cursor: default;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
      --paper-progress-active-color: var(--paper-slider-active-color, var(--google-blue-700));
      --paper-progress-secondary-color: var(--paper-slider-secondary-color, var(--google-blue-300));
      --paper-progress-disabled-active-color: var(--paper-slider-disabled-active-color, var(--paper-grey-400));
      --paper-progress-disabled-secondary-color: var(--paper-slider-disabled-secondary-color, var(--paper-grey-400));
      --calculated-paper-slider-height: var(--paper-slider-height, 2px);
    }

    /* focus shows the ripple */
    :host(:focus) {
      outline: none;
    }

    /**
      * NOTE(keanulee): Though :host-context is not universally supported, some pages
      * still rely on paper-slider being flipped when dir="rtl" is set on body. For full
      * compatibility, dir="rtl" must be explicitly set on paper-slider.
      */
    :dir(rtl) #sliderContainer {
      -webkit-transform: scaleX(-1);
      transform: scaleX(-1);
    }

    /**
      * NOTE(keanulee): This is separate from the rule above because :host-context may
      * not be recognized.
      */
    :host([dir="rtl"]) #sliderContainer {
      -webkit-transform: scaleX(-1);
      transform: scaleX(-1);
    }

    /**
      * NOTE(keanulee): Needed to override the :host-context rule (where supported)
      * to support LTR sliders in RTL pages.
      */
    :host([dir="ltr"]) #sliderContainer {
      -webkit-transform: scaleX(1);
      transform: scaleX(1);
    }

    #sliderContainer {
      position: relative;
      width: 100%;
      height: calc(30px + var(--calculated-paper-slider-height));
      margin-left: calc(15px + var(--calculated-paper-slider-height)/2);
      margin-right: calc(15px + var(--calculated-paper-slider-height)/2);
    }

    #sliderContainer:focus {
      outline: 0;
    }

    #sliderContainer.editable {
      margin-top: 12px;
      margin-bottom: 12px;
    }

    .bar-container {
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      overflow: hidden;
    }

    .ring > .bar-container {
      left: calc(5px + var(--calculated-paper-slider-height)/2);
      transition: left 0.18s ease;
    }

    .ring.expand.dragging > .bar-container {
      transition: none;
    }

    .ring.expand:not(.pin) > .bar-container {
      left: calc(8px + var(--calculated-paper-slider-height)/2);
    }

    #sliderBar {
      padding: 15px 0;
      width: 100%;
      background-color: var(--paper-slider-bar-color, transparent);
      --paper-progress-container-color: var(--paper-slider-container-color, var(--paper-grey-400));
      --paper-progress-height: var(--calculated-paper-slider-height);
    }

    .slider-markers {
      position: absolute;
      /* slider-knob is 30px + the slider-height so that the markers should start at a offset of 15px*/
      top: 15px;
      height: var(--calculated-paper-slider-height);
      left: 0;
      right: -1px;
      box-sizing: border-box;
      pointer-events: none;
      @apply --layout-horizontal;
    }

    .slider-marker {
      @apply --layout-flex;
    }
    .slider-markers::after,
    .slider-marker::after {
      content: "";
      display: block;
      margin-left: -1px;
      width: 2px;
      height: var(--calculated-paper-slider-height);
      border-radius: 50%;
      background-color: var(--paper-slider-markers-color, #000);
    }

    .slider-knob {
      position: absolute;
      left: 0;
      top: 0;
      margin-left: calc(-15px - var(--calculated-paper-slider-height)/2);
      width: calc(30px + var(--calculated-paper-slider-height));
      height: calc(30px + var(--calculated-paper-slider-height));
    }

    .transiting > .slider-knob {
      transition: left 0.08s ease;
    }

    .slider-knob:focus {
      outline: none;
    }

    .slider-knob.dragging {
      transition: none;
    }

    .snaps > .slider-knob.dragging {
      transition: -webkit-transform 0.08s ease;
      transition: transform 0.08s ease;
    }

    .slider-knob-inner {
      margin: 10px;
      width: calc(100% - 20px);
      height: calc(100% - 20px);
      background-color: var(--paper-slider-knob-color, var(--google-blue-700));
      border: 2px solid var(--paper-slider-knob-color, var(--google-blue-700));
      border-radius: 50%;

      -moz-box-sizing: border-box;
      box-sizing: border-box;

      transition-property: -webkit-transform, background-color, border;
      transition-property: transform, background-color, border;
      transition-duration: 0.18s;
      transition-timing-function: ease;
    }

    .expand:not(.pin) > .slider-knob > .slider-knob-inner {
      -webkit-transform: scale(1.5);
      transform: scale(1.5);
    }

    .ring > .slider-knob > .slider-knob-inner {
      background-color: var(--paper-slider-knob-start-color, transparent);
      border: 2px solid var(--paper-slider-knob-start-border-color, var(--paper-grey-400));
    }

    .slider-knob-inner::before {
      background-color: var(--paper-slider-pin-color, var(--google-blue-700));
    }

    .pin > .slider-knob > .slider-knob-inner::before {
      content: "";
      position: absolute;
      top: 0;
      left: 50%;
      margin-left: -13px;
      width: 26px;
      height: 26px;
      border-radius: 50% 50% 50% 0;

      -webkit-transform: rotate(-45deg) scale(0) translate(0);
      transform: rotate(-45deg) scale(0) translate(0);
    }

    .slider-knob-inner::before,
    .slider-knob-inner::after {
      transition: -webkit-transform .18s ease, background-color .18s ease;
      transition: transform .18s ease, background-color .18s ease;
    }

    .pin.ring > .slider-knob > .slider-knob-inner::before {
      background-color: var(--paper-slider-pin-start-color, var(--paper-grey-400));
    }

    .pin.expand > .slider-knob > .slider-knob-inner::before {
      -webkit-transform: rotate(-45deg) scale(1) translate(17px, -17px);
      transform: rotate(-45deg) scale(1) translate(17px, -17px);
    }

    .pin > .slider-knob > .slider-knob-inner::after {
      content: attr(value);
      position: absolute;
      top: 0;
      left: 50%;
      margin-left: -16px;
      width: 32px;
      height: 26px;
      text-align: center;
      color: var(--paper-slider-font-color, #fff);
      font-size: 10px;

      -webkit-transform: scale(0) translate(0);
      transform: scale(0) translate(0);
    }

    .pin.expand > .slider-knob > .slider-knob-inner::after {
      -webkit-transform: scale(1) translate(0, -17px);
      transform: scale(1) translate(0, -17px);
    }

    /* paper-input */
    .slider-input {
      width: 50px;
      overflow: hidden;
      --paper-input-container-input: {
        text-align: center;
        @apply --paper-slider-input-container-input;
      };
      @apply --paper-slider-input;
    }

    /* disabled state */
    #sliderContainer.disabled {
      pointer-events: none;
    }

    .disabled > .slider-knob > .slider-knob-inner {
      background-color: var(--paper-slider-disabled-knob-color, var(--paper-grey-400));
      border: 2px solid var(--paper-slider-disabled-knob-color, var(--paper-grey-400));
      -webkit-transform: scale3d(0.75, 0.75, 1);
      transform: scale3d(0.75, 0.75, 1);
    }

    .disabled.ring > .slider-knob > .slider-knob-inner {
      background-color: var(--paper-slider-knob-start-color, transparent);
      border: 2px solid var(--paper-slider-knob-start-border-color, var(--paper-grey-400));
    }

    paper-ripple {
      color: var(--paper-slider-knob-color, var(--google-blue-700));
    }
  </style>

  <div id="sliderContainer" class\$="[[_getClassNames(disabled, pin, snaps, immediateValue, min, expand, dragging, transiting, editable)]]">
    <div class="bar-container">
      <paper-progress disabled\$="[[disabled]]" id="sliderBar" aria-hidden="true" min="[[min]]" max="[[max]]" step="[[step]]" value="[[immediateValue]]" secondary-progress="[[secondaryProgress]]" on-down="_bardown" on-up="_resetKnob" on-track="_bartrack" on-tap="_barclick">
      </paper-progress>
    </div>

    <template is="dom-if" if="[[snaps]]">
      <div class="slider-markers">
        <template is="dom-repeat" items="[[markers]]">
          <div class="slider-marker"></div>
        </template>
      </div>
    </template>

    <div id="sliderKnob" class="slider-knob" on-down="_knobdown" on-up="_resetKnob" on-track="_onTrack" on-transitionend="_knobTransitionEnd">
        <div class="slider-knob-inner" value\$="[[immediateValue]]"></div>
    </div>
  </div>

  <template is="dom-if" if="[[editable]]">
    <paper-input id="input" type="number" step="[[step]]" min="[[min]]" max="[[max]]" class="slider-input" disabled\$="[[disabled]]" value="[[immediateValue]]" on-change="_changeValue" on-keydown="_inputKeyDown" no-label-float>
    </paper-input>
  </template>
`;BA.setAttribute("strip-whitespace","");It({_template:BA,is:"paper-slider",behaviors:[jn,Ur,vc,Bg],properties:{value:{type:Number,value:0},snaps:{type:Boolean,value:!1,notify:!0},pin:{type:Boolean,value:!1,notify:!0},secondaryProgress:{type:Number,value:0,notify:!0,observer:"_secondaryProgressChanged"},editable:{type:Boolean,value:!1},immediateValue:{type:Number,value:0,readOnly:!0,notify:!0},maxMarkers:{type:Number,value:0,notify:!0},expand:{type:Boolean,value:!1,readOnly:!0},ignoreBarTouch:{type:Boolean,value:!1},dragging:{type:Boolean,value:!1,readOnly:!0,notify:!0},transiting:{type:Boolean,value:!1,readOnly:!0},markers:{type:Array,readOnly:!0,value:function(){return[]}}},observers:["_updateKnob(value, min, max, snaps, step)","_valueChanged(value)","_immediateValueChanged(immediateValue)","_updateMarkers(maxMarkers, min, max, snaps)"],hostAttributes:{role:"slider",tabindex:0},keyBindings:{left:"_leftKey",right:"_rightKey","down pagedown home":"_decrementKey","up pageup end":"_incrementKey"},ready:function(){this.ignoreBarTouch&&Ea(this.$.sliderBar,"auto")},increment:function(){this.value=this._clampValue(this.value+this.step)},decrement:function(){this.value=this._clampValue(this.value-this.step)},_updateKnob:function(i,t,e,n,r){this.setAttribute("aria-valuemin",t),this.setAttribute("aria-valuemax",e),this.setAttribute("aria-valuenow",i),this._positionKnob(this._calcRatio(i)*100)},_valueChanged:function(){this.fire("value-change",{composed:!0})},_immediateValueChanged:function(){this.dragging?this.fire("immediate-value-change",{composed:!0}):this.value=this.immediateValue},_secondaryProgressChanged:function(){this.secondaryProgress=this._clampValue(this.secondaryProgress)},_expandKnob:function(){this._setExpand(!0)},_resetKnob:function(){this.cancelDebouncer("expandKnob"),this._setExpand(!1)},_positionKnob:function(i){this._setImmediateValue(this._calcStep(this._calcKnobPosition(i))),this._setRatio(this._calcRatio(this.immediateValue)*100),this.$.sliderKnob.style.left=this.ratio+"%",this.dragging&&(this._knobstartx=this.ratio*this._w/100,this.translate3d(0,0,0,this.$.sliderKnob))},_calcKnobPosition:function(i){return(this.max-this.min)*i/100+this.min},_onTrack:function(i){switch(i.stopPropagation(),i.detail.state){case"start":this._trackStart(i);break;case"track":this._trackX(i);break;case"end":this._trackEnd();break}},_trackStart:function(i){this._setTransiting(!1),this._w=this.$.sliderBar.offsetWidth,this._x=this.ratio*this._w/100,this._startx=this._x,this._knobstartx=this._startx,this._minx=-this._startx,this._maxx=this._w-this._startx,this.$.sliderKnob.classList.add("dragging"),this._setDragging(!0)},_trackX:function(i){this.dragging||this._trackStart(i);var t=this._isRTL?-1:1,e=Math.min(this._maxx,Math.max(this._minx,i.detail.dx*t));this._x=this._startx+e;var n=this._calcStep(this._calcKnobPosition(this._x/this._w*100));this._setImmediateValue(n);var r=this._calcRatio(this.immediateValue)*this._w-this._knobstartx;this.translate3d(r+"px",0,0,this.$.sliderKnob)},_trackEnd:function(){var i=this.$.sliderKnob.style;this.$.sliderKnob.classList.remove("dragging"),this._setDragging(!1),this._resetKnob(),this.value=this.immediateValue,i.transform=i.webkitTransform="",this.fire("change",{composed:!0})},_knobdown:function(i){this._expandKnob(),i.preventDefault(),this.focus()},_bartrack:function(i){this._allowBarEvent(i)&&this._onTrack(i)},_barclick:function(i){this._w=this.$.sliderBar.offsetWidth;var t=this.$.sliderBar.getBoundingClientRect(),e=(i.detail.x-t.left)/this._w*100;this._isRTL&&(e=100-e);var n=this.ratio;this._setTransiting(!0),this._positionKnob(e),n===this.ratio&&this._setTransiting(!1),this.async(function(){this.fire("change",{composed:!0})}),i.preventDefault(),this.focus()},_bardown:function(i){this._allowBarEvent(i)&&(this.debounce("expandKnob",this._expandKnob,60),this._barclick(i))},_knobTransitionEnd:function(i){i.target===this.$.sliderKnob&&this._setTransiting(!1)},_updateMarkers:function(i,t,e,n){n||this._setMarkers([]);var r=Math.round((e-t)/this.step);r>i&&(r=i),(r<0||!isFinite(r))&&(r=0),this._setMarkers(new Array(r))},_mergeClasses:function(i){return Object.keys(i).filter(function(t){return i[t]}).join(" ")},_getClassNames:function(){return this._mergeClasses({disabled:this.disabled,pin:this.pin,snaps:this.snaps,ring:this.immediateValue<=this.min,expand:this.expand,dragging:this.dragging,transiting:this.transiting,editable:this.editable})},_allowBarEvent:function(i){return!this.ignoreBarTouch||i.detail.sourceEvent instanceof MouseEvent},get _isRTL(){return this.__isRTL===void 0&&(this.__isRTL=window.getComputedStyle(this).direction==="rtl"),this.__isRTL},_leftKey:function(i){this._isRTL?this._incrementKey(i):this._decrementKey(i)},_rightKey:function(i){this._isRTL?this._decrementKey(i):this._incrementKey(i)},_incrementKey:function(i){this.disabled||(i.detail.key==="end"?this.value=this.max:this.increment(),this.fire("change"),i.preventDefault())},_decrementKey:function(i){this.disabled||(i.detail.key==="home"?this.value=this.min:this.decrement(),this.fire("change"),i.preventDefault())},_changeValue:function(i){this.value=i.target.value,this.fire("change",{composed:!0})},_inputKeyDown:function(i){i.stopPropagation()},_createRipple:function(){return this._rippleContainer=this.$.sliderKnob,dp._createRipple.call(this)},_focusedChanged:function(i){i&&this.ensureRipple(),this.hasRipple()&&(i?this._ripple.style.display="":this._ripple.style.display="none",this._ripple.holdDown=i)}});var Aw=document.createElement("template");Aw.setAttribute("style","display: none;");Aw.innerHTML=`<dom-module id="paper-spinner-styles">
  <template>
    <style>
      /*
      /**************************/
      /* STYLES FOR THE SPINNER */
      /**************************/

      /*
       * Constants:
       *      ARCSIZE     = 270 degrees (amount of circle the arc takes up)
       *      ARCTIME     = 1333ms (time it takes to expand and contract arc)
       *      ARCSTARTROT = 216 degrees (how much the start location of the arc
       *                                should rotate each time, 216 gives us a
       *                                5 pointed star shape (it's 360/5 * 3).
       *                                For a 7 pointed star, we might do
       *                                360/7 * 3 = 154.286)
       *      SHRINK_TIME = 400ms
       */

      :host {
        display: inline-block;
        position: relative;
        width: 28px;
        height: 28px;

        /* 360 * ARCTIME / (ARCSTARTROT + (360-ARCSIZE)) */
        --paper-spinner-container-rotation-duration: 1568ms;

        /* ARCTIME */
        --paper-spinner-expand-contract-duration: 1333ms;

        /* 4 * ARCTIME */
        --paper-spinner-full-cycle-duration: 5332ms;

        /* SHRINK_TIME */
        --paper-spinner-cooldown-duration: 400ms;
      }

      #spinnerContainer {
        width: 100%;
        height: 100%;

        /* The spinner does not have any contents that would have to be
         * flipped if the direction changes. Always use ltr so that the
         * style works out correctly in both cases. */
        direction: ltr;
      }

      #spinnerContainer.active {
        -webkit-animation: container-rotate var(--paper-spinner-container-rotation-duration) linear infinite;
        animation: container-rotate var(--paper-spinner-container-rotation-duration) linear infinite;
      }

      @-webkit-keyframes container-rotate {
        to { -webkit-transform: rotate(360deg) }
      }

      @keyframes container-rotate {
        to { transform: rotate(360deg) }
      }

      .spinner-layer {
        position: absolute;
        width: 100%;
        height: 100%;
        opacity: 0;
        white-space: nowrap;
        color: var(--paper-spinner-color, var(--google-blue-500));
      }

      .layer-1 {
        color: var(--paper-spinner-layer-1-color, var(--google-blue-500));
      }

      .layer-2 {
        color: var(--paper-spinner-layer-2-color, var(--google-red-500));
      }

      .layer-3 {
        color: var(--paper-spinner-layer-3-color, var(--google-yellow-500));
      }

      .layer-4 {
        color: var(--paper-spinner-layer-4-color, var(--google-green-500));
      }

      /**
       * IMPORTANT NOTE ABOUT CSS ANIMATION PROPERTIES (keanulee):
       *
       * iOS Safari (tested on iOS 8.1) does not handle animation-delay very well - it doesn't
       * guarantee that the animation will start _exactly_ after that value. So we avoid using
       * animation-delay and instead set custom keyframes for each color (as layer-2undant as it
       * seems).
       */
      .active .spinner-layer {
        -webkit-animation-name: fill-unfill-rotate;
        -webkit-animation-duration: var(--paper-spinner-full-cycle-duration);
        -webkit-animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);
        -webkit-animation-iteration-count: infinite;
        animation-name: fill-unfill-rotate;
        animation-duration: var(--paper-spinner-full-cycle-duration);
        animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);
        animation-iteration-count: infinite;
        opacity: 1;
      }

      .active .spinner-layer.layer-1 {
        -webkit-animation-name: fill-unfill-rotate, layer-1-fade-in-out;
        animation-name: fill-unfill-rotate, layer-1-fade-in-out;
      }

      .active .spinner-layer.layer-2 {
        -webkit-animation-name: fill-unfill-rotate, layer-2-fade-in-out;
        animation-name: fill-unfill-rotate, layer-2-fade-in-out;
      }

      .active .spinner-layer.layer-3 {
        -webkit-animation-name: fill-unfill-rotate, layer-3-fade-in-out;
        animation-name: fill-unfill-rotate, layer-3-fade-in-out;
      }

      .active .spinner-layer.layer-4 {
        -webkit-animation-name: fill-unfill-rotate, layer-4-fade-in-out;
        animation-name: fill-unfill-rotate, layer-4-fade-in-out;
      }

      @-webkit-keyframes fill-unfill-rotate {
        12.5% { -webkit-transform: rotate(135deg) } /* 0.5 * ARCSIZE */
        25%   { -webkit-transform: rotate(270deg) } /* 1   * ARCSIZE */
        37.5% { -webkit-transform: rotate(405deg) } /* 1.5 * ARCSIZE */
        50%   { -webkit-transform: rotate(540deg) } /* 2   * ARCSIZE */
        62.5% { -webkit-transform: rotate(675deg) } /* 2.5 * ARCSIZE */
        75%   { -webkit-transform: rotate(810deg) } /* 3   * ARCSIZE */
        87.5% { -webkit-transform: rotate(945deg) } /* 3.5 * ARCSIZE */
        to    { -webkit-transform: rotate(1080deg) } /* 4   * ARCSIZE */
      }

      @keyframes fill-unfill-rotate {
        12.5% { transform: rotate(135deg) } /* 0.5 * ARCSIZE */
        25%   { transform: rotate(270deg) } /* 1   * ARCSIZE */
        37.5% { transform: rotate(405deg) } /* 1.5 * ARCSIZE */
        50%   { transform: rotate(540deg) } /* 2   * ARCSIZE */
        62.5% { transform: rotate(675deg) } /* 2.5 * ARCSIZE */
        75%   { transform: rotate(810deg) } /* 3   * ARCSIZE */
        87.5% { transform: rotate(945deg) } /* 3.5 * ARCSIZE */
        to    { transform: rotate(1080deg) } /* 4   * ARCSIZE */
      }

      @-webkit-keyframes layer-1-fade-in-out {
        0% { opacity: 1 }
        25% { opacity: 1 }
        26% { opacity: 0 }
        89% { opacity: 0 }
        90% { opacity: 1 }
        to { opacity: 1 }
      }

      @keyframes layer-1-fade-in-out {
        0% { opacity: 1 }
        25% { opacity: 1 }
        26% { opacity: 0 }
        89% { opacity: 0 }
        90% { opacity: 1 }
        to { opacity: 1 }
      }

      @-webkit-keyframes layer-2-fade-in-out {
        0% { opacity: 0 }
        15% { opacity: 0 }
        25% { opacity: 1 }
        50% { opacity: 1 }
        51% { opacity: 0 }
        to { opacity: 0 }
      }

      @keyframes layer-2-fade-in-out {
        0% { opacity: 0 }
        15% { opacity: 0 }
        25% { opacity: 1 }
        50% { opacity: 1 }
        51% { opacity: 0 }
        to { opacity: 0 }
      }

      @-webkit-keyframes layer-3-fade-in-out {
        0% { opacity: 0 }
        40% { opacity: 0 }
        50% { opacity: 1 }
        75% { opacity: 1 }
        76% { opacity: 0 }
        to { opacity: 0 }
      }

      @keyframes layer-3-fade-in-out {
        0% { opacity: 0 }
        40% { opacity: 0 }
        50% { opacity: 1 }
        75% { opacity: 1 }
        76% { opacity: 0 }
        to { opacity: 0 }
      }

      @-webkit-keyframes layer-4-fade-in-out {
        0% { opacity: 0 }
        65% { opacity: 0 }
        75% { opacity: 1 }
        90% { opacity: 1 }
        to { opacity: 0 }
      }

      @keyframes layer-4-fade-in-out {
        0% { opacity: 0 }
        65% { opacity: 0 }
        75% { opacity: 1 }
        90% { opacity: 1 }
        to { opacity: 0 }
      }

      .circle-clipper {
        display: inline-block;
        position: relative;
        width: 50%;
        height: 100%;
        overflow: hidden;
      }

      /**
       * Patch the gap that appear between the two adjacent div.circle-clipper while the
       * spinner is rotating (appears on Chrome 50, Safari 9.1.1, and Edge).
       */
      .spinner-layer::after {
        content: '';
        left: 45%;
        width: 10%;
        border-top-style: solid;
      }

      .spinner-layer::after,
      .circle-clipper .circle {
        box-sizing: border-box;
        position: absolute;
        top: 0;
        border-width: var(--paper-spinner-stroke-width, 3px);
        border-radius: 50%;
      }

      .circle-clipper .circle {
        bottom: 0;
        width: 200%;
        border-style: solid;
        border-bottom-color: transparent !important;
      }

      .circle-clipper.left .circle {
        left: 0;
        border-right-color: transparent !important;
        -webkit-transform: rotate(129deg);
        transform: rotate(129deg);
      }

      .circle-clipper.right .circle {
        left: -100%;
        border-left-color: transparent !important;
        -webkit-transform: rotate(-129deg);
        transform: rotate(-129deg);
      }

      .active .gap-patch::after,
      .active .circle-clipper .circle {
        -webkit-animation-duration: var(--paper-spinner-expand-contract-duration);
        -webkit-animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);
        -webkit-animation-iteration-count: infinite;
        animation-duration: var(--paper-spinner-expand-contract-duration);
        animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);
        animation-iteration-count: infinite;
      }

      .active .circle-clipper.left .circle {
        -webkit-animation-name: left-spin;
        animation-name: left-spin;
      }

      .active .circle-clipper.right .circle {
        -webkit-animation-name: right-spin;
        animation-name: right-spin;
      }

      @-webkit-keyframes left-spin {
        0% { -webkit-transform: rotate(130deg) }
        50% { -webkit-transform: rotate(-5deg) }
        to { -webkit-transform: rotate(130deg) }
      }

      @keyframes left-spin {
        0% { transform: rotate(130deg) }
        50% { transform: rotate(-5deg) }
        to { transform: rotate(130deg) }
      }

      @-webkit-keyframes right-spin {
        0% { -webkit-transform: rotate(-130deg) }
        50% { -webkit-transform: rotate(5deg) }
        to { -webkit-transform: rotate(-130deg) }
      }

      @keyframes right-spin {
        0% { transform: rotate(-130deg) }
        50% { transform: rotate(5deg) }
        to { transform: rotate(-130deg) }
      }

      #spinnerContainer.cooldown {
        -webkit-animation: container-rotate var(--paper-spinner-container-rotation-duration) linear infinite, fade-out var(--paper-spinner-cooldown-duration) cubic-bezier(0.4, 0.0, 0.2, 1);
        animation: container-rotate var(--paper-spinner-container-rotation-duration) linear infinite, fade-out var(--paper-spinner-cooldown-duration) cubic-bezier(0.4, 0.0, 0.2, 1);
      }

      @-webkit-keyframes fade-out {
        0% { opacity: 1 }
        to { opacity: 0 }
      }

      @keyframes fade-out {
        0% { opacity: 1 }
        to { opacity: 0 }
      }
    </style>
  </template>
</dom-module>`;document.head.appendChild(Aw.content);var $g={properties:{active:{type:Boolean,value:!1,reflectToAttribute:!0,observer:"__activeChanged"},alt:{type:String,value:"loading",observer:"__altChanged"},__coolingDown:{type:Boolean,value:!1}},__computeContainerClasses:function(i,t){return[i||t?"active":"",t?"cooldown":""].join(" ")},__activeChanged:function(i,t){this.__setAriaHidden(!i),this.__coolingDown=!i&&t},__altChanged:function(i){i==="loading"?this.alt=this.getAttribute("aria-label")||i:(this.__setAriaHidden(i===""),this.setAttribute("aria-label",i))},__setAriaHidden:function(i){var t="aria-hidden";i?this.setAttribute(t,"true"):this.removeAttribute(t)},__reset:function(){this.active=!1,this.__coolingDown=!1}};var VA=ut`
  <style include="paper-spinner-styles"></style>

  <div id="spinnerContainer" class-name="[[__computeContainerClasses(active, __coolingDown)]]" on-animationend="__reset" on-webkit-animation-end="__reset">
    <div class="spinner-layer layer-1">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div>
      <div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>

    <div class="spinner-layer layer-2">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div>
      <div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>

    <div class="spinner-layer layer-3">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div>
      <div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>

    <div class="spinner-layer layer-4">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div>
      <div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>
  </div>
`;VA.setAttribute("strip-whitespace","");It({_template:VA,is:"paper-spinner",behaviors:[$g]});var HA=ut`
  <style include="paper-spinner-styles"></style>

  <div id="spinnerContainer" class-name="[[__computeContainerClasses(active, __coolingDown)]]" on-animationend="__reset" on-webkit-animation-end="__reset">
    <div class="spinner-layer">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div>
      <div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>
  </div>
`;HA.setAttribute("strip-whitespace","");It({_template:HA,is:"paper-spinner-lite",behaviors:[$g]});var Xq=ut`<iron-iconset-svg name="paper-tabs" size="24">
<svg><defs>
<g id="chevron-left"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></g>
<g id="chevron-right"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></g>
</defs></svg>
</iron-iconset-svg>`;document.head.appendChild(Xq.content);It({_template:ut`
    <style>
      :host {
        @apply --layout-inline;
        @apply --layout-center;
        @apply --layout-center-justified;
        @apply --layout-flex-auto;

        position: relative;
        padding: 0 12px;
        overflow: hidden;
        cursor: pointer;
        vertical-align: middle;

        @apply --paper-font-common-base;
        @apply --paper-tab;
      }

      :host(:focus) {
        outline: none;
      }

      :host([link]) {
        padding: 0;
      }

      .tab-content {
        height: 100%;
        transform: translateZ(0);
          -webkit-transform: translateZ(0);
        transition: opacity 0.1s cubic-bezier(0.4, 0.0, 1, 1);
        @apply --layout-horizontal;
        @apply --layout-center-center;
        @apply --layout-flex-auto;
        @apply --paper-tab-content;
      }

      :host(:not(.iron-selected)) > .tab-content {
        opacity: 0.8;

        @apply --paper-tab-content-unselected;
      }

      :host(:focus) .tab-content {
        opacity: 1;
        font-weight: 700;

        @apply --paper-tab-content-focused;
      }

      paper-ripple {
        color: var(--paper-tab-ink, var(--paper-yellow-a100));
      }

      .tab-content > ::slotted(a) {
        @apply --layout-flex-auto;

        height: 100%;
      }
    </style>

    <div class="tab-content">
      <slot></slot>
    </div>
`,is:"paper-tab",behaviors:[vn,Hr,dr],properties:{link:{type:Boolean,value:!1,reflectToAttribute:!0}},hostAttributes:{role:"tab"},listeners:{down:"_updateNoink",tap:"_onTap"},attached:function(){this._updateNoink()},get _parentNoink(){var i=Mt(this).parentNode;return!!i&&!!i.noink},_updateNoink:function(){this.noink=!!this.noink||!!this._parentNoink},_onTap:function(i){if(this.link){var t=this.queryEffectiveChildren("a");if(!t||i.target===t)return;t.click()}}});It({_template:ut`
    <style>
      :host {
        @apply --layout;
        @apply --layout-center;

        height: 48px;
        font-size: 14px;
        font-weight: 500;
        overflow: hidden;
        -moz-user-select: none;
        -ms-user-select: none;
        -webkit-user-select: none;
        user-select: none;

        /* NOTE: Both values are needed, since some phones require the value to be \`transparent\`. */
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        -webkit-tap-highlight-color: transparent;

        @apply --paper-tabs;
      }

      :host(:dir(rtl)) {
        @apply --layout-horizontal-reverse;
      }

      #tabsContainer {
        position: relative;
        height: 100%;
        white-space: nowrap;
        overflow: hidden;
        @apply --layout-flex-auto;
        @apply --paper-tabs-container;
      }

      #tabsContent {
        height: 100%;
        -moz-flex-basis: auto;
        -ms-flex-basis: auto;
        flex-basis: auto;
        @apply --paper-tabs-content;
      }

      #tabsContent.scrollable {
        position: absolute;
        white-space: nowrap;
      }

      #tabsContent:not(.scrollable),
      #tabsContent.scrollable.fit-container {
        @apply --layout-horizontal;
      }

      #tabsContent.scrollable.fit-container {
        min-width: 100%;
      }

      #tabsContent.scrollable.fit-container > ::slotted(*) {
        /* IE - prevent tabs from compressing when they should scroll. */
        -ms-flex: 1 0 auto;
        -webkit-flex: 1 0 auto;
        flex: 1 0 auto;
      }

      .hidden {
        display: none;
      }

      .not-visible {
        opacity: 0;
        cursor: default;
      }

      paper-icon-button {
        width: 48px;
        height: 48px;
        padding: 12px;
        margin: 0 4px;
      }

      #selectionBar {
        position: absolute;
        height: 0;
        bottom: 0;
        left: 0;
        right: 0;
        border-bottom: 2px solid var(--paper-tabs-selection-bar-color, var(--paper-yellow-a100));
          -webkit-transform: scale(0);
        transform: scale(0);
          -webkit-transform-origin: left center;
        transform-origin: left center;
          transition: -webkit-transform;
        transition: transform;

        @apply --paper-tabs-selection-bar;
      }

      #selectionBar.align-bottom {
        top: 0;
        bottom: auto;
      }

      #selectionBar.expand {
        transition-duration: 0.15s;
        transition-timing-function: cubic-bezier(0.4, 0.0, 1, 1);
      }

      #selectionBar.contract {
        transition-duration: 0.18s;
        transition-timing-function: cubic-bezier(0.0, 0.0, 0.2, 1);
      }

      #tabsContent > ::slotted(:not(#selectionBar)) {
        height: 100%;
      }
    </style>

    <paper-icon-button icon="paper-tabs:chevron-left" class$="[[_computeScrollButtonClass(_leftHidden, scrollable, hideScrollButtons)]]" on-up="_onScrollButtonUp" on-down="_onLeftScrollButtonDown" tabindex="-1"></paper-icon-button>

    <div id="tabsContainer" on-track="_scroll" on-down="_down">
      <div id="tabsContent" class$="[[_computeTabsContentClass(scrollable, fitContainer)]]">
        <div id="selectionBar" class$="[[_computeSelectionBarClass(noBar, alignBottom)]]" on-transitionend="_onBarTransitionEnd"></div>
        <slot></slot>
      </div>
    </div>

    <paper-icon-button icon="paper-tabs:chevron-right" class$="[[_computeScrollButtonClass(_rightHidden, scrollable, hideScrollButtons)]]" on-up="_onScrollButtonUp" on-down="_onRightScrollButtonDown" tabindex="-1"></paper-icon-button>
`,is:"paper-tabs",behaviors:[Br,Hg],properties:{noink:{type:Boolean,value:!1,observer:"_noinkChanged"},noBar:{type:Boolean,value:!1},noSlide:{type:Boolean,value:!1},scrollable:{type:Boolean,value:!1},fitContainer:{type:Boolean,value:!1},disableDrag:{type:Boolean,value:!1},hideScrollButtons:{type:Boolean,value:!1},alignBottom:{type:Boolean,value:!1},selectable:{type:String,value:"paper-tab"},autoselect:{type:Boolean,value:!1},autoselectDelay:{type:Number,value:0},_step:{type:Number,value:10},_holdDelay:{type:Number,value:1},_leftHidden:{type:Boolean,value:!1},_rightHidden:{type:Boolean,value:!1},_previousTab:{type:Object}},hostAttributes:{role:"tablist"},listeners:{"iron-resize":"_onTabSizingChanged","iron-items-changed":"_onTabSizingChanged","iron-select":"_onIronSelect","iron-deselect":"_onIronDeselect"},keyBindings:{"left:keyup right:keyup":"_onArrowKeyup"},created:function(){this._holdJob=null,this._pendingActivationItem=void 0,this._pendingActivationTimeout=void 0,this._bindDelayedActivationHandler=this._delayedActivationHandler.bind(this),this.addEventListener("blur",this._onBlurCapture.bind(this),!0)},ready:function(){this.setScrollDirection("y",this.$.tabsContainer)},detached:function(){this._cancelPendingActivation()},_noinkChanged:function(i){var t=Mt(this).querySelectorAll("paper-tab");t.forEach(i?this._setNoinkAttribute:this._removeNoinkAttribute)},_setNoinkAttribute:function(i){i.setAttribute("noink","")},_removeNoinkAttribute:function(i){i.removeAttribute("noink")},_computeScrollButtonClass:function(i,t,e){return!t||e?"hidden":i?"not-visible":""},_computeTabsContentClass:function(i,t){return i?"scrollable"+(t?" fit-container":""):" fit-container"},_computeSelectionBarClass:function(i,t){return i?"hidden":t?"align-bottom":""},_onTabSizingChanged:function(){this.debounce("_onTabSizingChanged",function(){this._scroll(),this._tabChanged(this.selectedItem)},10)},_onIronSelect:function(i){this._tabChanged(i.detail.item,this._previousTab),this._previousTab=i.detail.item,this.cancelDebouncer("tab-changed")},_onIronDeselect:function(i){this.debounce("tab-changed",function(){this._tabChanged(null,this._previousTab),this._previousTab=null},1)},_activateHandler:function(){this._cancelPendingActivation(),Ia._activateHandler.apply(this,arguments)},_scheduleActivation:function(i,t){this._pendingActivationItem=i,this._pendingActivationTimeout=this.async(this._bindDelayedActivationHandler,t)},_delayedActivationHandler:function(){var i=this._pendingActivationItem;this._pendingActivationItem=void 0,this._pendingActivationTimeout=void 0,i.fire(this.activateEvent,null,{bubbles:!0,cancelable:!0})},_cancelPendingActivation:function(){this._pendingActivationTimeout!==void 0&&(this.cancelAsync(this._pendingActivationTimeout),this._pendingActivationItem=void 0,this._pendingActivationTimeout=void 0)},_onArrowKeyup:function(i){this.autoselect&&this._scheduleActivation(this.focusedItem,this.autoselectDelay)},_onBlurCapture:function(i){i.target===this._pendingActivationItem&&this._cancelPendingActivation()},get _tabContainerScrollSize(){return Math.max(0,this.$.tabsContainer.scrollWidth-this.$.tabsContainer.offsetWidth)},_scroll:function(i,t){if(!!this.scrollable){var e=t&&-t.ddx||0;this._affectScroll(e)}},_down:function(i){this.async(function(){this._defaultFocusAsync&&(this.cancelAsync(this._defaultFocusAsync),this._defaultFocusAsync=null)},1)},_affectScroll:function(i){this.$.tabsContainer.scrollLeft+=i;var t=this.$.tabsContainer.scrollLeft;this._leftHidden=t===0,this._rightHidden=t===this._tabContainerScrollSize},_onLeftScrollButtonDown:function(){this._scrollToLeft(),this._holdJob=setInterval(this._scrollToLeft.bind(this),this._holdDelay)},_onRightScrollButtonDown:function(){this._scrollToRight(),this._holdJob=setInterval(this._scrollToRight.bind(this),this._holdDelay)},_onScrollButtonUp:function(){clearInterval(this._holdJob),this._holdJob=null},_scrollToLeft:function(){this._affectScroll(-this._step)},_scrollToRight:function(){this._affectScroll(this._step)},_tabChanged:function(i,t){if(!i){this.$.selectionBar.classList.remove("expand"),this.$.selectionBar.classList.remove("contract"),this._positionBar(0,0);return}var e=this.$.tabsContent.getBoundingClientRect(),n=e.width,r=i.getBoundingClientRect(),o=r.left-e.left;if(this._pos={width:this._calcPercent(r.width,n),left:this._calcPercent(o,n)},this.noSlide||t==null){this.$.selectionBar.classList.remove("expand"),this.$.selectionBar.classList.remove("contract"),this._positionBar(this._pos.width,this._pos.left);return}var s=t.getBoundingClientRect(),a=this.items.indexOf(t),l=this.items.indexOf(i),c=5;this.$.selectionBar.classList.add("expand");var u=a<l,h=this._isRTL;h&&(u=!u),u?this._positionBar(this._calcPercent(r.left+r.width-s.left,n)-c,this._left):this._positionBar(this._calcPercent(s.left+s.width-r.left,n)-c,this._calcPercent(o,n)+c),this.scrollable&&this._scrollToSelectedIfNeeded(r.width,o)},_scrollToSelectedIfNeeded:function(i,t){var e=t-this.$.tabsContainer.scrollLeft;e<0?this.$.tabsContainer.scrollLeft+=e:(e+=i-this.$.tabsContainer.offsetWidth,e>0&&(this.$.tabsContainer.scrollLeft+=e))},_calcPercent:function(i,t){return 100*i/t},_positionBar:function(i,t){i=i||0,t=t||0,this._width=i,this._left=t,this.transform("translateX("+t+"%) scaleX("+i/100+")",this.$.selectionBar)},_onBarTransitionEnd:function(i){var t=this.$.selectionBar.classList;t.contains("expand")?(t.remove("expand"),t.add("contract"),this._positionBar(this._pos.width,this._pos.left)):t.contains("contract")&&t.remove("contract")}});var Cc=null;It({_template:ut`
    <style>
      :host {
        display: block;
        position: fixed;
        background-color: var(--paper-toast-background-color, #323232);
        color: var(--paper-toast-color, #f1f1f1);
        min-height: 48px;
        min-width: 288px;
        padding: 16px 24px;
        box-sizing: border-box;
        box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);
        border-radius: 2px;
        margin: 12px;
        font-size: 14px;
        cursor: default;
        -webkit-transition: -webkit-transform 0.3s, opacity 0.3s;
        transition: transform 0.3s, opacity 0.3s;
        opacity: 0;
        -webkit-transform: translateY(100px);
        transform: translateY(100px);
        @apply --paper-font-common-base;
      }

      :host(.capsule) {
        border-radius: 24px;
      }

      :host(.fit-bottom) {
        width: 100%;
        min-width: 0;
        border-radius: 0;
        margin: 0;
      }

      :host(.paper-toast-open) {
        opacity: 1;
        -webkit-transform: translateY(0px);
        transform: translateY(0px);
      }
    </style>

    <span id="label">{{text}}</span>
    <slot></slot>
`,is:"paper-toast",behaviors:[wc],properties:{fitInto:{type:Object,value:window,observer:"_onFitIntoChanged"},horizontalAlign:{type:String,value:"left"},verticalAlign:{type:String,value:"bottom"},duration:{type:Number,value:3e3},text:{type:String,value:""},noCancelOnOutsideClick:{type:Boolean,value:!0},noAutoFocus:{type:Boolean,value:!0}},listeners:{transitionend:"__onTransitionEnd"},get visible(){return fs._warn("`visible` is deprecated, use `opened` instead"),this.opened},get _canAutoClose(){return this.duration>0&&this.duration!==1/0},created:function(){this._autoClose=null,Ui.requestAvailability()},show:function(i){typeof i=="string"&&(i={text:i});for(var t in i)t.indexOf("_")===0?fs._warn('The property "'+t+'" is private and was not set.'):t in this?this[t]=i[t]:fs._warn('The property "'+t+'" is not valid.');this.open()},hide:function(){this.close()},__onTransitionEnd:function(i){i&&i.target===this&&i.propertyName==="opacity"&&(this.opened?this._finishRenderOpened():this._finishRenderClosed())},_openedChanged:function(){this._autoClose!==null&&(this.cancelAsync(this._autoClose),this._autoClose=null),this.opened?(Cc&&Cc!==this&&Cc.close(),Cc=this,this.fire("iron-announce",{text:this.text}),this._canAutoClose&&(this._autoClose=this.async(this.close,this.duration))):Cc===this&&(Cc=null),ds._openedChanged.apply(this,arguments)},_renderOpened:function(){this.classList.add("paper-toast-open")},_renderClosed:function(){this.classList.remove("paper-toast-open")},_onFitIntoChanged:function(i){this.positionTarget=i}});var $A=ut`

    <style>
      :host {
        display: inline-block;
        @apply --layout-horizontal;
        @apply --layout-center;
        @apply --paper-font-common-base;
      }

      :host([disabled]) {
        pointer-events: none;
      }

      :host(:focus) {
        outline:none;
      }

      .toggle-bar {
        position: absolute;
        height: 100%;
        width: 100%;
        border-radius: 8px;
        pointer-events: none;
        opacity: 0.4;
        transition: background-color linear .08s;
        background-color: var(--paper-toggle-button-unchecked-bar-color, #000000);

        @apply --paper-toggle-button-unchecked-bar;
      }

      .toggle-button {
        position: absolute;
        top: -3px;
        left: 0;
        height: 20px;
        width: 20px;
        border-radius: 50%;
        box-shadow: 0 1px 5px 0 rgba(0, 0, 0, 0.6);
        transition: -webkit-transform linear .08s, background-color linear .08s;
        transition: transform linear .08s, background-color linear .08s;
        will-change: transform;
        background-color: var(--paper-toggle-button-unchecked-button-color, var(--paper-grey-50));

        @apply --paper-toggle-button-unchecked-button;
      }

      .toggle-button.dragging {
        -webkit-transition: none;
        transition: none;
      }

      :host([checked]:not([disabled])) .toggle-bar {
        opacity: 0.5;
        background-color: var(--paper-toggle-button-checked-bar-color, var(--primary-color));

        @apply --paper-toggle-button-checked-bar;
      }

      :host([disabled]) .toggle-bar {
        background-color: #000;
        opacity: 0.12;
      }

      :host([checked]) .toggle-button {
        -webkit-transform: translate(16px, 0);
        transform: translate(16px, 0);
      }

      :host([checked]:not([disabled])) .toggle-button {
        background-color: var(--paper-toggle-button-checked-button-color, var(--primary-color));

        @apply --paper-toggle-button-checked-button;
      }

      :host([disabled]) .toggle-button {
        background-color: #bdbdbd;
        opacity: 1;
      }

      .toggle-ink {
        position: absolute;
        top: -14px;
        left: -14px;
        right: auto;
        bottom: auto;
        width: 48px;
        height: 48px;
        opacity: 0.5;
        pointer-events: none;
        color: var(--paper-toggle-button-unchecked-ink-color, var(--primary-text-color));

        @apply --paper-toggle-button-unchecked-ink;
      }

      :host([checked]) .toggle-ink {
        color: var(--paper-toggle-button-checked-ink-color, var(--primary-color));

        @apply --paper-toggle-button-checked-ink;
      }

      .toggle-container {
        display: inline-block;
        position: relative;
        width: 36px;
        height: 14px;
        /* The toggle button has an absolute position of -3px; The extra 1px
        /* accounts for the toggle button shadow box. */
        margin: 4px 1px;
      }

      .toggle-label {
        position: relative;
        display: inline-block;
        vertical-align: middle;
        padding-left: var(--paper-toggle-button-label-spacing, 8px);
        pointer-events: none;
        color: var(--paper-toggle-button-label-color, var(--primary-text-color));
      }

      /* invalid state */
      :host([invalid]) .toggle-bar {
        background-color: var(--paper-toggle-button-invalid-bar-color, var(--error-color));
      }

      :host([invalid]) .toggle-button {
        background-color: var(--paper-toggle-button-invalid-button-color, var(--error-color));
      }

      :host([invalid]) .toggle-ink {
        color: var(--paper-toggle-button-invalid-ink-color, var(--error-color));
      }
    </style>

    <div class="toggle-container">
      <div id="toggleBar" class="toggle-bar"></div>
      <div id="toggleButton" class="toggle-button"></div>
    </div>

    <div class="toggle-label"><slot></slot></div>

  `;$A.setAttribute("strip-whitespace","");It({_template:$A,is:"paper-toggle-button",behaviors:[bc],hostAttributes:{role:"button","aria-pressed":"false",tabindex:0},properties:{},listeners:{track:"_ontrack"},attached:function(){fc(this,function(){Ea(this,"pan-y")})},_ontrack:function(i){var t=i.detail;t.state==="start"?this._trackStart(t):t.state==="track"?this._trackMove(t):t.state==="end"&&this._trackEnd(t)},_trackStart:function(i){this._width=this.$.toggleBar.offsetWidth/2,this._trackChecked=this.checked,this.$.toggleButton.classList.add("dragging")},_trackMove:function(i){var t=i.dx;this._x=Math.min(this._width,Math.max(0,this._trackChecked?this._width+t:t)),this.translate3d(this._x+"px",0,0,this.$.toggleButton),this._userActivate(this._x>this._width/2)},_trackEnd:function(i){this.$.toggleButton.classList.remove("dragging"),this.transform("",this.$.toggleButton)},_createRipple:function(){this._rippleContainer=this.$.toggleButton;var i=dr._createRipple();return i.id="ink",i.setAttribute("recenters",""),i.classList.add("circle","toggle-ink"),i}});It({_template:ut`
    <style>
      :host {
        --calculated-paper-toolbar-height: var(--paper-toolbar-height, 64px);
        --calculated-paper-toolbar-sm-height: var(--paper-toolbar-sm-height, 56px);
        display: block;
        position: relative;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        height: var(--calculated-paper-toolbar-height);
        background: var(--paper-toolbar-background, var(--primary-color));
        color: var(--paper-toolbar-color, var(--dark-theme-text-color));
        @apply --paper-toolbar;
      }

      :host(.animate) {
        transition: var(--paper-toolbar-transition, height 0.18s ease-in);
      }

      :host(.medium-tall) {
        height: calc(var(--calculated-paper-toolbar-height) * 2);
        @apply --paper-toolbar-medium;
      }

      :host(.tall) {
        height: calc(var(--calculated-paper-toolbar-height) * 3);
        @apply --paper-toolbar-tall;
      }

      .toolbar-tools {
        position: relative;
        height: var(--calculated-paper-toolbar-height);
        padding: 0 16px;
        pointer-events: none;
        @apply --layout-horizontal;
        @apply --layout-center;
        @apply --paper-toolbar-content;
      }

      /*
       * TODO: Where should media query breakpoints live so they can be shared between elements?
       */

      @media (max-width: 600px) {
        :host {
          height: var(--calculated-paper-toolbar-sm-height);
        }

        :host(.medium-tall) {
          height: calc(var(--calculated-paper-toolbar-sm-height) * 2);
        }

        :host(.tall) {
          height: calc(var(--calculated-paper-toolbar-sm-height) * 3);
        }

        .toolbar-tools {
          height: var(--calculated-paper-toolbar-sm-height);
        }
      }

      #topBar {
        position: relative;
      }

      /* middle bar */
      #middleBar {
        position: absolute;
        top: 0;
        right: 0;
        left: 0;
      }

      :host(.tall) #middleBar,
      :host(.medium-tall) #middleBar {
        -webkit-transform: translateY(100%);
        transform: translateY(100%);
      }

      /* bottom bar */
      #bottomBar {
        position: absolute;
        right: 0;
        bottom: 0;
        left: 0;
      }

      /*
       * make elements (e.g. buttons) respond to mouse/touch events
       *
       * \`.toolbar-tools\` disables touch events so multiple toolbars can stack and not
       * absorb events. All children must have pointer events re-enabled to work as
       * expected.
       */
      .toolbar-tools > ::slotted(*:not([disabled])) {
        pointer-events: auto;
      }

      .toolbar-tools > ::slotted(.title) {
        @apply --paper-font-common-base;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        font-size: 20px;
        font-weight: 400;
        line-height: 1;
        pointer-events: none;
        @apply --layout-flex;
      }

      .toolbar-tools > ::slotted(.title) {
        margin-left: 56px;
      }

      .toolbar-tools > ::slotted(paper-icon-button + .title) {
        margin-left: 0;
      }

      /**
       * The --paper-toolbar-title mixin is applied here instead of above to
       * fix the issue with margin-left being ignored due to css ordering.
       */
      .toolbar-tools > ::slotted(.title) {
        @apply --paper-toolbar-title;
      }

      .toolbar-tools > ::slotted(paper-icon-button[icon=menu]) {
        margin-right: 24px;
      }

      .toolbar-tools > ::slotted(.fit) {
        position: absolute;
        top: auto;
        right: 0;
        bottom: 0;
        left: 0;
        width: auto;
        margin: 0;
      }

      /* TODO(noms): Until we have a better solution for classes that don't use
       * /deep/ create our own.
       */
      .start-justified {
        @apply --layout-start-justified;
      }

      .center-justified {
        @apply --layout-center-justified;
      }

      .end-justified {
        @apply --layout-end-justified;
      }

      .around-justified {
        @apply --layout-around-justified;
      }

      .justified {
        @apply --layout-justified;
      }
    </style>

    <div id="topBar" class\$="toolbar-tools [[_computeBarExtraClasses(justify)]]">
      <slot name="top"></slot>
    </div>

    <div id="middleBar" class\$="toolbar-tools [[_computeBarExtraClasses(middleJustify)]]">
      <slot name="middle"></slot>
    </div>

    <div id="bottomBar" class\$="toolbar-tools [[_computeBarExtraClasses(bottomJustify)]]">
      <slot name="bottom"></slot>
    </div>
`,is:"paper-toolbar",hostAttributes:{role:"toolbar"},properties:{bottomJustify:{type:String,value:""},justify:{type:String,value:""},middleJustify:{type:String,value:""}},ready:function(){console.warn(this.is,"is deprecated. Please use app-layout instead!")},attached:function(){this._observer=this._observe(this),this._updateAriaLabelledBy()},detached:function(){this._observer&&this._observer.disconnect()},_observe:function(i){var t=new MutationObserver(function(){this._updateAriaLabelledBy()}.bind(this));return t.observe(i,{childList:!0,subtree:!0}),t},_updateAriaLabelledBy:function(){fr();for(var i=[],t=Array.prototype.slice.call(Mt(this.root).querySelectorAll("slot")).concat(Array.prototype.slice.call(Mt(this.root).querySelectorAll("content"))),e,n=0;e=t[n];n++)for(var r=Mt(e).getDistributedNodes(),o,s=0;o=r[s];s++)if(o.classList&&o.classList.contains("title"))if(o.id)i.push(o.id);else{var a="paper-toolbar-label-"+Math.floor(Math.random()*1e4);o.id=a,i.push(a)}i.length>0&&this.setAttribute("aria-labelledby",i.join(" "))},_computeBarExtraClasses:function(i){return i?i+(i==="justified"?"":"-justified"):""}});It({_template:ut`
    <style>
      :host {
        display: block;
        position: absolute;
        outline: none;
        z-index: 1002;
        -moz-user-select: none;
        -ms-user-select: none;
        -webkit-user-select: none;
        user-select: none;
        cursor: default;
      }

      #tooltip {
        display: block;
        outline: none;
        @apply --paper-font-common-base;
        font-size: 10px;
        line-height: 1;
        background-color: var(--paper-tooltip-background, #616161);
        color: var(--paper-tooltip-text-color, white);
        padding: 8px;
        border-radius: 2px;
        @apply --paper-tooltip;
      }

      @keyframes keyFrameScaleUp {
        0% {
          transform: scale(0.0);
        }
        100% {
          transform: scale(1.0);
        }
      }

      @keyframes keyFrameScaleDown {
        0% {
          transform: scale(1.0);
        }
        100% {
          transform: scale(0.0);
        }
      }

      @keyframes keyFrameFadeInOpacity {
        0% {
          opacity: 0;
        }
        100% {
          opacity: var(--paper-tooltip-opacity, 0.9);
        }
      }

      @keyframes keyFrameFadeOutOpacity {
        0% {
          opacity: var(--paper-tooltip-opacity, 0.9);
        }
        100% {
          opacity: 0;
        }
      }

      @keyframes keyFrameSlideDownIn {
        0% {
          transform: translateY(-2000px);
          opacity: 0;
        }
        10% {
          opacity: 0.2;
        }
        100% {
          transform: translateY(0);
          opacity: var(--paper-tooltip-opacity, 0.9);
        }
      }

      @keyframes keyFrameSlideDownOut {
        0% {
          transform: translateY(0);
          opacity: var(--paper-tooltip-opacity, 0.9);
        }
        10% {
          opacity: 0.2;
        }
        100% {
          transform: translateY(-2000px);
          opacity: 0;
        }
      }

      .fade-in-animation {
        opacity: 0;
        animation-delay: var(--paper-tooltip-delay-in, 500ms);
        animation-name: keyFrameFadeInOpacity;
        animation-iteration-count: 1;
        animation-timing-function: ease-in;
        animation-duration: var(--paper-tooltip-duration-in, 500ms);
        animation-fill-mode: forwards;
        @apply --paper-tooltip-animation;
      }

      .fade-out-animation {
        opacity: var(--paper-tooltip-opacity, 0.9);
        animation-delay: var(--paper-tooltip-delay-out, 0ms);
        animation-name: keyFrameFadeOutOpacity;
        animation-iteration-count: 1;
        animation-timing-function: ease-in;
        animation-duration: var(--paper-tooltip-duration-out, 500ms);
        animation-fill-mode: forwards;
        @apply --paper-tooltip-animation;
      }

      .scale-up-animation {
        transform: scale(0);
        opacity: var(--paper-tooltip-opacity, 0.9);
        animation-delay: var(--paper-tooltip-delay-in, 500ms);
        animation-name: keyFrameScaleUp;
        animation-iteration-count: 1;
        animation-timing-function: ease-in;
        animation-duration: var(--paper-tooltip-duration-in, 500ms);
        animation-fill-mode: forwards;
        @apply --paper-tooltip-animation;
      }

      .scale-down-animation {
        transform: scale(1);
        opacity: var(--paper-tooltip-opacity, 0.9);
        animation-delay: var(--paper-tooltip-delay-out, 500ms);
        animation-name: keyFrameScaleDown;
        animation-iteration-count: 1;
        animation-timing-function: ease-in;
        animation-duration: var(--paper-tooltip-duration-out, 500ms);
        animation-fill-mode: forwards;
        @apply --paper-tooltip-animation;
      }

      .slide-down-animation {
        transform: translateY(-2000px);
        opacity: 0;
        animation-delay: var(--paper-tooltip-delay-out, 500ms);
        animation-name: keyFrameSlideDownIn;
        animation-iteration-count: 1;
        animation-timing-function: cubic-bezier(0.0, 0.0, 0.2, 1);
        animation-duration: var(--paper-tooltip-duration-out, 500ms);
        animation-fill-mode: forwards;
        @apply --paper-tooltip-animation;
      }

      .slide-down-animation-out {
        transform: translateY(0);
        opacity: var(--paper-tooltip-opacity, 0.9);
        animation-delay: var(--paper-tooltip-delay-out, 500ms);
        animation-name: keyFrameSlideDownOut;
        animation-iteration-count: 1;
        animation-timing-function: cubic-bezier(0.4, 0.0, 1, 1);
        animation-duration: var(--paper-tooltip-duration-out, 500ms);
        animation-fill-mode: forwards;
        @apply --paper-tooltip-animation;
      }

      .cancel-animation {
        animation-delay: -30s !important;
      }

      /* Thanks IE 10. */

      .hidden {
        display: none !important;
      }
    </style>

    <div id="tooltip" class="hidden">
      <slot></slot>
    </div>
`,is:"paper-tooltip",hostAttributes:{role:"tooltip",tabindex:-1},properties:{for:{type:String,observer:"_findTarget"},manualMode:{type:Boolean,value:!1,observer:"_manualModeChanged"},position:{type:String,value:"bottom"},fitToVisibleBounds:{type:Boolean,value:!1},offset:{type:Number,value:14},marginTop:{type:Number,value:14},animationDelay:{type:Number,value:500,observer:"_delayChange"},animationEntry:{type:String,value:""},animationExit:{type:String,value:""},animationConfig:{type:Object,value:function(){return{entry:[{name:"fade-in-animation",node:this,timing:{delay:0}}],exit:[{name:"fade-out-animation",node:this}]}}},_showing:{type:Boolean,value:!1}},listeners:{webkitAnimationEnd:"_onAnimationEnd"},get target(){var i=Mt(this).parentNode,t=Mt(this).getOwnerRoot(),e;return this.for?e=Mt(t).querySelector("#"+this.for):e=i.nodeType==Node.DOCUMENT_FRAGMENT_NODE?t.host:i,e},attached:function(){this._findTarget()},detached:function(){this.manualMode||this._removeListeners()},playAnimation:function(i){i==="entry"?this.show():i==="exit"&&this.hide()},cancelAnimation:function(){this.$.tooltip.classList.add("cancel-animation")},show:function(){if(!this._showing){if(Mt(this).textContent.trim()===""){for(var i=!0,t=Mt(this).getEffectiveChildNodes(),e=0;e<t.length;e++)if(t[e].textContent.trim()!==""){i=!1;break}if(i)return}this._showing=!0,this.$.tooltip.classList.remove("hidden"),this.$.tooltip.classList.remove("cancel-animation"),this.$.tooltip.classList.remove(this._getAnimationType("exit")),this.updatePosition(),this._animationPlaying=!0,this.$.tooltip.classList.add(this._getAnimationType("entry"))}},hide:function(){if(!!this._showing){if(this._animationPlaying){this._showing=!1,this._cancelAnimation();return}else this._onAnimationFinish();this._showing=!1,this._animationPlaying=!0}},updatePosition:function(){if(!(!this._target||!this.offsetParent)){var i=this.offset;this.marginTop!=14&&this.offset==14&&(i=this.marginTop);var t=this.offsetParent.getBoundingClientRect(),e=this._target.getBoundingClientRect(),n=this.getBoundingClientRect(),r=(e.width-n.width)/2,o=(e.height-n.height)/2,s=e.left-t.left,a=e.top-t.top,l,c;switch(this.position){case"top":l=s+r,c=a-n.height-i;break;case"bottom":l=s+r,c=a+e.height+i;break;case"left":l=s-n.width-i,c=a+o;break;case"right":l=s+e.width+i,c=a+o;break}this.fitToVisibleBounds?(t.left+l+n.width>window.innerWidth?(this.style.right="0px",this.style.left="auto"):(this.style.left=Math.max(0,l)+"px",this.style.right="auto"),t.top+c+n.height>window.innerHeight?(this.style.bottom=t.height-a+i+"px",this.style.top="auto"):(this.style.top=Math.max(-t.top,c)+"px",this.style.bottom="auto")):(this.style.left=l+"px",this.style.top=c+"px")}},_addListeners:function(){this._target&&(this.listen(this._target,"mouseenter","show"),this.listen(this._target,"focus","show"),this.listen(this._target,"mouseleave","hide"),this.listen(this._target,"blur","hide"),this.listen(this._target,"tap","hide")),this.listen(this.$.tooltip,"animationend","_onAnimationEnd"),this.listen(this,"mouseenter","hide")},_findTarget:function(){this.manualMode||this._removeListeners(),this._target=this.target,this.manualMode||this._addListeners()},_delayChange:function(i){i!==500&&this.updateStyles({"--paper-tooltip-delay-in":i+"ms"})},_manualModeChanged:function(){this.manualMode?this._removeListeners():this._addListeners()},_cancelAnimation:function(){this.$.tooltip.classList.remove(this._getAnimationType("entry")),this.$.tooltip.classList.remove(this._getAnimationType("exit")),this.$.tooltip.classList.remove("cancel-animation"),this.$.tooltip.classList.add("hidden")},_onAnimationFinish:function(){this._showing&&(this.$.tooltip.classList.remove(this._getAnimationType("entry")),this.$.tooltip.classList.remove("cancel-animation"),this.$.tooltip.classList.add(this._getAnimationType("exit")))},_onAnimationEnd:function(){this._animationPlaying=!1,this._showing||(this.$.tooltip.classList.remove(this._getAnimationType("exit")),this.$.tooltip.classList.add("hidden"))},_getAnimationType:function(i){if(i==="entry"&&this.animationEntry!=="")return this.animationEntry;if(i==="exit"&&this.animationExit!=="")return this.animationExit;if(this.animationConfig[i]&&typeof this.animationConfig[i][0].name=="string"){if(this.animationConfig[i][0].timing&&this.animationConfig[i][0].timing.delay&&this.animationConfig[i][0].timing.delay!==0){var t=this.animationConfig[i][0].timing.delay;i==="entry"?this.updateStyles({"--paper-tooltip-delay-in":t+"ms"}):i==="exit"&&this.updateStyles({"--paper-tooltip-delay-out":t+"ms"})}return this.animationConfig[i][0].name}},_removeListeners:function(){this._target&&(this.unlisten(this._target,"mouseenter","show"),this.unlisten(this._target,"focus","show"),this.unlisten(this._target,"mouseleave","hide"),this.unlisten(this._target,"blur","hide"),this.unlisten(this._target,"tap","hide")),this.unlisten(this.$.tooltip,"animationend","_onAnimationEnd"),this.unlisten(this,"mouseenter","hide")}});var Ug=class{constructor(t,e){if(typeof ga=="undefined"||ga==null){this.eventLogging=!1,this.pageViewLogging=!1;return}this.eventLogging=e,this.pageViewLogging=t}logPageView(t){this.pageViewLogging&&ga("send",{hitType:"pageview",page:`/v/${t}`})}logProjectionChanged(t){this.eventLogging&&ga("send",{hitType:"event",eventCategory:"Projection",eventAction:"click",eventLabel:t})}logWebGLDisabled(){this.eventLogging&&ga("send",{hitType:"event",eventCategory:"Error",eventAction:"PageLoad",eventLabel:"WebGL_disabled"})}};var e$=zh(sR(),1);var Cp=zh(aR(),1),lR;window.numeric=(lR=window.numeric)!=null?lR:Cp.default;var t1=class{constructor(t){if(t.length<1)throw new Error("There should be at least 1 data point");this.dim=t[0].length,this.masks=new Array(Math.pow(2,this.dim));for(let s=0;s<this.masks.length;++s)this.masks[s]=1<<s;let e=new Array(this.dim);cR(e,Number.POSITIVE_INFINITY);let n=new Array(this.dim);cR(n,Number.NEGATIVE_INFINITY);for(let s=0;s<t.length;++s)for(let a=0;a<this.dim;++a)e[a]=Math.min(e[a],t[s][a]),n[a]=Math.max(n[a],t[s][a]);let r=new Array(this.dim),o=0;for(let s=0;s<this.dim;++s){let a=n[s]-e[s];r[s]=e[s]+a/2,o=Math.max(o,a/2)}this.root={children:[],box:{center:r,halfDim:o},point:t[0]};for(let s=1;s<t.length;++s)this.insert(this.root,t[s])}visit(t,e=!1){this.visitNode(this.root,t,e)}visitNode(t,e,n){let r;if(n)r=e(t);else{let o=new Array(this.dim),s=new Array(this.dim);for(let a=0;a<this.dim;++a)o[a]=t.box.center[a]-t.box.halfDim,s[a]=t.box.center[a]+t.box.halfDim;r=e(t,o,s)}if(!(!t.children||r))for(let o=0;o<t.children.length;++o){let s=t.children[o];s&&this.visitNode(s,e,n)}}insert(t,e){t.children==null&&(t.children=new Array(this.masks.length));let n=0;for(let r=0;r<this.dim;++r)e[r]>t.box.center[r]&&(n|=this.masks[r]);t.children[n]==null?this.makeChild(t,n,e):this.insert(t.children[n],e)}makeChild(t,e,n){let r=t.box.center,o=t.box.halfDim/2,s=new Array(this.dim);for(let a=0;a<this.dim;++a)s[a]=e&1<<a?r[a]+o:r[a]-o;t.children[e]={children:[],box:{center:s,halfDim:o},point:n}}};function cR(i,t){for(let e=0;e<i.length;++e)i[e]=t}var aK=.8,lK=1e-9,Yw=!1,uR=0;function cK(i,t){let e=i[0]-t[0],n=i[1]-t[1];return e*e+n*n}function uK(i,t){let e=i[0]-t[0],n=i[1]-t[1],r=i[2]-t[2];return e*e+n*n+r*r}function fR(i){if(Yw)return Yw=!1,uR;let t=2*i()-1,e=2*i()-1,n=t*t+e*e;if(n===0||n>1)return fR(i);let r=Math.sqrt(-2*Math.log(n)/n);return uR=e*r,Yw=!0,t*r}function hK(i,t,e){return t+fR(i)*e}function dR(i){return new Float64Array(i)}function pK(i,t,e){let n=i*t,r=dR(n);for(let o=0;o<n;++o)r[o]=hK(e,0,1e-4);return r}function hR(i,t,e){let n=[];for(let r=0;r<i;++r)n.push(t===3?[e,e,e]:[e,e]);return n}function fK(i,t,e){let n=i.length,r=Math.log(t),o=dR(n*n),s=i[0].length,a=new Array(s);for(let c=0;c<n;++c){let u=i[c],h=-1/0,p=1/0,f=1,d=50,m=0;for(;;){let x=0;for(let y=0;y<u.length;++y){let b=u[y],v=c===b.index?0:Math.exp(-b.dist*f);v=Math.max(v,lK),a[y]=v,x+=v}let g=0;for(let y=0;y<a.length;++y){a[y]/=x;let b=a[y];b>1e-7&&(g-=b*Math.log(b))}if(g>r?(h=f,p===1/0?f=f*2:f=(f+p)/2):(p=f,h===-1/0?f=f/2:f=(f+h)/2),m++,m>=d||Math.abs(g-r)<e)break}for(let x=0;x<a.length;++x){let g=a[x],y=u[x].index;o[c*n+y]=g}}let l=n*2;for(let c=0;c<n;++c)for(let u=c+1;u<n;++u){let h=c*n+u,p=u*n+c,f=(o[h]+o[p])/l;o[h]=f,o[p]=f}return o}function pR(i){return i>0?1:i<0?-1:0}function dK(i,t,e,n){i[0]+=t*(e[0]-n[0]),i[1]+=t*(e[1]-n[1])}function mK(i,t,e,n){i[0]+=t*(e[0]-n[0]),i[1]+=t*(e[1]-n[1]),i[2]+=t*(e[2]-n[2])}var e1=class{constructor(t){if(this.iter=0,t=t||{dim:2},this.perplexity=t.perplexity||30,this.setEpsilon(t.epsilon||10),this.rng=t.rng||Math.random,this.dim=t.dim,t.dim===2)this.dist2=cK,this.computeForce=dK;else if(t.dim===3)this.dist2=uK,this.computeForce=mK;else throw new Error("Only 2D and 3D is supported")}initDataDist(t){let e=t.length;this.nearest=t,this.P=fK(t,this.perplexity,1e-4),this.N=e,this.initSolution()}initSolution(){this.Y||(this.Y=pK(this.N,this.dim,this.rng)),this.gains=hR(this.N,this.dim,1),this.ystep=hR(this.N,this.dim,0),this.iter=0}getDim(){return this.dim}getRng(){return this.rng}getSolution(){return this.Y}setSolution(t){this.Y=t}perturb(){let t=this.N,e=0,n=this.dim===3?[0,0,0]:[0,0];for(let o=0;o<t;++o){let s=0;for(let a=0;a<this.dim;++a)s+=Math.pow(this.Y[o*this.dim+a],2);s>e&&(e=s)}let r=Math.pow(e,.5);for(let o=0;o<t;++o){let s=new Array(this.dim);for(;;){let a=0;for(let l=0;l<this.dim;++l)s[l]=.1*r*(Math.random()-.5),a+=Math.pow(this.Y[o*this.dim+l]+s[l],2);if(a<e)break}for(let a=0;a<this.dim;++a)this.Y[o*this.dim+a]+=s[a],n[a]+=this.Y[o*this.dim+a]}for(let o=0;o<t;++o)for(let s=0;s<this.dim;++s)this.Y[o*this.dim+s]-=n[s]/t}step(){this.iter+=1;let t=this.N,e=this.costGrad(this.Y),n=this.dim===3?[0,0,0]:[0,0];for(let r=0;r<t;++r)for(let o=0;o<this.dim;++o){let s=e[r][o],a=this.ystep[r][o],l=this.gains[r][o],c=pR(s)===pR(a)?l*.8:l+.2;c<.01&&(c=.01),this.gains[r][o]=c;let h=(this.iter<250?.5:.8)*a-this.epsilon*c*e[r][o];this.ystep[r][o]=h;let p=r*this.dim+o;this.Y[p]+=h,n[o]+=this.Y[p]}for(let r=0;r<t;++r)for(let o=0;o<this.dim;++o)this.Y[r*this.dim+o]-=n[o]/t}setEpsilon(t){this.epsilon=t}setSupervision(t,e){t!=null&&(this.labels=t,this.labelCounts={},Array.from(new Set(t)).forEach(r=>this.labelCounts[r]=0),t.forEach(r=>this.labelCounts[r]+=1)),e!=null&&(this.unlabeledClass=e)}setSuperviseFactor(t){t!=null&&(this.superviseFactor=t)}costGrad(t){let e=this.N,n=this.P,r=this.iter<100?4:1,o=this.superviseFactor/100,s=this.unlabeledClass,a=this.labels,l=this.labelCounts,c=o!=null&&o>0&&a!=null&&l!=null,u=c&&s!=null&&s!==""?l[s]:0,h=new Array(e);for(let S=0;S<e;++S){let E=S*this.dim,M=new Array(this.dim);for(let N=0;N<this.dim;++N)M[N]=t[E+N];h[S]=M}let p=new t1(h),f=p.root,d=S=>{let E=1;if(S.children==null)return S.numCells=E,S.yCell=S.point,{numCells:E,yCell:S.yCell};let M=S.point.slice();for(let N=0;N<S.children.length;++N){let I=S.children[N];if(I==null)continue;let w=d(I);E+=w.numCells;for(let R=0;R<this.dim;++R)M[R]+=w.yCell[R]}return S.numCells=E,S.yCell=M.map(N=>N/E),{numCells:E,yCell:M}};d(f),p.visit((S,E,M)=>(S.rCell=M[0]-E[0],!1));let m=[],x=0,g=0,y=new Array(e);for(let S=0;S<e;++S){let E=h[S],M=0;var b=0;c&&(M=l[a[S]],b=e-M-u);let N=this.dim===3?[0,0,0]:[0,0],I=this.nearest[S];for(let R=0;R<I.length;++R){let P=I[R].index,D=n[S*e+P];c&&(a[S]===s||a[P]===s?D*=1/e:a[S]!==a[P]?D*=Math.max(1/e-o/b,1e-7):a[S]===a[P]&&(D*=Math.min(1/e+o/M,1-1e-7)),g+=D);let F=h[P],z=this.dist2(E,F),V=D/(1+z);this.computeForce(N,V,E,F)}let w=this.dim===3?[0,0,0]:[0,0];p.visit(R=>{let P=this.dist2(E,R.yCell);if(R.children==null||P>0&&R.rCell/Math.sqrt(P)<aK){let z=1/(1+P),V=R.numCells*z;return x+=V,V*=z,this.computeForce(w,V,E,R.yCell),!0}let D=this.dist2(E,R.point),F=1/(1+D);return x+=F,F*=F,this.computeForce(w,F,E,R.point),!1},!0),y[S]=[N,w]}let v=4*r;c&&(v/=g);let _=4/x;for(let S=0;S<e;++S){let[E,M]=y[S],N=new Array(this.dim);for(let I=0;I<this.dim;++I)N[I]=v*E[I]-_*M[I];m.push(N)}return m}};var Na=class{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}},Ao=class{refCount(t){return ji("refCount")}incRef(t){return ji("incRef")}timerAvailable(){return!0}time(t){return ji("time")}read(t){return ji("read")}readSync(t){return ji("readSync")}numDataIds(){return ji("numDataIds")}disposeData(t,e){return ji("disposeData")}write(t,e,n){return ji("write")}move(t,e,n,r,o){return ji("move")}memory(){return ji("memory")}floatPrecision(){return ji("floatPrecision")}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}dispose(){return ji("dispose")}};function ji(i){throw new Error(`'${i}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function mR(i){let t=i.length,e=0,n=0;for(;t>0;)n=Math.random()*t|0,t--,e=i[t],i[t]=i[n],i[n]=e}function gK(i,t){if(i.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${i.length}Second array length was ${t.length}`);let e=i.length,n,r,o=0;for(;e>0;)o=Math.random()*e|0,e--,n=i[e],r=t[e],i[e]=i[o],t[e]=t[o],i[o]=n,t[o]=r}function Ic(i,t,e){return Math.max(i,Math.min(t,e))}function xK(i){return i%2===0?i:i+1}function yK(i){let t=0;for(let e=0;e<i.length;e++)t+=i[e];return t}function vK(i,t){let e=Math.random();return t*e+(1-e)*i}function bK(i,t){let e=0;for(let n=0;n<i.length;n++){let r=Number(i[n])-Number(t[n]);e+=r*r}return e}function Gt(i,t){if(!i)throw new Error(typeof t=="string"?t:t())}function Zw(i,t,e=""){Gt(Ac(i,t),()=>e+` Shapes ${i} and ${t} must match`)}function _K(i){Gt(i!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ms(i,t=[],e=!1){if(t==null&&(t=[]),Array.isArray(i)||vi(i)&&!e)for(let n=0;n<i.length;++n)ms(i[n],t,e);else t.push(i);return t}function Mn(i){if(i.length===0)return 1;let t=i[0];for(let e=1;e<i.length;e++)t*=i[e];return t}function wK(i){return i.length===0}function Ac(i,t){if(i===t)return!0;if(i==null||t==null||i.length!==t.length)return!1;for(let e=0;e<i.length;e++)if(i[e]!==t[e])return!1;return!0}function gR(i){return i%1===0}function SK(i){if(Math.tanh!=null)return Math.tanh(i);if(i===1/0)return 1;if(i===-1/0)return-1;{let t=Math.exp(2*i);return(t-1)/(t+1)}}function CK(i){let t=Math.ceil(Math.sqrt(i));return[t,Math.ceil(i/t)]}function MK(i){let t=new Uint32Array(i);for(let e=0;e<i;++e)t[e]=e;return mR(t),t}function Da(i,t){return t<=i.length?i:i+" ".repeat(t-i.length)}function EK(i,t=n=>0,e){return new Promise((n,r)=>{let o=0,s=()=>{if(i()){n();return}o++;let a=t(o);if(e!=null&&o>=e){r();return}setTimeout(s,a)};s()})}function TK(i,t){let e=1,n=-1;for(let o=0;o<i.length;++o)if(i[o]>=0)e*=i[o];else if(i[o]===-1){if(n!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${n} and dim ${o}`);n=o}else if(i[o]<0)throw Error(`Shapes can not be < 0. Found ${i[o]} at dim ${o}`);if(n===-1){if(t>0&&t!==e)throw Error(`Size(${t}) must match the product of shape ${i}`);return i}if(e===0)throw Error(`Cannot infer the missing size in [${i}] when there are 0 elements`);if(t%e!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${e}`);let r=i.slice();return r[n]=t/e,r}function xR(i,t){let e=t.length;return i=i==null?t.map((n,r)=>r):[].concat(i),Gt(i.every(n=>n>=-e&&n<e),()=>`All values in axis param must be in range [-${e}, ${e}) but got axis ${i}`),Gt(i.every(n=>gR(n)),()=>`All values in axis param must be integers but got axis ${i}`),i.map(n=>n<0?e+n:n)}function IK(i,t){let e=[],n=[],r=t!=null&&Array.isArray(t)&&t.length===0,o=t==null||r?null:xR(t,i).sort(),s=0;for(let a=0;a<i.length;++a){if(o!=null){if(o[s]===a&&i[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${i[a]}' is not 1`);(o[s]==null||o[s]>a)&&i[a]===1&&(e.push(i[a]),n.push(a)),o[s]<=a&&s++}i[a]!==1&&(e.push(i[a]),n.push(a))}return{newShape:e,keptDims:n}}function AK(i,t){let e=null;if(i==null||i==="float32")e=new Float32Array(t);else if(i==="int32")e=new Int32Array(t);else if(i==="bool")e=new Uint8Array(t);else throw new Error(`Unknown data type ${i}`);return e}function Jw(i,t){let e=null;if(i==null||i==="float32")e=new Float32Array(t);else if(i==="int32")e=new Int32Array(t);else if(i==="bool")e=new Uint8Array(t);else if(i==="string")e=new Array(t);else throw new Error(`Unknown data type ${i}`);return e}function Qw(i,t){for(let e=0;e<i.length;e++){let n=i[e];if(isNaN(n)||!isFinite(n))throw Error(`A tensor of type ${t} being uploaded contains ${n}.`)}}function tS(i){return i==="bool"||i==="complex64"||i==="float32"||i==="int32"||i==="string"}function kK(i,t){return!(t==="complex64"||t==="float32"&&i!=="complex64"||t==="int32"&&i!=="float32"&&i!=="complex64"||t==="bool"&&i==="bool")}function vi(i){return i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array}function n1(i){if(i==="float32"||i==="int32")return 4;if(i==="complex64")return 8;if(i==="bool")return 1;throw new Error(`Unknown dtype ${i}`)}function eS(i){if(i==null)return 0;let t=0;return i.forEach(e=>t+=e.length),t}function kc(i){return typeof i=="string"||i instanceof String}function yR(i){return typeof i=="boolean"}function vR(i){return typeof i=="number"}function Rc(i){return Array.isArray(i)?Rc(i[0]):i instanceof Float32Array?"float32":i instanceof Int32Array||i instanceof Uint8Array?"int32":vR(i)?"float32":kc(i)?"string":yR(i)?"bool":"float32"}function i1(i){return!!(i&&i.constructor&&i.call&&i.apply)}function Pc(i,t){for(let e=t;e<i;++e)if(i%e===0)return e;return i}function qr(i){let t=i.length;if(t<2)return[];let e=new Array(t-1);e[t-2]=i[t-1];for(let n=t-3;n>=0;--n)e[n]=e[n+1]*i[n+1];return e}function bR(i,t,e,n=!1){let r=new Array;if(t.length===1){let o=t[0]*(n?2:1);for(let s=0;s<o;s++)r[s]=e[i+s]}else{let o=t[0],s=t.slice(1),a=s.reduce((l,c)=>l*c)*(n?2:1);for(let l=0;l<o;l++)r[l]=bR(i+l*a,s,e,n)}return r}function La(i,t,e=!1){if(i.length===0)return t[0];let n=i.reduce((r,o)=>r*o)*(e?2:1);if(n===0)return[];if(n!==t.length)throw new Error(`[${i}] does not match the input size ${t.length}${e?" for a complex tensor":""}.`);return bR(0,i,t,e)}function nS(i,t){let e=Nc(i,t);for(let n=0;n<e.length;n++)e[n]=1;return e}function Nc(i,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(i);if(t==="int32")return new Int32Array(i);if(t==="bool")return new Uint8Array(i);throw new Error(`Unknown data type ${t}`)}function RK(i,t){let e=i.reduce((n,r)=>n*r,1);if(t==null||t==="float32")return La(i,new Float32Array(e));if(t==="int32")return La(i,new Int32Array(e));if(t==="bool")return La(i,new Uint8Array(e));throw new Error(`Unknown data type ${t}`)}function Mp(i){i.forEach(t=>{Gt(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${i}].`)})}function PK(i,t,e){if(t===0)return 0;if(t===1)return i[0];let n=i[i.length-1];for(let r=0;r<i.length-1;++r)n+=e[r]*i[r];return n}function NK(i,t,e){if(t===0)return[];if(t===1)return[i];let n=new Array(t);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(i/e[r]),i-=n[r]*e[r];return n[n.length-1]=i,n}function Ep(i){return i&&i.then&&typeof i.then=="function"}var _R="tfjsflags",Tp=class{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=DK,this.populateURLFlags()}setPlatform(t,e){this.platform!=null&&console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},this.urlFlags[t]!=null){let r=this.urlFlags[t];console.warn(`Setting feature override from URL ${t}: ${r}.`),this.set(t,r)}}getAsync(t){return $t(this,null,function*(){return t in this.flags?this.flags[t]:(this.flags[t]=yield this.evaluateFlag(t),this.flags[t])})}get(t){if(t in this.flags)return this.flags[t];let e=this.evaluateFlag(t);if(Ep(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")return;let t=this.getQueryParams(this.global.location.search);_R in t&&t[_R].split(",").forEach(n=>{let[r,o]=n.split(":");this.urlFlags[r]=FK(r,o)})}};function DK(i){let t={};return i.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(e,...n)=>(zK(t,n[0],n[1]),n.join("="))),t}function zK(i,t,e){i[decodeURIComponent(t)]=decodeURIComponent(e||"")}function FK(i,t){if(t=t.toLowerCase(),t==="true"||t==="false")return t==="true";if(`${+t}`===t)return+t;throw new Error(`Could not parse value flag value ${t} for flag ${i}.`)}function ot(){return iS}var iS=null;function wR(i){iS=i}var rS;function oS(){if(rS==null){let i;if(typeof window!="undefined")i=window;else if(typeof global!="undefined")i=global;else if(typeof process!="undefined")i=process;else if(typeof self!="undefined")i=self;else throw new Error("Could not find a global object");rS=i}return rS}function OK(){let i=oS();return i._tfGlobals==null&&(i._tfGlobals=new Map),i._tfGlobals}function Ip(i,t){let e=OK();if(e.has(i))return e.get(i);{let n=t();return e.set(i,n),e.get(i)}}var r1="Abs",Ap="Acos",kp="Acosh",za="Add",o1="AddN",s1="All",a1="Any",l1="ArgMax",c1="ArgMin",Rp="Asin",Pp="Asinh",Np="Atan",Lp="Atanh",Dp="Atan2",u1="AvgPool",h1="AvgPoolGrad",p1="AvgPool3D",f1="AvgPool3DGrad",Lc="BatchMatMul",d1="BatchToSpaceND",m1="Bincount";var gs="Cast",zp="Ceil",Fp="ClipByValue",Dc="Complex",g1="ComplexAbs",x1="Concat",y1="Conv2D",v1="Conv2DBackpropFilter",b1="Conv2DBackpropInput",_1="Conv3D",w1="Conv3DBackpropFilterV2",S1="Conv3DBackpropInputV2",Op="Cos",Bp="Cosh",C1="Cumsum",M1="CropAndResize",E1="DenseBincount",T1="DepthToSpace",I1="DepthwiseConv2dNative",A1="DepthwiseConv2dNativeBackpropFilter",k1="DepthwiseConv2dNativeBackpropInput",R1="Diag",P1="Dilation2D",sS="Dilation2DBackpropInput",aS="Dilation2DBackpropFilter",Vp="RealDiv",N1="Einsum",Fa="Elu",L1="EluGrad",Hp="Erf",$p="Equal",Up="Exp",D1="ExpandDims",Wp="Expm1",z1="FFT",F1="Fill",O1="FlipLeftRight",Gp="Floor",jp="FloorDiv",B1="FusedBatchNorm",V1="GatherV2",H1="GatherNd",qp="Greater",Xp="GreaterEqual",xs="Identity",$1="IFFT",U1="Imag",Kp="IsFinite",Yp="IsInf",Zp="IsNan",zc="LeakyRelu",Jp="Less",Qp="LessEqual",W1="LinSpace",tf="Log",ef="Log1p",nf="LogicalAnd",rf="LogicalNot",of="LogicalOr";var G1="LRN",j1="LRNGrad",q1="Max",sf="Maximum",X1="MaxPool",K1="MaxPoolGrad",Y1="MaxPool3D",Z1="MaxPool3DGrad",J1="MaxPoolWithArgmax",Q1="Mean",t0="Min",af="Minimum",e0="MirrorPad",lf="Mod",n0="Multinomial",Oa="Multiply",i0="Neg",cf="NotEqual",r0="NonMaxSuppressionV3",o0="NonMaxSuppressionV4",s0="NonMaxSuppressionV5",a0="OnesLike",l0="OneHot",c0="Pack",Fc="PadV2";var uf="Pow",Oc="Prelu",u0="Prod",h0="Range",p0="Real",hf="Reciprocal",Ba="Relu",Bc="Reshape",f0="ResizeNearestNeighbor",d0="ResizeNearestNeighborGrad",m0="ResizeBilinear",g0="ResizeBilinearGrad",Va="Relu6",x0="Reverse",pf="Round",ff="Rsqrt",y0="ScatterNd",v0="Select",df="Selu",b0="Slice",mf="Sin",gf="Sinh",xf="Sign",yf="Sigmoid",vf="Softplus",bf="Sqrt",Vc="Sum",_0="SpaceToBatchND",Hc="SplitV",w0="Softmax",_f="SquaredDifference",S0="Square",Ha="Sub",C0="SparseToDense",M0="StridedSlice",wf="Tan",Sf="Tanh",E0="Tile",T0="TopK",I0="Transform",$c="Transpose",A0="Unique",k0="Unpack",R0="UnsortedSegmentSum",P0="ZerosLike",$a="Step",SR="FromPixels",N0="RotateWithOffset",L0="_FusedMatMul",D0="FusedConv2D",z0="FusedDepthwiseConv2D";var F0=Ip("kernelRegistry",()=>new Map),BK=Ip("gradRegistry",()=>new Map);function lS(i,t){let e=CR(i,t);return F0.get(e)}function cS(i){return BK.get(i)}function uS(i){let t=F0.entries(),e=[];for(;;){let{done:n,value:r}=t.next();if(n)break;let[o,s]=r,[a]=o.split("_");a===i&&e.push(s)}return e}function O0(i){let{kernelName:t,backendName:e}=i,n=CR(t,e);F0.has(n)&&console.warn(`The kernel '${t}' for backend '${e}' is already registered`),F0.set(n,i)}function CR(i,t){return`${t}_${i}`}var L={};Dr(L,{arraysEqual:()=>Ac,assert:()=>Gt,assertNonNegativeIntegerDimensions:()=>Mp,assertNonNull:()=>_K,assertShapesMatch:()=>Zw,bytesFromStringArray:()=>eS,bytesPerElement:()=>n1,checkConversionForErrors:()=>Qw,clamp:()=>Ic,computeStrides:()=>qr,createScalarValue:()=>VK,createShuffledIndices:()=>MK,decodeString:()=>Gc,distSquared:()=>bK,encodeString:()=>Wc,fetch:()=>$K,flatten:()=>ms,getArrayFromDType:()=>Jw,getTypedArrayFromDType:()=>AK,hasEncodingLoss:()=>kK,indexToLoc:()=>NK,inferDtype:()=>Rc,inferFromImplicitShape:()=>TK,isBoolean:()=>yR,isFunction:()=>i1,isInt:()=>gR,isNumber:()=>vR,isPromise:()=>Ep,isScalarShape:()=>wK,isString:()=>kc,isTypedArray:()=>vi,isValidDtype:()=>tS,locToIndex:()=>PK,makeOnesTypedArray:()=>nS,makeZerosNestedTypedArray:()=>RK,makeZerosTypedArray:()=>Nc,nearestDivisor:()=>Pc,nearestLargerEven:()=>xK,now:()=>Ua,parseAxisParam:()=>xR,randUniform:()=>vK,repeatedTry:()=>EK,rightPad:()=>Da,shuffle:()=>mR,shuffleCombo:()=>gK,sizeFromShape:()=>Mn,sizeToSquarishShape:()=>CK,squeezeShape:()=>IK,sum:()=>yK,tanh:()=>SK,toNestedArray:()=>La,toTypedArray:()=>Uc});function VK(i,t){return t==="string"?Wc(i):Uc([i],t)}function HK(i,t){return i instanceof Float32Array&&t==="float32"||i instanceof Int32Array&&t==="int32"||i instanceof Uint8Array&&t==="bool"}function Uc(i,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(i)&&(i=ms(i)),ot().getBool("DEBUG")&&Qw(i,t),HK(i,t))return i;if(t==null||t==="float32"||t==="complex64")return new Float32Array(i);if(t==="int32")return new Int32Array(i);if(t==="bool"){let e=new Uint8Array(i.length);for(let n=0;n<e.length;++n)Math.round(i[n])!==0&&(e[n]=1);return e}else throw new Error(`Unknown data type ${t}`)}function Ua(){return ot().platform.now()}function $K(i,t){return ot().platform.fetch(i,t)}function Wc(i,t="utf-8"){return t=t||"utf-8",ot().platform.encode(i,t)}function Gc(i,t="utf-8"){return t=t||"utf-8",ot().platform.decode(i,t)}var B0=class{constructor(t,e){this.backendTimer=t,this.logger=e,e==null&&(this.logger=new hS)}profileKernel(t,e,n){let r,o=()=>{r=n()},s,a=Ua();if(this.backendTimer.timerAvailable())s=this.backendTimer.time(o);else{o();for(let c of r)c.dataSync();s=Promise.resolve({kernelMs:Ua()-a})}if(ot().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){let u=r[c];u.data().then(h=>{UK(h,u.dtype,t)})}return{kernelName:t,outputs:r,inputs:e,timeMs:s.then(c=>c.kernelMs),extraInfo:s.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(t){let{kernelName:e,outputs:n,timeMs:r,inputs:o,extraInfo:s}=t;n.forEach(a=>{Promise.all([a.data(),r,s]).then(l=>{this.logger.logKernelProfile(e,a,l[0],l[1],o,l[2])})})}};function UK(i,t,e){if(t!=="float32")return!1;for(let n=0;n<i.length;n++){let r=i[n];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${e}'`),!0}return!1}var hS=class{logKernelProfile(t,e,n,r,o,s){let a=typeof r=="number"?Da(`${r}ms`,9):r.error,l=Da(t,25),c=e.rank,u=e.size,h=Da(e.shape.toString(),14),p="";for(let f in o){let d=o[f];if(d!=null){let m=d.shape||e.shape,x=m.length;p+=`${f}: ${x}D ${x>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${h}	%c${u}	%c${p}	%c${s}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};function MR(i,t,e){let n={},r={};for(let l=0;l<t.length;l++)n[t[l].id]=!0;for(let l=0;l<i.length;l++){let c=i[l],u=c.inputs;for(let h in u){let p=u[h],f=!1;for(let d=0;d<t.length;d++)if(n[p.id]){c.outputs.forEach(m=>n[m.id]=!0),f=!0,r[c.id]=!0;break}if(f)break}}let o={};o[e.id]=!0;let s={};for(let l=i.length-1;l>=0;l--){let c=i[l],u=c.inputs;for(let h=0;h<c.outputs.length;h++)if(o[c.outputs[h].id]){for(let p in u)o[u[p].id]=!0,s[c.id]=!0;break}}let a=[];for(let l=0;l<i.length;l++){let c=i[l];if(r[c.id]&&s[c.id]){let u={};for(let p in c.inputs){let f=c.inputs[p];n[f.id]&&(u[p]=f)}let h=Object.assign({},c);h.inputs=u,h.outputs=c.outputs,a.push(h)}}return a}function ER(i,t,e,n){for(let r=t.length-1;r>=0;r--){let o=t[r],s=[];if(o.outputs.forEach(l=>{let c=i[l.id];c!=null?s.push(c):s.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);let a=o.gradient(s);for(let l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);let c=e(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);let u=o.inputs[l];if(!Ac(c.shape,u.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(i[u.id]==null)i[u.id]=c;else{let h=i[u.id];i[u.id]=n(h,c),h.dispose()}}}}var TR=20,Cf=3,pS=7;function IR(i,t,e,n){let r=qr(t),o=WK(i,t,e,r),s=t.length,a=V0(i,t,e,r,o),l=["Tensor"];return n&&(l.push(`  dtype: ${e}`),l.push(`  rank: ${s}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function WK(i,t,e,n){let r=Mn(t),o=n[n.length-1],s=new Array(o).fill(0),a=t.length,l=e==="complex64"?Ef(i):i;if(a>1)for(let c=0;c<r/o;c++){let u=c*o;for(let h=0;h<o;h++)s[h]=Math.max(s[h],Mf(l[u+h],0,e).length)}return s}function Mf(i,t,e){let n;return Array.isArray(i)?n=`${parseFloat(i[0].toFixed(pS))} + ${parseFloat(i[1].toFixed(pS))}j`:kc(i)?n=`'${i}'`:e==="bool"?n=AR(i):n=parseFloat(i.toFixed(pS)).toString(),Da(n,t)}function AR(i){return i===0?"false":"true"}function V0(i,t,e,n,r,o=!0){let s=e==="complex64"?2:1,a=t[0],l=t.length;if(l===0){if(e==="complex64"){let m=Ef(i);return[Mf(m[0],0,e)]}return e==="bool"?[AR(i[0])]:[i[0].toString()]}if(l===1){if(a>TR){let x=Cf*s,g=Array.from(i.slice(0,x)),y=Array.from(i.slice((a-Cf)*s,a*s));return e==="complex64"&&(g=Ef(g),y=Ef(y)),["["+g.map((b,v)=>Mf(b,r[v],e)).join(", ")+", ..., "+y.map((b,v)=>Mf(b,r[a-Cf+v],e)).join(", ")+"]"]}let m=e==="complex64"?Ef(i):Array.from(i);return["["+m.map((x,g)=>Mf(x,r[g],e)).join(", ")+"]"]}let c=t.slice(1),u=n.slice(1),h=n[0]*s,p=[];if(a>TR){for(let m=0;m<Cf;m++){let x=m*h,g=x+h;p.push(...V0(i.slice(x,g),c,e,u,r,!1))}p.push("...");for(let m=a-Cf;m<a;m++){let x=m*h,g=x+h;p.push(...V0(i.slice(x,g),c,e,u,r,m===a-1))}}else for(let m=0;m<a;m++){let x=m*h,g=x+h;p.push(...V0(i.slice(x,g),c,e,u,r,m===a-1))}let f=l===2?",":"";p[0]="["+p[0]+f;for(let m=1;m<p.length-1;m++)p[m]=" "+p[m]+f;let d=`,
`;for(let m=2;m<l;m++)d+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(o?"":d),p}function Ef(i){let t=[];for(let e=0;e<i.length;e+=2)t.push([i[e],i[e+1]]);return t}var Ie=class{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=Mn(t),n!=null){let r=n.length;Gt(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||Jw(e,this.size),this.strides=qr(t)}set(t,...e){e.length===0&&(e=[0]),Gt(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);let n=this.locToIndex(e);this.values[n]=t}get(...t){t.length===0&&(t=[0]);let e=0;for(let r of t){if(r<0||r>=this.shape[e]){let o=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(o)}e++}let n=t[t.length-1];for(let r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return this.values[n]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];let e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return Xr().makeTensor(this.values,this.shape,this.dtype)}},Xr=null,jc=null,GK=null;function kR(i){Xr=i}function RR(i){jc=i}function PR(i){GK=i}var Dn=class{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Mn(t),this.strides=qr(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}buffer(){return $t(this,null,function*(){let t=yield this.data();return jc.buffer(this.shape,this.dtype,t)})}bufferSync(){return jc.buffer(this.shape,this.dtype,this.dataSync())}array(){return $t(this,null,function*(){let t=yield this.data();return La(this.shape,t,this.dtype==="complex64")})}arraySync(){return La(this.shape,this.dataSync(),this.dtype==="complex64")}data(){return $t(this,null,function*(){this.throwIfDisposed();let t=Xr().read(this.dataId);if(this.dtype==="string"){let e=yield t;try{return e.map(n=>Gc(n))}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t})}dataSync(){this.throwIfDisposed();let t=Xr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(e=>Gc(e))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}bytes(){return $t(this,null,function*(){this.throwIfDisposed();let t=yield Xr().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)})}dispose(){this.isDisposed||(Xr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return jc.print(this,t)}clone(){return this.throwIfDisposed(),jc.clone(this)}toString(t=!1){let e=this.dataSync();return IR(e,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),jc.cast(this,t)}variable(t=!0,e,n){return this.throwIfDisposed(),Xr().makeVariable(this,t,e,n)}};Object.defineProperty(Dn,Symbol.hasInstance,{value:i=>!!i&&i.data!=null&&i.dataSync!=null&&i.throwIfDisposed!=null});function jK(){return Ip("Tensor",()=>Dn)}jK();var Wa=class extends Dn{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!Ac(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Xr().disposeTensor(this),this.dataId=t.dataId,Xr().incRef(this,null)}dispose(){Xr().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(Wa,Symbol.hasInstance,{value:i=>i instanceof Dn&&i.assign!=null&&i.assign instanceof Function});var fS;(function(i){i.R0="R0",i.R1="R1",i.R2="R2",i.R3="R3",i.R4="R4",i.R5="R5",i.R6="R6"})(fS||(fS={}));var dS;(function(i){i.float32="float32",i.int32="int32",i.bool="int32",i.complex64="complex64"})(dS||(dS={}));var mS;(function(i){i.float32="float32",i.int32="int32",i.bool="bool",i.complex64="complex64"})(mS||(mS={}));var gS;(function(i){i.float32="float32",i.int32="float32",i.bool="float32",i.complex64="complex64"})(gS||(gS={}));var xS;(function(i){i.float32="complex64",i.int32="complex64",i.bool="complex64",i.complex64="complex64"})(xS||(xS={}));var qK={float32:gS,int32:dS,bool:mS,complex64:xS};function dn(i,t){if(i==="string"||t==="string"){if(i==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${i} with ${t}`)}return qK[i][t]}function Ga(i){return dn(i,"int32")}function qc(i,t){if(i.dtype===t.dtype)return[i,t];let e=dn(i.dtype,t.dtype);return[i.cast(e),t.cast(e)]}function NR(i){let t=[];return LR(i,t,new Set),t}function LR(i,t,e){if(i==null)return;if(i instanceof Dn){t.push(i);return}if(!XK(i))return;let n=i;for(let r in n){let o=n[r];e.has(o)||(e.add(o),LR(o,t,e))}}function XK(i){return Array.isArray(i)||typeof i=="object"}function yS(i){return i.kernelName!=null}var H0=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(let t in this.registeredVariables)this.registeredVariables[t].dispose()}},ys=class{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new H0}ready(){return $t(this,null,function*(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let t=this.getSortedBackends();for(let e=0;e<t.length;e++){let n=t[e];if(yield this.initializeBackend(n).success){yield this.setBackend(n);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")})}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){let{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){let{asyncInit:e}=this.initializeBackend(t);if(e)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,n=1){return t in this.registryFactory?(console.warn(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}setBackend(t){return $t(this,null,function*(){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;let{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?yield e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new B0(this.backendInstance),!0})}setupRegisteredKernels(){uS(this.backendName).forEach(e=>{e.setupFunc!=null&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){uS(t).forEach(n=>{n.disposeFunc!=null&&n.disposeFunc(this.registry[t])})}initializeBackend(t){let e=this.registryFactory[t];if(e==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{let n=e.factory();if(n&&!(n instanceof Ao)&&typeof n.then=="function"){let r=++this.pendingBackendInitId,o=n.then(s=>r<this.pendingBackendInitId?!1:(this.registry[t]=s,this.pendingBackendInit=null,!0)).catch(s=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,console.warn(`Initialization of backend ${t} failed`),console.warn(s.stack||s.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[t]=n,{success:!0,asyncInit:!1}}catch(n){return console.warn(`Initialization of backend ${t} failed`),console.warn(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){let t=this.getSortedBackends();for(let e=0;e<t.length;e++){let n=t[e],{success:r,asyncInit:o}=this.initializeBackend(n);if(o||r)return{name:n,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){let n=this.state.tensorInfo.get(e),r=n.backend,o=this.readSync(e),s=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,o,n.shape,n.dtype,s),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n=null;if(e==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");e=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");n=t}let r;return this.scopedRun(()=>this.startScope(n),()=>this.endScope(r),()=>(r=e(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(t,e,n){t();try{let r=n();return e(),r}catch(r){throw e(),r}}nextTensorId(){return ys.nextTensorId++}nextVariableId(){return ys.nextVariableId++}clone(t){let e=Zt.runKernel(xs,{x:t}),n={x:t},r=s=>({x:()=>{let a="float32",l={x:s},c={dtype:a};return Zt.runKernel(gs,l,c)}}),o=[];return this.addTapeNode(this.state.activeScope.name,n,[e],r,o,{}),e}runKernel(t,e,n){if(!(lS(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){let r=this.backend.numDataIds(),o=0;n.forEach(l=>{o+=l.dtype==="complex64"?3:1});let s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-e-o-s;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${t}'`)}runKernelFunc(t){let e,n=[],r=this.isTapeOn(),o=this.state.numBytes,s=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l,c=yS(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(yS(t)){let{kernelName:d,inputs:m,attrs:x}=t;this.backendName==null&&this.backend;let g=lS(d,this.backendName);Gt(g!=null,()=>`Cannot find registered kernel '${d}' for backend '${this.backendName}'`),a=()=>{let y=this.backend.numDataIds();l=g.kernelFunc({inputs:m,attrs:x,backend:this.backend});let b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(d,y,b);let v=b.map(_=>{if(_.rank!=null)return _;let{dataId:S,shape:E,dtype:M}=_;return this.makeTensorFromDataId(S,E,M)});if(r){let _=this.getTensorsForGradient(d,m,v);n=this.saveTensorsForBackwardMode(_)}return v}}else{let{forwardFunc:d}=t,m=x=>{!r||(n=x.map(g=>this.keep(this.clone(g))))};a=()=>{let x=this.backend.numDataIds();l=this.tidy(()=>d(this.backend,m));let g=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,x,g),g}}let{inputs:u,attrs:h}=t,p=yS(t)?null:t.backwardsFunc,f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?e=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),e=f.outputs)}),r&&this.addTapeNode(c,u,e,p,n,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(d=>u[d]!=null?u[d].shape:null),outputShapes:e.map(d=>d.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?e:e[0]}saveTensorsForBackwardMode(t){return t.map(n=>this.keep(this.clone(n)))}getTensorsForGradient(t,e,n){let r=cS(t);if(r!=null){let o=r.inputsToSave||[],s=r.outputsToSave||[],a;r.saveAllInputs?(Gt(Array.isArray(e),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(e).map(c=>e[c])):a=o.map(c=>e[c]);let l=n.filter((c,u)=>s[u]);return a.concat(l)}return[]}makeTensor(t,e,n,r){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let o=t;n==="string"&&kc(t[0])&&(o=t.map(l=>Wc(l)));let s=r.write(o,e,n),a=new Dn(e,n,s,this.nextTensorId());if(this.trackTensor(a,r),n==="string"){let l=this.state.tensorInfo.get(s),c=eS(o);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(t,e,n,r){n=n||"float32";let o=new Dn(e,n,t,this.nextTensorId());return this.trackTensor(o,r),o}makeVariable(t,e=!0,n,r){n=n||this.nextVariableId().toString(),r!=null&&r!==t.dtype&&(t=t.cast(r));let o=new Wa(t,e,n,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(t,e){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let n=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(n=t.size*n1(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof Wa||this.track(t)}incRef(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}removeDataId(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;let e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){let n=t.size*n1(t.dtype);this.state.numBytes-=n}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}disposeVariables(){for(let t in this.state.registeredVariables){let e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){let t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}profile(t){return $t(this,null,function*(){this.state.profiling=!0;let e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=yield t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(let r of this.state.activeProfile.kernels)r.kernelTimeMs=yield r.kernelTimeMs,r.extraInfo=yield r.extraInfo;return this.state.activeProfile})}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,e,n,r,o,s){let a={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:o},l=cS(t);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,h)=>{if(u==null){let p=n[h],f=Nc(p.size,p.dtype);return this.makeTensor(f,p.shape,p.dtype)}return u}),r(c.length>1?c:c[0],o,s))),this.state.activeTape.push(a)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){let e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){let e=NR(t),n=new Set(e.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){let s=this.state.activeScope.track[o];!s.kept&&!n.has(s.id)&&s.dispose()}let r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach(o=>{!o.kept&&o.scopeId===r.id&&this.track(o)})}gradients(t,e,n,r=!1){if(Gt(e.length>0,()=>"gradients() received an empty list of xs."),n!=null&&n.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);let o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));Gt(o instanceof Dn,()=>"The result y returned by f() must be a tensor.");let s=MR(this.state.activeTape,e,o);if(!r&&s.length===0&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let a={};a[o.id]=n==null?KK(o.shape):n,ER(a,s,c=>this.tidy(c),YK);let l=e.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(let u of c.saved)u.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(t){return Gt(i1(t),()=>"The f passed in customGrad(f) must be a function."),(...e)=>{Gt(e.every(a=>a instanceof Dn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let n,r={};e.forEach((a,l)=>{r[l]=a});let o=(a,l)=>(n=t(...e,l),Gt(n.value instanceof Dn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),Gt(i1(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),s=(a,l)=>{let c=n.gradFunc(a,l),u=Array.isArray(c)?c:[c];Gt(u.length===e.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),Gt(u.every(p=>p instanceof Dn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let h={};return u.forEach((p,f)=>{h[f]=()=>p}),h};return this.runKernelFunc({forwardFunc:o,backwardsFunc:s,inputs:r})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}time(t){return $t(this,null,function*(){let e=Ua(),n=yield this.backend.time(t);return n.wallMs=Ua()-e,n})}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new H0;for(let t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};ys.nextTensorId=0;ys.nextVariableId=0;function KK(i){let t=nS(Mn(i),"float32");return Zt.makeTensor(t,i,"float32")}function vS(){let i=oS();if(i._tfengine==null){let t=new Tp(i);i._tfengine=new ys(t)}return wR(i._tfengine.ENV),kR(()=>i._tfengine),i._tfengine}var Zt=vS();function YK(i,t){let e={a:i,b:t};return Zt.runKernel(za,e)}var vs={};Dr(vs,{isBrowser:()=>bS,isMobile:()=>JK});function ZK(){return typeof navigator!="undefined"&&navigator!=null}function JK(i){if(i||ZK()){if(i||(i=navigator),i.product==="ReactNative")return!0;let t=i.userAgent||i.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function bS(){return typeof window!="undefined"&&window.document!=null||typeof WorkerGlobalScope!="undefined"}var gr=ot();gr.registerFlag("DEBUG",()=>!1,i=>{i&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});gr.registerFlag("IS_BROWSER",()=>bS());gr.registerFlag("IS_NODE",()=>typeof process!="undefined"&&typeof process.versions!="undefined"&&typeof process.versions.node!="undefined");gr.registerFlag("IS_CHROME",()=>typeof navigator!="undefined"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));gr.registerFlag("PROD",()=>!1);gr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>gr.getBool("DEBUG"));gr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);gr.registerFlag("IS_TEST",()=>!1);gr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);gr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);function _S(i,t){let e=i;if(vi(i))return t==="string"?[]:[i.length];if(!Array.isArray(i))return[];let n=[];for(;Array.isArray(e)||vi(e)&&t!=="string";)n.push(e.length),e=e[0];return Array.isArray(i)&&ot().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&zR(i,n,[]),n}function zR(i,t,e){if(e=e||[],!Array.isArray(i)&&!vi(i)){Gt(t.length===0,()=>`Element arr[${e.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}Gt(t.length>0,()=>`Element arr[${e.join("][")}] should be a primitive, but is an array of ${i.length} elements`),Gt(i.length===t[0],()=>`Element arr[${e.join("][")}] should have ${t[0]} elements, but has ${i.length} elements`);let n=t.slice(1);for(let r=0;r<i.length;++r)zR(i[r],n,e.concat(r))}function DR(i,t,e,n){if(i!=="string_or_numeric"){if(i==null)throw new Error("Expected dtype cannot be null.");if(i!=="numeric"&&i!==t||i==="numeric"&&t==="string")throw new Error(`Argument '${e}' passed to '${n}' must be ${i} tensor, but got ${t} tensor`)}}function me(i,t,e,n="numeric"){if(i instanceof Dn)return DR(n,i.dtype,t,e),i;let r=Rc(i);if(r!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(r=n),DR(n,r,t,e),i==null||!vi(i)&&!Array.isArray(i)&&typeof i!="number"&&typeof i!="boolean"&&typeof i!="string"){let l=i==null?"null":i.constructor.name;throw new Error(`Argument '${t}' passed to '${e}' must be a Tensor or TensorLike, but got '${l}'`)}let o=_S(i,r);!vi(i)&&!Array.isArray(i)&&(i=[i]);let a=r!=="string"?Uc(i,r):ms(i,[],!0);return Zt.makeTensor(a,o,r)}var QK="__op";function Se(i){let t=Object.keys(i);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let e=t[0],n=i[e];e.endsWith("_")&&(e=e.substring(0,e.length-1)),e=e+QK;let r=(...o)=>{Zt.startScope(e);try{let s=n(...o);return Ep(s)&&console.error("Cannot return a Promise inside of tidy."),Zt.endScope(s),s}catch(s){throw Zt.endScope(null),s}};return Object.defineProperty(r,"name",{value:e,configurable:!0}),r}function tY(i,t){let e=me(i,"real","complex"),n=me(t,"imag","complex");Zw(e.shape,n.shape,`real and imag shapes, ${e.shape} and ${n.shape}, must match in call to tf.complex().`);let r={real:e,imag:n};return Zt.runKernel(Dc,r)}var FR=Se({complex_:tY});function $0(i,t,e,n){if(n==null&&(n=Rc(i)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!vi(i)&&!Array.isArray(i)&&typeof i!="number"&&typeof i!="boolean"&&typeof i!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Mp(t);let r=Mn(t),o=Mn(e);Gt(r===o,()=>`Based on the provided shape, [${t}], the tensor should have ${r} values but has ${o}`);for(let s=0;s<e.length;++s){let a=e[s],l=s===e.length-1?a!==Mn(t.slice(s)):!0;Gt(e[s]===t[s]||!l,()=>`Error creating a new Tensor. Inferred shape (${e}) does not match the provided shape (${t}). `)}}return!vi(i)&&!Array.isArray(i)&&(i=[i]),t=t||e,i=n!=="string"?Uc(i,n):ms(i,[],!0),Zt.makeTensor(i,t,n)}function wS(i,t,e){let n=_S(i,e);return $0(i,t,n,e)}var SS=typeof Buffer!="undefined"&&(typeof Blob=="undefined"||typeof atob=="undefined"||typeof btoa=="undefined");function OR(i){return SS?Buffer.byteLength(i):new Blob([i]).size}function BR(i){if(SS)return Buffer.from(i).toString("base64");let t=new Uint8Array(i),e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function VR(i){if(SS){let n=Buffer.from(i,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}let t=atob(i),e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e.set([t.charCodeAt(n)],n);return e.buffer}function U0(i){if(i.length===1)return i[0];let t=0;i.forEach(r=>{t+=r.byteLength});let e=new Uint8Array(t),n=0;return i.forEach(r=>{e.set(new Uint8Array(r),n),n+=r.byteLength}),e.buffer}function ko(i){if(i.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:i.modelTopology==null?0:OR(JSON.stringify(i.modelTopology)),weightSpecsBytes:i.weightSpecs==null?0:OR(JSON.stringify(i.weightSpecs)),weightDataBytes:i.weightData==null?0:i.weightData.byteLength}}var je=class{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return je.instance==null&&(je.instance=new je),je.instance}static registerSaveRouter(t){je.getInstance().saveRouters.push(t)}static registerLoadRouter(t){je.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return je.getHandlers(t,"save")}static getLoadHandlers(t,e){return je.getHandlers(t,"load",e)}static getHandlers(t,e,n){let r=[];return(e==="load"?je.getInstance().loadRouters:je.getInstance().saveRouters).forEach(s=>{let a=s(t,n);a!==null&&r.push(a)}),r}};var CS="tensorflowjs",MS=1,ja="models_store",bs="model_info_store";function HR(){if(!ot().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let i=typeof window=="undefined"?self:window,t=i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB||i.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function ES(i){let t=i.result;t.createObjectStore(ja,{keyPath:"modelPath"}),t.createObjectStore(bs,{keyPath:"modelPath"})}var Kr=class{constructor(t){if(this.indexedDB=HR(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}save(t){return $t(this,null,function*(){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)})}load(){return $t(this,null,function*(){return this.databaseAction(this.modelPath)})}databaseAction(t,e){return new Promise((n,r)=>{let o=this.indexedDB.open(CS,MS);o.onupgradeneeded=()=>ES(o),o.onsuccess=()=>{let s=o.result;if(e==null){let a=s.transaction(ja,"readonly"),c=a.objectStore(ja).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return s.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));n(c.result.modelArtifacts)},c.onerror=u=>(s.close(),r(c.error)),a.oncomplete=()=>s.close()}else{let a=ko(e),l=s.transaction(bs,"readwrite"),c=l.objectStore(bs),u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a}),h;u.onsuccess=()=>{h=s.transaction(ja,"readwrite");let f=h.objectStore(ja).put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:a});f.onsuccess=()=>n({modelArtifactsInfo:a}),f.onerror=d=>{c=l.objectStore(bs);let m=c.delete(this.modelPath);m.onsuccess=()=>(s.close(),r(f.error)),m.onerror=x=>(s.close(),r(f.error))}},u.onerror=p=>(s.close(),r(u.error)),l.oncomplete=()=>{h==null?s.close():h.oncomplete=()=>s.close()}}},o.onerror=s=>r(o.error)})}};Kr.URL_SCHEME="indexeddb://";var $R=i=>ot().getBool("IS_BROWSER")&&!Array.isArray(i)&&i.startsWith(Kr.URL_SCHEME)?nY(i.slice(Kr.URL_SCHEME.length)):null;je.registerSaveRouter($R);je.registerLoadRouter($R);function nY(i){return new Kr(i)}function iY(i){return i.startsWith(Kr.URL_SCHEME)?i.slice(Kr.URL_SCHEME.length):i}var W0=class{constructor(){this.indexedDB=HR()}listModels(){return $t(this,null,function*(){return new Promise((t,e)=>{let n=this.indexedDB.open(CS,MS);n.onupgradeneeded=()=>ES(n),n.onsuccess=()=>{let r=n.result,o=r.transaction(bs,"readonly"),a=o.objectStore(bs).getAll();a.onsuccess=()=>{let l={};for(let c of a.result)l[c.modelPath]=c.modelArtifactsInfo;t(l)},a.onerror=l=>(r.close(),e(a.error)),o.oncomplete=()=>r.close()},n.onerror=r=>e(n.error)})})}removeModel(t){return $t(this,null,function*(){return t=iY(t),new Promise((e,n)=>{let r=this.indexedDB.open(CS,MS);r.onupgradeneeded=()=>ES(r),r.onsuccess=()=>{let o=r.result,s=o.transaction(bs,"readwrite"),a=s.objectStore(bs),l=a.get(t),c;l.onsuccess=()=>{if(l.result==null)return o.close(),n(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{let u=a.delete(t),h=()=>{c=o.transaction(ja,"readwrite");let f=c.objectStore(ja).delete(t);f.onsuccess=()=>e(l.result.modelArtifactsInfo),f.onerror=d=>n(l.error)};u.onsuccess=h,u.onerror=p=>(h(),o.close(),n(l.error))}},l.onerror=u=>(o.close(),n(l.error)),s.oncomplete=()=>{c==null?o.close():c.oncomplete=()=>o.close()}},r.onerror=o=>n(r.error)})})}};var Ro="/",Xc="tensorflowjs_models",UR="info",rY="model_topology",oY="weight_specs",sY="weight_data",aY="model_metadata";function WR(i){return{info:[Xc,i,UR].join(Ro),topology:[Xc,i,rY].join(Ro),weightSpecs:[Xc,i,oY].join(Ro),weightData:[Xc,i,sY].join(Ro),modelMetadata:[Xc,i,aY].join(Ro)}}function lY(i){let t=i.split(Ro);if(t.length<3)throw new Error(`Invalid key format: ${i}`);return t.slice(1,t.length-1).join(Ro)}function cY(i){return i.startsWith(Yr.URL_SCHEME)?i.slice(Yr.URL_SCHEME.length):i}var Yr=class{constructor(t){if(!ot().getBool("IS_BROWSER")||typeof window=="undefined"||typeof window.localStorage=="undefined")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=WR(this.modelPath)}save(t){return $t(this,null,function*(){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=ko(t);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,BR(t.weightData));let o={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};return t.signature!=null&&(o.signature=t.signature),t.userDefinedMetadata!=null&&(o.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(o.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch(o){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}})}load(){return $t(this,null,function*(){let t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(n==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);e.modelTopology=n;let r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);e.weightSpecs=r;let o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){let a=JSON.parse(o);e.format=a.format,e.generatedBy=a.generatedBy,e.convertedBy=a.convertedBy,a.signature!=null&&(e.signature=a.signature),a.userDefinedMetadata!=null&&(e.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(e.modelInitializer=a.modelInitializer)}let s=this.LS.getItem(this.keys.weightData);if(s==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return e.weightData=VR(s),e})}};Yr.URL_SCHEME="localstorage://";var GR=i=>ot().getBool("IS_BROWSER")&&!Array.isArray(i)&&i.startsWith(Yr.URL_SCHEME)?uY(i.slice(Yr.URL_SCHEME.length)):null;je.registerSaveRouter(GR);je.registerLoadRouter(GR);function uY(i){return new Yr(i)}var G0=class{constructor(){Gt(ot().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Gt(typeof window=="undefined"||typeof window.localStorage!="undefined",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}listModels(){return $t(this,null,function*(){let t={},e=Xc+Ro,n=Ro+UR;for(let r=0;r<this.LS.length;++r){let o=this.LS.key(r);if(o.startsWith(e)&&o.endsWith(n)){let s=lY(o);t[s]=JSON.parse(this.LS.getItem(o))}}return t})}removeModel(t){return $t(this,null,function*(){t=cY(t);let e=WR(t);if(this.LS.getItem(e.info)==null)throw new Error(`Cannot find model at path '${t}'`);let n=JSON.parse(this.LS.getItem(e.info));return this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),n})}};var jR="://",xr=class{constructor(){this.managers={}}static getInstance(){return xr.instance==null&&(xr.instance=new xr),xr.instance}static registerManager(t,e){Gt(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(jR)&&(t=t.slice(0,t.indexOf(jR))),Gt(t.length>0,()=>"scheme must not be an empty string.");let n=xr.getInstance();Gt(n.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),n.managers[t]=e}static getManager(t){let e=this.getInstance().managers[t];if(e==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(this.getInstance().managers)}};var TS=class{fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}};if(ot().get("IS_BROWSER")){ot().setPlatform("browser",new TS);try{xr.registerManager(Yr.URL_SCHEME,new G0)}catch(i){}try{xr.registerManager(Kr.URL_SCHEME,new W0)}catch(i){}}var hY={importFetch:()=>qR()},IS;var AS=class{constructor(){this.util=XR(),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return ot().global.fetch!=null?ot().global.fetch(t,e):(IS==null&&(IS=hY.importFetch()),IS(t,e))}now(){let t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(t)}decode(t,e){return t.length===0?"":new this.util.TextDecoder(e).decode(t)}};ot().get("IS_NODE")&&ot().setPlatform("node",new AS);function Yt(i,t="float32",e){return t=t||"float32",Mp(i),new Ie(i,t,e)}function pY(i,t){let e=me(i,"x","cast");if(!tS(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&e.dtype!=="string"||t!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");let n={x:e},r={dtype:t};return Zt.runKernel(gs,n,r)}var j0=Se({cast_:pY});function fY(i){let e={x:me(i,"x","clone","string_or_numeric")};return Zt.runKernel(xs,e)}var KR=Se({clone_:fY});function YR(i,t=!1){console.log(i.toString(t))}vS();var dY={buffer:Yt,cast:j0,clone:KR,print:YR};RR(dY);var mY="model",gY=".json",xY=".weights.bin";function ZR(i){return new Promise(t=>setTimeout(t)).then(i)}var Po=class{constructor(t){if(!ot().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Po.URL_SCHEME)&&(t=t.slice(Po.URL_SCHEME.length)),(t==null||t.length===0)&&(t=mY),this.modelTopologyFileName=t+gY,this.weightDataFileName=t+xY}save(t){return $t(this,null,function*(){if(typeof document=="undefined")throw new Error("Browser downloads are not supported in this environment since `document` is not present");let e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n};t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer);let o=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),s=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor;if(s.download=this.modelTopologyFileName,s.href=o,yield ZR(()=>s.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){let a=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;a.download=this.weightDataFileName,a.href=e,yield ZR(()=>a.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:ko(t)}}})}};Po.URL_SCHEME="downloads://";var yY=i=>ot().getBool("IS_BROWSER")&&!Array.isArray(i)&&i.startsWith(Po.URL_SCHEME)?vY(i.slice(Po.URL_SCHEME.length)):null;je.registerSaveRouter(yY);function vY(i="model"){return new Po(i)}function kS(i,t,e,n){s(i),e=e==null?0:e,n=n==null?1:n,a(e,n);let r=0,o=l=>(l.then(c=>{let u=e+ ++r/i.length*(n-e);return t(u),c}),l);function s(l){Gt(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){Gt(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),Gt(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),Gt(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(i.map(o))}function JR(i,t){return $t(this,null,function*(){t==null&&(t={});let e=t.fetchFunc==null?ot().platform.fetch:t.fetchFunc,n=i.map(h=>e(h,t.requestInit,{isBinary:!0})),r=0,o=.5,a=(t.onProgress==null?yield Promise.all(n):yield kS(n,t.onProgress,r,o)).map(h=>h.arrayBuffer()),l=.5,c=1;return t.onProgress==null?yield Promise.all(a):yield kS(a,t.onProgress,l,c)})}var _Y="application/octet-stream",wY="application/json",Tf=class{constructor(t,e){if(this.DEFAULT_METHOD="POST",e==null&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,this.weightUrlConverter=e.weightUrlConverter,e.fetchFunc!=null?(Gt(typeof e.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=e.fetchFunc):this.fetch=ot().platform.fetch,Gt(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&Gt(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,e.requestInit!=null&&e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}save(t){return $t(this,null,function*(){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;let n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n};t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),e.body.append("model.json",new Blob([JSON.stringify(r)],{type:wY}),"model.json"),t.weightData!=null&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:_Y}),"model.weights.bin");let o=yield this.fetch(this.path,e);if(o.ok)return{modelArtifactsInfo:ko(t),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)})}load(){return $t(this,null,function*(){let t=yield this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let e;try{e=yield t.json()}catch(d){let m=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?m+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":m+=" Please make sure the server is serving valid JSON for this request.",new Error(m)}let n=e.modelTopology,r=e.weightsManifest,o=e.generatedBy,s=e.convertedBy,a=e.format,l=e.signature,c=e.userDefinedMetadata;if(n==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);let u,h;r!=null&&([u,h]=yield this.loadWeights(r));let p={modelTopology:n,weightSpecs:u,weightData:h,generatedBy:o,convertedBy:s,format:a};l!=null&&(p.signature=l),c!=null&&(p.userDefinedMetadata=c);let f=e.modelInitializer;return f&&(p.modelInitializer=f),p})}loadWeights(t){return $t(this,null,function*(){let e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=SY(e),o=this.weightPathPrefix||n,s=[];for(let u of t)s.push(...u.weights);let a=[],l=[];for(let u of t)for(let h of u.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(h)):a.push(o+h+r);this.weightUrlConverter&&a.push(...yield Promise.all(l));let c=yield JR(a,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[s,U0(c)]})}};Tf.URL_SCHEME_REGEX=/^https?:\/\//;function SY(i){let t=i.lastIndexOf("/"),e=i.lastIndexOf("?"),n=i.substring(0,t),r=e>t?i.substring(e):"";return[n+"/",r]}function RS(i){return i.match(Tf.URL_SCHEME_REGEX)!=null}var QR=(i,t)=>{if(typeof fetch=="undefined"&&(t==null||t.fetchFunc==null))return null;{let e=!0;if(Array.isArray(i)?e=i.every(n=>RS(n)):e=RS(i),e)return tP(i,t)}return null};je.registerSaveRouter(QR);je.registerLoadRouter(QR);function tP(i,t){return new Tf(i,t)}function MY(i,t,e=!1,n=!1){let r=me(i,"a","matMul"),o=me(t,"b","matMul");[r,o]=qc(r,o);let s={a:r,b:o},a={transposeA:e,transposeB:n};return Zt.runKernel(Lc,s,a)}var PS=Se({matMul_:MY});function EY(i,t){let e=me(i,"x","transpose");if(t==null&&(t=e.shape.map((o,s)=>s).reverse()),Gt(e.rank===t.length,()=>`Error in transpose: rank of input ${e.rank} must match length of perm ${t}.`),t.forEach(o=>{Gt(o>=0&&o<e.rank,()=>`All entries in 'perm' must be between 0 and ${e.rank-1} but got ${t}`)}),e.rank<=1)return e.clone();let n={x:e},r={perm:t};return Zt.runKernel($c,n,r)}var eP=Se({transpose_:EY});function TY(i,t){let e=i.shape.length,n=t.shape.length;if(e<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${e}.`);if(n<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${n}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[n-1]>e)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[n-1]} vs. ${e}`);if(Mn(i.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${i.shape}.`);let r=t.shape,o=r[r.length-1],s=1;for(let h=0;h<r.length-1;++h)s*=r[h];let a=i.shape,l=r.slice();l.pop();let c=1;for(let h=o;h<e;++h)c*=a[h],l.push(a[h]);let u=[...qr(i.shape).map(h=>h/c),1].slice(0,o);return[l,s,c,u]}function nP(i,t,e){let n=t.rank>1?t.shape[t.rank-1]:1,r=t.rank>1?t.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${e.shape}, indices.shape: ${t.shape}, shape: ${i}, sliceDim: ${n}, and batchDim: ${r}.`;if(e.rank<r)throw new Error(o+` update.rank < ${r}. `);if(i.length<n+(e.rank-r))throw new Error(o+` Output shape length < ${n+(e.rank-r)}`);if(e.rank!==r+i.length-n)throw new Error(o+` update.rank != ${r+i.length-n}`);for(let s=0;s<r;++s)if(e.shape[s]!==t.shape[s])throw new Error(o+` updates.shape[${s}] (${e.shape[s]}) != indices.shape[${s}] (${t.shape[s]}).`);for(let s=0;s<e.rank-r;++s)if(e.shape[s+r]!==i[s+n])throw new Error(o+` updates.shape[${s+r}] (${e.shape[s+r]}) != shape[${s+r}] (${i[s+r]})`)}function IY(i,t,e){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(i.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${i.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(e.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${e}`);if(e.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(i.size===0)throw new Error(`Updates specified for empty output. updates shape: ${i.shape}`)}nP(e,t,i)}function AY(i,t,e){let n=t.shape.length,r=n>1?t.shape[n-1]:1,o=e.length,s=1;for(let h=r;h<o;++h)s*=e[h];let a=r<1?1:r,l=Mn(t.shape)/a,c=[...qr(e.slice(0,r)),1],u=Mn(e);return{sliceRank:r,numUpdates:l,sliceSize:s,strides:c,outputSize:u}}var zn={};Dr(zn,{assertParamsValid:()=>kY,computeFlatOffset:()=>PY,computeOutShape:()=>iP,getNormalizedAxes:()=>aP,isSliceContinous:()=>RY,maskToAxes:()=>q0,parseSliceParams:()=>NY,sliceInfo:()=>LY,startForAxis:()=>hP,startIndicesWithElidedDims:()=>lP,stopForAxis:()=>pP,stopIndicesWithElidedDims:()=>cP,stridesForAxis:()=>uP,stridesWithElidedDims:()=>rP});function kY(i,t,e){let n=i.shape.length;Gt(n===t.length,()=>`Error in slice${n}D: Length of begin ${t} must match the rank of the array (${n}).`),Gt(n===e.length,()=>`Error in slice${n}D: Length of size ${e} must match the rank of the array (${n}).`);for(let r=0;r<n;++r)Gt(t[r]+e[r]<=i.shape[r],()=>`Error in slice${n}D: begin[${r}] + size[${r}] (${t[r]+e[r]}) would overflow input.shape[${r}] (${i.shape[r]})`)}function q0(i){let t=[],e=0;for(;i>0;)i&1&&t.push(e),i/=2,e++;return t}function iP(i,t,e){let n=[];for(let r=0;r<i.length;r++)n[r]=Math.ceil((t[r]-i[r])/e[r]);return n}function rP(i,t,e,n){let r=[...i];for(let o=r.length;o<n.length;o++)r.push(1);for(let o=0;o<e;o++)o===0?r[t]=1:(r.splice(t,0,1),r.pop());return r}function oP(i,t,e){return e<=i?e:e-(t-1)}function sP(i,t){let e=[];for(let n=0;n<i;n++)e.push(t+n);return e}function aP(i,t,e,n,r,o,s,a,l){let c=i.length,u=new Array(c),h=new Array(c),p=new Array(c);if(t.length&&e>0){let f=t[0],d=e+1;u=lP(s,f,d,n,i),h=cP(a,f,d,r,i),p=rP(o,f,d,i)}else for(let f=0;f<c;f++)u[f]=hP(s,n,o,i,f,l),h[f]=pP(a,r,o,i,f,l),p[f]=uP(o,f,l);return{begin:u,end:h,strides:p}}function lP(i,t,e,n,r){let o=[...r],s=sP(e,t);for(let a=0;a<o.length;a++)if(s.indexOf(a)>-1)o[a]=0;else{let l=oP(t,e,a),c=n[l];i&1<<l&&(c=0),o[a]=c}return o}function cP(i,t,e,n,r){let o=[...r],s=sP(e,t);for(let a=0;a<o.length;a++)if(s.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{let l=oP(t,e,a),c=n[l];i&1<<l&&(c=Number.MAX_SAFE_INTEGER),o[a]=c}for(let a=0;a<o.length;a++){let l=r[a];o[a]<0&&(o[a]+=l),o[a]=Ic(0,o[a],r[a])}return o}function uP(i,t,e){let n=i[t];return(e&1<<t||n==null)&&(n=1),n}function hP(i,t,e,n,r,o){let s=t[r],a=e[r]||1;(i&1<<r||o&1<<r||s==null)&&(a>0?s=Number.MIN_SAFE_INTEGER:s=Number.MAX_SAFE_INTEGER);let l=n[r];return s<0&&(s+=l),s=Ic(0,s,l-1),s}function pP(i,t,e,n,r,o){let s=t[r],a=e[r]||1;(i&1<<r||o&1<<r||s==null)&&(a>0?s=Number.MAX_SAFE_INTEGER:s=Number.MIN_SAFE_INTEGER);let l=n[r];return s<0&&(s+=l),a>0?s=Ic(0,s,l):s=Ic(-1,s,l-1),s}function RY(i,t,e){let n=e.length;for(let r=0;r<e.length;r++)if(e[r]>1){n=r;break}for(let r=n+1;r<e.length;r++)if(t[r]>0||e[r]!==i[r])return!1;return!0}function PY(i,t){let e=i.length>0?i[i.length-1]:1;for(let n=0;n<i.length-1;n++)e+=i[n]*t[n];return e}function NY(i,t,e){let n,r=i.shape.length;typeof t=="number"?n=[t,...new Array(r-1).fill(0)]:t.length<r?n=t.concat(new Array(r-t.length).fill(0)):n=t.slice(),n.forEach(s=>{Gt(s!==-1,()=>"slice() does not support negative begin indexing.")});let o;return e==null?o=new Array(r).fill(-1):typeof e=="number"?o=[e,...new Array(r-1).fill(-1)]:e.length<r?o=e.concat(new Array(r-e.length).fill(-1)):o=e,o=o.map((s,a)=>s>=0?s:(Gt(s===-1,()=>`Negative size values should be exactly -1 but got ${s} for the slice() size at index ${a}.`),i.shape[a]-n[a])),[n,o]}function LY(i,t,e,n,r,o,s,a,l){let c=t.slice(),u=e.slice(),h=n;n==null&&(h=new Array(c.length));let p=q0(s);if(p.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(s!==0&&a!==0)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(s!==0&&l!==0)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");let f=i.length-c.length,d=q0(a),m=i.slice();d.forEach(E=>{c[E]=0,u[E]=1,m.splice(E,0,1)});let{begin:x,end:g,strides:y}=aP(m,p,f,c,u,h,r,o,s);c=x,u=g,h=y;let b=q0(l);b.forEach(E=>{u[E]=c[E]+1,h[E]=1});let v=iP(c,u,h),_=v.filter((E,M)=>b.indexOf(M)===-1);return{nonStrided:h.every(E=>E===1),$begin:c,$end:u,$strides:h,size:v,newShape:m,outShape:_}}function DY(i){ot().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(i+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}PR(DY);function No(){return Zt}function fP(i,t){return Zt.tidy(i,t)}function dP(){return Zt.ready()}function mP(){return Zt.backendName}function X0(i,t,e=1){return Zt.registerBackend(i,t,e)}function zY(i,t){let e=me(i,"a","mul"),n=me(t,"b","mul");[e,n]=qc(e,n);let r={a:e,b:n};return Zt.runKernel(Oa,r)}var gP=Se({mul_:zY});function FY(i,t,e,n,r="NHWC",o){let s=i[3],a=[...t,s],l=yP(r);return DS(i,a,e,o,n,null,null,l)}function OY(i,t,e,n,r,o,s="channelsLast"){let[a,l]=K0(t),c;if(s==="channelsLast")c=[a,l,i[3],i[3]];else if(s==="channelsFirst")c=[a,l,i[1],i[1]];else throw new Error(`Unknown dataFormat ${s}`);return DS(i,c,e,n,r,o,!1,s)}function BY(i,t,e,n,r,o,s="NDHWC"){let[a,l,c]=NS(t),u,h;if(s==="NDHWC")h="channelsLast",u=[a,l,c,i[4],i[4]];else if(s==="NCDHW")h="channelsFirst",u=[a,l,c,i[1],i[1]];else throw new Error(`Unknown dataFormat ${s}`);return xP(i,u,e,n,r,!1,h,o)}function DS(i,t,e,n,r,o,s=!1,a="channelsLast"){let[l,c,u,h]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,h]=i;else if(a==="channelsFirst")[l,h,c,u]=i;else throw new Error(`Unknown dataFormat ${a}`);let[p,f,,d]=t,[m,x]=K0(e),[g,y]=K0(n),b=Kc(p,g),v=Kc(f,y),{padInfo:_,outHeight:S,outWidth:E}=$Y(r,c,u,m,x,b,v,o,a),M=s?d*h:d,N;return a==="channelsFirst"?N=[l,M,S,E]:a==="channelsLast"&&(N=[l,S,E,M]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:h,outHeight:S,outWidth:E,outChannels:M,padInfo:_,strideHeight:m,strideWidth:x,filterHeight:p,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:v,dilationHeight:g,dilationWidth:y,inShape:i,outShape:N,filterShape:t}}function xP(i,t,e,n,r,o=!1,s="channelsLast",a){let[l,c,u,h,p]=[-1,-1,-1,-1,-1];if(s==="channelsLast")[l,c,u,h,p]=i;else if(s==="channelsFirst")[l,p,c,u,h]=i;else throw new Error(`Unknown dataFormat ${s}`);let[f,d,m,,x]=t,[g,y,b]=NS(e),[v,_,S]=NS(n),E=Kc(f,v),M=Kc(d,_),N=Kc(m,S),{padInfo:I,outDepth:w,outHeight:R,outWidth:P}=UY(r,c,u,h,g,y,b,E,M,N,a),D=o?x*p:x,F;return s==="channelsFirst"?F=[l,D,w,R,P]:s==="channelsLast"&&(F=[l,w,R,P,D]),{batchSize:l,dataFormat:s,inDepth:c,inHeight:u,inWidth:h,inChannels:p,outDepth:w,outHeight:R,outWidth:P,outChannels:D,padInfo:I,strideDepth:g,strideHeight:y,strideWidth:b,filterDepth:f,filterHeight:d,filterWidth:m,effectiveFilterDepth:E,effectiveFilterHeight:M,effectiveFilterWidth:N,dilationDepth:v,dilationHeight:_,dilationWidth:S,inShape:i,outShape:F,filterShape:t}}function VY(i,t,e,n,r){n==null&&(n=zS(i,t,e));let o=i[0],s=i[1],a=qa((o-t+2*n)/e+1,r),l=qa((s-t+2*n)/e+1,r);return[a,l]}function HY(i,t,e,n,r,o){r==null&&(r=zS(i,t,n));let s=i[0],a=i[1],l=i[2],c=qa((s-t+2*r)/n+1,o),u=qa((a-t+2*r)/n+1,o),h=qa((l-t+2*r)/n+1,o);return[c,u,h,e]}function zS(i,t,e,n=1){let r=Kc(t,n);return Math.floor((i[0]*(e-1)-e+r)/2)}function K0(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}function NS(i){return typeof i=="number"?[i,i,i]:i}function Kc(i,t){return t<=1?i:i+(i-1)*(t-1)}function $Y(i,t,e,n,r,o,s,a,l){let c,u,h;if(typeof i=="number"){c={top:i,bottom:i,left:i,right:i,type:i===0?"VALID":"NUMBER"};let f=VY([t,e],o,n,i,a);u=f[0],h=f[1]}else if(i==="same"){u=Math.ceil(t/n),h=Math.ceil(e/r);let p=Math.max(0,(u-1)*n+o-t),f=Math.max(0,(h-1)*r+s-e),d=Math.floor(p/2),m=p-d,x=Math.floor(f/2),g=f-x;c={top:d,bottom:m,left:x,right:g,type:"SAME"}}else if(i==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-o+1)/n),h=Math.ceil((e-s+1)/r);else if(typeof i=="object"){let p=l==="channelsLast"?i[1][0]:i[2][0],f=l==="channelsLast"?i[1][1]:i[2][1],d=l==="channelsLast"?i[2][0]:i[3][0],m=l==="channelsLast"?i[2][1]:i[3][1];c={top:p,bottom:f,left:d,right:m,type:p===0&&f===0&&d===0&&m===0?"VALID":"EXPLICIT"},u=qa((t-o+p+f)/n+1,a),h=qa((e-s+d+m)/r+1,a)}else throw Error(`Unknown padding parameter: ${i}`);return{padInfo:c,outHeight:u,outWidth:h}}function UY(i,t,e,n,r,o,s,a,l,c,u){let h,p,f,d;if(typeof i=="number"){h={top:i,bottom:i,left:i,right:i,front:i,back:i,type:i===0?"VALID":"NUMBER"};let x=HY([t,e,n,1],a,1,r,i,u);p=x[0],f=x[1],d=x[2]}else if(i==="same"){p=Math.ceil(t/r),f=Math.ceil(e/o),d=Math.ceil(n/s);let m=(p-1)*r+a-t,x=(f-1)*o+l-e,g=(d-1)*s+c-n,y=Math.floor(m/2),b=m-y,v=Math.floor(x/2),_=x-v,S=Math.floor(g/2),E=g-S;h={top:v,bottom:_,left:S,right:E,front:y,back:b,type:"SAME"}}else if(i==="valid")h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((t-a+1)/r),f=Math.ceil((e-l+1)/o),d=Math.ceil((n-c+1)/s);else throw Error(`Unknown padding parameter: ${i}`);return{padInfo:h,outDepth:p,outHeight:f,outWidth:d}}function qa(i,t){if(!t)return Math.trunc(i);switch(t){case"round":return Math.round(i);case"ceil":return Math.ceil(i);case"floor":return Math.floor(i);default:throw new Error(`Unknown roundingMode ${t}`)}}function LS(i){let[t,e,n]=K0(i);return t===1&&e===1&&n===1}function WY(i,t){return LS(i)||LS(t)}function yP(i){if(i==="NHWC")return"channelsLast";if(i==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${i}`)}function GY(i,t){let n={x:me(i,"x","reshape","string_or_numeric")},r={shape:t};return Zt.runKernel(Bc,n,r)}var vP=Se({reshape_:GY});function jY(i,t){let e=i.length,n=[];for(let r=0;r<e;r++){let o=e-1-r,s=i[o]||1;(t[t.length-1-r]||1)>1&&s===1&&n.unshift(o)}return n}function FS(i,t){let e=[];for(let n=0;n<t.length;n++){let r=i[i.length-n-1],o=t.length-n-1,s=t[o];(r==null||r===1&&s>1)&&e.unshift(o)}return e}function qY(i,t){let e=[],n=Math.max(i.length,t.length);for(let r=0;r<n;r++){let o=i[i.length-r-1];o==null&&(o=1);let s=t[t.length-r-1];if(s==null&&(s=1),o===1)e.unshift(s);else if(s===1)e.unshift(o);else if(o!==s){let a=`Operands could not be broadcast together with shapes ${i} and ${t}.`;throw Error(a)}else e.unshift(o)}return e}function KY(i){let e={x:me(i,"x","elu")};return Zt.runKernel(Fa,e)}var bP=Se({elu_:KY});function YY(i,t=.2){let n={x:me(i,"x","leakyRelu")},r={alpha:t};return Zt.runKernel(zc,n,r)}var _P=Se({leakyRelu_:YY});function ZY(i,t){let e=me(i,"a","sub"),n=me(t,"b","sub");[e,n]=qc(e,n);let r={a:e,b:n};return Zt.runKernel(Ha,r)}var OS=Se({sub_:ZY});function JY(i,t=null,e=!1){let n=me(i,"x","sum");n.dtype==="bool"&&(n=j0(n,"int32"));let r={x:n},o={axis:t,keepDims:e};return Zt.runKernel(Vc,r,o)}var wP=Se({sum_:JY});function BS(i,t){for(let e=0;e<i.length;++e)if(i[i.length-e-1]!==t-1-e)return!1;return!0}function SP(i,t,e){let n=i.length+t.length,r=[],o=0,s=0;for(let a=0;a<n;a++)e.indexOf(a)===-1?r.push(i[o++]):r.push(t[s++]);return r}function QY(i,t){let e=[],n=i.length;for(let o=0;o<n;o++)t.indexOf(o)===-1&&e.push(i[o]);let r=t.map(o=>i[o]);return[e,r]}function tZ(i,t){let e=t.map(n=>1);return SP(i,e,t)}function eZ(i,t,e){Gt(BS(t,e),()=>`${i} supports only inner-most axes for now. Got axes ${t} and rank-${e} input.`)}function nZ(i,t){if(BS(i,t))return null;let e=[];for(let n=0;n<t;++n)i.indexOf(n)===-1&&e.push(n);return i.forEach(n=>e.push(n)),e}function iZ(i){return i.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function rZ(i,t){let e=[];for(let n=t-i;n<t;++n)e.push(n);return e}function If(i,t="float32"){if(t==="complex64"){let n=If(i,"float32"),r=If(i,"float32");return FR(n,r)}let e=Nc(Mn(i),t);return Zt.makeTensor(e,i,t)}function oZ(i,t,e=0){let n=me(i,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let r={paddings:t,constantValue:e},o={x:n};return Zt.runKernel(Fc,o,r)}var VS=Se({pad_:oZ});function sZ(i,t){let e=me(i,"x","prelu"),n=me(t,"alpha","prelu"),r={x:e,alpha:n};return Zt.runKernel(Oc,r)}var CP=Se({prelu_:sZ});function fZ(i){let e={x:me(i,"x","relu")};return Zt.runKernel(Ba,e)}var HP=Se({relu_:fZ});function dZ(i){let e={x:me(i,"x","relu6")};return Zt.runKernel(Va,e)}var $P=Se({relu6_:dZ});function qS(i,t){if((vi(i)&&t!=="string"||Array.isArray(i))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&vi(i)&&!(i instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return $0(i,[],[],t)}function mZ(i,t,e=0){let r={x:me(i,"x","split")},o={numOrSizeSplits:t,axis:e};return Zt.runKernel(Hc,r,o)}var XS=Se({split_:mZ});function gZ(i,t=0){let n={x:me(i,"x","step")},r={alpha:t};return Zt.runKernel($a,n,r)}var UP=Se({step_:gZ});function WP(i,t){let e=[];for(let o=0;o<t.length;o++)t[o]&&e.push(o);let n=Yt(i,"int32"),r=Yt([e.length,i.length],"int32");for(let o=0;o<e.length;o++){let s=n.indexToLoc(e[o]),a=o*i.length;r.values.set(s,a)}return r.toTensor()}function xZ(i,t,e){if(e==null||e==="linear")return i;if(e==="relu")return gP(i,UP(t));throw new Error(`Cannot compute gradient for fused activation ${e}.`)}function yZ(i,t){let e=t,n=FS(i.shape,t.shape);return n.length>0&&(e=wP(e,n)),vP(e,i.shape)}function vZ(i,t,e,n){if(t==="linear")return i;if(t==="relu")return HP(i);if(t==="elu")return bP(i);if(t==="relu6")return $P(i);if(t==="prelu")return CP(i,e);if(t==="leakyrelu")return _P(i,n);throw new Error(`Unknown fused activation ${t}.`)}var bZ=(i,t)=>!(i>0)||t==="linear";function GP(i,t,e){let n=_Z(i,t,e),r=n<0?-(n+1):n;i.splice(r,0,t)}function _Z(i,t,e){return SZ(i,t,e||wZ)}function wZ(i,t){return i>t?1:i<t?-1:0}function SZ(i,t,e){let n=0,r=i.length,o=0,s=!1;for(;n<r;){o=n+(r-n>>>1);let a=e(t,i[o]);a>0?n=o+1:(r=o,s=!a)}return s?n:-n-1}function qP(i,t,e,n,r){return KS(i,t,e,n,r,0)}function XP(i,t,e,n,r,o){return KS(i,t,e,n,r,0,!1,o,!0)}function KP(i,t,e,n,r,o){return KS(i,t,e,n,r,o,!0)}function KS(i,t,e,n,r,o,s=!1,a=!1,l=!1){let c=[];for(let x=0;x<t.length;x++)t[x]>r&&c.push({score:t[x],boxIndex:x,suppressBeginIndex:0});c.sort(jP);let u=o>0?-.5/o:0,h=[],p=[];for(;h.length<e&&c.length>0;){let x=c.pop(),{score:g,boxIndex:y,suppressBeginIndex:b}=x;if(g<r)break;let v=!1;for(let _=h.length-1;_>=b;--_){let S=CZ(i,y,h[_]);if(S>=n){v=!0;break}if(x.score=x.score*MZ(n,u,S),x.score<=r)break}x.suppressBeginIndex=h.length,v||(x.score===g?(h.push(y),p.push(x.score)):x.score>r&&GP(c,x,jP))}let f=h.length,d=e-f;a&&d>0&&(h.push(...new Array(d).fill(0)),p.push(...new Array(d).fill(0)));let m={selectedIndices:h};return s&&(m.selectedScores=p),l&&(m.validOutputs=f),m}function CZ(i,t,e){let n=i.subarray(t*4,t*4+4),r=i.subarray(e*4,e*4+4),o=Math.min(n[0],n[2]),s=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),h=Math.max(r[0],r[2]),p=Math.max(r[1],r[3]),f=(a-o)*(l-s),d=(h-c)*(p-u);if(f<=0||d<=0)return 0;let m=Math.max(o,c),x=Math.max(s,u),g=Math.min(a,h),y=Math.min(l,p),b=Math.max(g-m,0)*Math.max(y-x,0);return b/(f+d-b)}function MZ(i,t,e){let n=Math.exp(t*e*e);return e<=i?n:0}function jP(i,t){return i.score-t.score||i.score===t.score&&t.boxIndex-i.boxIndex}var O={};Dr(O,{ERF_A1:()=>OZ,ERF_A2:()=>BZ,ERF_A3:()=>VZ,ERF_A4:()=>HZ,ERF_A5:()=>$Z,ERF_P:()=>FZ,PARALLELIZE_THRESHOLD:()=>Z0,SELU_SCALE:()=>zZ,SELU_SCALEALPHA:()=>DZ,applyActivation:()=>vZ,assertAndGetBroadcastShape:()=>qY,assertAxesAreInnerMostDims:()=>eZ,assertParamsConsistent:()=>EZ,assignToTypedArray:()=>YZ,axesAreInnerMostDims:()=>BS,calculateShapes:()=>AY,checkEinsumDimSizes:()=>nJ,combineLocations:()=>SP,complexWithEvenIndex:()=>qZ,complexWithOddIndex:()=>XZ,computeConv2DInfo:()=>DS,computeConv3DInfo:()=>xP,computeDefaultPad:()=>zS,computeDilation2DInfo:()=>FY,computeOptimalWindowSize:()=>IZ,computeOutAndReduceShapes:()=>QY,computeOutShape:()=>TZ,computePool2DInfo:()=>OY,computePool3DInfo:()=>BY,convertConv2DDataFormat:()=>yP,decodeEinsumEquation:()=>tJ,eitherStridesOrDilationsAreOne:()=>WY,expandShapeToKeepDim:()=>tZ,exponent:()=>JZ,exponents:()=>ZZ,fromStringArrayToUint8:()=>hJ,fromUint8ToStringArray:()=>uJ,getAxesPermutation:()=>nZ,getBroadcastDims:()=>jY,getComplexWithIndex:()=>KZ,getEinsumComputePath:()=>iJ,getEinsumPermutation:()=>eJ,getFusedBiasGradient:()=>yZ,getFusedDyActivation:()=>xZ,getImageCenter:()=>AZ,getInnerMostAxes:()=>rZ,getPermuted:()=>RZ,getReductionAxes:()=>FS,getReshaped:()=>kZ,getReshapedPermuted:()=>PZ,getSliceBeginCoords:()=>NZ,getSliceSize:()=>LZ,getUndoAxesPermutation:()=>iZ,isIdentityPermutation:()=>rJ,log:()=>WZ,mergeRealAndImagArrays:()=>GZ,prepareAndValidate:()=>TY,prepareSplitSize:()=>sJ,segment_util:()=>ZS,shouldFuse:()=>bZ,slice_util:()=>zn,splitRealAndImagArrays:()=>jZ,tupleValuesAreOne:()=>LS,upcastType:()=>dn,validateInput:()=>IY,validateUpdateShape:()=>nP,warn:()=>UZ});function EZ(i,t){let e=i[0].length;i.forEach((r,o)=>{Gt(r.length===e,()=>`Error in concat${e}D: rank of tensors[${o}] must be the same as the rank of the rest (${e})`)}),Gt(t>=0&&t<e,()=>`Error in concat${e}D: axis must be between 0 and ${e-1}.`);let n=i[0];i.forEach((r,o)=>{for(let s=0;s<e;s++)Gt(s===t||r[s]===n[s],()=>`Error in concat${e}D: Shape of tensors[${o}] (${r}) does not match the shape of the rest (${n}) along the non-concatenated axis ${o}.`)})}function TZ(i,t){let e=i[0].slice();for(let n=1;n<i.length;n++)e[t]+=i[n][t];return e}var Z0=30;function IZ(i){return i<=Z0?i:Pc(i,Math.floor(Math.sqrt(i)))}function AZ(i,t,e){let n=e*(typeof i=="number"?i:i[0]),r=t*(typeof i=="number"?i:i[1]);return[n,r]}function kZ(i,t,e,n=!0){let r=[];if(n)r=r.concat(t.slice(0)),r.push(i[0]/e),r=r.concat(i.slice(1));else{r=r.concat(i[0]);let o=t.length;for(let s=0;s<o;++s)r=r.concat([i[s+1]/t[s],t[s]]);r=r.concat(i.slice(o+1))}return r}function RZ(i,t,e=!0){let n=[];if(e){n.push(t);for(let r=t+1;r<i;++r)r<=2*t?(n.push(r),n.push(r-(t+1))):n.push(r)}else{let r=[],o=[];for(let s=1;s<i;++s)s>=t*2+1||s%2===1?o.push(s):r.push(s);n.push(...r),n.push(0),n.push(...o)}return n}function PZ(i,t,e,n=!0){let r=[];n?r.push(i[0]/e):r.push(i[0]*e);for(let o=1;o<i.length;++o)o<=t.length?n?r.push(t[o-1]*i[o]):r.push(i[o]/t[o-1]):r.push(i[o]);return r}function NZ(i,t){let e=[0];for(let n=0;n<t;++n)e.push(i[n][0]);return e}function LZ(i,t,e){let n=i.slice(0,1);for(let r=0;r<e;++r)n.push(i[r+1]-t[r][0]-t[r][1]);return n}var DZ=1.7580993408473768,zZ=1.0507009873554805;var FZ=.3275911,OZ=.254829592,BZ=-.284496736,VZ=1.421413741,HZ=-1.453152027,$Z=1.061405429;function UZ(...i){ot().getBool("IS_TEST")||console.warn(...i)}function WZ(...i){ot().getBool("IS_TEST")||console.log(...i)}function GZ(i,t){if(i.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${i.length}, imag: ${t.length}.`);let e=new Float32Array(i.length*2);for(let n=0;n<e.length;n+=2)e[n]=i[n/2],e[n+1]=t[n/2];return e}function jZ(i){let t=new Float32Array(i.length/2),e=new Float32Array(i.length/2);for(let n=0;n<i.length;n+=2)t[n/2]=i[n],e[n/2]=i[n+1];return{real:t,imag:e}}function qZ(i){let t=Math.ceil(i.length/4),e=new Float32Array(t),n=new Float32Array(t);for(let r=0;r<i.length;r+=4)e[Math.floor(r/4)]=i[r],n[Math.floor(r/4)]=i[r+1];return{real:e,imag:n}}function XZ(i){let t=Math.floor(i.length/4),e=new Float32Array(t),n=new Float32Array(t);for(let r=2;r<i.length;r+=4)e[Math.floor(r/4)]=i[r],n[Math.floor(r/4)]=i[r+1];return{real:e,imag:n}}function KZ(i,t){let e=i[t*2],n=i[t*2+1];return{real:e,imag:n}}function YZ(i,t,e,n){i[n*2]=t,i[n*2+1]=e}function ZZ(i,t){let e=new Float32Array(i/2),n=new Float32Array(i/2);for(let r=0;r<Math.ceil(i/2);r++){let o=(t?2:-2)*Math.PI*(r/i);e[r]=Math.cos(o),n[r]=Math.sin(o)}return{real:e,imag:n}}function JZ(i,t,e){let n=(e?2:-2)*Math.PI*(i/t),r=Math.cos(n),o=Math.sin(n);return{real:r,imag:o}}var YS="->",QZ=/->/g,YP=",",ZP="...";function tJ(i,t){i=i.replace(/\s/g,"");let e=(i.length-i.replace(QZ,"").length)/YS.length;if(e<1)throw new Error("Equations without an arrow are not supported.");if(e>1)throw new Error(`Equation must contain exactly one arrow ("${YS}").`);let[n,r]=i.split(YS);Gt(n.indexOf(ZP)===-1,()=>`The ellipsis notation ("${ZP}") is not supported yet.`);let o=n.split(YP),s=o.length;if(t!==s)throw new Error(`Expected ${s} input tensors, received ${t}`);if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let a=[];for(let p=0;p<r.length;++p){let f=r[p];if(!o.some(d=>d.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let p=0;p<n.length;++p){let f=n[p];a.indexOf(f)===-1&&f!==YP&&a.push(f)}let l=new Array(o.length);for(let p=0;p<s;++p){if(new Set(o[p].split("")).size!==o[p].length)throw new Error(`Found duplicate axes in input component ${o[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let f=0;f<o[p].length;++f)l[p].push(a.indexOf(o[p][f]))}let c=a.length,u=r.length,h=[];for(let p=u;p<c;++p)h.push(p);return{allDims:a,summedDims:h,idDims:l}}function eJ(i,t){let e=new Array(i);e.fill(-1);for(let r=0;r<t.length;++r)e[t[r]]=r;let n=[];for(let r=0;r<i;++r)e[r]===-1&&n.push(r);return e=e.filter(r=>r!==-1),{permutationIndices:e,expandDims:n}}function nJ(i,t,e){let n=new Array(i);for(let r=0;r<e.length;++r){let o=e[r].shape;for(let s=0;s<t[r].length;++s)n[t[r][s]]===void 0?n[t[r][s]]=o[s]:Gt(n[t[r][s]]===o[s],()=>`Expected dimension ${n[t[r][s]]} at axis ${s} of input shaped ${JSON.stringify(o)}, but got dimension ${o[s]}`)}}function iJ(i,t){let e=i,n=[],r=0;i.length===0&&e.push(-1),r=i.length+1;for(let s=0;s<r;++s)n.push([]);let o=[];for(let s=0;s<e.length;++s){let a=e[s],l=oJ(t,a);for(let c of l)o.indexOf(c)===-1&&(n[s].push(c),o.push(c))}return{path:e,steps:n}}function rJ(i){return i.every((t,e)=>t===e)}function oJ(i,t){let e=[];for(let n=0;n<i.length;++n)(i[n].length===0||i[n].indexOf(t)!==-1||t===-1)&&e.push(n);return e}function sJ(i,t,e=0){let n=[];if(typeof t=="number")Gt(i.shape[e]%t===0,()=>"Number of splits must evenly divide the axis."),n=new Array(t).fill(i.shape[e]/t);else{let r=t.reduce((s,a)=>(a===-1&&(s+=1),s),0);Gt(r<=1,()=>"There should be only one negative value in split array.");let o=t.indexOf(-1);if(o!==-1){let s=t.reduce((a,l)=>l>0?a+l:a);t[o]=i.shape[e]-s}Gt(i.shape[e]===t.reduce((s,a)=>s+a),()=>"The sum of sizes must match the size of the axis dimension."),n=t}return n}var ZS={};Dr(ZS,{collectGatherOpShapeInfo:()=>cJ,computeOutShape:()=>lJ,segOpComputeOptimalWindowSize:()=>aJ});function aJ(i,t){let e=!1,n;for(i<=Z0?(n=i,e=!0):n=Pc(i,Math.floor(Math.sqrt(i)));!e;)n>t||n===i?e=!0:n=Pc(i,n+1);return n}function lJ(i,t,e){let n=[],r=i.length;for(let o=0;o<r;o++)o!==t?n.push(i[o]):n.push(e);return n}function cJ(i,t,e,n){let r=t.shape.length,o=i.shape.length;if(n!==0&&(n<-r||n>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${n}`);if(n<0&&(n+=r),n>o)throw new Error(`batchDims (${n}) must be less than rank(x) (
    ${o}).`);if(e<n)throw new Error(`batchDims (${n}) must be less than or equal to axis (${e}).`);for(let h=0;h<n;++h)if(i.shape[h]!==t.shape[h])throw new Error(`x.shape[${h}]: ${i.shape[h]} should be equal to indices.shape[${h}]: ${t.shape[h]}.`);let s=i.shape[e],a=[],l=1,c=1,u=1;for(let h=0;h<n;++h)a.push(i.shape[h]),l*=i.shape[h];for(let h=n;h<e;h++)a.push(i.shape[h]),c*=i.shape[h];for(let h=n;h<r;h++)a.push(t.shape[h]);for(let h=e+1;h<o;h++)a.push(i.shape[h]),u*=i.shape[h];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:s,outputShape:a}}function uJ(i){try{return i.map(t=>Gc(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function hJ(i){return i.map(t=>Wc(t))}var Fn={};Dr(Fn,{nonMaxSuppressionV3Impl:()=>qP,nonMaxSuppressionV4Impl:()=>XP,nonMaxSuppressionV5Impl:()=>KP,whereImpl:()=>WP});function pt(i,t){Array.isArray(i)||(i=[i]),i.forEach(e=>{e!=null&&L.assert(e.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}var fJ=Fn.whereImpl,Ka=class extends Ao{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Na(this,No())}nextDataId(){return Ka.nextDataId++}write(t,e,n){this.firstUse&&(this.firstUse=!1,ot().get("IS_NODE")&&O.warn(`
============================
Hi there \u{1F44B}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));let r={id:this.nextDataId()};return this.data.set(r,{values:t,dtype:n,refCount:1}),r}makeTensorInfo(t,e,n){let r;if(e==="string"&&n!=null&&n.length>0&&L.isString(n[0])){let o=n.map(s=>L.encodeString(s));r=this.write(o,t,e)}else r=this.write(n,t,e);return{dataId:r,shape:t,dtype:e}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){let e=this.data.get(t);e.refCount++}decRef(t){if(this.data.has(t)){let e=this.data.get(t);e.refCount--}}move(t,e,n,r,o){this.data.set(t,{values:e,dtype:r,refCount:o})}numDataIds(){return this.data.numDataIds()}read(t){return $t(this,null,function*(){return this.readSync(t)})}readSync(t){let{dtype:e,complexTensorInfos:n}=this.data.get(t);if(e==="complex64"){let r=this.readSync(n.real.dataId),o=this.readSync(n.imag.dataId);return O.mergeRealAndImagArrays(r,o)}return this.data.get(t).values}bufferSync(t){let e=this.readSync(t.dataId),n=e;if(t.dtype==="string")try{n=e.map(r=>L.decodeString(r))}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return Yt(t.shape,t.dtype,n)}makeOutput(t,e,n){let r=this.write(t,e,n);return No().makeTensorFromDataId(r,e,n,this)}disposeData(t,e=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!e&&this.data.get(t).refCount>0)return!1;let{complexTensorInfos:n}=this.data.get(t);n!=null&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}time(t){return $t(this,null,function*(){let e=L.now();return t(),{kernelMs:L.now()-e}})}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){pt([t],"where");let e=this.readSync(t.dataId);return fJ(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}};Ka.nextDataId=0;var xC={};Dr(xC,{addImpl:()=>QS,bincountImpl:()=>Jc,bincountReduceImpl:()=>J0,ceilImpl:()=>tC,concatImpl:()=>Q0,expImpl:()=>eC,expm1Impl:()=>iC,floorImpl:()=>rC,gatherV2Impl:()=>tx,greaterImpl:()=>oC,lessImpl:()=>sC,linSpaceImpl:()=>ex,logImpl:()=>aC,maxImpl:()=>nx,maximumImpl:()=>lC,minimumImpl:()=>cC,multiplyImpl:()=>Af,negImpl:()=>uC,notEqualImpl:()=>hC,prodImpl:()=>pC,rangeImpl:()=>ix,rsqrtImpl:()=>fC,simpleAbsImpl:()=>JS,sliceImpl:()=>dC,squaredDifferenceImpl:()=>mC,stridedSliceImpl:()=>rx,subImpl:()=>gC,tileImpl:()=>ox,topKImpl:()=>sx,transposeImpl:()=>Qc,uniqueImpl:()=>ax});function JS(i){let t=new Float32Array(i.length);for(let e=0;e<i.length;++e)t[e]=Math.abs(i[e]);return t}var dJ=i=>{let{x:t}=i.inputs,e=i.backend;pt(t,"abs");let n=new Float32Array(L.sizeFromShape(t.shape)),r=e.data.get(t.dataId).values;return n=JS(r),e.makeOutput(n,t.shape,"float32")},JP={kernelName:r1,backendName:"cpu",kernelFunc:dJ};function ce(i){return(t,e,n,r,o)=>{let s=O.assertAndGetBroadcastShape(t,e),a=s.length,l=L.computeStrides(s),c=L.sizeFromShape(s),u=L.getTypedArrayFromDType(o,c),h=t.length,p=e.length,f=L.computeStrides(t),d=L.computeStrides(e),m=O.getBroadcastDims(t,s),x=O.getBroadcastDims(e,s);if(m.length+x.length===0)for(let g=0;g<u.length;++g)u[g]=i(n[g%n.length],r[g%r.length]);else for(let g=0;g<u.length;++g){let y=L.indexToLoc(g,a,l),b=y.slice(-h);m.forEach(E=>b[E]=0);let v=L.locToIndex(b,h,f),_=y.slice(-p);x.forEach(E=>_[E]=0);let S=L.locToIndex(_,p,d);u[g]=i(n[v],r[S])}return[u,s]}}function mn(i){let{inputs:t,backend:e}=i,{real:n,imag:r}=t,o=e.data.get(n.dataId).values,s=e.data.get(r.dataId).values,a=e.makeTensorInfo(n.shape,"complex64"),l=e.data.get(a.dataId);return l.complexTensorInfos={real:e.makeTensorInfo(n.shape,"float32",o),imag:e.makeTensorInfo(r.shape,"float32",s)},a}var QP={kernelName:Dc,backendName:"cpu",kernelFunc:mn};function Yc(i,t,e="float32"){if(e==="complex64"){let r=Yc(i,t,"float32"),o=Yc(i,t,"float32");return mn({inputs:{real:r,imag:o},backend:i})}let n=L.makeZerosTypedArray(L.sizeFromShape(t),e);return i.makeTensorInfo(t,e,n)}function On(i){let{inputs:t,backend:e}=i,{x:n}=t;return e.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}var tN={kernelName:xs,backendName:"cpu",kernelFunc:On};function qi(i){let{inputs:t,backend:e}=i,{input:n}=t,r=e.data.get(n.dataId).complexTensorInfos.real,o=e.data.get(r.dataId).values;return e.makeTensorInfo(r.shape,r.dtype,o)}var eN={kernelName:p0,backendName:"cpu",kernelFunc:qi};function Xi(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{dtype:o}=n;if(o==="complex64"){if(r.dtype==="complex64")return On({inputs:{x:r},backend:e});let s=Yc(e,r.shape,r.dtype),a=Xi({inputs:{x:r},backend:e,attrs:{dtype:"float32"}}),l=mn({inputs:{real:a,imag:s},backend:e});return e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){let s=qi({inputs:{input:r},backend:e}),a=Xi({inputs:{x:s},backend:e,attrs:{dtype:o}});return e.disposeIntermediateTensorInfo(s),a}if(!L.hasEncodingLoss(r.dtype,o)){let s=On({inputs:{x:r},backend:e});return{dataId:s.dataId,shape:s.shape,dtype:o}}if(o==="int32"){let s=e.data.get(r.dataId).values,a=Int32Array.from(s);return e.makeTensorInfo(r.shape,"int32",a)}if(o==="bool"){let s=e.data.get(r.dataId).values,a=L.toTypedArray([0],r.dtype),[l,c]=ce((u,h)=>u!==h?1:0)(r.shape,[],s,a,"bool");return e.makeTensorInfo(c,"bool",l)}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${o}`)}var nN={kernelName:gs,backendName:"cpu",kernelFunc:Xi};function xe(i,t,e,n){return e==null?({inputs:r,backend:o})=>{let{a:s,b:a}=r,l=o;pt([s,a],i);let c=l.data.get(s.dataId).values,u=l.data.get(a.dataId).values,h=n||s.dtype,[p,f]=t(s.shape,a.shape,c,u,h);return l.makeTensorInfo(f,h,p)}:({inputs:r,backend:o})=>{let{a:s,b:a}=r,l=o;if(s.dtype==="complex64"||a.dtype==="complex64"){let c=Xi({inputs:{x:s},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),h=u.complexTensorInfos.real,p=u.complexTensorInfos.imag,f=l.data.get(h.dataId).values,d=l.data.get(p.dataId).values,m=Xi({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),x=l.data.get(m.dataId),g=x.complexTensorInfos.real,y=x.complexTensorInfos.imag,b=l.data.get(g.dataId).values,v=l.data.get(y.dataId).values,[_,S,E]=e(s.shape,a.shape,f,d,b,v),M=l.makeTensorInfo(E,"float32",_),N=l.makeTensorInfo(E,"float32",S),I=mn({inputs:{real:M,imag:N},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(M),l.disposeIntermediateTensorInfo(N),I}else{let c=l.data.get(s.dataId).values,u=l.data.get(a.dataId).values,h=n||s.dtype,[p,f]=t(s.shape,a.shape,c,u,h);return l.makeTensorInfo(f,h,p)}}}function Zc(i){return(t,e,n,r,o,s)=>{let a=O.assertAndGetBroadcastShape(t,e),l=L.sizeFromShape(a),c=a.length,u=L.computeStrides(a),h=L.getTypedArrayFromDType("float32",l),p=L.getTypedArrayFromDType("float32",l),f=O.getBroadcastDims(t,a),d=O.getBroadcastDims(e,a),m=O.mergeRealAndImagArrays(n,r),x=O.mergeRealAndImagArrays(o,s),g=t.length,y=L.computeStrides(t),b=e.length,v=L.computeStrides(e);if(f.length+d.length===0)for(let _=0;_<h.length;_++){let S=_%m.length,E=_%x.length,M=i(m[S*2],m[S*2+1],x[E*2],x[E*2+1]);h[_]=M.real,p[_]=M.imag}else for(let _=0;_<h.length;_++){let S=L.indexToLoc(_,c,u),E=S.slice(-g);f.forEach(R=>E[R]=0);let M=L.locToIndex(E,g,y),N=S.slice(-b);d.forEach(R=>N[R]=0);let I=L.locToIndex(N,b,v),w=i(m[M*2],m[M*2+1],x[I*2],x[I*2+1]);h[_]=w.real,p[_]=w.imag}return[h,p,a]}}var QS=ce((i,t)=>i+t),mJ=Zc((i,t,e,n)=>({real:i+e,imag:t+n})),Lo=xe(za,QS,mJ),iN={kernelName:za,backendName:"cpu",kernelFunc:Lo};function Jc(i,t,e,n,r){let o=L.sizeFromShape(n),s=L.makeZerosTypedArray(r,e);for(let a=0;a<i.length;a++){let l=i[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(o>0?s[l]+=t[a]:s[l]+=1)}return s}function J0(i,t,e,n=!1){let r=i.shape[0],o=i.shape[1],s=Yt([r,e],t.dtype);for(let a=0;a<r;a++)for(let l=0;l<o;l++){let c=i.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=e||(n?s.set(1,a,c):t.size>0?s.set(s.get(a,c)+t.get(a,l),a,c):s.set(s.get(a,c)+1,a,c))}return s}function Ki(i){return(t,e,n)=>{let r=L.getTypedArrayFromDType(e,t.length);for(let o=0;o<t.length;++o)r[o]=i(t[o],n);return r}}function Kt(i,t,e){return({inputs:n,attrs:r,backend:o})=>{let{x:s}=n;if(pt(s,i),s.dtype==="string"||e==="string")throw new Error("unaryKernelFunc does not support string input/output");let a=o,l=a.data.get(s.dataId).values,c=L.sizeFromShape(s.shape),u=e||s.dtype,h=L.getArrayFromDType(u,c);for(let p=0;p<c;++p)h[p]=t(l[p],r);return a.makeTensorInfo(s.shape,u,h)}}function Yi(i,t,e){return({inputs:n,attrs:r,backend:o})=>{let{x:s}=n;if(pt(s,i),s.dtype==="string"||e==="string")throw new Error("unaryKernelFunc does not support string input/output");let a=o,l=a.data.get(s.dataId).values,c=e||s.dtype,u=t(l,c,r);return a.makeTensorInfo(s.shape,c,u)}}var tC=Ki(i=>Math.ceil(i)),gJ=Yi(zp,tC),rN={kernelName:zp,backendName:"cpu",kernelFunc:gJ};function Q0(i,t,e,n){let r=L.getArrayFromDType(e,L.sizeFromShape(t));if(n&&e!=="string"){let o=0;i.forEach(s=>{let a=L.sizeFromShape(s.shape);r.set(s.vals,o),o+=a})}else{let o=0;i.forEach(s=>{let a=e==="string"?O.fromUint8ToStringArray(s.vals):s.vals,l=0;for(let c=0;c<s.shape[0];++c){let u=c*t[1]+o;for(let h=0;h<s.shape[1];++h)r[u+h]=a[l++]}o+=s.shape[1]})}return r}var eC=Ki(i=>Math.exp(i)),nC=Yi(Up,eC),oN={kernelName:Up,backendName:"cpu",kernelFunc:nC};var iC=Ki(i=>Math.expm1(i)),xJ=Yi(Wp,iC),sN={kernelName:Wp,backendName:"cpu",kernelFunc:xJ};var rC=Ki(i=>Math.floor(i)),yJ=Yi(Gp,rC),aN={kernelName:Gp,backendName:"cpu",kernelFunc:yJ};function tx(i,t,e){let n=Yt(e,i.dtype);for(let r=0;r<n.size;++r){let s=n.indexToLoc(r).slice(),a=s[0],l=s[2],c=t.locToIndex([a,l]);s[2]=t.values[c];let u=i.locToIndex(s);n.values[r]=i.values[u]}return n}var oC=ce((i,t)=>i>t?1:0),vJ=xe(qp,oC,null,"bool"),lN={kernelName:qp,backendName:"cpu",kernelFunc:vJ};var sC=ce((i,t)=>i<t?1:0),bJ=xe(Jp,sC,null,"bool"),cN={kernelName:Jp,backendName:"cpu",kernelFunc:bJ};function ex(i,t,e){let n=(t-i)/(e-1),r=L.makeZerosTypedArray(e,"float32");r[0]=i;for(let o=1;o<r.length;o++)r[o]=r[o-1]+n;return r}var aC=Ki(i=>Math.log(i)),_J=Yi(tf,aC),uN={kernelName:tf,backendName:"cpu",kernelFunc:_J};function nx(i,t,e,n){let r=L.getTypedArrayFromDType(n,L.sizeFromShape(e));for(let o=0;o<r.length;++o){let s=o*t,a=i[s];for(let l=0;l<t;++l){let c=i[s+l];c>a&&(a=c)}r[o]=a}return r}var lC=ce((i,t)=>Math.max(i,t)),wJ=xe(sf,lC),hN={kernelName:sf,backendName:"cpu",kernelFunc:wJ};var cC=ce((i,t)=>Math.min(i,t)),SJ=xe(af,cC),pN={kernelName:af,backendName:"cpu",kernelFunc:SJ};var Af=ce((i,t)=>i*t),CJ=Zc((i,t,e,n)=>({real:i*e-t*n,imag:i*n+t*e})),Ya=xe(Oa,Af,CJ),fN={kernelName:Oa,backendName:"cpu",kernelFunc:Ya};function uC(i,t,e){let n=L.createScalarValue(-1,e);return Af([],t,n,i,e)}function MJ(i){let{inputs:t,backend:e}=i,{x:n}=t;pt(n,"neg");let r=e.data.get(n.dataId).values,[o,s]=uC(r,n.shape,n.dtype);return e.makeTensorInfo(s,n.dtype,o)}var dN={kernelName:i0,backendName:"cpu",kernelFunc:MJ};var hC=ce((i,t)=>i!==t?1:0),EJ=xe(cf,hC,null,"bool"),mN={kernelName:cf,backendName:"cpu",kernelFunc:EJ};function Qc(i,t,e,n,r){let o=t.length,s=L.sizeFromShape(t),a=L.computeStrides(t),l=L.computeStrides(r),c=L.getTypedArrayFromDType(e,L.sizeFromShape(r));for(let u=0;u<s;++u){let h=L.indexToLoc(u,o,a),p=new Array(h.length);for(let d=0;d<p.length;d++)p[d]=h[n[d]];let f=L.locToIndex(p,o,l);c[f]=i[u]}return c}function Ke(i){let{inputs:t,attrs:e,backend:n}=i,{x:r}=t,{perm:o}=e;pt(r,"transpose");let s=r.shape.length,a=new Array(s);for(let h=0;h<a.length;h++)a[h]=r.shape[o[h]];let l=n.data.get(r.dataId).values,c=Qc(l,r.shape,r.dtype,o,a);return{dataId:n.write(c,a,r.dtype),shape:a,dtype:r.dtype}}var gN={kernelName:$c,backendName:"cpu",kernelFunc:Ke};function pC(i,t,e,n){let[r,o]=O.computeOutAndReduceShapes(i,n),s=dn(t,"int32"),a=L.makeZerosTypedArray(L.sizeFromShape(r),s),l=L.sizeFromShape(o);for(let c=0;c<a.length;++c){let u=c*l,h=1;for(let p=0;p<l;++p)h*=e[u+p];a[c]=h}return{outVals:a,outShape:r,outDtype:s}}function TJ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,keepDims:s}=n;pt(r,"prod");let a=r.shape.length,l=L.parseAxisParam(o,r.shape),c=O.getAxesPermutation(l,a),u=l,h=r,p=[];c!=null&&(h=Ke({inputs:{x:r},backend:e,attrs:{perm:c}}),p.push(h),u=O.getInnerMostAxes(u.length,a));let f=e.data.get(h.dataId).values,{outVals:d,outShape:m,outDtype:x}=pC(h.shape,h.dtype,f,u),g=m;return s&&(g=O.expandShapeToKeepDim(m,l)),p.forEach(y=>e.disposeIntermediateTensorInfo(y)),e.makeTensorInfo(g,x,d)}var xN={kernelName:u0,backendName:"cpu",kernelFunc:TJ};function ix(i,t,e,n){let r=i===t,o=i<t&&e<0,s=t<i&&e>1;if(r||o||s)return L.makeZerosTypedArray(0,n);let a=Math.abs(Math.ceil((t-i)/e)),l=L.makeZerosTypedArray(a,n);t<i&&e===1&&(e=-1),l[0]=i;for(let c=1;c<l.length;c++)l[c]=l[c-1]+e;return l}var fC=Ki(i=>1/Math.sqrt(i)),IJ=Yi(ff,fC),yN={kernelName:ff,backendName:"cpu",kernelFunc:IJ};function dC(i,t,e,n,r){let o=zn.isSliceContinous(n,t,e),s=L.sizeFromShape(e),a=L.computeStrides(n);if(o){let h=zn.computeFlatOffset(t,a);return r==="string"?i.slice(h,h+s):i.subarray(h,h+s)}let l=r==="string"?O.fromUint8ToStringArray(i):i,c=Yt(n,r,l),u=Yt(e,r);for(let h=0;h<u.size;++h){let p=u.indexToLoc(h),f=p.map((d,m)=>d+t[m]);u.set(c.get(...f),...p)}return r==="string"?O.fromStringArrayToUint8(u.values):u.values}function Zi(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{begin:o,size:s}=n;pt(r,"slice");let[a,l]=zn.parseSliceParams(r,o,s);zn.assertParamsValid(r,a,l);let c=e.data.get(r.dataId).values,u=dC(c,a,l,r.shape,r.dtype);return e.makeTensorInfo(l,r.dtype,u)}var vN={kernelName:b0,backendName:"cpu",kernelFunc:Zi};var mC=ce((i,t)=>{let e=i-t;return e*e}),AJ=xe(_f,mC),bN={kernelName:_f,backendName:"cpu",kernelFunc:AJ};function rx(i,t,e,n){let r=Yt(i,t.dtype);for(let o=0;o<r.size;o++){let s=r.indexToLoc(o),a=new Array(s.length);for(let l=0;l<a.length;l++)a[l]=s[l]*e[l]+n[l];r.set(t.get(...a),...s)}return r}var gC=ce((i,t)=>i-t),kJ=Zc((i,t,e,n)=>({real:i-e,imag:t-n})),kf=xe(Ha,gC,kJ),_N={kernelName:Ha,backendName:"cpu",kernelFunc:kf};function ox(i,t){let e=new Array(i.rank);for(let r=0;r<e.length;r++)e[r]=i.shape[r]*t[r];let n=Yt(e,i.dtype);for(let r=0;r<n.values.length;++r){let o=n.indexToLoc(r),s=new Array(i.rank);for(let l=0;l<s.length;l++)s[l]=o[l]%i.shape[l];let a=i.locToIndex(s);n.values[r]=i.values[a]}return n}function sx(i,t,e,n,r){let o=t[t.length-1],[s,a]=[i.length/o,o],l=L.getTypedArrayFromDType(e,s*n),c=L.getTypedArrayFromDType("int32",s*n);for(let h=0;h<s;h++){let p=h*a,f=i.subarray(p,p+a),d=[];for(let y=0;y<f.length;y++)d.push({value:f[y],index:y});d.sort((y,b)=>b.value-y.value);let m=h*n,x=l.subarray(m,m+n),g=c.subarray(m,m+n);for(let y=0;y<n;y++)x[y]=d[y].value,g[y]=d[y].index}let u=t.slice();return u[u.length-1]=n,[Yt(u,e,l),Yt(u,"int32",c)]}function ax(i,t,e,n){let r=L.parseAxisParam(t,e)[0],o=[1,e[0],1];for(let d=0;d<r;d++)o[0]*=e[d];o[1]=e[r];for(let d=r+1;d<e.length;d++)o[2]*=e[d];let s={},a=new Int32Array(e[r]),l=new Ie(o,n,i),c=[],u=o[0]===1&&o[2]===1;for(let d=0;d<e[r];d++){let m;if(u)m=i[d].toString();else{let x=[];for(let g=0;g<o[0];g++)for(let y=0;y<o[2];y++)x.push(l.get(g,d,y));m=x.join(",")}if(s[m]!==void 0)a[d]=s[m];else{let x=Object.keys(s).length;s[m]=x,a[d]=x,c.push(d)}}let h=o.slice();h[1]=Object.keys(s).length;let p=new Ie(h,n);c.forEach((d,m)=>{for(let x=0;x<o[0];x++)for(let g=0;g<o[2];g++)p.set(l.get(x,d,g),x,m,g)});let f=e.slice();return f[r]=h[1],{outputValues:p.values,outputShape:f,indices:a}}X0("cpu",()=>new Ka,1);var yC=Kt(Fa,i=>i>=0?i:Math.exp(i)-1),wN={kernelName:Fa,backendName:"cpu",kernelFunc:yC};function vC(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{alpha:o}=n;pt([r],"leakyRelu");let s=L.sizeFromShape(r.shape),a=e.data.get(r.dataId).values,l=L.getTypedArrayFromDType("float32",s);for(let c=0;c<a.length;c++)l[c]=a[c]<0?o*a[c]:a[c];return e.makeTensorInfo(r.shape,"float32",l)}var SN={kernelName:zc,backendName:"cpu",kernelFunc:vC};var RJ=ce((i,t)=>i<0?t*i:i);function bC(i){let{inputs:t,backend:e}=i,{x:n,alpha:r}=t;pt([n,r],"prelu");let o=e.data.get(n.dataId).values,s=e.data.get(r.dataId).values,[a,l]=RJ(n.shape,r.shape,o,s,n.dtype);return e.makeTensorInfo(l,n.dtype,a)}var CN={kernelName:Oc,backendName:"cpu",kernelFunc:bC};var _C=Kt(Ba,i=>Math.max(0,i)),MN={kernelName:Ba,backendName:"cpu",kernelFunc:_C};var wC=Kt(Va,i=>Math.min(Math.max(0,i),6)),EN={kernelName:Va,backendName:"cpu",kernelFunc:wC};function tu(i,t,e,n,r){if(e==="linear")return On({inputs:{x:t},backend:i});if(e==="relu")return _C({inputs:{x:t},backend:i});if(e==="elu")return yC({inputs:{x:t},backend:i});if(e==="relu6")return wC({inputs:{x:t},backend:i});if(e==="prelu")return bC({inputs:{x:t,alpha:n},backend:i});if(e==="leakyrelu")return vC({inputs:{x:t},backend:i,attrs:{alpha:r}});throw new Error(`Activation ${e} has not been implemented for the CPU backend.`)}function ue(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{shape:o}=n,s=L.sizeFromShape(r.shape),a=L.inferFromImplicitShape(o,s),l=L.sizeFromShape(a);L.assert(s===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`),e.incRef(r.dataId);let c=e.data.get(r.dataId);if(c.complexTensorInfos!=null){let u=c.complexTensorInfos.real,h=c.complexTensorInfos.imag;u.shape=a,h.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}var TN={kernelName:Bc,backendName:"cpu",kernelFunc:ue};function SC(i){let{inputs:t,backend:e,attrs:n}=i,{a:r,b:o}=t,{transposeA:s,transposeB:a}=n;pt([r,o],"matMul");let l=r.shape.length,c=o.shape.length,u=s?r.shape[l-2]:r.shape[l-1],h=a?o.shape[c-1]:o.shape[c-2],p=s?r.shape[l-1]:r.shape[l-2],f=a?o.shape[c-2]:o.shape[c-1],d=r.shape.slice(0,-2),m=o.shape.slice(0,-2),x=L.sizeFromShape(d),g=L.sizeFromShape(m),y=x===g||x===1||g===1;L.assert(l>=2&&c>=2&&y,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${d}) and (${m}).`);let v=(x>g?r.shape.slice(0,-2):o.shape.slice(0,-2)).concat([p,f]);L.assert(u===h,()=>`Error in matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${r.shape} and ${o.shape} and transposeA=${s} and transposeB=${a} must match.`);let _=s?[x,u,p]:[x,p,u],S=a?[g,f,h]:[g,h,f],E=ue({inputs:{x:r},backend:e,attrs:{shape:_}}),M=ue({inputs:{x:o},backend:e,attrs:{shape:S}}),N=s?E.shape[1]:E.shape[2],I=s?E.shape[2]:E.shape[1],w=a?M.shape[1]:M.shape[2],R=Math.max(x,g),P=e.data.get(E.dataId).values,D=e.data.get(M.dataId).values,F=L.computeStrides(E.shape),z=L.computeStrides(M.shape),[V,H,X]=s?[F[0],1,F[1]]:[F[0],F[1],1],[U,Y,Z]=a?[1,z[1],z[0]]:[z[1],1,z[0]],K=I*w,J=Yt([R,I,w],E.dtype),G=J.values,nt=e.blockSize;for(let et=0;et<R;et++)for(let at=0;at<I;at+=nt)for(let it=0;it<w;it+=nt)for(let St=0;St<N;St+=nt){let yt=Math.min(at+nt,I),rt=Math.min(it+nt,w),vt=Math.min(St+nt,N);for(let ct=at;ct<yt;ct++)for(let _t=it;_t<rt;_t++){let gt=0;for(let Pt=St;Pt<vt;Pt++){let Dt=Math.min(et,x-1)*V,Jt=Math.min(et,g-1)*Z,Qt=P[Dt+ct*H+Pt*X],re=D[Pt*U+_t*Y+Jt];gt+=Qt*re}G[et*K+(ct*w+_t)]+=gt}}return e.disposeIntermediateTensorInfo(E),e.disposeIntermediateTensorInfo(M),e.makeTensorInfo(v,J.dtype,J.values)}var IN={kernelName:Lc,backendName:"cpu",kernelFunc:SC};function PJ(i){let{inputs:t,backend:e,attrs:n}=i,{a:r,b:o,bias:s,preluActivationWeights:a}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=n,p,f,d,m=[];p=SC({inputs:{a:r,b:o},attrs:{transposeA:l,transposeB:c},backend:e}),s&&(f=Lo({inputs:{a:p,b:s},backend:e}),m.push(p),p=f),u&&(d=tu(e,p,u,a,h),m.push(p),p=d);for(let g of m)e.disposeIntermediateTensorInfo(g);return p}var AN={kernelName:L0,backendName:"cpu",kernelFunc:PJ};var NJ=Kt(Ap,i=>Math.acos(i)),kN={kernelName:Ap,backendName:"cpu",kernelFunc:NJ};var LJ=Kt(kp,i=>Math.acosh(i)),RN={kernelName:kp,backendName:"cpu",kernelFunc:LJ};function DJ(i){let{inputs:t,backend:e}=i,n=t;pt(t,"addN");let r=n.map(a=>e.data.get(a.dataId).values),o=Yt(n[0].shape,n[0].dtype),s=o.values;for(let a=0;a<n.length;a++){let l=r[a];for(let c=0;c<s.length;c++)s[c]+=l[c]}return e.makeTensorInfo(o.shape,o.dtype,o.values)}var PN={kernelName:o1,backendName:"cpu",kernelFunc:DJ};function zJ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,keepDims:s}=n;pt(r,"all");let a=L.parseAxisParam(o,r.shape),l=a,c=O.getAxesPermutation(l,r.shape.length),u=r;c!=null&&(u=Ke({inputs:{x:r},backend:e,attrs:{perm:c}}),l=O.getInnerMostAxes(l.length,r.shape.length)),O.assertAxesAreInnerMostDims("all",l,u.shape.length);let[h,p]=O.computeOutAndReduceShapes(u.shape,l),f=L.sizeFromShape(p),d=L.makeZerosTypedArray(L.sizeFromShape(h),u.dtype),m=e.data.get(u.dataId).values;for(let g=0;g<d.length;++g){let y=g*f,b=m[y];for(let v=0;v<f;++v){let _=m[y+v];b=b&&_}d[g]=b}c!=null&&e.disposeIntermediateTensorInfo(u);let x=e.makeTensorInfo(h,u.dtype,d);if(s){let g=O.expandShapeToKeepDim(h,a),y=ue({inputs:{x},backend:e,attrs:{shape:g}});return e.disposeIntermediateTensorInfo(x),y}return x}var NN={kernelName:s1,backendName:"cpu",kernelFunc:zJ};function FJ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,keepDims:s}=n;pt(r,"any");let a=L.parseAxisParam(o,r.shape),l=a,c=O.getAxesPermutation(l,r.shape.length),u=r;c!=null&&(u=Ke({inputs:{x:r},backend:e,attrs:{perm:c}}),l=O.getInnerMostAxes(l.length,r.shape.length)),O.assertAxesAreInnerMostDims("any",l,u.shape.length);let[h,p]=O.computeOutAndReduceShapes(u.shape,l),f=L.sizeFromShape(p),d=L.makeZerosTypedArray(L.sizeFromShape(h),u.dtype),m=e.data.get(u.dataId).values;for(let g=0;g<d.length;++g){let y=g*f,b=m[y];for(let v=0;v<f;++v){let _=m[y+v];b=b||_}d[g]=b}c!=null&&e.disposeIntermediateTensorInfo(u);let x=e.makeTensorInfo(h,u.dtype,d);if(s){let g=O.expandShapeToKeepDim(h,a),y=ue({inputs:{x},backend:e,attrs:{shape:g}});return e.disposeIntermediateTensorInfo(x),y}return x}var LN={kernelName:a1,backendName:"cpu",kernelFunc:FJ};function OJ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o}=n;pt(r,"argMax");let s=L.parseAxisParam(o,r.shape),a=O.getAxesPermutation(s,r.shape.length),l=r,c=[];a!=null&&(l=Ke({inputs:{x:r},backend:e,attrs:{perm:a}}),c.push(l),s=O.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],O.assertAxesAreInnerMostDims("argMax",s,l.shape.length);let[u,h]=O.computeOutAndReduceShapes(l.shape,s),p=L.sizeFromShape(u),f=L.makeZerosTypedArray(p,"int32"),d=L.sizeFromShape(h),m=e.data.get(l.dataId).values;for(let x=0;x<f.length;++x){let g=x*d,y=m[g],b=0;for(let v=0;v<d;++v){let _=m[g+v];_>y&&(y=_,b=v)}f[x]=b}return c.forEach(x=>e.disposeIntermediateTensorInfo(x)),e.makeTensorInfo(u,"int32",f)}var DN={kernelName:l1,backendName:"cpu",kernelFunc:OJ};function BJ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o}=n;pt(r,"argMin");let s=L.parseAxisParam(o,r.shape),a=O.getAxesPermutation(s,r.shape.length),l=r,c=[];a!=null&&(l=Ke({inputs:{x:r},backend:e,attrs:{perm:a}}),c.push(l),s=O.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],O.assertAxesAreInnerMostDims("argMin",s,l.shape.length);let[u,h]=O.computeOutAndReduceShapes(l.shape,s),p=L.sizeFromShape(u),f=L.makeZerosTypedArray(p,"int32"),d=L.sizeFromShape(h),m=e.data.get(l.dataId).values;for(let x=0;x<f.length;++x){let g=x*d,y=m[g],b=0;for(let v=0;v<d;++v){let _=m[g+v];_<y&&(y=_,b=v)}f[x]=b}return c.forEach(x=>e.disposeIntermediateTensorInfo(x)),e.makeTensorInfo(u,"int32",f)}var zN={kernelName:c1,backendName:"cpu",kernelFunc:BJ};var VJ=Kt(Rp,i=>Math.asin(i)),FN={kernelName:Rp,backendName:"cpu",kernelFunc:VJ};var HJ=Kt(Pp,i=>Math.asinh(i)),ON={kernelName:Pp,backendName:"cpu",kernelFunc:HJ};var $J=Kt(Np,i=>Math.atan(i)),BN={kernelName:Np,backendName:"cpu",kernelFunc:$J};var UJ=ce((i,t)=>Math.atan2(i,t)),WJ=xe(Dp,UJ),VN={kernelName:Dp,backendName:"cpu",kernelFunc:WJ};var GJ=Kt(Lp,i=>Math.atanh(i)),HN={kernelName:Lp,backendName:"cpu",kernelFunc:GJ};function eu(i,t,e,n,r,o){let s=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.top,f=r.padInfo.left,d=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Yt(r.outShape,e),x=m.values,g=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],b=r.outShape[3];for(let v=0;v<r.batchSize;++v){let _=v*g,S=v*n[0];for(let E=0;E<r.inChannels;++E)for(let M=0;M<r.outHeight;++M){let N=M*s-p,I=Math.max(0,N),w=Math.min(r.inHeight,u+N),R=_+M*y;for(let P=0;P<r.outWidth;++P){let D=P*a-f,F=Math.max(0,D),z=Math.min(r.inWidth,h+D),V=d,H=0,X=0;for(let Y=I;Y<w;Y+=l){let Z=S+Y*n[1];for(let K=F;K<z;K+=c){let J=Z+K*n[2],G=i[J+E];o==="max"&&G>V?V=G:o==="avg"&&(H+=G,X++)}if(isNaN(V))break}let U=R+P*b+E;x[U]=o==="avg"?H/X:V}}}return m}function lx(i,t,e,n,r=!1,o=!1){let s=Yt(n.outShape,"int32"),a=n.strideHeight,l=n.strideWidth,c=n.dilationHeight,u=n.dilationWidth,h=n.effectiveFilterHeight,p=n.effectiveFilterWidth,f=n.padInfo.top,d=n.padInfo.left,m=Yt(t,e,i);for(let x=0;x<n.batchSize;++x)for(let g=0;g<n.inChannels;++g)for(let y=0;y<n.outHeight;++y){let b=y*a-f,v=b;for(;v<0;)v+=c;let _=Math.min(n.inHeight,h+b);for(let S=0;S<n.outWidth;++S){let E=S*l-d,M=E;for(;M<0;)M+=u;let N=Math.min(n.inWidth,p+E),I=Number.NEGATIVE_INFINITY,w=-1;for(let R=v;R<_;R+=c){let P=R-b;for(let D=M;D<N;D+=u){let F=D-E,z=m.get(x,R,D,g);z>I&&(I=z,r?w=o?((x*n.inHeight+R)*n.inWidth+D)*n.inChannels+g:(R*n.inWidth+D)*n.inChannels+g:w=P*p+F)}}s.set(w,x,y,S,g)}}return s}function cx(i,t,e,n,r,o){let s=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,h=r.dilationWidth,p=r.effectiveFilterDepth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,m=r.padInfo.front,x=r.padInfo.top,g=r.padInfo.left,y=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Yt(r.outShape,e),v=b.values,_=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[2]*r.outShape[3]*r.outShape[4],E=r.outShape[3]*r.outShape[4],M=r.outShape[4];for(let N=0;N<r.batchSize;++N){let I=N*_,w=N*n[0];for(let R=0;R<r.inChannels;++R)for(let P=0;P<r.outDepth;++P){let D=P*s-m,F=D;for(;F<0;)F+=c;let z=Math.min(r.inDepth,p+D),V=I+P*S;for(let H=0;H<r.outHeight;++H){let X=H*a-x,U=X;for(;U<0;)U+=u;let Y=Math.min(r.inHeight,f+X),Z=V+H*E;for(let K=0;K<r.outWidth;++K){let J=K*l-g,G=J;for(;G<0;)G+=h;let nt=Math.min(r.inWidth,d+J),et=Z+K*M,at=y,it=0,St=0;for(let rt=F;rt<z;rt+=c){let vt=w+rt*n[1];for(let ct=U;ct<Y;ct+=u){let _t=vt+ct*n[2];for(let gt=G;gt<nt;gt+=h){let Pt=_t+gt*n[3],Dt=i[Pt+R];if(o==="max"&&Dt>at?at=Dt:o==="avg"&&(it+=Dt,St++),isNaN(at))break}if(isNaN(at))break}if(isNaN(at))break}let yt=et+R;v[yt]=o==="avg"?it/St:at}}}}return b}function $N(i,t){let e=Yt(t.outShape,"int32"),n=t.strideDepth,r=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,a=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=t.padInfo.front,f=t.padInfo.top,d=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let x=0;x<t.inChannels;++x)for(let g=0;g<t.outDepth;++g){let y=g*n-p,b=y;for(;b<0;)b+=s;let v=Math.min(t.inDepth,c+y);for(let _=0;_<t.outHeight;++_){let S=_*r-f,E=S;for(;E<0;)E+=a;let M=Math.min(t.inHeight,u+S);for(let N=0;N<t.outWidth;++N){let I=N*o-d,w=I;for(;w<0;)w+=l;let R=Math.min(t.inWidth,h+I),P=Number.NEGATIVE_INFINITY,D=-1;for(let F=b;F<v;F+=s){let z=F-y;for(let V=E;V<M;V+=a){let H=V-S;for(let X=w;X<R;X+=l){let U=X-I,Y=i.get(m,F,V,X,x);Y>=P&&(P=Y,D=z*u*h+H*u+U)}}}e.set(D,m,g,_,N,x)}}}return e}function jJ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t;pt(r,"avgPool");let{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=n,c=1;L.assert(O.eitherStridesOrDilationsAreOne(s,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let u=O.computePool2DInfo(r.shape,o,s,c,a,l),h;if(u.filterWidth===1&&u.filterHeight===1&&L.arraysEqual(u.inShape,u.outShape))h=On({inputs:{x:r},backend:e});else{let p=e.data.get(r.dataId).values,f=L.computeStrides(r.shape),d=eu(p,r.shape,r.dtype,f,u,"avg");h=e.makeTensorInfo(u.outShape,r.dtype,d.values)}return h}var UN={kernelName:u1,backendName:"cpu",kernelFunc:jJ};function qJ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{filterSize:o,strides:s,pad:a,dimRoundingMode:l,dataFormat:c}=n;pt(r,"avgPool3d");let u=O.computePool3DInfo(r.shape,o,s,1,a,l,c),h=e.data.get(r.dataId).values,p=cx(h,r.shape,r.dtype,L.computeStrides(r.shape),u,"avg");return e.makeTensorInfo(p.shape,"float32",p.values)}var WN={kernelName:p1,backendName:"cpu",kernelFunc:qJ};function XJ(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,input:o}=t,{filterSize:s,strides:a,pad:l,dimRoundingMode:c}=n;pt([r,o],"avgPool3DGrad");let u=O.computePool3DInfo(o.shape,s,a,1,l,c),h=u.strideDepth,p=u.strideHeight,f=u.strideWidth,d=u.filterDepth,m=u.filterHeight,x=u.filterWidth,g=u.dilationDepth,y=u.dilationHeight,b=u.dilationWidth,v=u.effectiveFilterDepth,_=u.effectiveFilterHeight,S=u.effectiveFilterWidth,E=v-1-u.padInfo.front,M=S-1-u.padInfo.left,N=_-1-u.padInfo.top,I=Yt(o.shape,"float32"),w=1/(d*m*x),R=e.bufferSync(r);for(let P=0;P<u.batchSize;++P)for(let D=0;D<u.inChannels;++D)for(let F=0;F<u.inDepth;++F)for(let z=0;z<u.inHeight;++z)for(let V=0;V<u.inWidth;++V){let H=F-E,X=z-N,U=V-M,Y=0;for(let Z=0;Z<v;Z+=g){let K=(H+Z)/h;if(!(K<0||K>=u.outDepth||Math.floor(K)!==K))for(let J=0;J<_;J+=y){let G=(X+J)/p;if(!(G<0||G>=u.outHeight||Math.floor(G)!==G))for(let nt=0;nt<S;nt+=b){let et=(U+nt)/f;if(et<0||et>=u.outWidth||Math.floor(et)!==et)continue;Y+=R.get(P,K,G,et,D)}}}I.set(Y*w,P,F,z,V,D)}return e.makeTensorInfo(I.shape,I.dtype,I.values)}var GN={kernelName:f1,backendName:"cpu",kernelFunc:XJ};function KJ(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,input:o}=t,s=o;pt([r,o],"avgPoolGrad");let{filterSize:a,strides:l,pad:c}=n,u=O.computePool2DInfo(s.shape,a,l,1,c),h=u.strideHeight,p=u.strideWidth,f=u.filterHeight,d=u.filterWidth,m=u.dilationHeight,x=u.dilationWidth,g=u.effectiveFilterHeight,y=u.effectiveFilterWidth,b=y-1-u.padInfo.left,v=g-1-u.padInfo.top,_=Yt(s.shape,"float32"),S=1/(f*d),E=e.data.get(r.dataId).values,M=Yt(r.shape,"float32",E);for(let N=0;N<u.batchSize;++N)for(let I=0;I<u.inChannels;++I)for(let w=0;w<u.inHeight;++w)for(let R=0;R<u.inWidth;++R){let P=w-v,D=R-b,F=0;for(let z=0;z<g;z+=m){let V=(P+z)/h;if(!(V<0||V>=u.outHeight||Math.floor(V)!==V))for(let H=0;H<y;H+=x){let X=(D+H)/p;if(X<0||X>=u.outWidth||Math.floor(X)!==X)continue;F+=M.get(N,V,X,I)}}_.set(F*S,N,w,R,I)}return e.makeTensorInfo(_.shape,_.dtype,_.values)}var jN={kernelName:h1,backendName:"cpu",kernelFunc:KJ};function YJ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,scale:o,offset:s,mean:a,variance:l}=t;L.assert(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),L.assert(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),L.assert(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),pt([r,a,l,o,s],"batchNorm");let{varianceEpsilon:c}=n;c==null&&(c=.001);let u=e.data.get(r.dataId).values,h=e.data.get(a.dataId).values,p=e.data.get(l.dataId).values,f=o?e.data.get(o.dataId).values:new Float32Array([1]),d=s?e.data.get(s.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),x=d.length,g=f.length,y=p.length,b=h.length,v=0,_=0,S=0,E=0;for(let M=0;M<u.length;++M)m[M]=d[v++]+(u[M]-h[_++])*f[S++]/Math.sqrt(p[E++]+c),v>=x&&(v=0),_>=b&&(_=0),S>=g&&(S=0),E>=y&&(E=0);return e.makeTensorInfo(r.shape,r.dtype,m)}var qN={kernelName:B1,backendName:"cpu",kernelFunc:YJ};function ZJ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{blockShape:o,crops:s}=n;pt([r],"batchToSpaceND");let a=o.reduce((g,y)=>g*y),l=O.getReshaped(r.shape,o,a),c=O.getPermuted(l.length,o.length),u=O.getReshapedPermuted(r.shape,o,a),h=O.getSliceBeginCoords(s,o.length),p=O.getSliceSize(u,s,o.length),f=ue({inputs:{x:r},backend:e,attrs:{shape:l}}),d=Ke({inputs:{x:f},backend:e,attrs:{perm:c}}),m=ue({inputs:{x:d},backend:e,attrs:{shape:u}}),x=Zi({inputs:{x:m},backend:e,attrs:{begin:h,size:p}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(m),x}var XN={kernelName:d1,backendName:"cpu",kernelFunc:ZJ};function JJ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,weights:o}=t,{size:s}=n,a=e.data.get(r.dataId).values,l=e.data.get(o.dataId).values,c=Jc(a,l,o.dtype,o.shape,s);return e.makeTensorInfo([s],o.dtype,c)}var KN={kernelName:m1,backendName:"cpu",kernelFunc:JJ};var QJ=Kt(Fp,(i,t)=>{let e=t;return i>e.clipValueMax?e.clipValueMax:i<e.clipValueMin?e.clipValueMin:i}),YN={kernelName:Fp,backendName:"cpu",kernelFunc:QJ};var tQ=i=>{let{x:t}=i.inputs,e=i.backend,n=new Float32Array(L.sizeFromShape(t.shape)),r=e.data.get(t.dataId),o=r.complexTensorInfos.real,s=r.complexTensorInfos.imag,a=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values;for(let c=0;c<a.length;c++){let u=a[c],h=l[c];n[c]=Math.hypot(u,h)}return e.makeOutput(n,t.shape,"float32")},ZN={kernelName:g1,backendName:"cpu",kernelFunc:tQ};function Zr(i){let{inputs:t,backend:e}=i,{input:n}=t,r=e.data.get(n.dataId).complexTensorInfos.imag,o=e.data.get(r.dataId).values;return e.makeTensorInfo(r.shape,r.dtype,o)}var JN={kernelName:U1,backendName:"cpu",kernelFunc:Zr};function _s(i){let{inputs:t,backend:e,attrs:n}=i,{axis:r}=n,o=L.parseAxisParam(r,t[0].shape)[0],s=O.computeOutShape(t.map(m=>m.shape),o);if(L.sizeFromShape(s)===0)return e.makeTensorInfo(s,t[0].dtype,[]);let a=t.filter(m=>L.sizeFromShape(m.shape)>0);if(a.length===1)return On({inputs:{x:a[0]},backend:e});let l=a.map(m=>m.shape);if(O.assertParamsConsistent(l,o),a[0].dtype==="complex64"){let m=a.map(v=>qi({inputs:{input:v},backend:e})),x=a.map(v=>Zr({inputs:{input:v},backend:e})),g=_s({inputs:m,backend:e,attrs:{axis:o}}),y=_s({inputs:x,backend:e,attrs:{axis:o}}),b=mn({inputs:{real:g,imag:y},backend:e});return m.forEach(v=>e.disposeIntermediateTensorInfo(v)),x.forEach(v=>e.disposeIntermediateTensorInfo(v)),e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(y),b}let c=a.map(m=>{let x=L.sizeFromShape(m.shape.slice(o));return ue({inputs:{x:m},backend:e,attrs:{shape:[-1,x]}})}),u=c.map(m=>({vals:e.data.get(m.dataId).values,shape:m.shape}));s=O.computeOutShape(c.map(m=>m.shape),1);let h=c[0].shape[0]===1,p=Q0(u,s,t[0].dtype,h),f=O.computeOutShape(a.map(m=>m.shape),o),d=e.makeTensorInfo(f,t[0].dtype,p);return c.forEach(m=>e.disposeIntermediateTensorInfo(m)),d}var QN={kernelName:x1,backendName:"cpu",kernelFunc:_s};function CC(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,filter:o}=t,{strides:s,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=n;pt([r,o],"conv2d");let h=O.convertConv2DDataFormat(l),p=O.computeConv2DInfo(r.shape,o.shape,s,c,a,u,!1,h),f=p.filterHeight,d=p.filterWidth,m=p.dilationHeight,x=p.dilationWidth,g=p.padInfo.left,y=p.padInfo.top,b=p.dataFormat==="channelsLast",v=new Ie(p.outShape,r.dtype),_=L.computeStrides(r.shape),S=L.computeStrides(o.shape),E=_[0],M=b?_[1]:_[2],N=b?_[2]:1,I=b?1:_[1],w=v.strides[0],R=b?v.strides[1]:v.strides[2],P=b?v.strides[2]:1,D=b?1:v.strides[1],F=e.data.get(r.dataId).values,z=e.data.get(o.dataId).values,V=v.values;for(let H=0;H<p.batchSize;++H){let X=H*E,U=H*w;for(let Y=0;Y<p.outHeight;++Y){let Z=U+Y*R,K=Y*p.strideHeight-y;for(let J=0;J<f;++J){let G=K+J*m;if(G<0||G>=p.inHeight)continue;let nt=J*S[0],et=X+G*M;for(let at=0;at<p.outWidth;++at){let it=Z+at*P,St=at*p.strideWidth-g;for(let yt=0;yt<d;++yt){let rt=St+yt*x;if(rt<0||rt>=p.inWidth)continue;let vt=nt+yt*S[1],ct=et+rt*N,_t=vt;for(let gt=0;gt<p.inChannels;++gt){let Pt=F[ct+gt*I];for(let Dt=0;Dt<p.outChannels;++Dt)V[it+Dt*D]+=Pt*z[_t+Dt];_t+=p.outChannels}}}}}}return e.makeTensorInfo(v.shape,v.dtype,V)}var tL={kernelName:y1,backendName:"cpu",kernelFunc:CC};function eQ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,dy:o}=t,{strides:s,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=n;pt([r,o],"conv2dBackpropFilter");let h=O.convertConv2DDataFormat(l),p=O.computeConv2DInfo(r.shape,u,s,1,a,c,!1,h),{strideHeight:f,strideWidth:d,filterHeight:m,filterWidth:x}=p,g=p.dataFormat==="channelsLast",y=new Ie(p.filterShape,"float32"),b=p.padInfo.left,v=p.padInfo.top,_=e.data.get(r.dataId).values,S=e.data.get(o.dataId).values,E=new Ie(r.shape,r.dtype,_),M=new Ie(o.shape,o.dtype,S);for(let N=0;N<m;++N){let I=Math.max(0,Math.ceil((v-N)/f)),w=Math.min(p.outHeight,(p.inHeight+v-N)/f);for(let R=0;R<x;++R){let P=Math.max(0,Math.ceil((b-R)/d)),D=Math.min(p.outWidth,(p.inWidth+b-R)/d);for(let F=0;F<p.inChannels;++F)for(let z=0;z<p.outChannels;++z){let V=0;for(let H=0;H<p.batchSize;++H)for(let X=I;X<w;++X){let U=N+X*f-v;for(let Y=P;Y<D;++Y){let Z=R+Y*d-b;g?V+=E.get(H,U,Z,F)*M.get(H,X,Y,z):V+=E.get(H,F,U,Z)*M.get(H,z,X,Y)}}y.set(V,N,R,F,z)}}}return e.makeTensorInfo(y.shape,y.dtype,y.values)}var eL={kernelName:v1,backendName:"cpu",kernelFunc:eQ};function nQ(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,filter:o}=t,{inputShape:s,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=n;pt([r,o],"conv2dBackpropInput");let h=L.computeStrides(o.shape),p=L.computeStrides(r.shape),f=O.convertConv2DDataFormat(c),d=O.computeConv2DInfo(s,o.shape,a,1,l,u,!1,f),m=new Ie(d.inShape,"float32"),x=m.values,g=e.data.get(r.dataId).values,y=e.data.get(o.dataId).values,[b,v,_]=h,{batchSize:S,filterHeight:E,filterWidth:M,inChannels:N,inHeight:I,inWidth:w,outChannels:R,outHeight:P,outWidth:D,strideHeight:F,strideWidth:z}=d;f=d.dataFormat;let V=E-1-d.padInfo.top,H=M-1-d.padInfo.left,X=f==="channelsLast",U=m.strides[0],Y=X?m.strides[1]:m.strides[2],Z=X?m.strides[2]:1,K=X?1:m.strides[1],J=p[0],G=X?p[1]:p[2],nt=X?p[2]:1,et=X?1:p[1];for(let at=0;at<S;++at)for(let it=0;it<N;++it)for(let St=0;St<I;++St){let yt=St-V,rt=Math.max(0,Math.ceil(yt/F)),vt=Math.min(P,(E+yt)/F);for(let ct=0;ct<w;++ct){let _t=ct-H,gt=Math.max(0,Math.ceil(_t/z)),Pt=Math.min(D,(M+_t)/z),Dt=0;for(let Qt=rt;Qt<vt;++Qt){let re=Qt*F-yt;for(let j=gt;j<Pt;++j){let $=j*z-_t,ft=J*at+G*Qt+nt*j,kt=b*(E-1-re)+v*(M-1-$)+_*it;for(let Vt=0;Vt<R;++Vt){let mt=g[ft+et*Vt],Ut=y[kt+Vt];Dt+=mt*Ut}}}let Jt=U*at+Y*St+Z*ct+K*it;x[Jt]=Dt}}return e.makeTensorInfo(m.shape,m.dtype,m.values)}var nL={kernelName:b1,backendName:"cpu",kernelFunc:nQ};function iQ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,filter:o}=t,{strides:s,pad:a,dilations:l}=n;pt([r,o],"conv3d");let c=O.computeConv3DInfo(r.shape,o.shape,s,l,a),{filterDepth:u,filterHeight:h,filterWidth:p,dilationDepth:f,dilationHeight:d,dilationWidth:m,padInfo:x}=c,g=x.front,y=x.left,b=x.top,v=new Ie(c.outShape,r.dtype),_=e.data.get(r.dataId).values,S=e.data.get(o.dataId).values,E=v.values,M=L.computeStrides(r.shape),N=L.computeStrides(o.shape);for(let I=0;I<c.batchSize;++I){let w=I*M[0],R=I*v.strides[0];for(let P=0;P<c.outDepth;++P){let D=R+P*v.strides[1],F=P*c.strideDepth-g;for(let z=0;z<u;++z){let V=F+z*f;if(V<0||V>=c.inDepth)continue;let H=z*N[0],X=w+V*M[1];for(let U=0;U<c.outHeight;++U){let Y=D+U*v.strides[2],Z=U*c.strideHeight-b;for(let K=0;K<h;++K){let J=Z+K*d;if(J<0||J>=c.inHeight)continue;let G=H+K*N[1],nt=X+J*M[2];for(let et=0;et<c.outWidth;++et){let at=Y+et*c.outChannels,it=et*c.strideWidth-y;for(let St=0;St<p;++St){let yt=it+St*m;if(yt<0||yt>=c.inWidth)continue;let rt=G+St*N[2],vt=nt+yt*c.inChannels,ct=rt;for(let _t=0;_t<c.inChannels;++_t){let gt=_[vt+_t];for(let Pt=0;Pt<c.outChannels;++Pt)E[at+Pt]+=gt*S[ct+Pt];ct+=c.outChannels}}}}}}}}return e.makeTensorInfo(v.shape,v.dtype,v.values)}var iL={kernelName:_1,backendName:"cpu",kernelFunc:iQ};function rQ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,dy:o}=t,{strides:s,pad:a,filterShape:l}=n;pt([r,o],"conv3dBackpropFilterV2");let c=L.computeStrides(r.shape),u=L.computeStrides(o.shape),h=O.computeConv3DInfo(r.shape,l,s,1,a),p=h.strideDepth,f=h.strideHeight,d=h.strideWidth,m=h.filterDepth,x=h.filterHeight,g=h.filterWidth,y=new Ie(h.filterShape,"float32"),b=y.values,[v,_,S,E]=y.strides,M=e.data.get(o.dataId).values,[N,I,w,R]=u,P=e.data.get(r.dataId).values,[D,F,z,V]=c,H=h.padInfo.front,X=h.padInfo.left,U=h.padInfo.top;for(let Y=0;Y<m;++Y){let Z=Math.max(0,Math.ceil((H-Y)/p)),K=Math.min(h.outDepth,(h.inDepth+H-Y)/p),J=Y*v;for(let G=0;G<x;++G){let nt=Math.max(0,Math.ceil((U-G)/f)),et=Math.min(h.outHeight,(h.inHeight+U-G)/f),at=G*_+J;for(let it=0;it<g;++it){let St=Math.max(0,Math.ceil((X-it)/d)),yt=Math.min(h.outWidth,(h.inWidth+X-it)/d),rt=it*S+at;for(let vt=0;vt<h.inChannels;++vt){let ct=vt*E+rt;for(let _t=0;_t<h.outChannels;++_t){let gt=0;for(let Pt=0;Pt<h.batchSize;++Pt){let Dt=Pt*D,Jt=Pt*N;for(let Qt=Z;Qt<K;++Qt){let j=(Y+Qt*p-H)*F+Dt,$=Qt*I+Jt;for(let ft=nt;ft<et;++ft){let Vt=(G+ft*f-U)*z+j,mt=ft*w+$;for(let Ut=St;Ut<yt;++Ut){let xt=(it+Ut*d-X)*V+Vt,At=Ut*R+mt;gt+=P[xt+vt]*M[At+_t]}}}}b[ct+_t]=gt}}}}}return e.makeTensorInfo(y.shape,y.dtype,y.values)}var rL={kernelName:w1,backendName:"cpu",kernelFunc:rQ};function oQ(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,filter:o}=t,{pad:s,strides:a,inputShape:l}=n;pt([r],"conv3dBackpropInputV2");let c=L.computeStrides(r.shape),u=L.computeStrides(o.shape),h=O.computeConv3DInfo(l,o.shape,a,1,s),p=new Ie(h.inShape,"float32"),f=p.values,[d,m,x,g]=p.strides,y=e.data.get(r.dataId).values,[b,v,_,S]=c,E=e.data.get(o.dataId).values,[M,N,I,w]=u,{batchSize:R,filterDepth:P,filterHeight:D,filterWidth:F,inChannels:z,inDepth:V,inHeight:H,inWidth:X,outChannels:U,outDepth:Y,outHeight:Z,outWidth:K,strideDepth:J,strideHeight:G,strideWidth:nt}=h,et=P-1-h.padInfo.front,at=D-1-h.padInfo.top,it=F-1-h.padInfo.left;for(let St=0;St<R;++St)for(let yt=0;yt<z;++yt)for(let rt=0;rt<V;++rt){let vt=rt-et,ct=Math.max(0,Math.ceil(vt/J)),_t=Math.min(Y,(P+vt)/J);for(let gt=0;gt<H;++gt){let Pt=gt-at,Dt=Math.max(0,Math.ceil(Pt/G)),Jt=Math.min(Z,(D+Pt)/G);for(let Qt=0;Qt<X;++Qt){let re=Qt-it,j=Math.max(0,Math.ceil(re/nt)),$=Math.min(K,(F+re)/nt),ft=0;for(let kt=ct;kt<_t;++kt){let Vt=kt*J-vt;for(let mt=Dt;mt<Jt;++mt){let Ut=mt*G-Pt;for(let Q=j;Q<$;++Q){let xt=Q*nt-re,At=b*St+v*kt+_*mt+S*Q,jt=M*(P-1-Vt)+N*(D-1-Ut)+I*(F-1-xt)+w*yt;for(let tt=0;tt<U;++tt){let Ht=y[At+tt],Ft=E[jt+tt];ft+=Ht*Ft}}}}f[d*St+m*rt+x*gt+g*Qt+yt]=ft}}}return e.makeTensorInfo(p.shape,p.dtype,p.values)}var oL={kernelName:S1,backendName:"cpu",kernelFunc:oQ};var sQ=Kt(Op,i=>Math.cos(i)),sL={kernelName:Op,backendName:"cpu",kernelFunc:sQ};var aQ=Kt(Bp,i=>Math.cosh(i)),aL={kernelName:Bp,backendName:"cpu",kernelFunc:aQ};function lQ(i){let{inputs:t,backend:e,attrs:n}=i,{image:r,boxes:o,boxInd:s}=t,{cropSize:a,method:l,extrapolationValue:c}=n,[u,h,p,f]=r.shape,d=o.shape[0],[m,x]=a,g=Yt([d,m,x,f],"float32"),y=e.data.get(o.dataId).values,b=e.data.get(s.dataId).values,v=e.data.get(r.dataId).values,_=L.computeStrides(r.shape),S=L.computeStrides(g.shape);for(let E=0;E<d;E++){let M=E*4,N=y[M],I=y[M+1],w=y[M+2],R=y[M+3],P=b[E];if(P>=u)continue;let D=m>1?(w-N)*(h-1)/(m-1):0,F=x>1?(R-I)*(p-1)/(x-1):0;for(let z=0;z<m;z++){let V=m>1?N*(h-1)+z*D:.5*(N+w)*(h-1);if(V<0||V>h-1){for(let H=0;H<x;H++)for(let X=0;X<f;X++){let U=X+H*S[2]+z*S[1]+E*S[0];g.values[U]=c}continue}if(l==="bilinear"){let H=Math.floor(V),X=Math.ceil(V),U=V-H;for(let Y=0;Y<x;Y++){let Z=x>1?I*(p-1)+Y*F:.5*(I+R)*(p-1);if(Z<0||Z>p-1){for(let nt=0;nt<f;nt++){let et=nt+Y*S[2]+z*S[1]+E*S[0];g.values[et]=c}continue}let K=Math.floor(Z),J=Math.ceil(Z),G=Z-K;for(let nt=0;nt<f;nt++){let et=nt+K*_[2]+H*_[1]+P*_[0],at=v[et];et=nt+J*_[2]+H*_[1]+P*_[0];let it=v[et];et=nt+K*_[2]+X*_[1]+P*_[0];let St=v[et];et=nt+J*_[2]+X*_[1]+P*_[0];let yt=v[et],rt=at+(it-at)*G,vt=St+(yt-St)*G;et=nt+Y*S[2]+z*S[1]+E*S[0],g.values[et]=rt+(vt-rt)*U}}}else for(let H=0;H<x;++H){let X=x>1?I*(p-1)+H*F:.5*(I+R)*(p-1);if(X<0||X>p-1){for(let Z=0;Z<f;Z++){let K=Z+H*S[2]+z*S[1]+E*S[0];g.values[K]=c}continue}let U=Math.round(X),Y=Math.round(V);for(let Z=0;Z<f;Z++){let K=Z+U*_[2]+Y*_[1]+P*_[0],J=Z+H*S[2]+z*S[1]+E*S[0];g.values[J]=v[K]}}}}return e.makeTensorInfo(g.shape,g.dtype,g.values)}var lL={kernelName:M1,backendName:"cpu",kernelFunc:lQ};function cQ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,exclusive:s,reverse:a}=n;pt(r,"cumsum");let l=O.getAxesPermutation([o],r.shape.length),c=r;l!=null&&(c=Ke({inputs:{x:r},backend:e,attrs:{perm:l}}));let u=O.getInnerMostAxes(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);let h=dn(c.dtype,"int32"),p=L.makeZerosTypedArray(L.sizeFromShape(c.shape),h),f=e.data.get(c.dataId).values,d=c.shape[c.shape.length-1],m=a?(g,y)=>g+d-y-1:(g,y)=>g+y;for(let g=0;g<f.length;g+=d)for(let y=0;y<d;y++){let b=m(g,y);if(y===0)p[b]=s?0:f[b];else{let v=m(g,y-1);p[b]=s?f[v]+p[v]:f[b]+p[v]}}let x=e.makeTensorInfo(c.shape,h,p);if(l!=null){let g=O.getUndoAxesPermutation(l),y=Ke({inputs:{x},backend:e,attrs:{perm:g}});return e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(c),y}return x}var cL={kernelName:C1,backendName:"cpu",kernelFunc:cQ};function uQ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,weights:o}=t,{size:s,binaryOutput:a}=n;if(r.shape.length===1){let l=e.data.get(r.dataId).values,c=e.data.get(o.dataId).values,u=Jc(l,c,o.dtype,o.shape,s);return e.makeTensorInfo([s],o.dtype,u)}else if(r.shape.length===2){let l=e.bufferSync(r),c=e.bufferSync(o),u=J0(l,c,s,a);return e.makeTensorInfo(u.shape,o.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}var uL={kernelName:E1,backendName:"cpu",kernelFunc:uQ};function hQ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{blockSize:o,dataFormat:s}=n;L.assert(s==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${s}`),L.assert(o>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${o}`);let a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],h=l*o,p=c*o,f=u/(o*o),d=e.data.get(r.dataId).values,m=new Float32Array(a*h*p*f),x=0;for(let g=0;g<a;++g)for(let y=0;y<h;++y){let b=Math.floor(y/o),v=y%o;for(let _=0;_<p;++_){let S=Math.floor(_/o),E=_%o,M=(v*o+E)*f;for(let N=0;N<f;++N){let w=N+M+u*(S+c*(b+l*g));m[x++]=d[w]}}}return e.makeTensorInfo([a,h,p,f],r.dtype,m)}var hL={kernelName:T1,backendName:"cpu",kernelFunc:hQ};function MC(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,filter:o}=t,{strides:s,pad:a,dilations:l,dimRoundingMode:c}=n;pt([r,o],"depthwiseConv2DNative");let u=L.computeStrides(r.shape),h=L.computeStrides(o.shape),p=l;p==null&&(p=[1,1]),L.assert(O.eitherStridesOrDilationsAreOne(s,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${p}'`);let f=O.computeConv2DInfo(r.shape,o.shape,s,p,a,c,!0),{filterHeight:d,filterWidth:m,dilationHeight:x,dilationWidth:g,padInfo:y}=f,b=y.left,v=y.top,_=f.outChannels/f.inChannels,S=new Ie(f.outShape,r.dtype),E=e.data.get(r.dataId).values,M=e.data.get(o.dataId).values,N=S.values;for(let I=0;I<f.batchSize;++I){let w=I*u[0],R=I*S.strides[0];for(let P=0;P<f.outHeight;++P){let D=R+P*S.strides[1],F=P*f.strideHeight-b;for(let z=0;z<d;++z){let V=F+z*x;if(V<0||V>=f.inHeight)continue;let H=z*h[0],X=w+V*u[1];for(let U=0;U<f.outWidth;++U){let Y=D+U*S.strides[2],Z=U*f.strideWidth-v;for(let K=0;K<m;++K){let J=Z+K*g;if(J<0||J>=f.inWidth)continue;let G=H+K*h[1],nt=X+J*f.inChannels,et=Y,at=G;for(let it=0;it<f.inChannels;++it){let St=E[nt+it];for(let yt=0;yt<_;++yt)N[et+yt]+=St*M[at+yt];et+=_,at+=_}}}}}}return e.makeTensorInfo(S.shape,S.dtype,S.values)}var pL={kernelName:I1,backendName:"cpu",kernelFunc:MC};function pQ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,dy:o}=t,{strides:s,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=n;pt([r,o],"depthwiseConv2dNativeBackpropFilter");let h=O.computeConv2DInfo(r.shape,u,s,a,l,c,!0),{strideHeight:p,strideWidth:f,filterHeight:d,filterWidth:m}=h,x=new Ie(h.filterShape,"float32"),g=h.padInfo.left,y=h.padInfo.top,b=h.outChannels/h.inChannels,v=e.data.get(r.dataId).values,_=new Ie(r.shape,r.dtype,v),S=e.data.get(o.dataId).values,E=new Ie(o.shape,o.dtype,S);for(let M=0;M<d;++M){let N=Math.max(0,Math.ceil((y-M)/p)),I=Math.min(h.outHeight,(h.inHeight+y-M)/p);for(let w=0;w<m;++w){let R=Math.max(0,Math.ceil((g-w)/f)),P=Math.min(h.outWidth,(h.inWidth+g-w)/f);for(let D=0;D<h.outChannels;++D){let F=Math.trunc(D/b),z=D%b,V=0;for(let H=0;H<h.batchSize;++H)for(let X=N;X<I;++X){let U=M+X*p-y;for(let Y=R;Y<P;++Y){let Z=w+Y*f-g;V+=_.get(H,U,Z,F)*E.get(H,X,Y,D)}}x.set(V,M,w,F,z)}}}return e.makeTensorInfo(x.shape,x.dtype,x.values)}var fL={kernelName:A1,backendName:"cpu",kernelFunc:pQ};function fQ(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,filter:o}=t,{strides:s,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=n;pt([r,o],"depthwiseConv2DNativeBackpropInput");let h=L.computeStrides(r.shape),p=L.computeStrides(o.shape),f=O.computeConv2DInfo(u,o.shape,s,a,l,c,!0),d=new Ie(f.inShape,"float32"),m=d.values,[x,g,y]=d.strides,b=e.data.get(r.dataId).values,[v,_,S]=h,E=e.data.get(o.dataId).values,[M,N,I]=p,{batchSize:w,filterHeight:R,filterWidth:P,inChannels:D,inHeight:F,inWidth:z,outChannels:V,outHeight:H,outWidth:X,strideHeight:U,strideWidth:Y}=f,Z=R-1-f.padInfo.top,K=P-1-f.padInfo.left,J=V/D;for(let G=0;G<w;++G)for(let nt=0;nt<D;++nt)for(let et=0;et<F;++et){let at=et-Z,it=Math.max(0,Math.ceil(at/U)),St=Math.min(H,(R+at)/U);for(let yt=0;yt<z;++yt){let rt=yt-K,vt=Math.max(0,Math.ceil(rt/Y)),ct=Math.min(X,(P+rt)/Y),_t=0;for(let gt=it;gt<St;++gt){let Pt=gt*U-at;for(let Dt=vt;Dt<ct;++Dt){let Jt=Dt*Y-rt,Qt=v*G+_*gt+S*Dt,re=M*(R-1-Pt)+N*(P-1-Jt)+I*nt;for(let j=0;j<J;++j){let $=nt*J+j,ft=b[Qt+$],kt=E[re+j];_t+=ft*kt}}}m[x*G+g*et+y*yt+nt]=_t}}return e.makeTensorInfo(d.shape,d.dtype,d.values)}var dL={kernelName:k1,backendName:"cpu",kernelFunc:fQ};function dQ(i){let{inputs:t,backend:e}=i,{x:n}=t,r=L.sizeFromShape(n.shape),o=e.data.get(n.dataId).values,s=Yt([r,r],n.dtype),a=s.values;for(let c=0;c<o.length;c++)a[c*r+c]=o[c];let l=[...n.shape,...n.shape];return e.makeTensorInfo(l,s.dtype,s.values)}var mL={kernelName:R1,backendName:"cpu",kernelFunc:dQ};var gL={kernelName:P1,backendName:"cpu",kernelFunc:({inputs:i,backend:t,attrs:e})=>{let{x:n,filter:r}=i,{strides:o,pad:s,dilations:a}=e,l=t,c=l.data.get(n.dataId).values,u=n.shape.length,h=l.data.get(r.dataId).values,p=r.shape.length,{batchSize:f,inHeight:d,inWidth:m,inChannels:x,outHeight:g,outWidth:y,padInfo:b,strideHeight:v,strideWidth:_,filterHeight:S,filterWidth:E,dilationHeight:M,dilationWidth:N,outShape:I}=O.computeDilation2DInfo(n.shape,r.shape,o,s,"NHWC",a),w=L.sizeFromShape(I),R=I.length,P=L.getArrayFromDType(n.dtype,w);for(let F=0;F<f;++F)for(let z=0;z<g;++z){let V=z*v-b.top;for(let H=0;H<y;++H){let X=H*_-b.left;for(let U=0;U<x;++U){let Y=Number.MIN_SAFE_INTEGER;for(let K=0;K<S;++K){let J=V+K*M;if(J>=0&&J<d)for(let G=0;G<E;++G){let nt=X+G*N;if(nt>=0&&nt<m){let et=L.locToIndex([F,J,nt,U],u,L.computeStrides(n.shape)),at=L.locToIndex([K,G,U],p,L.computeStrides(r.shape)),it=c[et]+h[at];it>Y&&(Y=it)}}}let Z=L.locToIndex([F,z,H,U],R,L.computeStrides(I));P[Z]=Y}}}return{dataId:l.write(L.toTypedArray(P,n.dtype),I,n.dtype),shape:I,dtype:n.dtype}}};var xL={kernelName:aS,backendName:"cpu",kernelFunc:({inputs:i,backend:t,attrs:e})=>{let{x:n,filter:r,dy:o}=i,{strides:s,pad:a,dilations:l}=e,c=t,u=L.toNestedArray(n.shape,c.data.get(n.dataId).values),h=L.toNestedArray(r.shape,c.data.get(r.dataId).values),{batchSize:p,inHeight:f,inWidth:d,inChannels:m,outHeight:x,outWidth:g,padInfo:y,strideHeight:b,strideWidth:v,filterHeight:_,filterWidth:S,dilationHeight:E,dilationWidth:M,outShape:N}=O.computeDilation2DInfo(n.shape,r.shape,s,a,"NHWC",l);L.assert(o.rank===N.length,()=>`Error in ${aS}, dy must have the same rank as output ${N.length}, but got ${o.rank}`);let I=L.toNestedArray(N,c.data.get(o.dataId).values),w=L.makeZerosNestedTypedArray(r.shape,r.dtype);for(let P=0;P<p;++P)for(let D=0;D<x;++D){let F=D*b-y.top;for(let z=0;z<g;++z){let V=z*v-y.left;for(let H=0;H<m;++H){let X=Number.MIN_SAFE_INTEGER,U=0,Y=0;for(let Z=0;Z<_;++Z){let K=F+Z*E;if(K>=0&&K<f)for(let J=0;J<S;++J){let G=V+J*M;if(G>=0&&G<d){let nt=u[P][K][G][H]+h[Z][J][H];nt>X&&(X=nt,U=Z,Y=J)}}}w[U][Y][H]+=I[P][D][z][H]}}}return{dataId:c.write(L.toTypedArray(w,n.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};var yL={kernelName:sS,backendName:"cpu",kernelFunc:({inputs:i,backend:t,attrs:e})=>{let{x:n,filter:r,dy:o}=i,{strides:s,pad:a,dilations:l}=e,c=t,u=L.toNestedArray(n.shape,c.data.get(n.dataId).values),h=L.toNestedArray(r.shape,c.data.get(r.dataId).values),{batchSize:p,inHeight:f,inWidth:d,inChannels:m,outHeight:x,outWidth:g,padInfo:y,strideHeight:b,strideWidth:v,filterHeight:_,filterWidth:S,dilationHeight:E,dilationWidth:M,outShape:N}=O.computeDilation2DInfo(n.shape,r.shape,s,a,"NHWC",l);L.assert(o.rank===N.length,()=>`Error in ${sS}, dy must have the same rank as output ${N.length}, but got ${o.rank}`);let I=L.toNestedArray(N,c.data.get(o.dataId).values),w=L.makeZerosNestedTypedArray(n.shape,n.dtype);for(let P=0;P<p;++P)for(let D=0;D<x;++D){let F=D*b-y.top;for(let z=0;z<g;++z){let V=z*v-y.left;for(let H=0;H<m;++H){let X=Number.MIN_SAFE_INTEGER,U=F<0?0:F,Y=V<0?0:V;for(let Z=0;Z<_;++Z){let K=F+Z*E;if(K>=0&&K<f)for(let J=0;J<S;++J){let G=V+J*M;if(G>=0&&G<d){let nt=u[P][K][G][H]+h[Z][J][H];nt>X&&(X=nt,U=K,Y=G)}}}w[P][U][Y][H]+=I[P][D][z][H]}}}return{dataId:c.write(L.toTypedArray(w,n.dtype),n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};function Do(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,keepDims:s}=n;pt(r,"sum");let a;r.dtype==="bool"?a=Xi({inputs:{x:r},backend:e,attrs:{dtype:"int32"}}):a=On({inputs:{x:r},backend:e});let l=a.shape.length,c=L.parseAxisParam(o,a.shape),u=O.getAxesPermutation(c,l),h=c,p=a;u!=null&&(p=Ke({inputs:{x:a},backend:e,attrs:{perm:u}}),h=O.getInnerMostAxes(h.length,l)),O.assertAxesAreInnerMostDims("sum",h,p.shape.length);let[f,d]=O.computeOutAndReduceShapes(p.shape,h),m=O.upcastType(p.dtype,"int32"),x=Yc(e,f,m),g=L.sizeFromShape(d),y=e.data.get(x.dataId).values,b=e.data.get(p.dataId).values;for(let v=0;v<y.length;++v){let _=v*g,S=0;for(let E=0;E<g;++E)S+=b[_+E];y[v]=S}if(s){let v=O.expandShapeToKeepDim(x.shape,c),_=x;x=ue({inputs:{x},backend:e,attrs:{shape:v}}),e.disposeIntermediateTensorInfo(_)}return e.disposeIntermediateTensorInfo(a),u!=null&&e.disposeIntermediateTensorInfo(p),x}var vL={kernelName:Vc,backendName:"cpu",kernelFunc:Do};function mQ(i){let{inputs:t,backend:e,attrs:n}=i,{equation:r}=n,o=t,{allDims:s,summedDims:a,idDims:l}=O.decodeEinsumEquation(r,o.length);O.checkEinsumDimSizes(s.length,l,o);let{path:c,steps:u}=O.getEinsumComputePath(a,l),h=u.length,p=null,f=s.length,d=[];for(let m=0;m<h;++m){for(let x of u[m]){let{permutationIndices:g,expandDims:y}=O.getEinsumPermutation(f,l[x]),b;O.isIdentityPermutation(g)?b=o[x]:(b=Ke({inputs:{x:o[x]},backend:e,attrs:{perm:g}}),d.push(b));let v=b.shape.slice();for(let _=0;_<y.length;++_)v.splice(y[_],0,1);L.arraysEqual(b.shape,v)||(b=ue({inputs:{x:b},backend:e,attrs:{shape:v}}),d.push(b)),p===null?p=b:(p=Ya({inputs:{a:b,b:p},backend:e}),d.push(p))}m<h-1&&(c[m]>=0&&(p=Do({inputs:{x:p},backend:e,attrs:{axis:c[m]-(s.length-f),keepDims:!1}}),d.push(p)),f--)}for(let m of d)m!==p&&e.disposeIntermediateTensorInfo(m);return p}var bL={kernelName:N1,backendName:"cpu",kernelFunc:mQ};function gQ(i){let{inputs:t,backend:e}=i,{dy:n,y:r}=t;pt([n,r],"eluGrad");let o=new Float32Array(L.sizeFromShape(r.shape)),s=e.data.get(r.dataId).values,a=e.data.get(n.dataId).values;for(let l=0;l<s.length;++l){let c=s[l];c>=1?o[l]=a[l]:o[l]=a[l]*(c+1)}return e.makeTensorInfo(r.shape,"float32",o)}var _L={kernelName:L1,backendName:"cpu",kernelFunc:gQ};var xQ=ce((i,t)=>i===t?1:0),EC=xe($p,xQ,null,"bool"),wL={kernelName:$p,backendName:"cpu",kernelFunc:EC};var yQ=O.ERF_P,vQ=O.ERF_A1,bQ=O.ERF_A2,_Q=O.ERF_A3,wQ=O.ERF_A4,SQ=O.ERF_A5,CQ=Kt(Hp,i=>{let t=Math.sign(i),e=Math.abs(i),n=1/(1+yQ*e);return t*(1-((((SQ*n+wQ)*n+_Q)*n+bQ)*n+vQ)*n*Math.exp(-e*e))}),SL={kernelName:Hp,backendName:"cpu",kernelFunc:CQ};function nu(i){let{inputs:t,backend:e,attrs:n}=i,{input:r}=t,{dim:o}=n,s=r.shape.length,a=r.shape.slice(),l=o;return o<0&&(L.assert(-(s+1)<=o,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+o+1),a.splice(l,0,1),ue({inputs:{x:r},backend:e,attrs:{shape:a}})}var CL={kernelName:D1,backendName:"cpu",kernelFunc:nu};var MQ=ce((i,t)=>i/t),Rf=xe(Vp,MQ),Pf={kernelName:Vp,backendName:"cpu",kernelFunc:Rf};function ux(i,t,e){let n=i.shape,r=n[0],o=n[1],s=e.data.get(i.dataId),a=s.complexTensorInfos.real,l=s.complexTensorInfos.imag,c=[r,o],u=L.sizeFromShape(c),h=L.getTypedArrayFromDType("float32",u),p=L.getTypedArrayFromDType("float32",u);for(let x=0;x<r;x++){let g=Zi({inputs:{x:a},backend:e,attrs:{begin:[x,0],size:[1,o]}}),y=Zi({inputs:{x:l},backend:e,attrs:{begin:[x,0],size:[1,o]}}),b=mn({inputs:{real:g,imag:y},backend:e}),{real:v,imag:_}=EQ(b,t,e),S=O.mergeRealAndImagArrays(v,_);for(let E=0;E<o;E++){let M=O.getComplexWithIndex(S,E);h[x*o+E]=M.real,p[x*o+E]=M.imag}e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(b)}let f=e.makeTensorInfo(c,"float32",h),d=e.makeTensorInfo(c,"float32",p),m=mn({inputs:{real:f,imag:d},backend:e});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(d),m}function EQ(i,t,e){let n=L.sizeFromShape(i.shape),r=e.data.get(i.dataId),o=e.data.get(r.complexTensorInfos.real.dataId).values,s=e.data.get(r.complexTensorInfos.imag.dataId).values;if(TQ(n)){let a=TC(o,s,n,t,e),l=[i.shape[0],i.shape[1]];if(t){let c=e.makeTensorInfo(l,"float32",a.real),u=e.makeTensorInfo(l,"float32",a.imag),h=e.makeTensorInfo([],"float32",L.createScalarValue(n,"float32")),p=On({inputs:{x:h},backend:e}),f=Pf.kernelFunc({inputs:{a:c,b:h},backend:e}),d=Pf.kernelFunc({inputs:{a:u,b:p},backend:e}),m=e.data.get(f.dataId).values,x=e.data.get(d.dataId).values;return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(d),{real:m,imag:x}}return a}else{let a=O.mergeRealAndImagArrays(o,s),l=IQ(a,n,t);return O.splitRealAndImagArrays(l)}}function TQ(i){return(i&i-1)===0}function TC(i,t,e,n,r){if(e===1)return{real:i,imag:t};let o=O.mergeRealAndImagArrays(i,t),s=e/2,a=O.complexWithEvenIndex(o),l=a.real,c=a.imag,u=[l.length],h=r.makeTensorInfo(u,"float32",l),p=r.makeTensorInfo(u,"float32",c),f=mn({inputs:{real:h,imag:p},backend:r}),d=O.complexWithOddIndex(o),m=d.real,x=d.imag,g=[m.length],y=r.makeTensorInfo(g,"float32",m),b=r.makeTensorInfo(g,"float32",x),v=mn({inputs:{real:y,imag:b},backend:r}),_=TC(l,c,s,n,r),S=_.real,E=_.imag,M=[S.length],N=r.makeTensorInfo(M,"float32",S),I=r.makeTensorInfo(M,"float32",E),w=mn({inputs:{real:N,imag:I},backend:r}),R=TC(m,x,s,n,r),P=R.real,D=R.imag,F=[P.length],z=r.makeTensorInfo(F,"float32",P),V=r.makeTensorInfo(F,"float32",D),H=mn({inputs:{real:z,imag:V},backend:r}),X=O.exponents(e,n),U=[X.real.length],Y=r.makeTensorInfo(U,"float32",X.real),Z=r.makeTensorInfo(U,"float32",X.imag),K=mn({inputs:{real:Y,imag:Z},backend:r}),J=Ya({inputs:{a:K,b:H},backend:r}),G=Lo({inputs:{a:w,b:J},backend:r}),nt=kf({inputs:{a:w,b:J},backend:r}),et=qi({inputs:{input:G},backend:r}),at=qi({inputs:{input:nt},backend:r}),it=Zr({inputs:{input:G},backend:r}),St=Zr({inputs:{input:nt},backend:r}),yt=_s({inputs:[et,at],backend:r,attrs:{axis:0}}),rt=_s({inputs:[it,St],backend:r,attrs:{axis:0}}),vt=r.data.get(yt.dataId).values,ct=r.data.get(rt.dataId).values;return r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(N),r.disposeIntermediateTensorInfo(I),r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(z),r.disposeIntermediateTensorInfo(V),r.disposeIntermediateTensorInfo(H),r.disposeIntermediateTensorInfo(Y),r.disposeIntermediateTensorInfo(Z),r.disposeIntermediateTensorInfo(K),r.disposeIntermediateTensorInfo(J),r.disposeIntermediateTensorInfo(G),r.disposeIntermediateTensorInfo(nt),r.disposeIntermediateTensorInfo(et),r.disposeIntermediateTensorInfo(it),r.disposeIntermediateTensorInfo(at),r.disposeIntermediateTensorInfo(St),r.disposeIntermediateTensorInfo(yt),r.disposeIntermediateTensorInfo(rt),{real:vt,imag:ct}}function IQ(i,t,e){let n=new Float32Array(t*2);for(let r=0;r<t;r++){let o=0,s=0;for(let a=0;a<t;a++){let l=O.exponent(r*a,t,e),c=O.getComplexWithIndex(i,a);o+=c.real*l.real-c.imag*l.imag,s+=c.real*l.imag+c.imag*l.real}e&&(o/=t,s/=t),O.assignToTypedArray(n,o,s,r)}return n}function AQ(i){let{inputs:t,backend:e}=i,{input:n}=t,r=L.sizeFromShape(n.shape),o=n.shape[n.shape.length-1],s=r/o,a=ue({inputs:{x:n},backend:e,attrs:{shape:[s,o]}}),l=ux(a,!1,e),c=ue({inputs:{x:l},backend:e,attrs:{shape:n.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(l),c}var ML={kernelName:z1,backendName:"cpu",kernelFunc:AQ};function Nf(i){let{backend:t,attrs:e}=i,{shape:n,value:r,dtype:o}=e,s=o||L.inferDtype(r),a=L.getArrayFromDType(s,L.sizeFromShape(n));return kQ(a,r,s),t.makeTensorInfo(n,s,a)}var EL={kernelName:F1,backendName:"cpu",kernelFunc:Nf};function kQ(i,t,e){i.fill(t)}var TL={kernelName:O1,backendName:"cpu",kernelFunc:({inputs:i,attrs:t,backend:e})=>{let{image:n}=i,r=e,o=L.getTypedArrayFromDType(n.dtype,L.sizeFromShape(n.shape)),[s,a,l,c]=n.shape,u=r.data.get(n.dataId).values;for(let p=0;p<s;p++){let f=p*l*a*c;for(let d=0;d<a;d++){let m=d*(l*c);for(let x=0;x<l;x++){let g=x*c;for(let y=0;y<c;y++){let v=[s,d,x,y][2],_=Math.round(l-v),S=f+m+g+y,E=u[S];if(_>=0&&_<l){let M=_*c,N=f+m+M+y;E=u[N]}o[S]=E}}}}return{dataId:r.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};var RQ=ce((i,t)=>Math.floor(i/t)),PQ=xe(jp,RQ,null,"int32"),IL={kernelName:jp,backendName:"cpu",kernelFunc:PQ};function NQ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,filter:o,bias:s,preluActivationWeights:a}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:d}=n,m=CC({inputs:{x:r,filter:o},backend:e,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p}});if(s){let x=m;m=Lo({inputs:{a:m,b:s},backend:e}),e.disposeIntermediateTensorInfo(x)}if(f){let x=m;m=tu(e,m,f,a,d),e.disposeIntermediateTensorInfo(x)}return m}var AL={kernelName:D0,backendName:"cpu",kernelFunc:NQ};function LQ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,filter:o,bias:s,preluActivationWeights:a}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:d}=n,m=MC({inputs:{x:r,filter:o},backend:e,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p}});if(s){let x=m;m=Lo({inputs:{a:m,b:s},backend:e}),e.disposeIntermediateTensorInfo(x)}if(f){let x=m;m=tu(e,m,f,a,d),e.disposeIntermediateTensorInfo(x)}return m}var kL={kernelName:z0,backendName:"cpu",kernelFunc:LQ};function DQ(i){let{inputs:t,backend:e}=i,{params:n,indices:r}=t,o=L.sizeFromShape(n.shape),s=r.shape,a=s[s.length-1],[l,c,u,h]=O.prepareAndValidate(n,r);if(c===0)return e.makeTensorInfo(l,n.dtype,[]);let p=Yt([c,u],n.dtype),f=e.data.get(r.dataId).values,d=e.data.get(n.dataId).values;for(let m=0;m<c;m++){let x=[],g=0;for(let y=0;y<a;y++){let b=f[m*a+y];g+=b*h[y],x.push(b)}if(g<0||g>=o/u)throw new Error(`Invalid indices: ${x} does not index into ${n.shape}`);for(let y=0;y<u;y++)p.values[m*u+y]=d[g*u+y]}return e.makeTensorInfo(l,p.dtype,p.values)}var RL={kernelName:H1,backendName:"cpu",kernelFunc:DQ};function zQ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,indices:o}=t,{axis:s,batchDims:a}=n;pt([r,o],"gatherV2");let l=a;a==null&&(l=0);let c=L.sizeFromShape(o.shape),u=L.parseAxisParam(s,r.shape)[0],h=O.segment_util.collectGatherOpShapeInfo(r,o,u,l),p=ue({inputs:{x:r},backend:e,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),f=ue({inputs:{x:o},backend:e,attrs:{shape:[h.batchSize,c/h.batchSize]}}),d=[h.batchSize,h.outerSize,c/h.batchSize,h.sliceSize],m=e.bufferSync(f),x=e.bufferSync(p),g=tx(x,m,d);return e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(f),e.makeTensorInfo(h.outputShape,g.dtype,g.values)}var PL={kernelName:V1,backendName:"cpu",kernelFunc:zQ};var FQ=ce((i,t)=>i>=t?1:0),OQ=xe(Xp,FQ,null,"bool"),NL={kernelName:Xp,backendName:"cpu",kernelFunc:OQ};function BQ(i){let{inputs:t,backend:e}=i,{input:n}=t,r=L.sizeFromShape(n.shape),o=n.shape[n.shape.length-1],s=r/o,a=ue({inputs:{x:n},backend:e,attrs:{shape:[s,o]}}),l=ux(a,!0,e),c=ue({inputs:{x:l},backend:e,attrs:{shape:n.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(l),c}var LL={kernelName:$1,backendName:"cpu",kernelFunc:BQ};var VQ=Kt(Kp,i=>Number.isFinite(i)?1:0,"bool"),DL={kernelName:Kp,backendName:"cpu",kernelFunc:VQ};var HQ=Kt(Yp,i=>Math.abs(i)===1/0?1:0,"bool"),zL={kernelName:Yp,backendName:"cpu",kernelFunc:HQ};var $Q=Kt(Zp,i=>Number.isNaN(i)?1:0,"bool"),FL={kernelName:Zp,backendName:"cpu",kernelFunc:$Q};var UQ=ce((i,t)=>i<=t?1:0),WQ=xe(Qp,UQ,null,"bool"),OL={kernelName:Qp,backendName:"cpu",kernelFunc:WQ};function GQ(i){let{backend:t,attrs:e}=i,{start:n,stop:r,num:o}=e,s=ex(n,r,o);return t.makeTensorInfo([s.length],"float32",s)}var BL={kernelName:W1,backendName:"cpu",kernelFunc:GQ};var jQ=Kt(ef,i=>Math.log1p(i)),VL={kernelName:ef,backendName:"cpu",kernelFunc:jQ};var qQ=ce((i,t)=>i&&t),XQ=xe(nf,qQ,null,"bool"),HL={kernelName:nf,backendName:"cpu",kernelFunc:XQ};var KQ=Kt(rf,i=>i?0:1,"bool"),$L={kernelName:rf,backendName:"cpu",kernelFunc:KQ};var YQ=ce((i,t)=>i||t),ZQ=xe(of,YQ,null,"bool"),UL={kernelName:of,backendName:"cpu",kernelFunc:ZQ};function JQ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{depthRadius:o,bias:s,alpha:a,beta:l}=n;pt(r,"LRN");let c=r.shape[3],u=c-1,h=e.data.get(r.dataId).values,p=L.sizeFromShape(r.shape),f=new Float32Array(p);function d(m){let x=m%c,g=m-x+Math.max(0,x-o),y=m-x+Math.min(x+o,u),b=0;for(;g<=y;g++){let v=h[g];b+=v*v}return b}for(let m=0;m<p;m++){let x=d(m),g=h[m]*Math.pow(s+a*x,-l);f[m]=g}return e.makeTensorInfo(r.shape,r.dtype,f)}var WL={kernelName:G1,backendName:"cpu",kernelFunc:JQ};function QQ(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,y:o,dy:s}=t,{depthRadius:a,bias:l,alpha:c,beta:u}=n;pt(s,"LRNGrad");let h=L.sizeFromShape(s.shape),p=s.shape[3],f=e.data.get(s.dataId).values,d=e.data.get(r.dataId).values,m=e.data.get(o.dataId).values,x=new Float32Array(h),g=h;for(let y=0;y<g;y++){let b=y%p,v=y-b+Math.max(0,b-a),_=y-b+Math.min(p,b+a+1),S=0;for(let E=v;E<_;E++)S+=Math.pow(d[E],2);S=c*S+l;for(let E=v;E<_;E++){let M=-2*c*u*d[E]*m[y]/S;y===E&&(M+=Math.pow(S,-u)),M*=f[y],x[E]+=M}}return e.makeTensorInfo(s.shape,r.dtype,x)}var GL={kernelName:j1,backendName:"cpu",kernelFunc:QQ};function IC(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{reductionIndices:o,keepDims:s}=n,a=e,l=r.shape,c=l.length,u=L.parseAxisParam(o,l),h=u,p=O.getAxesPermutation(h,c),f=a.data.get(r.dataId).values;if(p!=null){let v=new Array(c);for(let _=0;_<v.length;_++)v[_]=l[p[_]];f=Qc(f,l,r.dtype,p,v),h=O.getInnerMostAxes(h.length,c),l=v}pt(r,"max"),O.assertAxesAreInnerMostDims("max",h,c);let[d,m]=O.computeOutAndReduceShapes(l,h),x=L.sizeFromShape(m),g=nx(f,x,d,r.dtype),y=a.write(g,d,r.dtype),b=d;return s&&(b=O.expandShapeToKeepDim(d,u)),{dataId:y,shape:b,dtype:r.dtype}}var jL={kernelName:q1,backendName:"cpu",kernelFunc:IC};function ttt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t;pt(r,"maxPool");let{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=n,c=1;L.assert(O.eitherStridesOrDilationsAreOne(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let u=O.computePool2DInfo(r.shape,o,s,c,a,l),h;if(u.filterWidth===1&&u.filterHeight===1&&L.arraysEqual(u.inShape,u.outShape))h=On({inputs:{x:r},backend:e});else{let p=e.data.get(r.dataId).values,f=L.computeStrides(r.shape),d=eu(p,r.shape,r.dtype,f,u,"max");h=e.makeTensorInfo(u.outShape,r.dtype,d.values)}return h}var qL={kernelName:X1,backendName:"cpu",kernelFunc:ttt};function ett(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{filterSize:o,strides:s,pad:a,dimRoundingMode:l,dataFormat:c}=n;pt(r,"maxPool3d");let u=O.computePool3DInfo(r.shape,o,s,1,a,l,c),h=e.data.get(r.dataId).values,p=cx(h,r.shape,r.dtype,L.computeStrides(r.shape),u,"max");return e.makeTensorInfo(p.shape,"float32",p.values)}var XL={kernelName:Y1,backendName:"cpu",kernelFunc:ett};function ntt(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,input:o}=t,{filterSize:s,strides:a,pad:l,dimRoundingMode:c}=n;pt([r,o],"maxPool3DGrad");let u=O.computePool3DInfo(o.shape,s,a,1,l,c),h=e.bufferSync(o),p=$N(h,u),f=u.strideDepth,d=u.strideHeight,m=u.strideWidth,x=u.dilationDepth,g=u.dilationHeight,y=u.dilationWidth,b=u.effectiveFilterDepth,v=u.effectiveFilterHeight,_=u.effectiveFilterWidth,S=b-1-u.padInfo.front,E=_-1-u.padInfo.left,M=v-1-u.padInfo.top,N=Yt(o.shape,"float32"),I=e.bufferSync(r);for(let w=0;w<u.batchSize;++w)for(let R=0;R<u.inChannels;++R)for(let P=0;P<u.inDepth;++P)for(let D=0;D<u.inHeight;++D)for(let F=0;F<u.inWidth;++F){let z=P-S,V=D-M,H=F-E,X=0;for(let U=0;U<b;U+=x){let Y=(z+U)/f;if(!(Y<0||Y>=u.outDepth||Math.floor(Y)!==Y))for(let Z=0;Z<v;Z+=g){let K=(V+Z)/d;if(!(K<0||K>=u.outHeight||Math.floor(K)!==K))for(let J=0;J<_;J+=y){let G=(H+J)/m;if(G<0||G>=u.outWidth||Math.floor(G)!==G)continue;let nt=b*v*_-1-p.get(w,Y,K,G,R),et=U*v*_+Z*_+J,at=nt===et?1:0;if(at===0)continue;X+=I.get(w,Y,K,G,R)*at}}}N.set(X,w,P,D,F,R)}return e.makeTensorInfo(N.shape,N.dtype,N.values)}var KL={kernelName:Z1,backendName:"cpu",kernelFunc:ntt};function itt(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,input:o,output:s}=t,a=o;pt([o,s],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=n,p=O.computePool2DInfo(a.shape,l,c,1,u,h),f=e.data.get(a.dataId).values,d=Yt(p.outShape,a.dtype,lx(f,a.shape,a.dtype,p).values),m=p.strideHeight,x=p.strideWidth,g=p.dilationHeight,y=p.dilationWidth,b=p.effectiveFilterHeight,v=p.effectiveFilterWidth,_=v-1-p.padInfo.left,S=b-1-p.padInfo.top,E=Yt(a.shape,"float32"),M=e.data.get(r.dataId).values,N=Yt(r.shape,"float32",M);for(let I=0;I<p.batchSize;++I)for(let w=0;w<p.inChannels;++w)for(let R=0;R<p.inHeight;++R)for(let P=0;P<p.inWidth;++P){let D=R-S,F=P-_,z=0;for(let V=0;V<b;V+=g){let H=(D+V)/m;if(!(H<0||H>=p.outHeight||Math.floor(H)!==H))for(let X=0;X<v;X+=y){let U=(F+X)/x;if(U<0||U>=p.outWidth||Math.floor(U)!==U)continue;let Y=b*v-1-d.get(I,H,U,w),Z=V*v+X,K=Y===Z?1:0;if(K===0)continue;z+=N.get(I,H,U,w)*K}}E.set(z,I,R,P,w)}return e.makeTensorInfo(E.shape,E.dtype,E.values)}var YL={kernelName:K1,backendName:"cpu",kernelFunc:itt};function ZL(i,t,e,n,r){let o=L.computeStrides(t),s=eu(i,t,e,o,r,"max"),a=lx(i,t,e,r,!0,n);return[s.values,a.values]}var JL={kernelName:J1,backendName:"cpu",kernelFunc:({inputs:i,attrs:t,backend:e})=>{let{x:n}=i,{filterSize:r,strides:o,pad:s,includeBatchInIndex:a}=t,l=e;pt(n,"MaxPoolWithArgmax");let c=l.data.get(n.dataId).values,u=O.computePool2DInfo(n.shape,r,o,[1,1],s),[h,p]=ZL(c,n.shape,n.dtype,a,u),f=l.write(h,u.outShape,n.dtype),d=l.write(p,u.outShape,n.dtype);return[{dataId:f,shape:u.outShape,dtype:n.dtype},{dataId:d,shape:u.outShape,dtype:"int32"}]}};function rtt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,keepDims:s}=n,a=L.parseAxisParam(o,r.shape),c=O.computeOutAndReduceShapes(r.shape,a)[1],u=L.sizeFromShape(c),h=[],p=e.makeTensorInfo([],"float32",new Float32Array([u]));h.push(p);let f=Xi({inputs:{x:r},backend:e,attrs:{dtype:"float32"}});h.push(f);let d=Rf({inputs:{a:f,b:p},backend:e});h.push(d);let m=Do({inputs:{x:d},backend:e,attrs:{axis:o,keepDims:s}});return h.forEach(x=>e.disposeIntermediateTensorInfo(x)),m}var QL={kernelName:Q1,backendName:"cpu",kernelFunc:rtt};function ott(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,keepDims:s}=n;pt(r,"min");let a=L.parseAxisParam(o,r.shape),l=a,c=O.getAxesPermutation(l,r.shape.length),u=r;c!=null&&(u=Ke({inputs:{x:r},backend:e,attrs:{perm:c}}),l=O.getInnerMostAxes(l.length,r.shape.length)),O.assertAxesAreInnerMostDims("min",l,u.shape.length);let[h,p]=O.computeOutAndReduceShapes(u.shape,l),f=L.sizeFromShape(p),d=L.makeZerosTypedArray(L.sizeFromShape(h),u.dtype),m=e.data.get(u.dataId).values;for(let g=0;g<d.length;++g){let y=g*f,b=m[y];for(let v=0;v<f;++v){let _=m[y+v];_<b&&(b=_)}d[g]=b}c!=null&&e.disposeIntermediateTensorInfo(u);let x=e.makeTensorInfo(h,u.dtype,d);if(s){let g=O.expandShapeToKeepDim(h,a),y=ue({inputs:{x},backend:e,attrs:{shape:g}});return e.disposeIntermediateTensorInfo(x),y}return x}var t6={kernelName:t0,backendName:"cpu",kernelFunc:ott};function stt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{paddings:o,mode:s}=n;pt(r,"mirrorPad");let a=o.map((b,v)=>b[0]+r.shape[v]+b[1]),l=o.map(b=>b[0]),c=o.map((b,v)=>b[0]+r.shape[v]),u=s==="reflect"?0:1,h=e.data.get(r.dataId).values,p=r.shape.length,f=L.computeStrides(r.shape),d=L.sizeFromShape(a),m=a.length,x=L.computeStrides(a),g=L.getTypedArrayFromDType(r.dtype,d);for(let b=0;b<d;b++){let v=L.indexToLoc(b,m,x);for(let S=0;S<m;S++)v[S]<l[S]?v[S]=l[S]*2-v[S]-u:v[S]>=c[S]&&(v[S]=(c[S]-1)*2-v[S]+u);v=v.map((S,E)=>S-l[E]);let _=L.locToIndex(v,p,f);g[b]=h[_]}return{dataId:e.write(g,a,r.dtype),shape:a,dtype:r.dtype}}var e6={kernelName:e0,backendName:"cpu",kernelFunc:stt};var att=ce((i,t)=>{let e=i%t;return i<0&&t<0||i>=0&&t>=0?e:(e+t)%t}),ltt=xe(lf,att),n6={kernelName:lf,backendName:"cpu",kernelFunc:ltt};var r6=zh(VP());function AC(i){let{inputs:t,backend:e,attrs:n}=i,{logits:r}=t,{dim:o}=n,s=r.shape.length,a=o;if(a===-1&&(a=s-1),a!==s-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${s} and dim was ${a}`);let l=L.parseAxisParam([a],r.shape),c=IC({inputs:{x:r},backend:e,attrs:{reductionIndices:l,keepDims:!1}}),u=O.expandShapeToKeepDim(c.shape,l),h=ue({inputs:{x:c},backend:e,attrs:{shape:u}}),p=kf({inputs:{a:r,b:h},backend:e}),f=nC({inputs:{x:p},backend:e}),d=Do({inputs:{x:f},backend:e,attrs:{axis:l,keepDims:!1}}),m=ue({inputs:{x:d},backend:e,attrs:{shape:u}}),x=Rf({inputs:{a:f,b:m},backend:e});return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(m),x}var i6={kernelName:w0,backendName:"cpu",kernelFunc:AC};function ctt(i){let{inputs:t,backend:e,attrs:n}=i,{logits:r}=t,{numSamples:o,seed:s,normalized:a}=n;pt(r,"multinomial");let l=a?r:AC({inputs:{logits:r},backend:e,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],h=e.data.get(l.dataId).values,p=[c,o],f=L.makeZerosTypedArray(L.sizeFromShape(p),"int32");for(let d=0;d<c;++d){let m=d*u,x=new Float32Array(u-1);x[0]=h[m];for(let b=1;b<x.length;++b)x[b]=x[b-1]+h[m+b];let g=r6.alea(s.toString()),y=d*o;for(let b=0;b<o;++b){let v=g();f[y+b]=x.length;for(let _=0;_<x.length;_++)if(v<x[_]){f[y+b]=_;break}}}return a||e.disposeIntermediateTensorInfo(l),e.makeTensorInfo(p,"int32",f)}var o6={kernelName:n0,backendName:"cpu",kernelFunc:ctt};var utt=Fn.nonMaxSuppressionV3Impl;function htt(i){let{inputs:t,backend:e,attrs:n}=i,{boxes:r,scores:o}=t,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l}=n;pt(r,"NonMaxSuppression");let c=e.data.get(r.dataId).values,u=e.data.get(o.dataId).values,{selectedIndices:h}=utt(c,u,s,a,l);return e.makeTensorInfo([h.length],"int32",new Int32Array(h))}var s6={kernelName:r0,backendName:"cpu",kernelFunc:htt};var ptt=Fn.nonMaxSuppressionV4Impl;function ftt(i){let{inputs:t,backend:e,attrs:n}=i,{boxes:r,scores:o}=t,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=n;pt(r,"NonMaxSuppressionPadded");let u=e.data.get(r.dataId).values,h=e.data.get(o.dataId).values,{selectedIndices:p,validOutputs:f}=ptt(u,h,s,a,l,c);return[e.makeTensorInfo([p.length],"int32",new Int32Array(p)),e.makeTensorInfo([],"int32",new Int32Array([f]))]}var a6={kernelName:o0,backendName:"cpu",kernelFunc:ftt};var dtt=Fn.nonMaxSuppressionV5Impl;function mtt(i){let{inputs:t,backend:e,attrs:n}=i,{boxes:r,scores:o}=t,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=n;pt(r,"NonMaxSuppressionWithScore");let u=e.data.get(r.dataId).values,h=e.data.get(o.dataId).values,p=s,f=a,d=l,m=c,{selectedIndices:x,selectedScores:g}=dtt(u,h,p,f,d,m);return[e.makeTensorInfo([x.length],"int32",new Int32Array(x)),e.makeTensorInfo([g.length],"float32",new Float32Array(g))]}var l6={kernelName:s0,backendName:"cpu",kernelFunc:mtt};function gtt(i){let{inputs:t,backend:e,attrs:n}=i,{indices:r}=t,{depth:o,onValue:s,offValue:a}=n;pt(r,"oneHot");let l=L.sizeFromShape(r.shape),c=new Float32Array(l*o);c.fill(a);let u=e.data.get(r.dataId).values;for(let h=0;h<l;++h)u[h]>=0&&u[h]<o&&(c[h*o+u[h]]=s);return e.makeTensorInfo([...r.shape,o],"int32",c)}var c6={kernelName:l0,backendName:"cpu",kernelFunc:gtt};function Lf(i){let{inputs:t,backend:e}=i,{x:n}=t;if(n.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(n.dtype==="complex64"){let r=qi({inputs:{input:n},backend:e}),o=Lf({inputs:{x:r},backend:e}),s=Zr({inputs:{input:n},backend:e}),a=Lf({inputs:{x:s},backend:e}),l=mn({inputs:{real:o,imag:a},backend:e});return e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(a),l}else return Nf({backend:e,attrs:{shape:n.shape,value:0,dtype:n.dtype}})}var u6={kernelName:P0,backendName:"cpu",kernelFunc:Lf};function h6(i){let{inputs:t,backend:e}=i,{x:n}=t;if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(n.dtype==="complex64"){let r=qi({inputs:{input:n},backend:e}),o=h6({inputs:{x:r},backend:e}),s=Zr({inputs:{input:n},backend:e}),a=Lf({inputs:{x:s},backend:e}),l=mn({inputs:{real:o,imag:a},backend:e});return e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(a),l}else return Nf({backend:e,attrs:{shape:n.shape,value:1,dtype:n.dtype}})}var p6={kernelName:a0,backendName:"cpu",kernelFunc:h6};function kC(i){let{inputs:t,backend:e,attrs:n}=i,{axis:r}=n;if(t.length===1)return nu({inputs:{input:t[0]},backend:e,attrs:{dim:r}});let o=t[0].shape,s=t[0].dtype;t.forEach(u=>{L.assertShapesMatch(o,u.shape,"All tensors passed to stack must have matching shapes"),L.assert(s===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let a=[],l=t.map(u=>{let h=nu({inputs:{input:u},backend:e,attrs:{dim:r}});return a.push(h),h}),c=_s({inputs:l,backend:e,attrs:{axis:r}});return a.forEach(u=>e.disposeIntermediateTensorInfo(u)),c}var f6={kernelName:c0,backendName:"cpu",kernelFunc:kC};function xtt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{paddings:o,constantValue:s}=n;pt(r,"pad");let a=o.map((y,b)=>y[0]+r.shape[b]+y[1]),l=o.map(y=>y[0]),c=e.data.get(r.dataId).values,u=L.sizeFromShape(r.shape),h=r.shape.length,p=L.computeStrides(r.shape),f=L.sizeFromShape(a),d=a.length,m=L.computeStrides(a),x=L.getTypedArrayFromDType(r.dtype,f);s!==0&&x.fill(s);for(let y=0;y<u;y++){let v=L.indexToLoc(y,h,p).map((S,E)=>S+l[E]),_=L.locToIndex(v,d,m);x[_]=c[y]}return{dataId:e.write(x,a,r.dtype),shape:a,dtype:r.dtype}}var hx={kernelName:Fc,backendName:"cpu",kernelFunc:xtt};var ytt=ce((i,t)=>Math.pow(i,t)),vtt=xe(uf,ytt),d6={kernelName:uf,backendName:"cpu",kernelFunc:vtt};function btt(i){let{backend:t,attrs:e}=i,{start:n,stop:r,dtype:o,step:s}=e,a=ix(n,r,s,o);return t.makeTensorInfo([a.length],o,a)}var m6={kernelName:h0,backendName:"cpu",kernelFunc:btt};var _tt=Kt(hf,i=>1/i),g6={kernelName:hf,backendName:"cpu",kernelFunc:_tt};function wtt(i){let{inputs:t,backend:e,attrs:n}=i,{images:r}=t,{alignCorners:o,halfPixelCenters:s,size:a}=n;pt(r,"resizeBilinear");let l=L.computeStrides(r.shape),[c,u]=a,[h,p,f,d]=r.shape,m=e.data.get(r.dataId).values,x=new Float32Array(L.sizeFromShape([h,c,u,d])),g=[o&&c>1?p-1:p,o&&u>1?f-1:f],y=[o&&c>1?c-1:c,o&&u>1?u-1:u],b=0,v=g[0]/y[0],_=g[1]/y[1];for(let S=0;S<h;S++)for(let E=0;E<c;E++){let M;s?M=v*(E+.5)-.5:M=v*E;let N=Math.max(0,Math.floor(M)),I=M-N,w=Math.min(p-1,Math.ceil(M)),R=S*l[0]+N*l[1],P=S*l[0]+w*l[1];for(let D=0;D<u;D++){let F;s?F=_*(D+.5)-.5:F=_*D;let z=Math.max(0,Math.floor(F)),V=F-z,H=Math.min(f-1,Math.ceil(F)),X=R+z*l[2],U=P+z*l[2],Y=R+H*l[2],Z=P+H*l[2];for(let K=0;K<d;K++){let J=m[X+K],G=m[U+K],nt=m[Y+K],et=m[Z+K],at=J+(nt-J)*V,it=G+(et-G)*V,St=at+(it-at)*I;x[b++]=St}}}return e.makeTensorInfo([h,c,u,d],"float32",x)}var x6={kernelName:m0,backendName:"cpu",kernelFunc:wtt};function Stt(i){let{inputs:t,backend:e,attrs:n}=i,{images:r,dy:o}=t,{alignCorners:s}=n;pt([o,r],"resizeBilinearGrad");let a=L.computeStrides(r.shape),[l,c,u,h]=r.shape,[,p,f]=o.shape,d=new Float32Array(l*c*u*h),m=[s&&p>1?c-1:c,s&&f>1?u-1:u],x=[s&&p>1?p-1:p,s&&f>1?f-1:f],g=m[0]/x[0],y=m[1]/x[1],b=e.data.get(o.dataId).values,v=0;for(let _=0;_<l;_++){let S=_*a[0];for(let E=0;E<p;E++){let M=E*g,N=Math.floor(M),I=Math.min(Math.ceil(M),c-1),w=S+N*a[1],R=S+I*a[1],P=M-N,D=1-P;for(let F=0;F<f;F++){let z=F*y,V=Math.floor(z),H=Math.min(Math.ceil(z),u-1),X=z-V,U=1-X,Y=w+V*a[2],Z=w+H*a[2],K=R+V*a[2],J=R+H*a[2],G=D*U,nt=D*X,et=P*U,at=P*X;for(let it=0;it<h;it++){let St=b[v++];d[Y+it]+=St*G,d[Z+it]+=St*nt,d[K+it]+=St*et,d[J+it]+=St*at}}}}return e.makeTensorInfo([l,u,c,h],"float32",d)}var y6={kernelName:g0,backendName:"cpu",kernelFunc:Stt};function Ctt(i){let{inputs:t,backend:e,attrs:n}=i,{images:r}=t,{alignCorners:o,halfPixelCenters:s,size:a}=n;pt(r,"resizeNearestNeighbor");let l=L.computeStrides(r.shape),[c,u]=a,[h,p,f,d]=r.shape,m=e.data.get(r.dataId).values,x=new Float32Array(h*c*u*d),g=[o&&c>1?p-1:p,o&&u>1?f-1:f],y=[o&&c>1?c-1:c,o&&u>1?u-1:u],b=g[0]/y[0],v=g[1]/y[1],_=0;for(let S=0;S<h;S++){let E=S*l[0];for(let M=0;M<c;M++){let N=s?b*(M+.5):b*M,I=Math.min(p-1,o?Math.round(N):Math.floor(N));s&&(I=Math.max(0,I));let w=E+I*l[1];for(let R=0;R<u;R++){let P=s?v*(R+.5):v*R,D=Math.min(f-1,o?Math.round(P):Math.floor(P));s&&(D=Math.max(0,D));let F=w+D*l[2];for(let z=0;z<d;z++){let V=m[F+z];x[_++]=V}}}}return e.makeTensorInfo([h,c,u,d],r.dtype,x)}var v6={kernelName:f0,backendName:"cpu",kernelFunc:Ctt};function Mtt(i){let{inputs:t,backend:e,attrs:n}=i,{images:r,dy:o}=t,{alignCorners:s}=n;pt([o,r],"resizeNearestNeighborGrad");let a=L.computeStrides(r.shape),l=L.computeStrides(o.shape),[c,u,h,p]=r.shape,[,f,d]=o.shape,m=new Float32Array(c*u*h*p),x=e.data.get(o.dataId).values,g=[s&&f>1?u-1:u,s&&d>1?h-1:h],y=[s&&f>1?f-1:f,s&&d>1?d-1:d],b=g[0]/y[0],v=g[1]/y[1],_=1/b,S=1/v,E=Math.ceil(_)*2+2,M=Math.ceil(S)*2+2;for(let N=0;N<c;N++){let I=N*a[0];for(let w=0;w<u;w++){let R=I+w*a[1],P=Math.floor(w*_),D=Math.floor(P-E/2);for(let F=0;F<h;F++){let z=R+F*a[2],V=Math.floor(F*S),H=Math.floor(V-M/2);for(let X=0;X<p;X++){let U=0;for(let Y=0;Y<E;Y++){let Z=Y+D;if(Z<0||Z>=f)continue;let K=I+Z*l[1],J=Z*b,G=Math.min(u-1,s?Math.round(J):Math.floor(J));if(w===G)for(let nt=0;nt<M;nt++){let et=nt+H;if(et<0||et>=d)continue;let at=K+et*l[2],it=et*v,St=Math.min(h-1,s?Math.round(it):Math.floor(it));F===St&&(U+=x[at+X])}}m[z+X]=U}}}}return e.makeTensorInfo(r.shape,r.dtype,m)}var b6={kernelName:d0,backendName:"cpu",kernelFunc:Mtt};function Ett(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{dims:o}=n;pt(r,"reverse");let s=r.shape.length,a=L.parseAxisParam(o,r.shape);if(s===0)return On({inputs:{x:r},backend:e});let l=new Ie(r.shape,r.dtype),c=e.bufferSync(r);for(let u=0;u<l.size;u++){let h=l.indexToLoc(u),p=h.slice();a.forEach(f=>p[f]=r.shape[f]-1-p[f]),l.set(c.get(...p),...h)}return e.makeTensorInfo(l.shape,l.dtype,l.values)}var _6={kernelName:x0,backendName:"cpu",kernelFunc:Ett};var w6={kernelName:N0,backendName:"cpu",kernelFunc:({inputs:i,attrs:t,backend:e})=>{let{image:n}=i,{radians:r,fillValue:o,center:s}=t,a=e,l=L.getTypedArrayFromDType(n.dtype,L.sizeFromShape(n.shape)),[c,u,h,p]=n.shape,[f,d]=O.getImageCenter(s,u,h),m=255,x=Math.sin(r),g=Math.cos(r),y=a.data.get(n.dataId).values;for(let v=0;v<c;v++){let _=v*h*u*p;for(let S=0;S<u;S++){let E=S*(h*p);for(let M=0;M<h;M++){let N=M*p;for(let I=0;I<p;I++){let w=[c,S,M,I],R=w[2],P=w[1],D=(R-f)*g-(P-d)*x,F=(R-f)*x+(P-d)*g;D=Math.round(D+f),F=Math.round(F+d);let z=o;if(typeof o!="number"&&(I===3?z=m:z=o[I]),D>=0&&D<h&&F>=0&&F<u){let H=F*(h*p),X=D*p,U=_+H+X+I;z=y[U]}let V=_+E+N+I;l[V]=z}}}}return{dataId:a.write(l,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};var Ttt=Kt(pf,i=>{let t=Math.floor(i);return i-t<.5?Math.floor(i):i-t>.5?Math.ceil(i):t%2===0?t:t+1}),S6={kernelName:pf,backendName:"cpu",kernelFunc:Ttt};function px(i,t,e,n,r,o,s,a,l,c){let u=[n/r,r],h=i.values,p=t.values;if(n===0)return Yt(e,t.dtype);let f=Yt(u,t.dtype);f.values.fill(l);for(let d=0;d<o;d++){let m=[],x=0;for(let g=0;g<s;g++){let y=h[d*s+g];m.push(y),x+=y*a[g]}if(x<0||x>=n/r)throw new Error(`Invalid indices: ${m} does not index into ${e}`);for(let g=0;g<r;g++)c?f.values[x*r+g]+=p[d*r+g]:f.values[x*r+g]=t.rank===0?p[0]:p[d*r+g]}return f}function Itt(i){let{inputs:t,backend:e,attrs:n}=i,{indices:r,updates:o}=t,{shape:s}=n,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=O.calculateShapes(o,r,s),p=!0,f=e.bufferSync(r),d=e.bufferSync(o),m=px(f,d,s,h,c,l,a,u,0,p);return e.makeTensorInfo(s,m.dtype,m.values)}var C6={kernelName:y0,backendName:"cpu",kernelFunc:Itt};function Att(i){let{inputs:t,backend:e}=i,{condition:n,t:r,e:o}=t;pt([n,r,o],"select");let s=n.shape.length,a=e.data.get(n.dataId).values,l=e.data.get(r.dataId).values,c=e.data.get(o.dataId).values,u=dn(r.dtype,o.dtype),h=L.makeZerosTypedArray(L.sizeFromShape(r.shape),u),p=0,f=s===0||s>1||r.shape.length===1?1:L.sizeFromShape(r.shape.slice(1));for(let d=0;d<a.length;d++)for(let m=0;m<f;m++)a[d]===1?h[p++]=l[d]:h[p++]=c[d];return e.makeTensorInfo(r.shape,u,h)}var M6={kernelName:v0,backendName:"cpu",kernelFunc:Att};var ktt=O.SELU_SCALEALPHA,Rtt=O.SELU_SCALE,Ptt=Kt(df,i=>i>=0?Rtt*i:ktt*(Math.exp(i)-1)),E6={kernelName:df,backendName:"cpu",kernelFunc:Ptt};var Ntt=Kt(yf,i=>1/(1+Math.exp(-i))),T6={kernelName:yf,backendName:"cpu",kernelFunc:Ntt};var Ltt=Kt(xf,i=>i<0?-1:i>0?1:0),I6={kernelName:xf,backendName:"cpu",kernelFunc:Ltt};var Dtt=Kt(mf,i=>Math.sin(i)),A6={kernelName:mf,backendName:"cpu",kernelFunc:Dtt};var ztt=Kt(gf,i=>Math.sinh(i)),k6={kernelName:gf,backendName:"cpu",kernelFunc:ztt};var Ftt=11920928955078125e-23,R6=Math.log(Ftt)+2,Ott=Kt(vf,i=>{let t=i>-R6,e=i<R6,n=Math.exp(i),r;return e?r=n:t?r=i:r=Math.log(1+n),r}),P6={kernelName:vf,backendName:"cpu",kernelFunc:Ott};function Btt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{blockShape:o,paddings:s}=n;pt([r],"spaceToBatchND");let a=L.sizeFromShape(o),l=[[0,0]];l.push(...s);for(let S=1+o.length;S<r.shape.length;++S)l.push([0,0]);let c=hx.kernelFunc({inputs:{x:r},backend:e,attrs:{paddings:l,constantValue:0}}),u=O.getReshaped(c.shape,o,a,!1),h=O.getPermuted(u.length,o.length,!1),p=O.getReshapedPermuted(c.shape,o,a,!1),m=ue({inputs:{x:c},backend:e,attrs:{shape:u}}),y=Ke({inputs:{x:m},backend:e,attrs:{perm:h}}),_=ue({inputs:{x:y},backend:e,attrs:{shape:p}});return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(y),_}var N6={kernelName:_0,backendName:"cpu",kernelFunc:Btt};function Vtt(i){let{inputs:t,backend:e,attrs:n}=i,{sparseIndices:r,sparseValues:o,defaultValue:s}=t,{outputShape:a}=n,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:p}=O.calculateShapes(o,r,a),f=!1,d=e.bufferSync(r),m=e.bufferSync(o),x=e.data.get(s.dataId).values[0],g=px(d,m,a,p,u,c,l,h,x,f);return e.makeTensorInfo(a,g.dtype,g.values)}var L6={kernelName:C0,backendName:"cpu",kernelFunc:Vtt};function Htt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{numOrSizeSplits:o,axis:s}=n,a=L.parseAxisParam(s,r.shape)[0],l=O.prepareSplitSize(r,o,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(h=>{let p=[...u];p[a]=h;let f=Zi({inputs:{x:r},backend:e,attrs:{begin:c,size:p}});return c[a]+=h,f})}var D6={kernelName:Hc,backendName:"cpu",kernelFunc:Htt};var $tt=Kt(bf,i=>Math.sqrt(i)),z6={kernelName:bf,backendName:"cpu",kernelFunc:$tt};var F6={kernelName:S0,backendName:"cpu",kernelFunc:({inputs:i,backend:t})=>{let{x:e}=i,n=t;pt(e,"square");let r=n.data.get(e.dataId).values,o=new Float32Array(r.length);for(let a=0;a<r.length;++a){let l=r[a];o[a]=l*l}return{dataId:n.write(o,e.shape,e.dtype),shape:e.shape,dtype:e.dtype}}};var Utt=Kt($a,(i,t)=>{let e=t;return isNaN(i)?NaN:i>0?1:e.alpha}),O6={kernelName:$a,backendName:"cpu",kernelFunc:Utt};function Wtt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{begin:o,end:s,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:p}=n;pt(r,"stridedSlice");let{nonStrided:f,$begin:d,$strides:m,size:x,newShape:g,outShape:y}=zn.sliceInfo(r.shape,o,s,a,l,c,u,h,p),b=ue({inputs:{x:r},backend:e,attrs:{shape:g}}),v;if(f){let S=Zi({inputs:{x:b},backend:e,attrs:{begin:d,size:x}});v=ue({inputs:{x:S},backend:e,attrs:{shape:y}}),e.disposeIntermediateTensorInfo(S)}else if(y.some(S=>S===0))v=e.makeTensorInfo(y,r.dtype,[]);else{let S=e.bufferSync(b),E=rx(y,S,m,d);v=e.makeTensorInfo(E.shape,E.dtype,E.values)}let _=ue({inputs:{x:v},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(v),_}var B6={kernelName:M0,backendName:"cpu",kernelFunc:Wtt};var Gtt=Kt(wf,i=>Math.tan(i)),V6={kernelName:wf,backendName:"cpu",kernelFunc:Gtt};var jtt=Kt(Sf,i=>Math.tanh(i)),H6={kernelName:Sf,backendName:"cpu",kernelFunc:jtt};function qtt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{reps:o}=n;pt(r,"tile");let s=ox(e.bufferSync(r),o);return e.makeTensorInfo(s.shape,s.dtype,s.values)}var $6={kernelName:E0,backendName:"cpu",kernelFunc:qtt};function Xtt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{k:o,sorted:s}=n;pt(r,"topk");let a=e.data.get(r.dataId).values,[l,c]=sx(a,r.shape,r.dtype,o,s);return[e.makeTensorInfo(l.shape,l.dtype,l.values),e.makeTensorInfo(c.shape,c.dtype,c.values)]}var U6={kernelName:T0,backendName:"cpu",kernelFunc:Xtt};function Ktt(i){let{inputs:t,attrs:e,backend:n}=i,{image:r,transforms:o}=t,{interpolation:s,fillMode:a,fillValue:l,outputShape:c}=e,[u,h,p,f]=r.shape,[d,m]=c!=null?c:[h,p],x=[u,d,m,f],g=L.computeStrides(r.shape),y=g[0],b=g[1],v=g[2],_=L.getTypedArrayFromDType(r.dtype,L.sizeFromShape(x));_.fill(l);let S=n.data.get(r.dataId).values,E=n.data.get(o.dataId).values;for(let N=0;N<u;++N){let I=o.shape[0]===1?E:E.subarray(N*8,N*8+8);for(let w=0;w<d;++w)for(let R=0;R<m;++R)for(let P=0;P<f;++P){let D,F=I[6]*R+I[7]*w+1;if(F===0)continue;let z=(I[0]*R+I[1]*w+I[2])/F,V=(I[3]*R+I[4]*w+I[5])/F,H=W6(z,p,a),X=W6(V,h,a);switch(s){case"nearest":D=tet(S,h,p,y,b,v,N,X,H,P,l);break;case"bilinear":D=eet(S,h,p,y,b,v,N,X,H,P,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${s}`)}let U=N*y+w*b+R*v+P;_[U]=D}return n.makeTensorInfo(x,r.dtype,_)}return{dataId:n.write(_,x,r.dtype),shape:r.shape,dtype:r.dtype}}var G6={kernelName:I0,backendName:"cpu",kernelFunc:Ktt};function W6(i,t,e){switch(e){case"reflect":return Ytt(i,t);case"wrap":return Ztt(i,t);case"nearest":return Qtt(i,t);case"constant":default:return Jtt(i,t)}}function Ytt(i,t){let e=i;if(e<0)if(t<=1)e=0;else{let n=2*t;e<n&&(e=n*Math.trunc(-e/n)+e),e=e<-t?e+n:-e-1}else if(e>t-1)if(t<=1)e=0;else{let n=2*t;e-=n*Math.trunc(e/n),e>=t&&(e=n-e-1)}return L.clamp(0,e,t-1)}function Ztt(i,t){let e=i;if(e<0)if(t<=1)e=0;else{let n=t-1;e+=t*(Math.trunc(-e/n)+1)}else if(e>t-1)if(t<=1)e=0;else{let n=t-1;e-=t*Math.trunc(e/n)}return L.clamp(0,e,t-1)}function Jtt(i,t){return i}function Qtt(i,t){return L.clamp(0,i,t-1)}function Df(i,t,e,n,r,o,s,a,l,c,u){let h=s*n+a*r+l*o+c;return 0<=a&&a<t&&0<=l&&l<e?i[h]:u}function tet(i,t,e,n,r,o,s,a,l,c,u){let h=Math.round(a),p=Math.round(l);return Df(i,t,e,n,r,o,s,h,p,c,u)}function eet(i,t,e,n,r,o,s,a,l,c,u){let h=Math.floor(a),p=Math.floor(l),f=h+1,d=p+1,m=(d-l)*Df(i,t,e,n,r,o,s,h,p,c,u)+(l-p)*Df(i,t,e,n,r,o,s,h,d,c,u),x=(d-l)*Df(i,t,e,n,r,o,s,f,p,c,u)+(l-p)*Df(i,t,e,n,r,o,s,f,d,c,u);return(f-a)*m+(a-h)*x}function net(i){let{inputs:t,attrs:e,backend:n}=i,{axis:r}=e,{x:o}=t;pt(o,"unique");let s=n.data.get(o.dataId).values,{outputValues:a,outputShape:l,indices:c}=ax(s,r,o.shape,o.dtype);return[n.makeTensorInfo(l,o.dtype,a),n.makeTensorInfo([c.length],"int32",c)]}var j6={kernelName:A0,backendName:"cpu",kernelFunc:net};function iet(i){let{inputs:t,backend:e,attrs:n}=i,{value:r}=t,{axis:o}=n;o<0&&(o+=r.shape.length);let s=r.shape.length,a=r.shape[o],l=new Array(s-1),c=0;for(let f=0;f<s;f++)f!==o&&(l[c++]=r.shape[f]);let u=new Array(s).fill(0),h=r.shape.slice();h[o]=1;let p=new Array(a);for(let f=0;f<p.length;f++){u[o]=f;let d=Zi({inputs:{x:r},backend:e,attrs:{begin:u,size:h}});p[f]=ue({inputs:{x:d},backend:e,attrs:{shape:l}}),e.disposeIntermediateTensorInfo(d)}return p}var q6={kernelName:k0,backendName:"cpu",kernelFunc:iet};function ret(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,segmentIds:o}=t,{numSegments:s}=n;pt(r,"unsortedSegmentSum");let a=r.shape.length,l=o.shape.length,c=[],u=[],h=a-l,p=o;for(let d=0;d<h;++d){let m=nu({inputs:{input:p},backend:e,attrs:{dim:d+1}});p=m,u.push(m)}for(let d=0;d<s;++d){let m=L.createScalarValue(d,"int32"),x=e.makeTensorInfo([],"int32",m),g=EC({inputs:{a:x,b:p},backend:e}),y=Xi({inputs:{x:g},backend:e,attrs:{dtype:"float32"}}),b=Ya({inputs:{a:y,b:r},backend:e}),v=Do({inputs:{x:b},backend:e,attrs:{axis:0,keepDims:!1}});c.push(v),u.push(x),u.push(g),u.push(y),u.push(b),u.push(v)}let f=kC({inputs:c,backend:e,attrs:{axis:0}});return u.forEach(d=>e.disposeIntermediateTensorInfo(d)),f}var X6={kernelName:R0,backendName:"cpu",kernelFunc:ret};var oet=[AN,JP,kN,RN,iN,PN,NN,LN,DN,zN,FN,ON,BN,VN,HN,UN,WN,GN,jN,IN,qN,XN,KN,nN,rN,YN,QP,ZN,QN,eL,nL,tL,rL,oL,iL,sL,aL,lL,cL,uL,hL,pL,fL,dL,mL,gL,yL,xL,Pf,bL,wN,_L,wL,SL,oN,CL,sN,ML,EL,TL,aN,IL,AL,kL,RL,PL,lN,NL,tN,LL,JN,DL,zL,FL,SN,cN,OL,BL,uN,VL,HL,$L,UL,WL,GL,hN,qL,XL,KL,YL,JL,jL,QL,t6,pN,e6,n6,o6,fN,dN,s6,a6,l6,mN,c6,p6,f6,hx,d6,CN,xN,m6,eN,g6,MN,EN,TN,x6,y6,v6,b6,_6,w6,S6,yN,C6,M6,E6,T6,I6,A6,k6,vN,i6,P6,N6,L6,D6,z6,F6,bN,O6,B6,_N,vL,V6,H6,$6,U6,gN,G6,j6,q6,X6,u6];for(let i of oet)O0(i);var Za={},RC={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function K6(i,t){Za[i]=t}function Ai(i){if(!(i in Za)){let e=aet(i);if(e!==null)Za[i]=e;else return console.log("Could not get context for WebGL version",i),null}let t=Za[i];return t.isContextLost()?(delete Za[i],Ai(i)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Za[i])}function set(i){if(typeof OffscreenCanvas!="undefined"&&i===2)return new OffscreenCanvas(300,150);if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function aet(i){if(i!==1&&i!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let t=set(i);return t.addEventListener("webglcontextlost",e=>{e.preventDefault(),delete Za[i]},!1),i===1?t.getContext("webgl",RC)||t.getContext("experimental-webgl",RC):t.getContext("webgl2",RC)}var ws;(function(i){i[i.DENSE=0]="DENSE",i[i.SHARED_BATCH=1]="SHARED_BATCH"})(ws||(ws={}));var Bn;(function(i){i[i.RENDER=0]="RENDER",i[i.UPLOAD=1]="UPLOAD",i[i.PIXELS=2]="PIXELS",i[i.DOWNLOAD=3]="DOWNLOAD"})(Bn||(Bn={}));var En;(function(i){i[i.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",i[i.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",i[i.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",i[i.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",i[i.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(En||(En={}));function Ja(i,t){return[t,i]}function Y6(i,t){return i*t}function Ss(i){let t=L.sizeFromShape(i),e=Math.ceil(t/4);return L.sizeToSquarishShape(e)}function Jr(i,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(i/2))]}function Z6(i,t){let[e,n]=Jr(i,t);return e*n*4}function zf(i,t){let e=i,n,r,o,s,a,l,c,u,h,p;return ot().getNumber("WEBGL_VERSION")===2?(n=e.R32F,r=e.R16F,o=e.RGBA16F,s=e.RGBA32F,a=e.RED,c=4,u=1,h=e.HALF_FLOAT,p=e.FLOAT):(n=i.RGBA,r=i.RGBA,o=i.RGBA,s=e.RGBA,a=i.RGBA,c=4,u=4,h=t!=null?t.HALF_FLOAT_OES:null,p=i.FLOAT),l=i.RGBA,{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:s,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:p}}function qt(i,t){let e=t();return ot().getBool("DEBUG")&&cet(i),e}function cet(i){let t=i.getError();if(t!==i.NO_ERROR)throw new Error("WebGL Error: "+pet(i,t))}var uet=596e-10,het=65504;function J6(i){return!!(ot().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||i===0||uet<Math.abs(i)&&Math.abs(i)<het)}function pet(i,t){switch(t){case i.NO_ERROR:return"NO_ERROR";case i.INVALID_ENUM:return"INVALID_ENUM";case i.INVALID_VALUE:return"INVALID_VALUE";case i.INVALID_OPERATION:return"INVALID_OPERATION";case i.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case i.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case i.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function Ff(i,t){return zo(i,()=>i.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function Q6(i,t){let e=zo(i,()=>i.createShader(i.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(qt(i,()=>i.shaderSource(e,t)),qt(i,()=>i.compileShader(e)),i.getShaderParameter(e,i.COMPILE_STATUS)===!1)throw console.log(i.getShaderInfoLog(e)),new Error("Failed to compile vertex shader.");return e}function t9(i,t){let e=zo(i,()=>i.createShader(i.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(qt(i,()=>i.shaderSource(e,t)),qt(i,()=>i.compileShader(e)),i.getShaderParameter(e,i.COMPILE_STATUS)===!1)throw det(t,i.getShaderInfoLog(e)),new Error("Failed to compile fragment shader.");return e}var fet=/ERROR: [0-9]+:([0-9]+):/g;function det(i,t){let e=fet.exec(t);if(e==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(i);return}let n=+e[1],r=i.split(`
`),o=r.length.toString().length+2,s=r.map((h,p)=>L.rightPad((p+1).toString(),o)+h),a=0;for(let h=0;h<s.length;h++)a=Math.max(s[h].length,a);let l=s.slice(0,n-1),c=s.slice(n-1,n),u=s.slice(n);console.log(l.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${L.rightPad(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function e9(i){return zo(i,()=>i.createProgram(),"Unable to create WebGLProgram.")}function n9(i,t){if(qt(i,()=>i.linkProgram(t)),i.getProgramParameter(t,i.LINK_STATUS)===!1)throw console.log(i.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function dx(i,t){if(qt(i,()=>i.validateProgram(t)),i.getProgramParameter(t,i.VALIDATE_STATUS)===!1)throw console.log(i.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function i9(i,t){let e=zo(i,()=>i.createBuffer(),"Unable to create WebGLBuffer");return qt(i,()=>i.bindBuffer(i.ARRAY_BUFFER,e)),qt(i,()=>i.bufferData(i.ARRAY_BUFFER,t,i.STATIC_DRAW)),e}function r9(i,t){let e=zo(i,()=>i.createBuffer(),"Unable to create WebGLBuffer");return qt(i,()=>i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e)),qt(i,()=>i.bufferData(i.ELEMENT_ARRAY_BUFFER,t,i.STATIC_DRAW)),e}function o9(i){return zo(i,()=>i.createTexture(),"Unable to create WebGLTexture.")}function s9(i,t){let e=ot().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(i<=0||t<=0){let n=`[${i}x${t}]`;throw new Error("Requested texture size "+n+" is invalid.")}if(i>e||t>e){let n=`[${i}x${t}]`,r=`[${e}x${e}]`;throw new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+r+".")}}function a9(i){return zo(i,()=>i.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function zC(i,t,e,n,r,o,s){let a=i.getAttribLocation(t,e);return a===-1?!1:(qt(i,()=>i.bindBuffer(i.ARRAY_BUFFER,n)),qt(i,()=>i.vertexAttribPointer(a,r,i.FLOAT,!1,o,s)),qt(i,()=>i.enableVertexAttribArray(a)),!0)}function met(i,t,e){xet(i,e),qt(i,()=>i.activeTexture(i.TEXTURE0+e)),qt(i,()=>i.bindTexture(i.TEXTURE_2D,t))}function l9(i,t,e){return zo(i,()=>i.getUniformLocation(t,e),'uniform "'+e+'" not present in program.')}function c9(i,t,e){return i.getUniformLocation(t,e)}function u9(i,t,e,n){qt(i,()=>met(i,t,n)),qt(i,()=>i.uniform1i(e,n))}function mx(i,t,e){qt(i,()=>i.bindFramebuffer(i.FRAMEBUFFER,e)),qt(i,()=>i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,t,0))}function FC(i,t){qt(i,()=>i.bindFramebuffer(i.FRAMEBUFFER,t)),qt(i,()=>i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,null,0))}function Of(i){let t=i.checkFramebufferStatus(i.FRAMEBUFFER);if(t!==i.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+get(i,t))}function get(i,t){switch(t){case i.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case i.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case i.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case i.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function zo(i,t,e){let n=qt(i,()=>t());if(n==null)throw new Error(e);return n}function xet(i,t){let e=i.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=t+i.TEXTURE0;if(n<i.TEXTURE0||n>e){let r=`[gl.TEXTURE0, gl.TEXTURE${e}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Cs(i,t=2){return L.sizeFromShape(i.slice(0,i.length-t))}function Ms(i){if(i.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[i.length>1?i[i.length-2]:1,i[i.length-1]]}function gx(i){let t=[1,1,1];return i.length===0||i.length===1&&i[0]===1||(t=[Cs(i),...Ms(i)]),t}function h9(i,t=!1){let e=ot().getNumber("WEBGL_MAX_TEXTURE_SIZE");t&&(e=e*2,i=i.map((r,o)=>o>=i.length-2?L.nearestLargerEven(i[o]):i[o]),i.length===1&&(i=[2,i[0]])),i.length!==2&&(i=L.squeezeShape(i).newShape);let n=L.sizeFromShape(i);if(i.length<=1&&n<=e)return[1,n];if(i.length===2&&i[0]<=e&&i[1]<=e)return i;if(i.length===3&&i[0]*i[1]<=e&&i[2]<=e)return[i[0]*i[1],i[2]];if(i.length===3&&i[0]<=e&&i[1]*i[2]<=e)return[i[0],i[1]*i[2]];if(i.length===4&&i[0]*i[1]*i[2]<=e&&i[3]<=e)return[i[0]*i[1]*i[2],i[3]];if(i.length===4&&i[0]<=e&&i[1]*i[2]*i[3]<=e)return[i[0],i[1]*i[2]*i[3]];if(t){let r=Cs(i),o=2,s=2;return i.length&&([o,s]=Ms(i)),n=r*(o/2)*(s/2),L.sizeToSquarishShape(n).map(a=>a*2)}return L.sizeToSquarishShape(n)}function fx(i){return i%2===0}function Qa(i,t){if(i=i.slice(-2),t=t.slice(-2),L.arraysEqual(i,t)||!i.length||!t.length||i[0]===0||i[1]===0||t[0]===0||t[1]===0)return!0;if(i.length!==t.length){let e=i.slice(-1)[0],n=t.slice(-1)[0];if(e===n||fx(e)&&fx(n)&&(i[0]===1||t[0]===1))return!0}return i[1]===t[1]&&fx(i[0])&&fx(t[0])}var NC,LC;function p9(i){if(NC==null){let t=Ai(i);NC=t.getParameter(t.MAX_TEXTURE_SIZE)}return NC}function f9(i){if(LC==null){let t=Ai(i);LC=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,LC)}function d9(i){if(i===0)return 0;let t,e=Ai(i);return ki(e,"EXT_disjoint_timer_query_webgl2")&&i===2?t=2:ki(e,"EXT_disjoint_timer_query")?t=1:t=0,t}function ki(i,t){return i.getExtension(t)!=null}function OC(i){try{if(Ai(i)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function m9(i){if(i===0)return!1;let t=Ai(i);if(i===1){if(!ki(t,"OES_texture_float"))return!1}else if(!ki(t,"EXT_color_buffer_float"))return!1;return DC(t)}function g9(i){if(i===0)return!1;let t=Ai(i);if(i===1){if(!ki(t,"OES_texture_float")||!ki(t,"WEBGL_color_buffer_float"))return!1}else{if(ki(t,"EXT_color_buffer_float"))return DC(t);let n="EXT_color_buffer_half_float";if(ki(t,n)){let r=t.getExtension(n);return yet(t,r)}return!1}return DC(t)}function DC(i){let t=zf(i),e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);let n=1,r=1;i.texImage2D(i.TEXTURE_2D,0,t.internalFormatFloat,n,r,0,t.textureFormatFloat,t.textureTypeFloat,null);let o=i.createFramebuffer();i.bindFramebuffer(i.FRAMEBUFFER,o),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0);let s=i.checkFramebufferStatus(i.FRAMEBUFFER)===i.FRAMEBUFFER_COMPLETE;return i.bindTexture(i.TEXTURE_2D,null),i.bindFramebuffer(i.FRAMEBUFFER,null),i.deleteTexture(e),i.deleteFramebuffer(o),s}function yet(i,t){let e=zf(i,t),n=i.createTexture();i.bindTexture(i.TEXTURE_2D,n);let r=1,o=1;i.texImage2D(i.TEXTURE_2D,0,e.internalFormatHalfFloat,r,o,0,e.textureFormatFloat,e.textureTypeHalfFloat,null);let s=i.createFramebuffer();i.bindFramebuffer(i.FRAMEBUFFER,s),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,n,0);let a=i.checkFramebufferStatus(i.FRAMEBUFFER)===i.FRAMEBUFFER_COMPLETE;return i.bindTexture(i.TEXTURE_2D,null),i.bindFramebuffer(i.FRAMEBUFFER,null),i.deleteTexture(n),i.deleteFramebuffer(s),a}function x9(i){return i!==2?!1:Ai(i).fenceSync!=null}function Qr(i,t){Array.isArray(i)||(i=[i]),i.forEach(e=>{e!=null&&L.assert(e.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}var ee=ot();ee.registerFlag("HAS_WEBGL",()=>ee.getNumber("WEBGL_VERSION")>0);ee.registerFlag("WEBGL_VERSION",()=>OC(2)?2:OC(1)?1:0);ee.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);ee.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>ee.get("WEBGL_VERSION")===2);ee.registerFlag("WEBGL_CPU_FORWARD",()=>!0);ee.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);ee.registerFlag("WEBGL_PACK",()=>ee.getBool("HAS_WEBGL"));ee.registerFlag("WEBGL_PACK_NORMALIZATION",()=>ee.getBool("WEBGL_PACK"));ee.registerFlag("WEBGL_PACK_CLIP",()=>ee.getBool("WEBGL_PACK"));ee.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>!0);ee.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>ee.getBool("WEBGL_PACK"));ee.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>ee.getBool("WEBGL_PACK"));ee.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>ee.getBool("WEBGL_PACK"));ee.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>ee.getBool("WEBGL_PACK"));ee.registerFlag("WEBGL_PACK_REDUCE",()=>ee.getBool("WEBGL_PACK"));ee.registerFlag("WEBGL_LAZILY_UNPACK",()=>ee.getBool("WEBGL_PACK"));ee.registerFlag("WEBGL_CONV_IM2COL",()=>ee.getBool("WEBGL_PACK"));ee.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>p9(ee.getNumber("WEBGL_VERSION")));ee.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>f9(ee.getNumber("WEBGL_VERSION")));ee.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let i=ee.getNumber("WEBGL_VERSION");return i===0?0:d9(i)});ee.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>ee.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!vs.isMobile());ee.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>m9(ee.getNumber("WEBGL_VERSION")));ee.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>ee.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:ee.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));ee.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>g9(ee.getNumber("WEBGL_VERSION")));ee.registerFlag("WEBGL_FENCE_API_ENABLED",()=>x9(ee.getNumber("WEBGL_VERSION")));ee.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>ee.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);ee.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,i=>{if(i<0&&i!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${i}.`)});ee.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>vs.isMobile()&&ee.getBool("IS_CHROME")?1:-1,i=>{if(i<0&&i!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${i}.`)});function $e(){let i,t,e,n,r,o,s,a,l,c;return ot().getNumber("WEBGL_VERSION")===2?(i="#version 300 es",t="in",e="out",n="in",r="texture",o="outputColor",s="out vec4 outputColor;",a=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(i="",t="attribute",e="varying",n="varying",r="texture2D",o="gl_FragColor",s="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:i,attribute:t,varyingVs:e,varyingFs:n,texture2D:r,output:o,defineOutput:s,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}function yr(i,t,e="index"){let n=L.computeStrides(t);return n.map((r,o)=>{let s=`int ${i[o]} = ${e} / ${r}`,a=o===n.length-1?`int ${i[o+1]} = ${e} - ${i[o]} * ${r}`:`index -= ${i[o]} * ${r}`;return`${s}; ${a};`}).join("")}function iu(i){let t=L.computeStrides(i).map(e=>e.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}var yx=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;var vx=class{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=ws.DENSE;let e=Ss(t),n=$e();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${yr(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(${e[0]}, ${e[1]}));
        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}};var bx=class{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=ws.DENSE;let e=Ss(t),n=$e();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${yr(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(${e[0]}, ${e[1]}));
        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}};var _x=class{constructor(t){this.variableNames=["A"],this.outTexUsage=Bn.DOWNLOAD;let e=$e();this.outputShape=t,this.userCode=`
      ${yx}

      void main() {
        float x = getAAtOutCoords();
        ${e.output} = encode_float(x);
      }
    `}};var wx=class{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Bn.DOWNLOAD;let e=$e();this.outputShape=t,this.userCode=`
      ${yx}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${e.output} = encode_float(x);
      }
    `}};var Sx=class{constructor(t,e,n=!1){this.variableNames=["A"];let r=$e(),[o,s]=e;this.outputShape=t;let a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      ${iu(t)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / ${s};
        int c = imod(flatIndex, ${s});
        vec2 uv = (vec2(c, r) + halfCR) / vec2(${s}.0, ${o}.0);
        vec4 values = ${r.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${r.output} = vec4(${a}, 0., 0., 0.);
      }
    `}};var Cx=class{constructor(t,e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let r=$e(),[o,s]=e;this.outputShape=t;let a="",l="result";n&&(l="floor(result * 255. + 0.5)");for(let c=0;c<=1;c++)for(let u=0;u<=1;u++){let h=c*2+u;a+=`
          localCoords = coords;
          if(localCoords[2] + ${u} < ${t[2]}) {
            localCoords[2] += ${u};
            if(localCoords[1] + ${c} < ${t[1]}) {
              localCoords[1] += ${c};

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / ${s};
              c = imod(flatIndex, ${s});
              uv = (vec2(c, r) + halfCR) / vec2(${s}.0, ${o}.0);
              values = ${r.texture2D}(A, uv);

              if(offset == 0) {
                result[${h}] = values[0];
              } else if(offset == 1) {
                result[${h}] = values[1];
              } else if(offset == 2) {
                result[${h}] = values[2];
              } else {
                result[${h}] = values[3];
              }
            }
          }
        `}this.userCode=`
      ${iu(t)}

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        ${a}

        ${r.output} = ${l};
      }
    `}};function y9(i){let t=$e(),e=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return Q6(i,e)}function v9(i){let t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return i9(i,t)}function b9(i){let t=new Uint16Array([0,1,2,2,1,3]);return r9(i,t)}function Bf(i,t,e,n,r,o){s9(t,e);let s=o9(i),a=i.TEXTURE_2D;return qt(i,()=>i.bindTexture(a,s)),qt(i,()=>i.texParameteri(a,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE)),qt(i,()=>i.texParameteri(a,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)),qt(i,()=>i.texParameteri(a,i.TEXTURE_MIN_FILTER,i.NEAREST)),qt(i,()=>i.texParameteri(a,i.TEXTURE_MAG_FILTER,i.NEAREST)),qt(i,()=>i.texImage2D(a,0,n,t,e,0,r,o,null)),qt(i,()=>i.bindTexture(i.TEXTURE_2D,null)),s}function BC(i){return i.internalFormatFloat}function _9(i,t,e,n){let[r,o]=Ja(t,e);return Bf(i,r,o,BC(n),n.textureFormatFloat,i.FLOAT)}function VC(i){return i.internalFormatHalfFloat}function w9(i,t,e,n){let[r,o]=Ja(t,e);return Bf(i,r,o,VC(n),n.textureFormatFloat,n.textureTypeHalfFloat)}function HC(i){return i.downloadTextureFormat}function S9(i,t,e,n){let[r,o]=Ja(t,e);return Bf(i,r,o,HC(n),i.RGBA,i.UNSIGNED_BYTE)}function $C(i){return i.internalFormatPackedFloat}function C9(i,t,e,n){let[r,o]=Jr(t,e);return Bf(i,r,o,$C(n),i.RGBA,i.FLOAT)}function UC(i){return i.internalFormatPackedHalfFloat}function M9(i,t,e,n){let[r,o]=Jr(t,e);return Bf(i,r,o,UC(n),i.RGBA,n.textureTypeHalfFloat)}function E9(i,t,e){return qt(i,()=>i.bindBuffer(i.ARRAY_BUFFER,e)),zC(i,t,"clipSpacePos",e,3,20,0)&&zC(i,t,"uv",e,2,20,12)}function T9(i,t,e,n,r,o){qt(i,()=>i.bindTexture(i.TEXTURE_2D,t));let s,a,l;r instanceof Uint8Array?(s=new Uint8Array(e*n*4),a=i.UNSIGNED_BYTE,l=i.RGBA):(s=new Float32Array(e*n*4),a=i.FLOAT,l=o.internalFormatPackedFloat),s.set(r),qt(i,()=>i.texImage2D(i.TEXTURE_2D,0,l,e,n,0,i.RGBA,a,s)),qt(i,()=>i.bindTexture(i.TEXTURE_2D,null))}function I9(i,t,e){qt(i,()=>i.bindTexture(i.TEXTURE_2D,t)),e.data instanceof Uint8Array?qt(i,()=>i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e.width,e.height,0,i.RGBA,i.UNSIGNED_BYTE,e.data)):qt(i,()=>i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e)),qt(i,()=>i.bindTexture(i.TEXTURE_2D,null))}function A9(i,t,e,n){let r=i.createBuffer();qt(i,()=>i.bindBuffer(i.PIXEL_PACK_BUFFER,r));let a=4*4*t*e;return qt(i,()=>i.bufferData(i.PIXEL_PACK_BUFFER,a,i.STREAM_READ)),qt(i,()=>i.readPixels(0,0,e,t,i.RGBA,i.FLOAT,0)),qt(i,()=>i.bindBuffer(i.PIXEL_PACK_BUFFER,null)),r}function k9(i,t,e){let n=i,r=new Float32Array(e);return n.bindBuffer(n.PIXEL_PACK_BUFFER,t),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,r),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),r}function R9(i,t,e,n){let[r,o]=Ja(t,e),s=4,a=new Uint8Array(Y6(t*e,s));return qt(i,()=>i.readPixels(0,0,r,o,n.downloadTextureFormat,i.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function P9(i,t,e,n,r,o,s,a){let l=i,c=new Float32Array(Z6(o,s));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function N9(i,t,e){let n=new Float32Array(t*e*4);return qt(i,()=>i.readPixels(0,0,e,t,i.RGBA,i.FLOAT,n)),n}var Mx=class{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];let e=ot().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,K6(e,t)):this.gl=Ai(e);let n="WEBGL_color_buffer_float",r="EXT_color_buffer_half_float";if(ot().getNumber("WEBGL_VERSION")===1){let o="OES_texture_float",s="OES_texture_half_float";if(this.textureFloatExtension=Ff(this.gl,o),ki(this.gl,s))this.textureHalfFloatExtension=Ff(this.gl,s);else if(ot().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),ki(this.gl,r))this.colorBufferHalfFloatExtension=Ff(this.gl,r);else if(ot().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",ki(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else if(ki(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=v9(this.gl),this.indexBuffer=b9(this.gl),this.framebuffer=a9(this.gl),this.textureConfig=zf(this.gl,this.textureHalfFloatExtension)}get debug(){return ot().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let t=this.gl;qt(t,()=>t.finish()),qt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),qt(t,()=>t.deleteFramebuffer(this.framebuffer)),qt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),qt(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),qt(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),_9(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),w9(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),S9(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),I9(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,n,r){this.throwIfDisposed(),T9(this.gl,t,e,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),M9(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),C9(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(FC(this.gl,this.framebuffer),this.outputTexture=null),qt(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,()=>R9(this.gl,e,n,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,n,r,o,s){return P9(this.gl,t,e,n,r,o,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return k9(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);let r=A9(this.gl,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){let t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if(ot().getBool("WEBGL_FENCE_API_ENABLED")){let r=t,o=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{let s=r.clientWaitSync(o,0,0);return s===r.ALREADY_SIGNALED||s===r.CONDITION_SATISFIED},e=o}else ot().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,ot().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,()=>N9(this.gl,e,n))}createProgram(t){this.throwIfDisposed();let e=this.gl,n=t9(e,t),r=y9(e),o=e9(e);return qt(e,()=>e.attachShader(o,r)),qt(e,()=>e.attachShader(o,n)),n9(e,o),this.debug&&dx(e,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=E9(e,this.program,this.vertexBuffer)),o}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&qt(this.gl,()=>this.gl.deleteProgram(t))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&dx(this.gl,this.program),qt(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,e,n=!0){return this.throwIfDisposed(),n?l9(this.gl,t,e):c9(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),qt(this.gl,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),u9(this.gl,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();let[r,o]=Jr(e,n);this.setOutputMatrixTextureDriver(t,r,o)}setOutputMatrixWriteRegion(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)}setOutputPackedMatrixWriteRegion(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&dx(this.gl,this.program),Of(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let t=this.gl;this.debug&&this.debugValidate(),qt(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),qt(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Ff(this.gl,ot().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ot().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let n=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=n.createQuery();return n.beginQuery(r.TIME_ELAPSED_EXT,o),o}let t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(ot().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT);return}let t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}waitForQueryAndGetTime(t){return $t(this,null,function*(){return yield L.repeatedTry(()=>this.disposed||this.isQueryAvailable(t,ot().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,ot().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})}getQueryTime(t,e){if(e===0)return null;if(e===2){let n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}else{let n=this.getQueryTimerExtensionWebGL1();return n.getQueryObjectEXT(t,n.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(e===0)return!0;if(e===2){let n=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{let n=this.getQueryTimerExtensionWebGL1(),r=n.getQueryObjectEXT(t,n.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){let t=bet(this.itemsToPoll.map(e=>e.isDoneFn));for(let e=0;e<=t;++e){let{resolveFn:n}=this.itemsToPoll[e];n()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),!(this.itemsToPoll.length>1)&&L.repeatedTry(()=>(this.pollItems(),this.itemsToPoll.length===0))}bindTextureToFrameBuffer(t){this.throwIfDisposed(),mx(this.gl,t,this.framebuffer),this.debug&&Of(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(mx(this.gl,this.outputTexture,this.framebuffer),this.debug&&Of(this.gl)):FC(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);let n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();let r=this.gl;mx(r,t,this.framebuffer),this.debug&&Of(r),this.outputTexture=t,qt(r,()=>r.viewport(0,0,e,n)),qt(r,()=>r.scissor(0,0,e,n))}setOutputMatrixWriteRegionDriver(t,e,n,r){this.throwIfDisposed(),qt(this.gl,()=>this.gl.scissor(t,e,n,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}};function bet(i){let t=0;for(;t<i.length&&i[t]();++t);return t-1}var{getBroadcastDims:L9}=O;function D9(i,t,e,n){let r=[];i.forEach(d=>{let m=L.sizeFromShape(d.shapeInfo.logicalShape);d.shapeInfo.isUniform?r.push(`uniform float ${d.name}${m>1?`[${m}]`:""};`):(r.push(`uniform sampler2D ${d.name};`),r.push(`uniform int offset${d.name};`))});let o=r.join(`
`),s=i.map(d=>_et(d,t,n)).join(`
`),a=t.texShape,l=$e(),c=Met(l),u,h,p=Iet(l);return t.isPacked?(u=wet(t.logicalShape,a),h=Tet(l)):(u=Cet(t.logicalShape,a),h=Eet(l)),n&&(p+=Pet),[p,c,h,o,u,s,e].join(`
`)}function ou(i){let t=i.shapeInfo.logicalShape;switch(t.length){case 0:return Wet(i);case 1:return jet(i);case 2:return Xet(i);case 3:return Yet(i);case 4:return Jet(i);case 5:return Qet(i);case 6:return tnt(i);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function z9(i){switch(i.shapeInfo.logicalShape.length){case 0:return Uet(i);case 1:return Get(i);case 2:return qet(i);case 3:return Ket(i);default:return Zet(i)}}function _et(i,t,e=!1){let n="";e?n+=z9(i):n+=ou(i);let r=i.shapeInfo.logicalShape,o=t.logicalShape;return r.length<=o.length&&(e?n+=ent(i,t):n+=nnt(i,t)),n}function wet(i,t){switch(i.length){case 0:return F9();case 1:return Net(i,t);case 2:return Het(i,t);case 3:return Det(i,t);default:return Fet(i,t)}}function Cet(i,t){switch(i.length){case 0:return F9();case 1:return Let(i,t);case 2:return $et(i,t);case 3:return zet(i,t);case 4:return Oet(i,t);case 5:return Bet(i,t);case 6:return Vet(i,t);default:throw new Error(`${i.length}-D output sampling is not yet supported`)}}function Met(i){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${i.texture2D}(textureSampler, uv).r;
    }
  `}function Eet(i){return`
    void setOutput(float val) {
      ${i.output} = vec4(val, 0, 0, 0);
    }
  `}function Tet(i){return`
    void setOutput(vec4 val) {
      ${i.output} = val;
    }
  `}function Iet(i){return`${i.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${i.varyingFs} vec2 resultUV;
    ${i.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${i.defineSpecialNaN}
    ${i.defineSpecialInf}
    ${i.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Aet}
    ${ket}
    ${Ret}
  `}var Aet=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ket=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Ret=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Pet=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function F9(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Net(i,t){let e=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return e[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${e[0]}.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return 2 * (resTexRC.x * ${e[1]} + resTexRC.y);
    }
  `}function Let(i,t){return t[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function Det(i,t){let e=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],n=Math.ceil(i[2]/2),r=n*Math.ceil(i[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      int b = index / ${r};
      index -= b * ${r};

      int r = 2 * (index / ${n});
      int c = imod(index, ${n}) * 2;

      return ivec3(b, r, c);
    }
  `}function zet(i,t){let e=yr(["r","c","d"],i);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${e}
      return ivec3(r, c, d);
    }
  `}function Fet(i,t){let e=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],n=Math.ceil(i[i.length-1]/2),r=n*Math.ceil(i[i.length-2]/2),o=r,s="",a="b, r, c";for(let l=2;l<i.length-1;l++)o*=i[i.length-l-1],s=`
      int b${l} = index / ${o};
      index -= b${l} * ${o};
    `+s,a=`b${l}, `+a;return`
    ivec${i.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${s}

      int b = index / ${r};
      index -= b * ${r};

      int r = 2 * (index / ${n});
      int c = imod(index, ${n}) * 2;

      return ivec${i.length}(${a});
    }
  `}function Oet(i,t){let e=yr(["r","c","d","d2"],i);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${e}
      return ivec4(r, c, d, d2);
    }
  `}function Bet(i,t){let e=yr(["r","c","d","d2","d3"],i);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${e}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Vet(i,t){let e=yr(["r","c","d","d2","d3","d4"],i);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${e}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Het(i,t){let e=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(L.arraysEqual(i,t))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `;let n=Math.ceil(i[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = 2 * (index / ${n});
      int c = imod(index, ${n}) * 2;

      return ivec2(r, c);
    }
  `}function $et(i,t){return L.arraysEqual(i,t)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:i[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:i[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${i[1]};
      int c = index - r * ${i[1]};
      return ivec2(r, c);
    }
  `}function tl(i){return`offset${i}`}function Uet(i){let t=i.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),n=$e();return`
    vec4 ${e}() {
      return ${n.texture2D}(${t}, halfCR);
    }
  `}function Wet(i){let t=i.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1);if(i.shapeInfo.isUniform)return`float ${e}() {return ${t};}`;let[n,r]=i.shapeInfo.texShape;if(n===1&&r===1)return`
      float ${e}() {
        return sampleTexture(${t}, halfCR);
      }
    `;let[o,s]=i.shapeInfo.texShape,a=tl(t);return`
    float ${e}() {
      vec2 uv = uvFromFlat(${o}, ${s}, ${a});
      return sampleTexture(${t}, uv);
    }
  `}function Get(i){let t=i.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),n=i.shapeInfo.texShape,r=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)],o=$e();return`
    vec4 ${e}(int index) {
      vec2 uv = packedUVfrom1D(
        ${r[0]}, ${r[1]}, index);
      return ${o.texture2D}(${t}, uv);
    }
  `}function jet(i){let t=i.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1);if(i.shapeInfo.isUniform)return`
      float ${e}(int index) {
        ${su(i)}
      }
    `;let n=i.shapeInfo.texShape,r=n[0],o=n[1];if(o===1&&r===1)return`
      float ${e}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;let s=tl(t);return o===1?`
      float ${e}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / ${r}.0);
        return sampleTexture(${t}, uv);
      }
    `:r===1?`
      float ${e}(int index) {
        vec2 uv = vec2((float(index + ${s}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
    float ${e}(int index) {
      vec2 uv = uvFromFlat(${r}, ${o}, index + ${s});
      return sampleTexture(${t}, uv);
    }
  `}function qet(i){let t=i.shapeInfo.logicalShape,e=i.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=i.shapeInfo.texShape,o=r[0],s=r[1],a=$e();if(r!=null&&L.arraysEqual(t,r))return`
      vec4 ${n}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}.0, ${o}.0);

        return ${a.texture2D}(${e}, uv);
      }
    `;let l=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],c=Math.ceil(t[1]/2);return`
    vec4 ${n}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${l[0]}, ${l[1]}, row, col);
      return ${a.texture2D}(${e}, uv);
    }
  `}function Xet(i){let t=i.shapeInfo.logicalShape,e=i.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=i.shapeInfo.texShape;if(r!=null&&L.arraysEqual(t,r)){let h=r[0],p=r[1];return`
    float ${n}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${p}.0, ${h}.0);
      return sampleTexture(${e}, uv);
    }
  `}let{newShape:o,keptDims:s}=L.squeezeShape(t),a=o;if(a.length<t.length){let h=au(i,a),p=["row","col"];return`
      ${ou(h)}
      float ${n}(int row, int col) {
        return ${n}(${lu(p,s)});
      }
    `}if(i.shapeInfo.isUniform)return`
      float ${n}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${su(i)}
      }
    `;let l=r[0],c=r[1],u=tl(e);return c===1?`
    float ${n}(int row, int col) {
      float index = dot(vec3(row, col, ${u}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${l}.0);
      return sampleTexture(${e}, uv);
    }
  `:l===1?`
    float ${n}(int row, int col) {
      float index = dot(vec3(row, col, ${u}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${e}, uv);
    }
  `:`
  float ${n}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${u};
    vec2 uv = uvFromFlat(${l}, ${c}, index);
    return sampleTexture(${e}, uv);
  }
`}function Ket(i){let t=i.shapeInfo.logicalShape,e=i.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=i.shapeInfo.texShape,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];if(t[0]===1){let h=t.slice(1),p=[1,2],f=au(i,h),d=["b","row","col"];return`
        ${z9(f)}
        vec4 ${n}(int b, int row, int col) {
          return ${n}(${lu(d,p)});
        }
      `}let s=o[0],a=o[1],l=Math.ceil(t[2]/2),c=l*Math.ceil(t[1]/2),u=$e();return`
    vec4 ${n}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${s}, ${a}, ${c}, ${l}, b, row, col);
      return ${u.texture2D}(${e}, uv);
    }
  `}function Yet(i){let t=i.shapeInfo.logicalShape,e=i.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t[1]*t[2],o=t[2],{newShape:s,keptDims:a}=L.squeezeShape(t),l=s;if(l.length<t.length){let d=au(i,l),m=["row","col","depth"];return`
        ${ou(d)}
        float ${n}(int row, int col, int depth) {
          return ${n}(${lu(m,a)});
        }
      `}if(i.shapeInfo.isUniform)return`
      float ${n}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${r}, ${o}, 1)));
        ${su(i)}
      }
    `;let c=i.shapeInfo.texShape,u=c[0],h=c[1],p=i.shapeInfo.flatOffset;if(h===r&&p==null)return`
        float ${n}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${u}.0);
          return sampleTexture(${e}, uv);
        }
      `;if(h===o&&p==null)return`
    float ${n}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${u}.0);
      return sampleTexture(${e}, uv);
    }
  `;let f=tl(e);return`
      float ${n}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r} + col * ${o} + depth + ${f};
        vec2 uv = uvFromFlat(${u}, ${h}, index);
        return sampleTexture(${e}, uv);
      }
  `}function Zet(i){let t=i.shapeInfo.logicalShape,e=t.length,n=i.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=i.shapeInfo.texShape,s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],a=s[0],l=s[1],c=Math.ceil(t[e-1]/2),u=c*Math.ceil(t[e-2]/2),h="int b, int row, int col",p=`b * ${u} + (row / 2) * ${c} + (col / 2)`;for(let d=2;d<e-1;d++)h=`int b${d}, `+h,u*=t[e-d-1],p=`b${d} * ${u} + `+p;let f=$e();return`
    vec4 ${r}(${h}) {
      int index = ${p};
      int texR = index / ${l};
      int texC = index - texR * ${l};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${l}, ${a});
      return ${f.texture2D}(${n}, uv);
    }
  `}function Jet(i){let t=i.shapeInfo.logicalShape,e=i.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t[3],o=t[2]*r,s=t[1]*o,{newShape:a,keptDims:l}=L.squeezeShape(t);if(a.length<t.length){let d=au(i,a),m=["row","col","depth","depth2"];return`
      ${ou(d)}
      float ${n}(int row, int col, int depth, int depth2) {
        return ${n}(${lu(m,l)});
      }
    `}if(i.shapeInfo.isUniform)return`
      float ${n}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${s}, ${o}, ${r}, 1)));
        ${su(i)}
      }
    `;let c=i.shapeInfo.flatOffset,u=i.shapeInfo.texShape,h=u[0],p=u[1];if(p===s&&c==null)return`
      float ${n}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(p===r&&c==null)return`
      float ${n}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${e}, uv);
      }
    `;let f=tl(e);return`
    float ${n}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${s} + col * ${o} +
          depth * ${r} + depth2;
      vec2 uv = uvFromFlat(${h}, ${p}, index + ${f});
      return sampleTexture(${e}, uv);
    }
  `}function Qet(i){let t=i.shapeInfo.logicalShape,e=i.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t[4],o=t[3]*r,s=t[2]*o,a=t[1]*s,{newShape:l,keptDims:c}=L.squeezeShape(t);if(l.length<t.length){let m=au(i,l),x=["row","col","depth","depth2","depth3"];return`
      ${ou(m)}
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        return ${n}(${lu(x,c)});
      }
    `}if(i.shapeInfo.isUniform)return`
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${s}, ${o}, ${r})) +
          depth3;
        ${su(i)}
      }
    `;let u=i.shapeInfo.flatOffset,h=i.shapeInfo.texShape,p=h[0],f=h[1];if(f===a&&u==null)return`
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${s}, ${o}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(f===r&&u==null)return`
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${e}, uv);
      }
    `;let d=tl(e);return`
    float ${n}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${s} + depth * ${o} +
          depth2 * ${r} + depth3 + ${d};
      vec2 uv = uvFromFlat(${p}, ${f}, index);
      return sampleTexture(${e}, uv);
    }
  `}function tnt(i){let t=i.shapeInfo.logicalShape,e=i.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),{newShape:r,keptDims:o}=L.squeezeShape(t);if(r.length<t.length){let x=au(i,r),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${ou(x)}
      float ${n}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${n}(${lu(g,o)});
      }
    `}let s=t[5],a=t[4]*s,l=t[3]*a,c=t[2]*l,u=t[1]*c;if(i.shapeInfo.isUniform)return`
      float ${n}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${s}, 1)));
        ${su(i)}
      }
    `;let h=i.shapeInfo.flatOffset,p=i.shapeInfo.texShape,f=p[0],d=p[1];if(d===u&&h==null)return`
      float ${n}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${s})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${d}.0, ${f}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(d===s&&h==null)return`
      float ${n}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${d}.0, ${f}.0);
        return sampleTexture(${e}, uv);
      }
    `;let m=tl(e);return`
    float ${n}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${s} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${d}, index);
      return sampleTexture(${e}, uv);
    }
  `}function su(i){let t=i.name,e=L.sizeFromShape(i.shapeInfo.logicalShape);return e<2?`return ${t};`:`
    for (int i = 0; i < ${e}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function ent(i,t){let e=i.name,n=e.charAt(0).toUpperCase()+e.slice(1),r="get"+n+"AtOutCoords",o=i.shapeInfo.logicalShape.length,s=t.logicalShape.length,a=L9(i.shapeInfo.logicalShape,t.logicalShape),l=ie(s),c=s-o,u,h=["x","y","z","w","u","v"];o===0?u="":s<2&&a.length>=1?u="coords = 0;":u=a.map(y=>`coords.${h[y+c]} = 0;`).join(`
`);let p="";s<2&&o>0?p="coords":p=i.shapeInfo.logicalShape.map((y,b)=>`coords.${h[b+c]}`).join(", ");let f="return outputValue;",m=L.sizeFromShape(i.shapeInfo.logicalShape)===1,g=L.sizeFromShape(t.logicalShape)===1;if(o===1&&!m&&!g)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!g)s===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){let y=o-2,b=o-1;a.indexOf(y)>-1&&a.indexOf(b)>-1?f="return vec4(outputValue.x);":a.indexOf(y)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${n}(${p});
      ${f}
    }
  `}function nnt(i,t){let e=i.name,n=e.charAt(0).toUpperCase()+e.slice(1),r="get"+n+"AtOutCoords",o=t.texShape,s=i.shapeInfo.texShape,a=i.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!i.shapeInfo.isUniform&&a===l&&i.shapeInfo.flatOffset==null&&L.arraysEqual(s,o))return`
      float ${r}() {
        return sampleTexture(${e}, resultUV);
      }
    `;let c=ie(l),u=L9(i.shapeInfo.logicalShape,t.logicalShape),h=l-a,p,f=["x","y","z","w","u","v"];a===0?p="":l<2&&u.length>=1?p="coords = 0;":p=u.map(m=>`coords.${f[m+h]} = 0;`).join(`
`);let d="";return l<2&&a>0?d="coords":d=i.shapeInfo.logicalShape.map((m,x)=>`coords.${f[x+h]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${p}
      return get${n}(${d});
    }
  `}function ie(i){if(i<=1)return"int";if(i===2)return"ivec2";if(i===3)return"ivec3";if(i===4)return"ivec4";if(i===5)return"ivec5";if(i===6)return"ivec6";throw Error(`GPU for rank ${i} is not yet supported`)}function au(i,t){let e=JSON.parse(JSON.stringify(i));return e.shapeInfo.logicalShape=t,e}function lu(i,t){return t.map(e=>i[e]).join(", ")}function B9(i,t,e,n){let r=t.userCode,o=e.map((f,d)=>{let m={logicalShape:f.shape,texShape:f.isUniform?null:f.texData.texShape,isUniform:f.isUniform,isPacked:f.isUniform?!1:f.texData.isPacked,flatOffset:null};return f.texData!=null&&f.texData.slice!=null&&f.texData.slice.flatOffset>0&&(m.flatOffset=f.texData.slice.flatOffset),{name:t.variableNames[d],shapeInfo:m}}),s=o.map(f=>f.shapeInfo),a={logicalShape:n.shape,texShape:n.texData.texShape,isUniform:!1,isPacked:n.texData.isPacked,flatOffset:null},l=D9(o,a,r,t.packedInputs),c=i.createProgram(l),u=null,h=i.getUniformLocation(c,"NAN",!1);ot().getNumber("WEBGL_VERSION")===1&&(u=i.getUniformLocation(c,"INFINITY",!1));let p={};for(let f=0;f<t.variableNames.length;f++){let d=t.variableNames[f],m=!1;p[d]=i.getUniformLocation(c,d,m),p[`offset${d}`]=i.getUniformLocation(c,`offset${d}`,m)}return{program:t,source:l,webGLProgram:c,uniformLocations:p,inShapeInfos:s,outShapeInfo:a,infLoc:u,nanLoc:h}}function O9(i,t){if(i.length!==t.length)throw Error(`Binary was compiled with ${i.length} inputs, but was executed with ${t.length} inputs`);i.forEach((e,n)=>{let r=e.logicalShape,o=t[n],s=o.shape;if(!L.arraysEqual(r,s))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${s} must match`);if(e.isUniform&&o.isUniform)return;let a=e.texShape,l=o.isUniform?null:o.texData.texShape;if(!L.arraysEqual(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function V9(i,t,e,n,r){O9(t.inShapeInfos,e),O9([t.outShapeInfo],[n]);let o=n.texData.texture,s=n.texData.texShape;n.texData.isPacked?i.setOutputPackedMatrixTexture(o,s[0],s[1]):i.setOutputMatrixTexture(o,s[0],s[1]),i.setProgram(t.webGLProgram),ot().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&i.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&i.gl.uniform1f(t.nanLoc,NaN),e.forEach((a,l)=>{let c=t.program.variableNames[l],u=t.uniformLocations[c],h=t.uniformLocations[`offset${c}`];if(u!=null){if(a.isUniform){if(L.sizeFromShape(a.shape)<2)i.gl.uniform1f(u,a.uniformValues[0]);else{let p=a.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),i.gl.uniform1fv(u,p)}return}a.texData.slice!=null&&h!=null&&i.gl.uniform1i(h,a.texData.slice.flatOffset),i.setInputMatrixTexture(a.texData.texture,u,l)}}),r!=null&&r(i,t.webGLProgram),i.executeProgram()}function H9(i,t,e){let n="";t.concat(e).forEach(s=>{let a=s.texData!=null&&s.texData.slice!=null&&s.texData.slice.flatOffset>0,l=s.isUniform?"uniform":s.texData.texShape;n+=`${s.shape}_${l}_${a}`});let r=i.userCode,o=i.constructor.name;return o+="_"+n+"_"+r,o}var{addImpl:$9,bincountImpl:Ex,bincountReduceImpl:U9,ceilImpl:W9,concatImpl:G9,expImpl:j9,expm1Impl:q9,floorImpl:X9,gatherV2Impl:K9,greaterImpl:Y9,lessImpl:Z9,linSpaceImpl:J9,logImpl:Q9,maxImpl:tD,maximumImpl:eD,minimumImpl:nD,multiplyImpl:iD,negImpl:rD,prodImpl:oD,rangeImpl:sD,rsqrtImpl:aD,simpleAbsImpl:Tx,sliceImpl:lD,stridedSliceImpl:cD,subImpl:uD,tileImpl:hD,topKImpl:pD,transposeImpl:el,uniqueImpl:fD}=xC;function WC(i,t){return["x","y","z","w","u","v"].slice(0,t).map(e=>`${i}.${e}`)}function qe(i,t){return t===1?[i]:WC(i,t)}function dD(i,t){if(i===1)return"rc";let e="";for(let n=0;n<i;n++)e+=t[n],n<i-1&&(e+=",");return e}var Ix=class{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;let e=t.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let n=qe("rc",e),r=ie(e),o=snt(e,t,n),s=ant(e,t[t.length-1],t[t.length-2],n),a=lnt(t,n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${o}) {
            setOutput(vec4(0));
          } else {
            ${s}

            setOutput(vec4(${a}));
          }
        }
      `}}};function ont(i,t){let e=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let o=`${n===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let s=2;s<i;s++)o=`${t[t.length-1-s]},`+o;e.push(o)}return e}function snt(i,t,e){if(i===1)return`rc > ${t[0]}`;let n="";for(let r=i-2;r<i;r++)n+=`${e[r]} >= ${t[r]}`,r<i-1&&(n+="||");return n}function ant(i,t,e,n){if(i===1)return"";let r=n.slice(-2);return`
    int r = ${r[0]};
    int c = ${r[1]};
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= ${t};
    bool rEdge = rp1 >= ${e};
  `}function lnt(i,t){let e=i.length,n=ont(e,t);return e===1?`getA(rc),
            rc + 1 >= ${i[0]} ? 0. : getA(rc + 1),
            0, 0`:`getA(${n[0]}),
          cEdge ? 0. : getA(${n[1]}),
          rEdge ? 0. : getA(${n[2]}),
          rEdge || cEdge ? 0. : getA(${n[3]})`}var cu=class{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let n="";for(let r=0;r<4;r++){let o="thisRC = rc;";r%2===1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+=`
        ${o}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${cnt(e)}
      ${iu(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${t[1]};
        int cols = ${t[2]};

        ${n}

        setOutput(result);
      }
    `}};function cnt(i){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${yr(["r","c","d"],i)}
      return ivec3(r, c, d);
    }
  `}var Ax=class{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,e,n){let r=gD(e,n),o=xD(t,r,n);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);let s=mD(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();let l=this.freeTextures[o].shift();return this.usedTextures[o].push(l),l}let a;return r===En.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===En.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===En.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===En.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===En.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),a}releaseTexture(t,e,n,r){if(this.freeTextures==null)return;let o=gD(n,r),s=xD(e,o,r);s in this.freeTextures||(this.freeTextures[s]=[]);let a=mD(e,o,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=ot().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(t),this._numBytesAllocated-=a):(this.freeTextures[s].push(t),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;let c=this.usedTextures[s],u=c.indexOf(t);if(u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(u,1),this.log()}log(){if(!this.logEnabled)return;let t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);let e=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*e)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let t in this.freeTextures)this.freeTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e)});for(let t in this.usedTextures)this.usedTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function unt(i,t){let e=i;if(t===e.R32F)return 4;if(t===e.R16F)return 2;if(t===e.RGBA32F)return 16;if(t===i.RGBA)return 16;if(t===e.RGBA16F)return 8;throw new Error(`Unknown internal format ${t}`)}function mD(i,t,e,n,r){let o=hnt(t,n),s;if(r){let[l,c]=Jr(i[0],i[1]);s=l*c}else{let[l,c]=Ja(i[0],i[1]);s=l*c}let a=unt(e,o);return s*a}function hnt(i,t){switch(i){case En.PACKED_2X2_FLOAT32:return $C(t);case En.PACKED_2X2_FLOAT16:return UC(t);case En.UNPACKED_FLOAT32:return BC(t);case En.UNPACKED_FLOAT16:return VC(t);case En.PACKED_4X1_UNSIGNED_BYTE:return HC(t);default:throw new Error(`Unknown physical texture type ${i}`)}}function pnt(i){return ot().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?i?En.PACKED_2X2_FLOAT32:En.UNPACKED_FLOAT32:i?En.PACKED_2X2_FLOAT16:En.UNPACKED_FLOAT16}function gD(i,t){if(i===Bn.UPLOAD)return En.PACKED_2X2_FLOAT32;if(i===Bn.RENDER||i==null)return pnt(t);if(i===Bn.DOWNLOAD||i===Bn.PIXELS)return En.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${i}`)}function xD(i,t,e){return`${i[0]}_${i[1]}_${t}_${e}`}var ti=class{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      float unaryOperation(float x) {
        ${e}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}},bn="if (isnan(x)) return x;",yD="return x;",GC="return abs(x);";var vD="return (x >= 0.0) ? x : (exp(x) - 1.0);",bD=bn+`
  return (x < 0.0) ? 0.0 : x;
`,_D=bn+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Vf="return x;";var SD="return x;",CD=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,MD=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ED=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Ji=class{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${e}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}};var kx=class{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;let e=t.length,n=qe("rc",e),r=ie(e),o=dD(e,n),s=n.slice(-2),a=e<=1?"rc":`vec2(${s.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}};var dnt=Fn.whereImpl,mnt=1e-7,gnt=1e-4,Rx={};function xnt(i){return i in Rx||(Rx[i]={}),Rx[i]}var ynt=128,vnt=600;function bnt(){return ot().global.screen==null?1024:ot().global.screen.height*ot().global.screen.width*window.devicePixelRatio*vnt/1024/1024}var nl=class extends Ao{constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ot().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(t==null){let e=Ai(ot().getNumber("WEBGL_VERSION"));this.binaryCache=xnt(ot().getNumber("WEBGL_VERSION")),this.gpgpu=new Mx(e),this.canvas=e.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpu=t,this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;this.textureManager=new Ax(this.gpgpu),this.numMBBeforeWarning=bnt(),this.texData=new Na(this,No())}nextDataId(){return nl.nextDataId++}numDataIds(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}write(t,e,n){if((ot().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ot().getBool("DEBUG"))&&this.checkNumericalProblems(t),n==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let r={id:this.nextDataId()};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:Bn.UPLOAD,refCount:1}),r}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){let e=this.texData.get(t);e.refCount++}decRef(t){if(this.texData.has(t)){let e=this.texData.get(t);e.refCount--}}move(t,e,n,r,o){if(ot().getBool("DEBUG")&&this.checkNumericalProblems(e),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:Bn.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){let e=this.texData.get(t),{values:n,dtype:r,complexTensorInfos:o,slice:s,shape:a,isPacked:l}=e;if(s!=null){let p;l?p=new Ji(a,Vf):p=new ti(a,Vf);let f=this.runWebGLProgram(p,[{dataId:t,shape:a,dtype:r}],r),d=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),d}if(n!=null)return this.convertAndCacheOnCPU(t);if(r==="string")return n;let c=this.activeTimers!=null,u;c&&(u=L.now());let h;if(r==="complex64"){let p=this.readSync(o.real.dataId),f=this.readSync(o.imag.dataId);h=O.mergeRealAndImagArrays(p,f)}else h=this.getValuesFromTexture(t);return c&&(this.downloadWaitMs+=L.now()-u),this.convertAndCacheOnCPU(t,h)}read(t){return $t(this,null,function*(){if(this.pendingRead.has(t)){let d=this.pendingRead.get(t);return new Promise(m=>d.push(m))}let e=this.texData.get(t),{values:n,shape:r,slice:o,dtype:s,complexTensorInfos:a,isPacked:l}=e;if(o!=null){let d;l?d=new Ji(r,Vf):d=new ti(r,Vf);let m=this.runWebGLProgram(d,[{dataId:t,shape:r,dtype:s}],s),x=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),x}if(n!=null)return this.convertAndCacheOnCPU(t);if(!ot().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ot().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(s!=="complex64"&&ot().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(t);let d=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(d.texture,...Ss(r))}this.pendingRead.set(t,[]),s!=="complex64"&&(yield this.gpgpu.createAndWaitForFence());let h;if(s==="complex64"){let d=yield Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=d[0],x=d[1];h=O.mergeRealAndImagArrays(m,x)}else if(c==null)h=this.getValuesFromTexture(t);else{let d=L.sizeFromShape(r);h=this.gpgpu.downloadFloat32MatrixFromBuffer(c,d)}u!=null&&this.disposeIntermediateTensorInfo(u);let p=this.convertAndCacheOnCPU(t,h),f=this.pendingRead.get(t);return this.pendingRead.delete(t),f.forEach(d=>d(p)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&No().removeDataId(t,this),this.pendingDeletes--),p})}bufferSync(t){let e=this.readSync(t.dataId),n=e;if(t.dtype==="string")try{n=e.map(r=>L.decodeString(r))}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return Yt(t.shape,t.dtype,n)}checkNumericalProblems(t){if(t!=null)for(let e=0;e<t.length;e++){let n=t[e];if(!J6(n))throw ot().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${n} cannot be represented on this device.`)}}getValuesFromTexture(t){let{shape:e,dtype:n,isPacked:r}=this.texData.get(t),o=L.sizeFromShape(e);if(ot().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let p=this.decode(t),f=this.texData.get(p.dataId),d=this.gpgpu.downloadMatrixFromPackedTexture(f.texture,...Ss(e)).subarray(0,o);return this.disposeIntermediateTensorInfo(p),d}let s=ot().getBool("WEBGL_PACK")&&r===!0,a=s?gx(e):e,l=s?new wx(a):new _x(a),c=this.runWebGLProgram(l,[{shape:a,dtype:n,dataId:t}],"float32"),u=this.texData.get(c.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture,u.texShape[0],u.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(c),h}timerAvailable(){return ot().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){return $t(this,null,function*(){let e=this.activeTimers,n=[],r=!1;this.programTimersStack==null?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t();let o=L.flatten(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),s=L.flatten(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=e,r&&(this.programTimersStack=null);let a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};if(ot().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let l=yield Promise.all(o);a.kernelMs=L.sum(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:s[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ot().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:L.now(),endMs:null}}endTimer(t){return ot().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=L.now(),t)}getQueryTime(t){return $t(this,null,function*(){if(ot().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);let e=t;return e.endMs-e.startMs})}disposeData(t,e=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(e?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!e&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);let{complexTensorInfos:n}=this.texData.get(t);return n!=null&&(this.disposeData(n.real.dataId,e),this.disposeData(n.imag.dataId,e)),this.texData.delete(t),!0}releaseGPUData(t){let{texture:e,dtype:n,texShape:r,usage:o,isPacked:s,slice:a}=this.texData.get(t),l=a&&a.origDataId||t,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),e!=null&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(e,r,o,s)));let u=this.texData.get(t);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,e=ynt){return ot().getBool("WEBGL_CPU_FORWARD")&&t.every(n=>this.texData.get(n.dataId).texture==null&&L.sizeFromShape(n.shape)<e)}getGPGPUContext(){return this.gpgpu}where(t){O.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let e=t.dataSync();return dnt(t.shape,e)}packedUnaryOp(t,e,n){let r=new Ji(t.shape,e),o=this.compileAndRun(r,[t],n);return No().makeTensorFromDataId(o.dataId,o.shape,o.dtype)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){let r=Tx(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,r)}if(ot().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,GC,t.dtype);let e=new ti(t.shape,GC),n=this.compileAndRun(e,[t]);return No().makeTensorFromDataId(n.dataId,n.shape,n.dtype)}makeTensorInfo(t,e,n){let r;if(e==="string"&&n!=null&&n.length>0&&L.isString(n[0])){let o=n.map(s=>L.encodeString(s));r=this.write(o,t,e)}else r=this.write(n,t,e);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:e}}makeOutput(t,e,n){let{dataId:r}=this.makeTensorInfo(t,e,n);return No().makeTensorFromDataId(r,t,e,this)}unpackTensor(t){let e=new kx(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){let e=new Ix(t.shape),n=!0;return this.runWebGLProgram(e,[t],t.dtype,null,n)}packedReshape(t,e){let n=[Cs(t.shape),...Ms(t.shape)],r={dtype:t.dtype,shape:n,dataId:t.dataId},o=[Cs(e),...Ms(e)],s=new cu(o,n),a=!0,l=this.runWebGLProgram(s,[r],t.dtype,null,a);return{dataId:l.dataId,shape:e,dtype:l.dtype}}decode(t){let e=this.texData.get(t),{isPacked:n,shape:r,dtype:o}=e,s=gx(r),a;n?a=new bx(s):a=new vx(s);let l=!0,c=this.runWebGLProgram(a,[{shape:s,dtype:o,dataId:t}],o,null,l);return{dtype:o,shape:r,dataId:c.dataId}}runWebGLProgram(t,e,n,r,o=!1){let s=this.makeTensorInfo(t.outputShape,n),a=this.texData.get(s.dataId);if(t.packedOutput&&(a.isPacked=!0),t.outPackingScheme===ws.DENSE){let x=Ss(t.outputShape);a.texShape=x.map(g=>g*2)}if(t.outTexUsage!=null&&(a.usage=t.outTexUsage),L.sizeFromShape(s.shape)===0)return a.values=L.getTypedArrayFromDType(s.dtype,0),s;let l=[],c=e.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let g=this.texData.get(x.dataId);if(g.texture==null){if(!t.packedInputs&&L.sizeFromShape(x.shape)<=ot().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:g.values};t.packedInputs&&(g.isPacked=!0,g.shape=x.shape)}else if(!!g.isPacked!=!!t.packedInputs)x=g.isPacked?this.unpackTensor(x):this.packTensor(x),l.push(x),g=this.texData.get(x.dataId);else if(g.isPacked&&!Qa(g.shape,x.shape)){let y=x,b=x.shape;x.shape=g.shape,x=this.packedReshape(x,b),l.push(x),g=this.texData.get(x.dataId),y.shape=b}return this.uploadToGPU(x.dataId),{shape:x.shape,texData:g,isUniform:!1}});this.uploadToGPU(s.dataId);let u={shape:s.shape,texData:a,isUniform:!1},h=H9(t,c,u),p=this.getAndSaveBinary(h,()=>B9(this.gpgpu,t,c,u)),f=this.activeTimers!=null,d;f&&(d=this.startTimer()),V9(this.gpgpu,p,c,u,r),l.forEach(x=>this.disposeIntermediateTensorInfo(x)),f&&(d=this.endTimer(d),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(d)}));let m=ot().get("WEBGL_FLUSH_THRESHOLD");if(m>0){let x=L.now();x-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!ot().getBool("WEBGL_LAZILY_UNPACK")&&a.isPacked&&o===!1){let x=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),x}return s}compileAndRun(t,e,n,r,o=!1){return n=n||e[0].dtype,this.runWebGLProgram(t,e,n,r,o)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ot().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement!="undefined"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=fP(()=>{if(!ot().get("WEBGL_RENDER_FLOAT32_ENABLED")){let t=ot().getBool("DEBUG");ot().set("DEBUG",!1);let e=this.abs(qS(1e-8)).dataSync()[0];if(ot().set("DEBUG",t),e>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?mnt:gnt}uploadToGPU(t){let e=this.texData.get(t),{shape:n,dtype:r,values:o,texture:s,usage:a,isPacked:l}=e;if(s!=null)return;let c=this.activeTimers!=null,u;c&&(u=L.now());let h=e.texShape;if(h==null&&(h=h9(n,l),e.texShape=h),o!=null){let p=gx(n),f,d=h[1],m=h[0],x=o instanceof Uint8Array;l?([d,m]=Jr(h[0],h[1]),f=new Cx(p,[m,d],x)):f=new Sx(p,[m,d],x);let g=this.makeTensorInfo([m,d],r);x?this.texData.get(g.dataId).usage=Bn.PIXELS:this.texData.get(g.dataId).usage=Bn.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),d,m,o);let y=!0,b=this.runWebGLProgram(f,[g],r,null,y),v=this.texData.get(b.dataId);e.texture=v.texture,e.texShape=v.texShape,e.isPacked=v.isPacked,e.usage=v.usage,this.disposeIntermediateTensorInfo(g),this.texData.delete(b.dataId),e.values=null,c&&(this.uploadWaitMs+=L.now()-u)}else{let p=this.acquireTexture(h,a,r,l);e.texture=p}}convertAndCacheOnCPU(t,e){let n=this.texData.get(t),{dtype:r}=n;return this.releaseGPUData(t),e!=null&&(n.values=_nt(e,r)),n.values}acquireTexture(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){let o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,e,r)}computeBytes(t,e){return t[0]*t[1]*L.bytesPerElement(e)}};nl.nextDataId=0;function _nt(i,t){if(t==="float32"||t==="complex64")return i;if(t==="int32"||t==="bool"){let e=t==="int32"?new Int32Array(i.length):new Uint8Array(i.length);for(let n=0;n<e.length;++n)e[n]=Math.round(i[n]);return e}else throw new Error(`Unknown dtype ${t}`)}vs.isBrowser()&&X0("webgl",()=>new nl,2);var Px=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;var Ri=class{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=O.assertAndGetBroadcastShape(e,n),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}};var Es=`
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;
`;var Qi=class{constructor(t,e,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=O.assertAndGetBroadcastShape(e,n);let o=this.outputShape.length,s="";if(r)if(o===0||L.sizeFromShape(this.outputShape)===1)s=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(s=`
          ${ie(o)} coords = getOutputCoords();
        `,o===1)s+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let l=qe("coords",o);s+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${s}

        setOutput(result);
      }
    `}};function Xe(i){let{inputs:t,backend:e}=i,{x:n}=t;return e.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}var TD={kernelName:xs,backendName:"webgl",kernelFunc:Xe};function ui(i){let{inputs:t,backend:e}=i,{real:n,imag:r}=t,o=e.makeTensorInfo(n.shape,"complex64"),s=e.texData.get(o.dataId),a=Xe({inputs:{x:n},backend:e}),l=Xe({inputs:{x:r},backend:e});return s.complexTensorInfos={real:a,imag:l},o}var ID={kernelName:Dc,backendName:"webgl",kernelFunc:ui};var jC="return (a < 0.) ? b * a : a;",qC=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function wnt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{alpha:o}=n,s=e.makeTensorInfo([],"float32",L.createScalarValue(o,"float32")),a=ot().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Qi(qC,r.shape,s.shape):new Ri(jC,r.shape,s.shape),l=e.runWebGLProgram(a,[r,s],r.dtype);return e.disposeIntermediateTensorInfo(s),l}var AD={kernelName:zc,backendName:"webgl",kernelFunc:wnt};var XC="return (a < 0.) ? b * a : a;",KC=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Snt(i){let{inputs:t,backend:e}=i,{x:n,alpha:r}=t,o=ot().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Qi(KC,n.shape,r.shape):new Ri(XC,n.shape,r.shape);return e.runWebGLProgram(o,[n,r],n.dtype)}var kD={kernelName:Oc,backendName:"webgl",kernelFunc:Snt};var Nx="if (isnan(x)) return x;",RD=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,PD=`
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;
`;function Bt({opSnippet:i,packedOpSnippet:t,cpuKernelImpl:e,dtype:n}){return({inputs:r,backend:o})=>{let{x:s}=r,a=o,l=n||s.dtype;if(a.shouldExecuteOnCPU([s])&&e!=null){let h=a.texData.get(s.dataId),p=e(h.values,l);return a.makeTensorInfo(s.shape,l,p)}let c=ot().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null,u;return c?u=new Ji(s.shape,t):u=new ti(s.shape,i),a.runWebGLProgram(u,[s],l)}}function be({opSnippet:i,packedOpSnippet:t,checkOutOfBounds:e=!1,supportsComplex:n=!1,cpuKernelImpl:r,dtype:o}){return({inputs:s,backend:a})=>{let{a:l,b:c}=s,u=a;if(n&&l.dtype==="complex64"){let d=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[x,g]=[[d.complexTensorInfos.real,m.complexTensorInfos.real],[d.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(b=>{let[v,_]=b,S={dataId:v.dataId,dtype:v.dtype,shape:l.shape},E={dataId:_.dataId,dtype:_.dtype,shape:c.shape},M=new Ri(i,l.shape,c.shape);return u.runWebGLProgram(M,[S,E],dn(v.dtype,_.dtype))}),y=ui({inputs:{real:x,imag:g},backend:u});return u.disposeIntermediateTensorInfo(x),u.disposeIntermediateTensorInfo(g),y}let h=o||dn(l.dtype,c.dtype);if(u.shouldExecuteOnCPU([l,c])&&r!=null){let d=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[x,g]=r(l.shape,c.shape,d.values,m.values,h),y=u.makeTensorInfo(g,h),b=u.texData.get(y.dataId);return b.values=x,y}let p=ot().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null,f;return p?f=new Qi(t,l.shape,c.shape,e):f=new Ri(i,l.shape,c.shape),u.runWebGLProgram(f,[l,c],h)}}function Ts(i,t=!1){if(i==="linear")return t?SD:yD;if(i==="relu")return t?MD:bD;if(i==="elu")return t?CD:vD;if(i==="relu6")return t?ED:_D;if(i==="prelu")return t?KC:XC;if(i==="leakyrelu")return t?qC:jC;throw new Error(`Activation ${i} has not been implemented for the WebGL backend.`)}var uu=class{constructor(t,e,n,r=!1,o=!1,s=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;let u=r?t[1]:t[2],h=Math.ceil(u/2),p=r?"i * 2, rc.y":"rc.y, i * 2",f=o?"rc.z, i * 2":"i * 2, rc.z",d=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],x="",g="";a&&(l?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:x=`vec4 activation(vec4 x) {
          ${a}
        }`,g="result = activation(result);");let y=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let b="rc.x",v="rc.x";t[0]<e[0]?b=`int(min(float(rc.x), ${t[0]-1}.))`:e[0]<t[0]&&(v=`int(min(float(rc.x), ${e[0]-1}.))`),this.userCode=`
      ${x}

      const float sharedDimension = ${h}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${h}; i++) {
          int batchA = ${b};
          int batchB = ${v};
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${d[0]} * ${m[0]});
          result += (${d[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${g}

        setOutput(result);
      }
    `}};var YC={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},Hf=class{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=O.assertAndGetBroadcastShape(e,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}};var ND="return a * b;";function $f(i){let{inputs:t,backend:e}=i,{a:n,b:r}=t,o=O.upcastType(n.dtype,r.dtype);if(n.dtype==="complex64"){let a=e.texData.get(n.dataId),l=e.texData.get(r.dataId),c=new Hf(YC.REAL,n.shape,r.shape),u=new Hf(YC.IMAG,n.shape,r.shape),h=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:n.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:n.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],p=e.runWebGLProgram(c,h,"float32"),f=e.runWebGLProgram(u,h,"float32"),d=ui({inputs:{real:p,imag:f},backend:e});return e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(f),d}if(e.shouldExecuteOnCPU([n,r])){let a=e.texData.get(n.dataId),l=e.texData.get(r.dataId),[c,u]=iD(n.shape,r.shape,a.values,l.values,o),h=e.makeTensorInfo(u,o),p=e.texData.get(h.dataId);return p.values=c,h}let s;return ot().getBool("WEBGL_PACK_BINARY_OPERATIONS")?s=new Qi(ND,n.shape,r.shape):s=new Ri(ND,n.shape,r.shape),e.runWebGLProgram(s,[n,r],o)}var LD={kernelName:Oa,backendName:"webgl",kernelFunc:$f};function DD(i,t,e){let n=[Cs(i.shape),...Ms(i.shape)],r={dtype:i.dtype,shape:n,dataId:i.dataId},o=[Cs(t),...Ms(t)],s=new cu(o,n),a=!0,l=e.runWebGLProgram(s,[r],i.dtype,null,a);return{dataId:l.dataId,shape:t,dtype:l.dtype}}function Tt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{shape:o}=n,s=e,a=L.sizeFromShape(r.shape),l=L.inferFromImplicitShape(o,a),c=L.sizeFromShape(l);L.assert(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);let u=s.texData.get(r.dataId);return u.isPacked&&!Qa(r.shape,l)&&!(u.texture!==null&&Qa(u.shape,l))?DD(r,l,s):(s.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}var zD={kernelName:Bc,backendName:"webgl",kernelFunc:Tt};var Uf=class{constructor(t,e){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:o,outSize:s}=t;this.outputShape=[r,s];let a=Math.floor(n/4)*4,l=n%4,c="sumValue += dot(values, ones);";if(e!=null){let h=1/e;c=`sumValue += dot(values * ${L.isInt(h)?h.toPrecision(2):h}, ones);`}let u="";o%n>0&&(u=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}};var Lx=class{constructor(t,e){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:o,outSize:s}=t;this.outputShape=[r,s];let a="0.0",l="";e==="prod"?a="1.0":e==="min"?(a="1.0 / 1e-20",l="min"):e==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="sum"?c="sumValue":e==="prod"?c="prodValue":e==="all"?c="allValue":e==="any"&&(c="anyValue");let u=Math.floor(n/4)*4,h=n%4,p=`
      if (${e==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${e==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
      }
    `,f="vec4";e==="all"?(a="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):e==="any"&&(a="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let d="";o%n>0&&(d=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${h===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${h===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${c});
      }
    `}};function Mnt(i){let t=[];for(;t.length===0||t[t.length-1].outSize!==1;){let e=t.length?t[t.length-1].outSize:i[1],n=O.computeOptimalWindowSize(e);t.push({inSize:e,windowSize:n,outSize:Math.ceil(e/n)})}return t}function bi(i,t,e,n){let r=Mnt(i.shape),o=i;for(let s=0;s<r.length;s++){let{inSize:a,windowSize:l,outSize:c}=r[s],u,h;e==="mean"?u=s===0?new Uf({windowSize:l,inSize:a,batchSize:i.shape[0],outSize:c},a):new Uf({windowSize:l,inSize:a,batchSize:i.shape[0],outSize:c}):u=new Lx({windowSize:l,inSize:a,batchSize:i.shape[0],outSize:c},e),h=o,o=n.runWebGLProgram(u,[o],t),h.dataId!==i.dataId&&n.disposeIntermediateTensorInfo(h)}return o}var Dx=class{constructor(t,e){this.variableNames=["A"];let n=new Array(t.length);for(let s=0;s<n.length;s++)n[s]=t[e[s]];this.outputShape=n,this.rank=n.length;let r=ie(this.rank),o=Ent(e);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}};function Ent(i){let t=i.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);let e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],n=new Array(t);for(let r=0;r<i.length;r++)n[i[r]]=e[r];return n.join()}var zx=class{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let n=new Array(t.length);for(let u=0;u<n.length;u++)n[u]=t[e[u]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let r=ie(this.rank),o=WC("rc",this.rank),s=new Array(this.rank);for(let u=0;u<e.length;u++)s[e[u]]=o[u];let a=`vec2(${s.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${n[this.rank-1]}`,c=`getChannel(getA(${s.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${n[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}};function Is(i,t,e){let n=ot().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zx(i.shape,t):new Dx(i.shape,t);return e.runWebGLProgram(n,[i],i.dtype)}function FD(i,t,e,n){let r=t,o=i.shape.length,s=L.parseAxisParam(r,i.shape),a=s,l=O.getAxesPermutation(a,o),c=l!=null,u=i;c&&(u=Is(i,l,n),a=O.getInnerMostAxes(a.length,o)),O.assertAxesAreInnerMostDims("sum",a,o);let[h,p]=O.computeOutAndReduceShapes(u.shape,a),f=h;e&&(f=O.expandShapeToKeepDim(h,s));let d=L.sizeFromShape(p),x=L.sizeFromShape(i.shape)/d,g=Tt({inputs:{x:u},attrs:{shape:[x,d]},backend:n}),y=Ga(i.dtype),b=bi(g,y,"sum",n),v=Tt({inputs:{x:b},attrs:{shape:f},backend:n});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),c&&n.disposeIntermediateTensorInfo(u),v}function il(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,keepDims:s}=n;return FD(r,o,s,e)}var OD={kernelName:Vc,backendName:"webgl",kernelFunc:il};function Be(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{perm:o}=n,s=e,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[o[u]];let c;if(s.shouldExecuteOnCPU([r])){let h=s.texData.get(r.dataId).values,p=el(h,r.shape,r.dtype,o,l);c=s.makeTensorInfo(l,r.dtype);let f=s.texData.get(c.dataId);f.values=p}else c=Is(r,o,s);return c}var BD={kernelName:$c,backendName:"webgl",kernelFunc:Be};var ZC=1e3;function rl({a:i,b:t,transposeA:e,transposeB:n,backend:r,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:l=null}){let c=i.shape.length,u=t.shape.length,h=e?i.shape[c-2]:i.shape[c-1],p=n?t.shape[u-1]:t.shape[u-2],f=e?i.shape[c-1]:i.shape[c-2],d=n?t.shape[u-2]:t.shape[u-1],m=i.shape.slice(0,-2),x=t.shape.slice(0,-2),g=L.sizeFromShape(m),y=L.sizeFromShape(x),b=g===y||g===1||y===1;L.assert(c>=2&&u>=2&&b,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${m}) and (${x}).`);let _=(g>y?i.shape.slice(0,-2):t.shape.slice(0,-2)).concat([f,d]);L.assert(h===p,()=>`Error in matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${i.shape} and ${t.shape} and transposeA=${e} and transposeB=${n} must match.`);let S=e?[g,h,f]:[g,f,h],E=n?[y,d,p]:[y,p,d],M=Tt({inputs:{x:i},backend:r,attrs:{shape:S}}),N=Tt({inputs:{x:t},backend:r,attrs:{shape:E}}),I=[M,N],w=Math.max(g,y),R=e?M.shape[1]:M.shape[2],P=o!=null,D=s!=null,F=l==="leakyrelu",z=l!=null?Ts(l,!0):null,V=P||D||F||z!=null,H;if((f===1||d===1)&&R>ZC&&V===!1){let U=M,Y=N;e&&(U=Be({inputs:{x:M},backend:r,attrs:{perm:[0,2,1]}}),I.push(U)),n&&(Y=Be({inputs:{x:N},backend:r,attrs:{perm:[0,2,1]}}),I.push(Y));let Z=d!==1,K=d===1,J=U;Z&&(J=Tt({inputs:{x:U},backend:r,attrs:{shape:[w,R,1]}}),I.push(J));let G=d===1?2:1,nt=Y;K&&(nt=Tt({inputs:{x:Y},backend:r,attrs:{shape:[w,1,R]}}),I.push(nt));let et=$f({inputs:{a:J,b:nt},backend:r});H=il({inputs:{x:et},backend:r,attrs:{axis:G,keepDims:!0}}),I.push(et)}else{let U=dn(i.dtype,t.dtype),Y=new uu(S,E,[w,f,d],e,n,P,z,D,F),Z=[M,N];if(o!=null&&Z.push(o),D&&Z.push(s),F){let K=r.makeTensorInfo([],"float32",L.createScalarValue(a,"float32"));Z.push(K),I.push(K)}H=r.runWebGLProgram(Y,Z,U)}let X=Tt({inputs:{x:H},backend:r,attrs:{shape:_}});I.push(H);for(let U of I)r.disposeIntermediateTensorInfo(U);return X}function Tnt(i){let{inputs:t,backend:e,attrs:n}=i,{a:r,b:o,bias:s,preluActivationWeights:a}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=n;return rl({a:r,b:o,transposeA:l,transposeB:c,backend:e,bias:s,preluActivationWeights:a,leakyreluAlpha:h,activation:u})}var VD={kernelName:L0,backendName:"webgl",kernelFunc:Tnt};var HD="return abs(x);";function Int(i){let{inputs:t,backend:e}=i,{x:n}=t;if(e.shouldExecuteOnCPU([n])&&n.dtype!=="complex64"){let o=e.texData.get(n.dataId),s=Tx(o.values);return e.makeTensorInfo(n.shape,n.dtype,s)}let r;return ot().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Ji(n.shape,HD):r=new ti(n.shape,HD),e.runWebGLProgram(r,[n],n.dtype)}var $D={kernelName:r1,backendName:"webgl",kernelFunc:Int};var Ant=bn+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,knt=Bt({opSnippet:Ant}),UD={kernelName:Ap,backendName:"webgl",kernelFunc:knt};var Rnt=bn+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Pnt=Bt({opSnippet:Rnt}),WD={kernelName:kp,backendName:"webgl",kernelFunc:Pnt};var GD="return a + b;",Nnt=be({opSnippet:GD,packedOpSnippet:GD,supportsComplex:!0,cpuKernelImpl:$9}),jD={kernelName:za,backendName:"webgl",kernelFunc:Nnt};var Fx=class{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((o,s)=>`T${s}`);let n=[];this.variableNames.forEach(o=>{n.push(`float v${o} = get${o}AtOutCoords();`)});let r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${n.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}};var Ox=class{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((o,s)=>`T${s}`);let n=[];this.variableNames.forEach(o=>{n.push(`vec4 v${o} = get${o}AtOutCoords();`)});let r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${n.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}};function Bx(i){let{inputs:t,backend:e}=i,n=t;if(n.length===1)return Xe({inputs:{x:n[0]},backend:e});if(n.length>ot().get("WEBGL_MAX_TEXTURES_IN_SHADER")){let l=Math.floor(n.length/2),c=Bx({inputs:n.slice(0,l),backend:e}),u=Bx({inputs:n.slice(l),backend:e});return Bx({inputs:[c,u],backend:e})}let r=n.map(l=>l.dtype).reduce((l,c)=>dn(l,c)),o=n.map(l=>l.shape),a=ot().getBool("WEBGL_PACK")?new Ox(n[0].shape,o):new Fx(n[0].shape,o);return e.runWebGLProgram(a,n,r)}var qD={kernelName:o1,backendName:"webgl",kernelFunc:Bx};function Lnt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,keepDims:s}=n,a=r.shape.length,l=L.parseAxisParam(o,r.shape),c=l,u=O.getAxesPermutation(c,a),h=r;u!=null&&(h=Be({inputs:{x:r},backend:e,attrs:{perm:u}}),c=O.getInnerMostAxes(c.length,a)),O.assertAxesAreInnerMostDims("all",c,a);let[p,f]=O.computeOutAndReduceShapes(h.shape,c),d=L.sizeFromShape(f),m=Tt({inputs:{x:h},backend:e,attrs:{shape:[-1,d]}}),x=bi(m,m.dtype,"all",e),g;if(s){let y=O.expandShapeToKeepDim(p,l);g=Tt({inputs:{x},backend:e,attrs:{shape:y}})}else g=Tt({inputs:{x},backend:e,attrs:{shape:p}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(x),u!=null&&e.disposeIntermediateTensorInfo(h),g}var XD={kernelName:s1,backendName:"webgl",kernelFunc:Lnt};function Dnt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,keepDims:s}=n,a=r.shape.length,l=L.parseAxisParam(o,r.shape),c=l,u=O.getAxesPermutation(c,a),h=r;u!=null&&(h=Be({inputs:{x:r},backend:e,attrs:{perm:u}}),c=O.getInnerMostAxes(c.length,a)),O.assertAxesAreInnerMostDims("any",c,a);let[p,f]=O.computeOutAndReduceShapes(h.shape,c),d=L.sizeFromShape(f),m=Tt({inputs:{x:h},backend:e,attrs:{shape:[-1,d]}}),x=bi(m,m.dtype,"any",e),g;if(s){let y=O.expandShapeToKeepDim(p,l);g=Tt({inputs:{x},backend:e,attrs:{shape:y}})}else g=Tt({inputs:{x},backend:e,attrs:{shape:p}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(x),u!=null&&e.disposeIntermediateTensorInfo(h),g}var KD={kernelName:a1,backendName:"webgl",kernelFunc:Dnt};var Vx=class{constructor(t,e,n){this.variableNames=["A"];let{windowSize:r,batchSize:o,outSize:s}=t;n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,s];let a=e==="max"?">":"<",l=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}};var Hx=class{constructor(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,L.assert(t.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);let o=t[t.length-1],s=Math.ceil(o/e);this.outputShape=t.slice(0,-1),s>1&&this.outputShape.push(s),r||this.variableNames.push("bestIndicesA");let a=this.outputShape,l=a.length,c=ie(l),u=qe("coords",l),h,p;if(s===1){p=l+1;let M=ie(p);h=`
        ${M} sourceLocR = ${M}(${u.join()}, 0);
        ++${u[l-1]};
        ${M} sourceLocG = ${M}(${u.join()}, 0);
        ++${u[l-2]};
        ${M} sourceLocA = ${M}(${u.join()}, 0);
        --${u[l-1]};
        ${M} sourceLocB = ${M}(${u.join()}, 0);
        --${u[l-2]};`}else p=l,h=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;let f=["x","y","z","w","u","v"].slice(0,p),d="."+f[p-1],m=f.map(M=>"int "+M),x=qe("sourceLocR",p-1).concat("inIdx.r"),g=qe("sourceLocG",p-1).concat("inIdx.g"),y=qe("sourceLocB",p-1).concat("inIdx.b"),b=qe("sourceLocA",p-1).concat("inIdx.a"),v=n==="max"?"greaterThan":"lessThan",_=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()})));`,S=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,E=r?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${E}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${h}
        ivec4 srcIdx = ivec4(sourceLocR${d}, sourceLocG${d},
          sourceLocB${d}, sourceLocA${d}) * ${e};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${S};

        for (int i = 0; i < ${e}; i++) {
          inIdx = srcIdx;
          ${_}
          vec4 candidate = ${S};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${v}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}};function YD(i,t,e,n=null){let r=t.shape[0],o=t.shape[1];n!=null&&(r=n.shape[0],o=n.shape[1]);let s=O.computeOptimalWindowSize(o),a={windowSize:s,inSize:o,batchSize:r,outSize:Math.ceil(o/s)},l=new Vx(a,e,n==null),c=[t];n!=null&&c.push(n);let u=i.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;let h=YD(i,t,e,u);return i.disposeIntermediateTensorInfo(u),h}function ZD(i,t,e,n=null){let r=n!=null?n.shape:t.shape,o=r[r.length-1],s=O.computeOptimalWindowSize(o),a=new Hx(r,s,e,n==null),l=n==null?[t]:[t,n],c=i.runWebGLProgram(a,l,"int32");if(c.shape.length===t.shape.length){let u=ZD(i,t,e,c);return i.disposeIntermediateTensorInfo(c),u}return c}function $x(i,t,e,n){let r=[e];if(O.assertAxesAreInnerMostDims("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,t.shape.length),!ot().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let o=[],[s,a]=O.computeOutAndReduceShapes(t.shape,r),l=L.sizeFromShape(a),c=Tt({inputs:{x:t},backend:i,attrs:{shape:[-1,l]}});o.push(c);let u=YD(i,c,n);o.push(u);let h=Tt({inputs:{x:u},backend:i,attrs:{shape:s}});return o.forEach(p=>i.disposeIntermediateTensorInfo(p)),h}return ZD(i,t,n)}function znt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o}=n,s=L.parseAxisParam(o,r.shape),a=O.getAxesPermutation(s,r.shape.length),l=r,c=[];a!=null&&(l=Be({inputs:{x:r},backend:e,attrs:{perm:a}}),c.push(l),s=O.getInnerMostAxes(s.length,l.shape.length)),O.assertAxesAreInnerMostDims("argMax",[s[0]],l.shape.length);let u=$x(e,l,s[0],"max");return c.forEach(h=>e.disposeIntermediateTensorInfo(h)),u}var JD={kernelName:l1,backendName:"webgl",kernelFunc:znt};function Fnt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o}=n,s=L.parseAxisParam(o,r.shape),a=O.getAxesPermutation(s,r.shape.length),l=r,c=[];a!=null&&(l=Be({inputs:{x:r},backend:e,attrs:{perm:a}}),c.push(l),s=O.getInnerMostAxes(s.length,l.shape.length)),O.assertAxesAreInnerMostDims("argMin",[s[0]],l.shape.length);let u=$x(e,l,s[0],"min");return c.forEach(h=>e.disposeIntermediateTensorInfo(h)),u}var QD={kernelName:c1,backendName:"webgl",kernelFunc:Fnt};var Ont=bn+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Bnt=Bt({opSnippet:Ont}),tz={kernelName:Rp,backendName:"webgl",kernelFunc:Bnt};var Vnt=bn+"return log(x + sqrt(x * x + 1.0));",Hnt=Bt({opSnippet:Vnt}),ez={kernelName:Pp,backendName:"webgl",kernelFunc:Hnt};var $nt=bn+`
  return atan(x);
`,Unt=Bt({opSnippet:$nt}),nz={kernelName:Np,backendName:"webgl",kernelFunc:Unt};var Wnt=RD+`
  return atan(a, b);
`,Gnt=`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+PD+`
  return result;
`,jnt=be({opSnippet:Wnt,packedOpSnippet:Gnt}),iz={kernelName:Dp,backendName:"webgl",kernelFunc:jnt};var qnt=bn+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Xnt=Bt({opSnippet:qnt}),rz={kernelName:Lp,backendName:"webgl",kernelFunc:Xnt};var vr=class{constructor(t,e,n,r=!1,o=!1){if(this.variableNames=["x"],e==="avg"&&n)throw new Error("Cannot compute positions for average pool.");let s=t.filterWidth,a=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,u=t.dilationWidth,h=t.effectiveFilterHeight,p=t.effectiveFilterWidth,f=t.padInfo.top,d=t.padInfo.left;this.outputShape=t.outShape;let m=e==="avg",x=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,g=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`,y="0.0";if(m||(y="-1.0 / 1e-20"),n){let M=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${d});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${M} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?o?x:g:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let b="max",v=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="avg"&&(v="avgValue / count");let _=Math.floor(s/4)*4,S=s%4,E=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${d});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${h};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${_}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${E}
          }

          int xC = xCCorner + ${_};
          if (${S===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${E}
          } else if (${S===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${E}
          } else if (${S===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${E}
          }
        }
        setOutput(${v});
      }
    `}},As=class{constructor(t,e,n,r=!1,o=!1){if(this.variableNames=["x"],e==="avg"&&n)throw new Error("Cannot compute positions for average pool.");let s=t.filterWidth,a=t.strideDepth,l=t.strideHeight,c=t.strideWidth,u=t.dilationDepth,h=t.dilationHeight,p=t.dilationWidth,f=t.effectiveFilterDepth,d=t.effectiveFilterHeight,m=t.effectiveFilterWidth,x=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;let b=e==="avg",v="0.0";if(b||(v="-1.0 / 1e-20"),n){let I=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${x}, ${g}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${d};
                wR += ${h}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${I} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?o?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${d} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let _="max",S=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="avg"&&(S="avgValue / count");let E=Math.floor(s/4)*4,M=s%4,N=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${_}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${x}, ${g}, ${y});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d};
            wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${E}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${N}
            }

            int xC = xCCorner + ${E};
            if (${M===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${N}
            } else if (${M===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${N}
            } else if (${M===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${N}
            }
          }
          setOutput(${S});
        }
      }
    `}};function Knt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t;Qr(r,"avgPool");let{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=n,c=1;L.assert(O.eitherStridesOrDilationsAreOne(s,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let u=O.computePool2DInfo(r.shape,o,s,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&L.arraysEqual(u.inShape,u.outShape))return Xe({inputs:{x:r},backend:e});let h=new vr(u,"avg",!1);return e.runWebGLProgram(h,[r],"float32")}var oz={kernelName:u1,backendName:"webgl",kernelFunc:Knt};function Ynt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{filterSize:o,strides:s,pad:a,dimRoundingMode:l,dataFormat:c}=n,u=[1,1,1],h=O.computePool3DInfo(r.shape,o,s,u,a,l,c),p=new As(h,"avg",!1);return e.runWebGLProgram(p,[r],"float32")}var sz={kernelName:p1,backendName:"webgl",kernelFunc:Ynt};var Ux=class{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;let e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,s=t.dilationHeight,a=t.dilationWidth,l=t.effectiveFilterHeight,c=t.effectiveFilterWidth,u=l-1-t.padInfo.top,h=c-1-t.padInfo.left,p=1/(e*n);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${h});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}},Wx=class{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;let e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,o=t.strideDepth,s=t.strideHeight,a=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,u=t.dilationWidth,h=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=h-1-t.padInfo.front,m=p-1-t.padInfo.top,x=f-1-t.padInfo.left,g=1/(e*n*r);this.userCode=`
      const ivec3 pads = ivec3(${d}, ${m}, ${x});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Znt(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,input:o}=t,s=o,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=n,h=[1,1,1],p=O.computePool3DInfo(s.shape,a,l,h,c,u),f=new Wx(p);return e.runWebGLProgram(f,[r],s.dtype)}var az={kernelName:f1,backendName:"webgl",kernelFunc:Znt};function Jnt(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,input:o}=t,s=o;Qr([r,o],"avgPoolGrad");let{filterSize:a,strides:l,pad:c}=n,u=O.computePool2DInfo(s.shape,a,l,1,c),h=new Ux(u);return e.runWebGLProgram(h,[r],s.dtype)}var lz={kernelName:h1,backendName:"webgl",kernelFunc:Jnt};function Qnt(i){let{inputs:t,backend:e,attrs:n}=i,{a:r,b:o}=t,{transposeA:s,transposeB:a}=n;return rl({a:r,b:o,transposeA:s,transposeB:a,backend:e})}var cz={kernelName:Lc,backendName:"webgl",kernelFunc:Qnt};var Gx=class{constructor(t,e,n,r,o,s){this.outputShape=[],this.variableNames=["x","mean","variance"],O.assertAndGetBroadcastShape(t,e),O.assertAndGetBroadcastShape(t,n);let a="0.0";r!=null&&(O.assertAndGetBroadcastShape(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(O.assertAndGetBroadcastShape(t,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${s}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}};var jx=class{constructor(t,e,n,r,o,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],O.assertAndGetBroadcastShape(t,e),O.assertAndGetBroadcastShape(t,n);let a="vec4(0.0)";r!=null&&(O.assertAndGetBroadcastShape(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(O.assertAndGetBroadcastShape(t,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${s}));

        setOutput((x - mean) * inv + offset);
      }
    `}};var tit=({inputs:i,backend:t,attrs:e})=>{let{x:n,mean:r,variance:o,offset:s,scale:a}=i;L.assert(r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),L.assert(s==null||r.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),L.assert(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=e;l==null&&(l=.001);let c=[n,r,o],u=null;s!=null&&(u=s.shape,c.push(s));let h=null;a!=null&&(h=a.shape,c.push(a));let p=ot().getBool("WEBGL_PACK_NORMALIZATION")?new jx(n.shape,r.shape,o.shape,u,h,l):new Gx(n.shape,r.shape,o.shape,u,h,l);return t.runWebGLProgram(p,c,c[0].dtype)},uz={kernelName:B1,backendName:"webgl",kernelFunc:tit};var qx=class{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;let e=ie(this.rank),n=`uniform int start[${this.rank}];`,r=eit(this.rank),o,s=t.map((a,l)=>`sourceLoc.${JC[l]} = start[${l}] + coords.${JC[l]};`);o=`
        ${e} sourceLoc;
        ${e} coords = getOutputCoords();
        ${s.join(`
`)}
      `,this.userCode=`
      ${n}
      void main() {
        ${o}
        setOutput(getSource(${r}));
      }
    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(e,n)=>{this.startLoc==null&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),this.startLoc==null)||e.gl.uniform1iv(this.startLoc,t)}}},JC=["x","y","z","w","u","v"];function eit(i){if(i===1)return"sourceLoc";if(i<=6)return JC.slice(0,i).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${i} is not yet supported`)}var Xx=class{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;let e=ie(this.rank),n=qe("coords",this.rank),r=qe("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,s=`getChannel(getSource(${r.join()}), ${o})`,a=`
      result.x = ${s};
      if (++${n[this.rank-1]} < ${t[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${s};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${n[this.rank-1]};
      if (++${n[this.rank-2]} < ${t[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${s};
        if (++${n[this.rank-1]} < ${t[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${s};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${e}(${t.map((u,h)=>`start[${h}]`).join()});`:t.map((u,h)=>`${r[h]} = ${n[h]} + start[${h}];`).join(`
`);this.userCode=`
      uniform int start[${this.rank}];
      void main() {
        ${e} coords = getOutputCoords();
        ${e} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(e,n)=>{this.startLoc==null&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),this.startLoc==null)||e.gl.uniform1iv(this.startLoc,t)}}};function nit(i,t,e,n){let r=n.texData.get(i.dataId),o=n.makeTensorInfo(e,i.dtype),s=n.texData.get(o.dataId);Object.assign(s,r),s.refCount=1,s.shape=e,s.dtype=i.dtype;let a=zn.computeFlatOffset(t,L.computeStrides(i.shape));r.slice&&(a+=r.slice.flatOffset),s.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||i.dataId};let l=n.dataRefCount.get(s.slice.origDataId)||1;return n.dataRefCount.set(s.slice.origDataId,l+1),o}function Fo(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{begin:o,size:s}=n,[a,l]=zn.parseSliceParams(r,o,s);if(zn.assertParamsValid(r,a,l),L.sizeFromShape(l)===0)return e.makeTensorInfo(l,r.dtype,[]);if(e.shouldExecuteOnCPU([r])||r.dtype==="string"){let h=e.texData.get(r.dataId),p=lD(h.values,a,l,r.shape,r.dtype);return e.makeTensorInfo(l,r.dtype,p)}let{isPacked:c}=e.texData.get(r.dataId),u=zn.isSliceContinous(r.shape,a,l);if(c||!u){let h=ot().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Xx(l):new qx(l),p=h.getCustomSetupFunc(a);return e.runWebGLProgram(h,[r],r.dtype,p)}return e.uploadToGPU(r.dataId),nit(r,a,l,e)}var hz={kernelName:b0,backendName:"webgl",kernelFunc:Fo};var iit=i=>{let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{blockShape:o,crops:s}=n;L.assert(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let a=o.reduce((y,b)=>y*b),l=O.getReshaped(r.shape,o,a),c=O.getPermuted(l.length,o.length),u=O.getReshapedPermuted(r.shape,o,a),h=O.getSliceBeginCoords(s,o.length),p=O.getSliceSize(u,s,o.length),f=[],d=Tt({inputs:{x:r},backend:e,attrs:{shape:l}}),m=Be({inputs:{x:d},backend:e,attrs:{perm:c}}),x=Tt({inputs:{x:m},backend:e,attrs:{shape:u}}),g=Fo({inputs:{x},backend:e,attrs:{begin:h,size:p}});return f.push(d),f.push(m),f.push(x),f.forEach(y=>e.disposeIntermediateTensorInfo(y)),g},pz={kernelName:d1,backendName:"webgl",kernelFunc:iit};function rit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,weights:o}=t,{size:s}=n,a=e.readSync(r.dataId),l=e.readSync(o.dataId),c=Ex(a,l,o.dtype,o.shape,s);return e.makeTensorInfo([s],o.dtype,c)}var fz={kernelName:m1,backendName:"webgl",kernelFunc:rit};var oit="return float(a != b);",QC=be({opSnippet:oit,dtype:"bool"}),dz={kernelName:cf,backendName:"webgl",kernelFunc:QC};function Oo(i){let{inputs:t,backend:e}=i,{input:n}=t,r=e.texData.get(n.dataId);return Xe({inputs:{x:r.complexTensorInfos.real},backend:e})}var mz={kernelName:p0,backendName:"webgl",kernelFunc:Oo};var sit="return float(int(x));";function gz(i,t){let e=new ti(i.shape,sit),n=t.runWebGLProgram(e,[i],"int32");return{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}function t3(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{dtype:o}=n;if(o==="complex64"){if(r.dtype==="complex64")return Xe({inputs:{x:r},backend:e});let s=If(r.shape),a=t3({inputs:{x:r},backend:e,attrs:{dtype:"float32"}}),l=ui({inputs:{real:a,imag:s},backend:e});return s.dispose(),e.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){let s=Oo({inputs:{input:r},backend:e}),a=t3({inputs:{x:s},backend:e,attrs:{dtype:o}});return e.disposeIntermediateTensorInfo(s),a}if(!L.hasEncodingLoss(r.dtype,o)){let s=Xe({inputs:{x:r},backend:e});return{dataId:s.dataId,shape:s.shape,dtype:o}}if(o==="int32")return gz(r,e);if(o==="bool"){let s=e.makeTensorInfo([],"bool",L.getTypedArrayFromDType("bool",1)),l=QC({inputs:{a:r,b:s},backend:e});return e.disposeIntermediateTensorInfo(s),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${o}`)}var xz={kernelName:gs,backendName:"webgl",kernelFunc:t3};var yz="return ceil(x);",ait=Bt({opSnippet:yz,packedOpSnippet:yz,cpuKernelImpl:W9}),vz={kernelName:zp,backendName:"webgl",kernelFunc:ait};var Kx=class{constructor(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}getCustomSetupFunc(t,e){return(n,r)=>{this.minLoc==null&&(this.minLoc=n.getUniformLocationNoThrow(r,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(r,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}};var Yx=class{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}getCustomSetupFunc(t,e){return(n,r)=>{this.minLoc==null&&(this.minLoc=n.getUniformLocationNoThrow(r,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(r,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}};function lit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{clipValueMin:o,clipValueMax:s}=n,a;ot().getBool("WEBGL_PACK_CLIP")?a=new Yx(r.shape):a=new Kx(r.shape);let l=a.getCustomSetupFunc(o,s);return e.runWebGLProgram(a,[r],r.dtype,l)}var bz={kernelName:Fp,backendName:"webgl",kernelFunc:lit};var Zx=class{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}};function _z(i,t){return{dataId:t.dataId,dtype:t.dtype,shape:i.shape}}function cit(i){let{inputs:t,backend:e}=i,{x:n}=t,r=e.texData.get(n.dataId),o=new Zx(n.shape),s=[_z(n,r.complexTensorInfos.real),_z(n,r.complexTensorInfos.imag)];return e.runWebGLProgram(o,s,s[0].dtype)}var wz={kernelName:g1,backendName:"webgl",kernelFunc:cit};var Jx=class{constructor(t){this.outputShape=[],this.outputShape=O.computeOutShape(t,1),this.variableNames=t.map((s,a)=>`T${a}`);let e=new Array(t.length-1);e[0]=t[0][1];for(let s=1;s<e.length;s++)e[s]=e[s-1]+t[s][1];let n=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let s=1;s<e.length;s++){let a=e[s-1];n.push(`else if (yC < ${e[s]}) setOutput(getT${s}(yR, yC-${a}));`)}let r=e.length,o=e[e.length-1];n.push(`else setOutput(getT${r}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${n.join(`
        `)}
      }
    `}};var ty=class{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=O.computeOutShape(t,e);let n=this.outputShape,r=n.length,o=ie(r),s=qe("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((m,x)=>`T${x}`);let l=new Array(t.length-1);l[0]=t[0][e];for(let m=1;m<l.length;m++)l[m]=l[m-1]+t[m][e];let c=a[e],u=a.slice(-2),h=a.join(),p=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${h}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){let x=l[m-1];p+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${Qx(a,c,x)}),
            vec2(${Qx(u,c,x)}));
        }`}let f=l.length,d=l[l.length-1];p+=`
        return getChannel(
          getT${f}(${Qx(a,c,d)}),
          vec2(${Qx(u,c,d)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${p}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${s}), 0., 0., 0.);

        ${s[r-1]} = ${s[r-1]} + 1;
        if (${s[r-1]} < ${n[r-1]}) {
          result.g = getValue(${s});
        }

        ${s[r-2]} = ${s[r-2]} + 1;
        if (${s[r-2]} < ${n[r-2]}) {
          result.a = getValue(${s});
        }

        ${s[r-1]} = ${s[r-1]} - 1;
        if (${s[r-2]} < ${n[r-2]} &&
            ${s[r-1]} < ${n[r-1]}) {
          result.b = getValue(${s});
        }
        setOutput(result);
      }
    `}};function Qx(i,t,e){let n=i.indexOf(t);return i.map((o,s)=>s===n?`${o} - ${e}`:o).join()}function ol(i){let{inputs:t,backend:e}=i,{input:n}=t,r=e.texData.get(n.dataId);return Xe({inputs:{x:r.complexTensorInfos.imag},backend:e})}var Sz={kernelName:U1,backendName:"webgl",kernelFunc:ol};function sl(i,t,e){let n=i[0].dtype;if(n==="complex64"){let c=i.map(d=>Oo({inputs:{input:d},backend:e})),u=i.map(d=>ol({inputs:{input:d},backend:e})),h=sl(c,t,e),p=sl(u,t,e),f=ui({inputs:{real:h,imag:p},backend:e});return c.forEach(d=>e.disposeIntermediateTensorInfo(d)),u.forEach(d=>e.disposeIntermediateTensorInfo(d)),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(p),f}if(n==="string"){let{tensors2D:c,outShape:u}=Cz(i,t,e),h=c.map(x=>({vals:e.readSync(x.dataId),shape:x.shape})),p=c[0].shape[0]===1,f=G9(h,u,n,p),d=O.computeOutShape(i.map(x=>x.shape),t),m=e.makeTensorInfo(d,n,f);return c.forEach(x=>e.disposeIntermediateTensorInfo(x)),m}if(i.length>ot().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let c=Math.floor(i.length/2),u=sl(i.slice(0,c),t,e),h=sl(i.slice(c),t,e),p=sl([u,h],t,e);return e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(h),p}if(ot().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1){let c=new ty(i.map(u=>u.shape),t);return e.runWebGLProgram(c,i,n)}let{tensors2D:r,outShape:o}=Cz(i,t,e),s=new Jx(r.map(c=>c.shape)),a=e.runWebGLProgram(s,r,n);r.forEach(c=>e.disposeIntermediateTensorInfo(c));let l=Tt({inputs:{x:a},attrs:{shape:o},backend:e});return e.disposeIntermediateTensorInfo(a),l}function Cz(i,t,e){let n=O.computeOutShape(i.map(o=>o.shape),t);return{tensors2D:i.map(o=>Tt({inputs:{x:o},attrs:{shape:[-1,L.sizeFromShape(o.shape.slice(t))]},backend:e})),outShape:n}}function e3(i){let{inputs:t,backend:e,attrs:n}=i,{axis:r}=n,o=L.parseAxisParam(r,t[0].shape)[0],s=O.computeOutShape(t.map(c=>c.shape),o);if(L.sizeFromShape(s)===0)return e.makeTensorInfo(s,t[0].dtype,[]);let a=t.filter(c=>L.sizeFromShape(c.shape)>0);if(a.length===1)return Xe({inputs:{x:a[0]},backend:e});let l=a.map(c=>c.shape);return O.assertParamsConsistent(l,o),sl(a,o,e)}var Mz={kernelName:x1,backendName:"webgl",kernelFunc:e3};var hu=class{constructor(t,e=!1,n=null,r=!1,o=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;let s=t.padInfo.top,a=t.padInfo.left,l=t.strideHeight,c=t.strideWidth,u=t.dilationHeight,h=t.dilationWidth,p=t.filterHeight,f=t.filterWidth,d=Math.floor(t.inChannels/4)*4,m=t.inChannels%4,x=t.dataFormat==="channelsLast",g=x?1:2,y=x?2:3,b=x?3:1,v="",_="";n&&(r?v=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:o?v=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:v=`
          float activation(float x) {
            ${n}
          }
        `,_="result = activation(result);");let S=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${v}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${s}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${h};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${d}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${d}) *
                    getW(wR, wC, ${d}, d2);
              } else {
                dotProd +=
                    getX(batch, ${d}, xR, xC) *
                    getW(wR, wC, ${d}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${d}, d2),
                getW(wR, wC, ${d} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${d}),
                  getX(batch, xR, xC, ${d} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${d}, xR, xC),
                  getX(batch, ${d} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${d}, d2),
                getW(wR, wC, ${d} + 1, d2),
                getW(wR, wC, ${d} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${d}),
                  getX(batch, xR, xC, ${d} + 1),
                  getX(batch, xR, xC, ${d} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${d}, xR, xC),
                  getX(batch, ${d} + 1, xR, xC),
                  getX(batch, ${d} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${S}
        ${_}
        setOutput(result);
      }
    `}},ey=class{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;let e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,o=t.strideDepth,s=t.strideHeight,a=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,u=t.dilationWidth,h=t.filterDepth,p=t.filterHeight,f=t.filterWidth,d=Math.floor(t.inChannels/4)*4,m=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${s}, ${a});
      const ivec3 pads = ivec3(${e}, ${n}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${h}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${d}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${d}) *
                  getW(wF, wR, wC, ${d}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${d}),
                  getX(batch, xF, xR, xC, ${d} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${d}, d2),
                  getW(wF, wR, wC, ${d} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${d}),
                  getX(batch, xF, xR, xC, ${d} + 1),
                  getX(batch, xF, xR, xC, ${d} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${d}, d2),
                  getW(wF, wR, wC, ${d} + 1, d2),
                  getW(wF, wR, wC, ${d} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};var ny=class{constructor(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let{filterWidth:r,inChannels:o,strideWidth:s,strideHeight:a,padInfo:l,outWidth:c,dilationWidth:u,dilationHeight:h,dataFormat:p}=n,{left:f,top:d}=l,m=o*r,x=$e(),g=p==="channelsLast",y=g?0:1,b=g?1:2,v="";for(let _=0;_<=1;_++)for(let S=0;S<=1;S++)v+=`
          blockIndex = rc.y + ${S};
          pos = rc.x + ${_};

          if(blockIndex < ${t[1]} && pos < ${t[0]}) {
            offsetY = int(blockIndex / (${c})) * ${a} - ${d};
            d0 = offsetY + ${h} * (pos / ${m});

            if(d0 < ${e[y]} && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), ${c}.) * ${s}. - ${f}.);
              d1 = offsetX + ${u} * (int(mod(float(pos), ${m}.) / ${o}.));

              if(d1 < ${e[b]} && d1 >= 0) {

                ch = int(mod(float(pos), ${o}.));

                if (${g}) {
                  innerDims = vec2(d1, ch);
                  result[${_*2+S}] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${_*2+S}] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${v}

        ${x.output} = result;
      }
    `}};function iy({x:i,filter:t,convInfo:e,backend:n,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:a=null}){let l=i.shape,c=n.texData.get(i.dataId),u=e.inChannels,h=l[0]*l[1]*l[2],p=e.outChannels,f=e.dataFormat==="channelsLast",d=!1,m=!1,x,g=[],y=(h===1||p===1)&&u>ZC,b=l[2]%2!==0&&!!c.isPacked;if(y||!ot().getBool("WEBGL_LAZILY_UNPACK")||!ot().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!b){let v=f?l[0]*l[1]*l[2]:l[0]*l[2]*l[3],_=Tt({inputs:{x:i},backend:n,attrs:{shape:[1,v,e.inChannels]}}),S=Tt({inputs:{x:t},backend:n,attrs:{shape:[1,e.inChannels,e.outChannels]}}),E=rl({a:_,b:S,transposeA:d,transposeB:m,backend:n,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:s});x=Tt({inputs:{x:E},backend:n,attrs:{shape:e.outShape}}),g.push(_),g.push(S),g.push(E)}else{let v=f?l[0]*l[1]*(l[2]+1):l[0]*l[2]*(l[3]+1),_={dataId:i.dataId,shape:[1,v,e.inChannels],dtype:i.dtype},S=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,L.assert(Qa(c.shape,_.shape),()=>`packed reshape ${c.shape} to ${_.shape} isn't free`);let E=Tt({inputs:{x:t},backend:n,attrs:{shape:[1,e.inChannels,e.outChannels]}});g.push(E);let M=rl({a:_,b:E,backend:n,transposeA:d,transposeB:m,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:s}),N=n.texData.get(M.dataId);L.assert(N.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=S,N.shape=e.outShape,x=Xe({inputs:{x:M},backend:n}),x.shape=e.outShape,g.push(M)}for(let v of g)n.disposeIntermediateTensorInfo(v);return x}function ry({x:i,filter:t,convInfo:e,backend:n,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:a=null}){let{filterWidth:l,filterHeight:c,inChannels:u,outWidth:h,outHeight:p,dataFormat:f}=e,d=f==="channelsLast",m=l*c*u,x=p*h,g=[m,x],y=!0,b=!1,v=[],_=Tt({inputs:{x:i},backend:n,attrs:{shape:i.shape.slice(1)}}),S=Tt({inputs:{x:t},backend:n,attrs:{shape:[1,m,L.sizeFromShape(t.shape)/m]}});v.push(_),v.push(S);let E=new ny(g,_.shape,e),M=n.runWebGLProgram(E,[_],"float32"),N=Tt({inputs:{x:M},backend:n,attrs:{shape:[1,g[0],g[1]]}});v.push(M),v.push(N);let I=r!=null,w=o!=null,R=a==="leakyrelu",P=a?Ts(a,!0):null,D=new uu(N.shape,S.shape,[1,x,e.outChannels],y,b,I,P,w,R),F=[N,S];if(r&&F.push(r),w&&F.push(o),R){let X=n.makeTensorInfo([],"float32",L.createScalarValue(s,"float32"));F.push(X),v.push(X)}let z=n.runWebGLProgram(D,F,"float32"),V=d?[1,p,h,e.outChannels]:[1,e.outChannels,p,h],H=Tt({inputs:{x:z},backend:n,attrs:{shape:V}});v.push(z);for(let X of v)n.disposeIntermediateTensorInfo(X);return H}function uit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,filter:o}=t,{strides:s,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=n,h=O.convertConv2DDataFormat(l),p=O.computeConv2DInfo(r.shape,o.shape,s,c,a,u,!1,h),f;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))f=iy({x:r,filter:o,convInfo:p,backend:e});else if(ot().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)f=ry({x:r,filter:o,convInfo:p,backend:e});else{let m=new hu(p);f=e.runWebGLProgram(m,[r,o],"float32")}let d=Tt({inputs:{x:f},backend:e,attrs:{shape:p.outShape}});return e.disposeIntermediateTensorInfo(f),d}var Ez={kernelName:y1,backendName:"webgl",kernelFunc:uit};var oy=class{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;let e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,s=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${e} - ${r};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${o};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              if (${s}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},sy=class{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;let e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,s=t.dataFormat==="channelsLast",a=e-1-t.padInfo.top,l=n-1-t.padInfo.left,c=s?1:2,u=s?2:3,h=s?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${h}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${s}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},ay=class{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;let e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,o=t.padInfo.front,s=t.padInfo.top,a=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${e} - ${o};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${n} - ${s};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},ly=class{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;let e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,o=t.strideDepth,s=t.strideHeight,a=t.strideWidth,l=e-1-t.padInfo.front,c=n-1-t.padInfo.top,u=r-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${e}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${e} - 1 - wF;

          for (int wR = 0; wR < ${n}; wR++) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${n} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function hit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,dy:o}=t,{strides:s,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=n,h=O.convertConv2DDataFormat(l),p=O.computeConv2DInfo(r.shape,u,s,1,a,c,!1,h),f=new oy(p);return e.runWebGLProgram(f,[r,o],"float32")}var Tz={kernelName:v1,backendName:"webgl",kernelFunc:hit};function pit(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,filter:o}=t,{inputShape:s,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=n,h=O.convertConv2DDataFormat(c),p=O.computeConv2DInfo(s,o.shape,a,1,l,u,!1,h),f=new sy(p);return e.runWebGLProgram(f,[r,o],"float32")}var Iz={kernelName:b1,backendName:"webgl",kernelFunc:pit};function fit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,filter:o}=t,{strides:s,pad:a,dilations:l}=n,c=O.computeConv3DInfo(r.shape,o.shape,s,l,a),u=new ey(c);return e.runWebGLProgram(u,[r,o],"float32")}var Az={kernelName:_1,backendName:"webgl",kernelFunc:fit};function dit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,dy:o}=t,{strides:s,pad:a,filterShape:l}=n,c=O.computeConv3DInfo(r.shape,l,s,1,a),u=new ay(c);return e.runWebGLProgram(u,[r,o],"float32")}var kz={kernelName:w1,backendName:"webgl",kernelFunc:dit};function mit(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,filter:o}=t,{pad:s,strides:a,inputShape:l}=n,c=O.computeConv3DInfo(l,o.shape,a,1,s),u=new ly(c);return e.runWebGLProgram(u,[r,o],"float32")}var Rz={kernelName:S1,backendName:"webgl",kernelFunc:mit};var git=Nx+`
  return cos(x);
`,xit=Bt({opSnippet:git}),Pz={kernelName:Op,backendName:"webgl",kernelFunc:xit};var yit=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,vit=Bt({opSnippet:yit}),Nz={kernelName:Bp,backendName:"webgl",kernelFunc:vit};var cy=class{constructor(t,e,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[s,a,l,c]=t,[u]=e,[h,p]=n;this.outputShape=[u,h,p,c];let f=r==="bilinear"?1:0,[d,m]=[`${a-1}.0`,`${l-1}.0`],[x,g,y]=h>1?[`${(a-1)/(h-1)}`,"(y2-y1) * height_ratio",`y1*${d} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${d}`],[b,v,_]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${s}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${v};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${d} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${_};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}};var bit=i=>{let{inputs:t,backend:e,attrs:n}=i,{image:r,boxes:o,boxInd:s}=t,{cropSize:a,method:l,extrapolationValue:c}=n,u=new cy(r.shape,o.shape,a,l,c);return e.runWebGLProgram(u,[r,o,s],"float32")},Lz={kernelName:M1,backendName:"webgl",kernelFunc:bit};var Wf=class{constructor(t,e,n){this.variableNames=["x"],this.outputShape=t;let r=t.length,o=e?"0.0":`getX(${Dz(r,"coords")})`,s=t[t.length-1],a="",l="";e?(a=n?`end != ${s-1}`:"end != 0",l=n?"end + 1":"end - 1"):(a=n?`end + pow2 < ${s}`:"end >= pow2",l=n?"end + pow2":"end - pow2"),this.userCode=`
      uniform float index;
      void main() {
        ${ie(r)} coords = getOutputCoords();
        int end = ${zz(r,"coords")};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${a}) {
          int idx = ${l};
          ${zz(r,"coords")} = idx;
          val += getX(${Dz(r,"coords")});
        }
        setOutput(val);
      }
    `}getCustomSetupFunc(t){return(e,n)=>{this.index==null&&(this.index=e.getUniformLocation(n,"index")),e.gl.uniform1f(this.index,t)}}};function Dz(i,t){if(i===1)return`${t}`;if(i===2)return`${t}.x, ${t}.y`;if(i===3)return`${t}.x, ${t}.y, ${t}.z`;if(i===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw Error(`Cumulative sum for rank ${i} is not yet supported`)}function zz(i,t){if(i===1)return`${t}`;if(i===2)return`${t}.y`;if(i===3)return`${t}.z`;if(i===4)return`${t}.w`;throw Error(`Cumulative sum for rank ${i} is not yet supported`)}function _it(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,exclusive:s,reverse:a}=n,l=r.shape.length,c=O.getAxesPermutation([o],l),u=r;c!=null&&(u=Be({inputs:{x:r},backend:e,attrs:{perm:c}}));let h=O.getInnerMostAxes(1,l)[0];if(h!==l-1)throw new Error(`WebGL cumsum shader expects an inner-most axis=${r.shape.length-1} but got axis=${o}`);let p=u.shape[h],f=Xe({inputs:{x:u},backend:e});for(let d=0;d<=Math.ceil(Math.log2(p))-1;d++){let m=new Wf(u.shape,!1,a),x=m.getCustomSetupFunc(d),g=f;f=e.runWebGLProgram(m,[f],f.dtype,x),e.disposeIntermediateTensorInfo(g)}if(s){let d=new Wf(u.shape,s,a),m=f;f=e.runWebGLProgram(d,[f],f.dtype),e.disposeIntermediateTensorInfo(m)}if(c!=null){let d=O.getUndoAxesPermutation(c),m=Be({inputs:{x:f},backend:e,attrs:{perm:d}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(u),m}return f}var Fz={kernelName:C1,backendName:"webgl",kernelFunc:_it};function wit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,weights:o}=t,{size:s,binaryOutput:a}=n;if(r.shape.length===1){let l=e.readSync(r.dataId),c=e.readSync(o.dataId),u=Ex(l,c,o.dtype,o.shape,s);return e.makeTensorInfo([s],o.dtype,u)}else if(r.shape.length===2){let l=e.bufferSync(r),c=e.bufferSync(o),u=U9(l,c,s,a);return e.makeTensorInfo(u.shape,o.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}var Oz={kernelName:E1,backendName:"webgl",kernelFunc:wit};var uy=class{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${e};
      int offset_h = imod(h, ${e});
      int in_w = w / ${e};
      int offset_w = imod(w, ${e});
      int offset_d = (offset_h * ${e} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};function Sit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{blockSize:o,dataFormat:s}=n;L.assert(o>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${o}`);let a=r.shape[0],l=s==="NHWC"?r.shape[1]:r.shape[2],c=s==="NHWC"?r.shape[2]:r.shape[3],u=s==="NHWC"?r.shape[3]:r.shape[1],h=l*o,p=c*o,f=u/(o*o),d=s==="NHWC"?[a,h,p,f]:[a,f,h,p],m=new uy(d,o,s);return e.runWebGLProgram(m,[r],r.dtype)}var Bz={kernelName:T1,backendName:"webgl",kernelFunc:Sit};var pu=class{constructor(t,e=!1,n=null,r=!1,o=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;let s=t.inHeight,a=t.inWidth,l=t.padInfo.top,c=t.padInfo.left,u=t.strideHeight,h=t.strideWidth,p=t.dilationHeight,f=t.dilationWidth,d=t.filterHeight,m=t.filterWidth,x=t.outChannels/t.inChannels,g="",y="";n&&(r?g=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:o?g=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:g=`
          float activation(float x) {
            ${n}
          }
        `,y="result = activation(result);");let b=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${g}

      const ivec2 strides = ivec2(${u}, ${h});
      const ivec2 pads = ivec2(${l}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${x};
        int q = d2 - d1 * ${x};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${p};

          if (xR < 0 || xR >= ${s}) {
            continue;
          }

          for (int wC = 0; wC < ${m}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${a}) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${b}
        ${y}
        setOutput(result);
      }
    `}};var fu=class{constructor(t,e=!1,n=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;let s=t.outChannels/t.inChannels,a=t.inHeight,l=t.inWidth,c=t.padInfo.top,u=t.padInfo.left,h=t.strideHeight,p=t.strideWidth,f=t.dilationHeight,d=t.dilationWidth,m=t.filterHeight,x=t.filterWidth,g=x,y=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let S=0;S<x;S++)y+=`
          vec4 xTexelC${S*2};
          vec4 xC${S};`;for(let S=0;S<m;S++){for(let E=0;E<x;E++)y+=`
          xTexelC${E*2} = vec4(0.0);
          xC${E} = vec4(0.0);`;y+=`
        xR = xRCorner + ${S*f};
        if (xR >=0 && xR < ${a}) {
      `;for(let E=0;E<g/2+1;E++){let M=E*2;if(y+=`
          xC = xCCorner + ${M*d};
          `,p===1){if(M<x&&(u%2===1?(y+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < ${l}) {
                  xTexelC${M} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= ${l}) {
                    xTexelC${M}.zw = vec2(0.0);
                  }
                }
              `,d===1&&M>0?y+=`
                xC${M} = vec4(xTexelC${M-2}.zw, xTexelC${M}.xy);
                `:y+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < ${l}) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= ${l}) {
                      previous.zw = vec2(0.0);
                    }

                    xC${M} = vec4(previous.zw, xTexelC${M}.xy);
                  } else {
                    xC${M} = vec4(0.0, 0.0, xTexelC${M}.xy);
                  }
                  `):y+=`
                if (xC >= 0 && xC < ${l}) {
                  xTexelC${M} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= ${l}) {
                    xTexelC${M}.zw = vec2(0.0);
                  }
                }

                xC${M} = xTexelC${M};
                `,M+1<x)){let N=u%2===0?L.nearestLargerEven(d):d;d%2===0&&u%2===1||d%2!==0&&u%2!==1?(y+=`
                  xCOffset = xC + ${u%2} + ${N};

                  if (xCOffset >= 0 && xCOffset < ${l}) {
                    xTexelC${M+2} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= ${l}) {
                      xTexelC${M+2}.zw = vec2(0.0);
                    }
                  }
                  `,d>1&&(y+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < ${l}) {
                      xTexelC${M} = getX(batch, xR, xCOffset, d1);
                    }
                    `),y+=`
                  xC${M+1} = vec4(xTexelC${M}.zw, xTexelC${M+2}.xy);
                  `):N===1?y+=`
                    xC${M+1} = xTexelC${M};
                    `:y+=`
                    xCOffset = xC + ${N};

                    if (xCOffset >= 0 && xCOffset < ${l}) {
                      xTexelC${M+2} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= ${l}) {
                        xTexelC${M+2}.zw = vec2(0.0);
                      }
                    }

                    xC${M+1} = xTexelC${M+2};
                    `}}else M<x&&(u%2===1?(y+=`
                xCOffset = xC + 1 - ${p};
                if(xCOffset >= 0 && xCOffset < ${l}) {
                  xTexelC${M} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= ${l}) {
                    xTexelC${M}.zw = vec2(0.0);
                  }
                }

                if(xC + 1 >= 0 && xC + 1 < ${l}) {
                  xTexelC${M+2} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= ${l}) {
                    xTexelC${M+2}.zw = vec2(0.0);
                  }
                }

                xC${M} = vec4(xTexelC${M}.zw, xTexelC${M+2}.zw);
              `,M+1<x&&(y+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + ${p};
                  if(xCOffset >= 0 && xCOffset < ${l}) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${M+1} = vec4(xTexelC${M+2}.xy, final.xy);
                `)):(y+=`
                if(xC >= 0 && xC < ${l}) {
                  xTexelC${M} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= ${l}) {
                    xTexelC${M}.zw = vec2(0.0);
                  }
                }

                xCOffset = xC + ${p};
                if(xCOffset >= 0 && xCOffset < ${l}) {
                  xTexelC${M+2} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= ${l}) {
                    xTexelC${M+2}.zw = vec2(0.);
                  }
                }

                xC${M} = vec4(
                  xTexelC${M}.xy, xTexelC${M+2}.xy);
              `,M+1<x&&(y+=`
                  xC${M+1} = vec4(xTexelC${M}.zw, xTexelC${M+2}.zw);
                `)));M<x&&(y+=`
            wTexel = getW(${S}, ${M}, d1, q);
            dotProd += xC${M} * vec4(wTexel.xz, wTexel.xz);
          `,M+1<x&&(y+=`
              wTexel = getW(${S}, ${M+1}, d1, q);
              dotProd += xC${M+1} * vec4(wTexel.xz, wTexel.xz);
            `))}y+=`
        }
      `}let b="",v="";n&&(r?b=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:o?b=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:b=`vec4 activation(vec4 x) {
          ${n}
        }`,v="result = activation(result);");let _=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${h}, ${p});
      const ivec2 pads = ivec2(${c}, ${u});

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${s};
        int q = d2 - d1 * ${s};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${y}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${_}
        ${v}
        setOutput(result);
      }
    `}};function Cit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,filter:o}=t,{strides:s,pad:a,dilations:l,dimRoundingMode:c}=n,u=l;u==null&&(u=[1,1]),L.assert(O.eitherStridesOrDilationsAreOne(s,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);let h=O.computeConv2DInfo(r.shape,o.shape,s,u,a,c,!0),p;return ot().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?p=new fu(h):p=new pu(h),e.runWebGLProgram(p,[r,o],"float32")}var Vz={kernelName:I1,backendName:"webgl",kernelFunc:Cit};var hy=class{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;let e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${s} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${e} - ${r};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${o};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}},py=class{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;let e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,s=e-1-t.padInfo.top,a=n-1-t.padInfo.left,l=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Mit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,dy:o}=t,{strides:s,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=n,h=O.computeConv2DInfo(r.shape,u,s,a,l,c,!0),p=new hy(h);return e.runWebGLProgram(p,[r,o],"float32")}var Hz={kernelName:A1,backendName:"webgl",kernelFunc:Mit};function Eit(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,filter:o}=t,{strides:s,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=n,h=O.computeConv2DInfo(u,o.shape,s,a,l,c,!0),p=new py(h);return e.runWebGLProgram(p,[r,o],"float32")}var $z={kernelName:k1,backendName:"webgl",kernelFunc:Eit};var fy=class{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}};function Tit(i){let{inputs:t,backend:e}=i,{x:n}=t,r=[...n.shape,...n.shape],o=L.sizeFromShape(n.shape),s=Tt({inputs:{x:n},backend:e,attrs:{shape:[o]}}),a=new fy(o),l=e.runWebGLProgram(a,[s],s.dtype),c=Tt({inputs:{x:l},backend:e,attrs:{shape:r}});return e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(l),c}var Uz={kernelName:R1,backendName:"webgl",kernelFunc:Tit};var dy=class{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;let{inHeight:e,inWidth:n,padInfo:r,strideHeight:o,strideWidth:s,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=t,{top:h,left:p}=r;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${s});
      const ivec2 pads = ivec2(${h}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${e}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${n}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}};function Iit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,filter:o}=t,{strides:s,pad:a,dilations:l}=n,c=O.computeDilation2DInfo(r.shape,o.shape,s,a,"NHWC",l),u,h=new dy(c);u=e.runWebGLProgram(h,[r,o],"float32");let p=Tt({inputs:{x:u},backend:e,attrs:{shape:c.outShape}});return e.disposeIntermediateTensorInfo(u),p}var Wz={kernelName:P1,backendName:"webgl",kernelFunc:Iit};function Ait(i){let{inputs:t,backend:e,attrs:n}=i,{equation:r}=n,o=t,{allDims:s,summedDims:a,idDims:l}=O.decodeEinsumEquation(r,o.length);O.checkEinsumDimSizes(s.length,l,o);let{path:c,steps:u}=O.getEinsumComputePath(a,l),h=u.length,p=null,f=s.length,d=[];for(let m=0;m<h;++m){for(let x of u[m]){let{permutationIndices:g,expandDims:y}=O.getEinsumPermutation(f,l[x]),b;O.isIdentityPermutation(g)?b=o[x]:(b=Be({inputs:{x:o[x]},backend:e,attrs:{perm:g}}),d.push(b));let v=b.shape.slice();for(let _=0;_<y.length;++_)v.splice(y[_],0,1);L.arraysEqual(b.shape,v)||(b=Tt({inputs:{x:b},backend:e,attrs:{shape:v}}),d.push(b)),p===null?p=b:(p=$f({inputs:{a:b,b:p},backend:e}),d.push(p))}m<h-1&&(c[m]>=0&&(p=il({inputs:{x:p},backend:e,attrs:{axis:c[m]-(s.length-f),keepDims:!1}}),d.push(p)),f--)}for(let m of d)m!==p&&e.disposeIntermediateTensorInfo(m);return p}var Gz={kernelName:N1,backendName:"webgl",kernelFunc:Ait};var kit="return (x >= 0.0) ? x : (exp(x) - 1.0);",Rit=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Pit=Bt({opSnippet:kit,packedOpSnippet:Rit}),jz={kernelName:Fa,backendName:"webgl",kernelFunc:Pit};var Nit="return (b >= 1.0) ? a : a * (b + 1.0);",Lit=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Dit=i=>{let{inputs:t,backend:e}=i,{dy:n,y:r}=t,o=ot().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Qi(Lit,n.shape,r.shape):new Ri(Nit,n.shape,r.shape);return e.runWebGLProgram(o,[n,r],n.dtype)},qz={kernelName:L1,backendName:"webgl",kernelFunc:Dit};var zit=`
  return vec4(equal(a, b));
`,Fit="return float(a == b);",Oit=be({opSnippet:Fit,packedOpSnippet:zit,dtype:"bool"}),Xz={kernelName:$p,backendName:"webgl",kernelFunc:Oit};var Bit=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${O.ERF_P};
  float a1 = ${O.ERF_A1};
  float a2 = ${O.ERF_A2};
  float a3 = ${O.ERF_A3};
  float a4 = ${O.ERF_A4};
  float a5 = ${O.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Vit=Bt({opSnippet:Bit}),Kz={kernelName:Hp,backendName:"webgl",kernelFunc:Vit};var Yz="return exp(x);",n3=Bt({opSnippet:Yz,packedOpSnippet:Yz,cpuKernelImpl:j9}),Zz={kernelName:Up,backendName:"webgl",kernelFunc:n3};function my(i){let{inputs:t,attrs:e,backend:n}=i,{dim:r}=e,{input:o}=t,s=o.shape.length,a=o.shape.slice(),l=r;return r<0&&(L.assert(-(s+1)<=r,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+r+1),a.splice(l,0,1),Tt({inputs:{x:o},backend:n,attrs:{shape:a}})}var Jz={kernelName:D1,backendName:"webgl",kernelFunc:my};var Qz="return exp(x) - 1.0;",Hit=Bt({opSnippet:Qz,packedOpSnippet:Qz,cpuKernelImpl:q9}),tF={kernelName:Wp,backendName:"webgl",kernelFunc:Hit};var Gf=class{constructor(t,e,n){this.variableNames=["real","imag"];let r=e[1];this.outputShape=e;let o=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,s=n?`${r}.0`:"1.0",a;if(t==="real")a="return real * expR - imag * expI;";else if(t==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${s};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}};function gy(i,t,e){let n=e.texData.get(i.dataId),r=L.sizeFromShape(i.shape),o=i.shape[i.shape.length-1],s=r/o,a=Tt({inputs:{x:i},backend:e,attrs:{shape:[s,o]}}),l=a.shape,c=new Gf("real",l,t),u=new Gf("imag",l,t),h=[{dataId:n.complexTensorInfos.real.dataId,dtype:n.complexTensorInfos.real.dtype,shape:l},{dataId:n.complexTensorInfos.imag.dataId,dtype:n.complexTensorInfos.imag.dtype,shape:l}],p=e.runWebGLProgram(c,h,"float32"),f=e.runWebGLProgram(u,h,"float32"),d=ui({inputs:{real:p,imag:f},backend:e});e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(f);let m=Tt({inputs:{x:d},backend:e,attrs:{shape:i.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(d),m}function $it(i){let{inputs:t,backend:e}=i,{input:n}=t;return gy(n,!1,e)}var eF={kernelName:z1,backendName:"webgl",kernelFunc:$it};var xy=class{constructor(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}getCustomSetupFunc(t){return(e,n)=>{this.valueLoc==null&&(this.valueLoc=e.getUniformLocationNoThrow(n,"value")),e.gl.uniform1f(this.valueLoc,t)}}};function jf(i){let{backend:t,attrs:e}=i,{shape:n,value:r}=e,{dtype:o}=e;if(o=o||L.inferDtype(r),o==="string"){let s=L.getArrayFromDType(o,L.sizeFromShape(n));return s.fill(r),t.makeTensorInfo(n,o,s)}else{let s=new xy(n,r),a=s.getCustomSetupFunc(r);return t.runWebGLProgram(s,[],o,a)}}var nF={kernelName:F1,backendName:"webgl",kernelFunc:jf};var yy=class{constructor(t){this.variableNames=["Image"],this.outputShape=[];let e=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${e} - x;
          float outputValue;
          if(coordX >= 0 && coordX < ${e}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}};var iF={kernelName:O1,backendName:"webgl",kernelFunc:({inputs:i,backend:t})=>{let{image:e}=i,n=t,r=new yy(e.shape);return n.runWebGLProgram(r,[e],e.dtype)}};var rF="return floor(x);",Uit=Bt({opSnippet:rF,packedOpSnippet:rF,cpuKernelImpl:X9}),oF={kernelName:Gp,backendName:"webgl",kernelFunc:Uit};var Wit=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Git=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,jit=be({opSnippet:Wit,packedOpSnippet:Git,dtype:"int32"}),sF={kernelName:jp,backendName:"webgl",kernelFunc:jit};var vy=class{constructor(t){this.variableNames=["A"];let e=$e(),[n,r]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);

        vec4 values = ${e.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}};var by=class{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let e=$e(),[n,r]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${n}.0);
            vec4 values = ${e.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${e.output} = result;
      }
    `}};var aF={kernelName:SR,backendName:"webgl",kernelFunc:qit},du;function qit(i){let{inputs:t,backend:e,attrs:n}=i,{pixels:r}=t,{numChannels:o}=n,s=typeof HTMLVideoElement!="undefined"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement,[l,c]=s?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],h=[c,l,o];(a||s)&&(du==null&&(du=document.createElement("canvas").getContext("2d")),du.canvas.width=l,du.canvas.height=c,du.drawImage(r,0,0,l,c),r=du.canvas);let p=e.makeTensorInfo(u,"int32");e.texData.get(p.dataId).usage=Bn.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(p.dataId),r);let f=ot().getBool("WEBGL_PACK")?new by(h):new vy(h),d=e.runWebGLProgram(f,[p],"int32");return e.disposeData(p.dataId),d}function Xit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,filter:o,bias:s,preluActivationWeights:a}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:d}=n,m=O.convertConv2DDataFormat(u),x=O.computeConv2DInfo(r.shape,o.shape,l,h,c,p,!1,m),g,y=[];if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))g=iy({x:r,filter:o,convInfo:x,backend:e,bias:s,activation:f,preluActivationWeights:a,leakyreluAlpha:d});else if(ot().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)g=ry({x:r,filter:o,convInfo:x,backend:e,bias:s,activation:f,preluActivationWeights:a,leakyreluAlpha:d});else{let v=s!=null,_=a!=null,S=f==="leakyrelu",E=f?Ts(f,!1):null,M=new hu(x,v,E,_,S),N=[r,o];if(s&&N.push(s),a&&N.push(a),S){let I=e.makeTensorInfo([],"float32",L.createScalarValue(d,"float32"));N.push(I),y.push(I)}g=e.runWebGLProgram(M,N,"float32")}let b=Tt({inputs:{x:g},backend:e,attrs:{shape:x.outShape}});return y.push(g),y.forEach(v=>e.disposeIntermediateTensorInfo(v)),b}var lF={kernelName:D0,backendName:"webgl",kernelFunc:Xit};function Kit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,filter:o,bias:s,preluActivationWeights:a}=t,{strides:l,pad:c,dilations:u,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=n,d=[],m=u;m==null&&(m=[1,1]),L.assert(O.eitherStridesOrDilationsAreOne(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);let x=O.computeConv2DInfo(r.shape,o.shape,l,m,c,h,!0),g=ot().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,y=p?Ts(p,g):null,b=[r,o],v=s!=null,_=a!=null,S=p==="leakyrelu";if(v&&b.push(s),_&&b.push(a),S){let N=e.makeTensorInfo([],"float32",L.createScalarValue(f,"float32"));b.push(N),d.push(N)}let E;g?E=new fu(x,v,y,_,S):E=new pu(x,v,y,_,S);let M=e.runWebGLProgram(E,b,"float32");return d.forEach(N=>e.disposeIntermediateTensorInfo(N)),M}var cF={kernelName:z0,backendName:"webgl",kernelFunc:Kit};var _y=class{constructor(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;let r=ie(e.length),o=ie(n.length),s=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        ${r} strides = ${r}(${this.strides});
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < ${this.sliceDim}; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * ${s};
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `}};function Yit(i){let{inputs:t,backend:e}=i,{params:n,indices:r}=t,o=r.shape,s=o[o.length-1],[a,l,c,u]=O.prepareAndValidate(n,r),h=Tt({inputs:{x:r},backend:e,attrs:{shape:[l,s]}}),p=Tt({inputs:{x:n},backend:e,attrs:{shape:[L.sizeFromShape(n.shape)/c,c]}}),f=new _y(s,u,[l,c]),d=e.runWebGLProgram(f,[p,h],p.dtype),m=Tt({inputs:{x:d},backend:e,attrs:{shape:a}});return e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(d),m}var uF={kernelName:H1,backendName:"webgl",kernelFunc:Yit};var wy=class{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;let n=ie(this.rank),r=Zit(t,2);this.userCode=`
      void main() {
        ${n} resRC = getOutputCoords();
        setOutput(getA(${r}));
      }
    `}};function Zit(i,t){let e=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<i.length;r++)r===2?n.push("int(getIndices(resRC.x, resRC.z))"):n.push(`${e[r]}`);return n.join()}function Jit(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,indices:o}=t,{axis:s,batchDims:a}=n,l=L.parseAxisParam(s,r.shape)[0],c=O.segment_util.collectGatherOpShapeInfo(r,o,l,a),u=L.sizeFromShape(o.shape),h=[],p=Tt({inputs:{x:r},backend:e,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=Tt({inputs:{x:o},backend:e,attrs:{shape:[c.batchSize,u/c.batchSize]}});h.push(p),h.push(f);let d=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(e.shouldExecuteOnCPU([r,o])||r.dtype==="string"){let y=e.bufferSync(f),b=e.bufferSync(p),v=K9(b,y,d);return h.forEach(_=>e.disposeIntermediateTensorInfo(_)),e.makeTensorInfo(c.outputShape,v.dtype,v.values)}let m=new wy(p.shape,d),x=e.runWebGLProgram(m,[p,f],p.dtype);h.push(x);let g=Tt({inputs:{x},backend:e,attrs:{shape:c.outputShape}});return h.forEach(y=>e.disposeIntermediateTensorInfo(y)),g}var hF={kernelName:V1,backendName:"webgl",kernelFunc:Jit};var Qit="return float(a > b);",trt=`
  return vec4(greaterThan(a, b));
`,ert=be({opSnippet:Qit,packedOpSnippet:trt,cpuKernelImpl:Y9,dtype:"bool"}),pF={kernelName:qp,backendName:"webgl",kernelFunc:ert};var nrt="return float(a >= b);",irt=`
  return vec4(greaterThanEqual(a, b));
`,rrt=be({opSnippet:nrt,packedOpSnippet:irt,dtype:"bool"}),fF={kernelName:Xp,backendName:"webgl",kernelFunc:rrt};function ort(i){let{inputs:t,backend:e}=i,{input:n}=t;return gy(n,!0,e)}var dF={kernelName:$1,backendName:"webgl",kernelFunc:ort};var srt="return float(!isnan(x) && !isinf(x));",art=Bt({opSnippet:srt,dtype:"bool"}),mF={kernelName:Kp,backendName:"webgl",kernelFunc:art};var lrt="return float(isinf(x));",crt=Bt({opSnippet:lrt,dtype:"bool"}),gF={kernelName:Yp,backendName:"webgl",kernelFunc:crt};var urt="return float(isnan(x));",hrt=Bt({opSnippet:urt,dtype:"bool"}),xF={kernelName:Zp,backendName:"webgl",kernelFunc:hrt};var prt="return float(a < b);",frt=`
  return vec4(lessThan(a, b));
`,drt=be({opSnippet:prt,packedOpSnippet:frt,cpuKernelImpl:Z9,dtype:"bool"}),yF={kernelName:Jp,backendName:"webgl",kernelFunc:drt};var mrt="return float(a <= b);",grt=`
  return vec4(lessThanEqual(a, b));
`,xrt=be({opSnippet:mrt,packedOpSnippet:grt,dtype:"bool"}),vF={kernelName:Qp,backendName:"webgl",kernelFunc:xrt};function yrt(i){let{backend:t,attrs:e}=i,{start:n,stop:r,num:o}=e,s=J9(n,r,o);return t.makeTensorInfo([s.length],"float32",s)}var bF={kernelName:W1,backendName:"webgl",kernelFunc:yrt};var vrt=`if (x < 0.0) return NAN;
  return log(x);`,brt=`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,_rt=Bt({opSnippet:vrt,packedOpSnippet:brt,cpuKernelImpl:Q9}),_F={kernelName:tf,backendName:"webgl",kernelFunc:_rt};var wrt="return log(1.0 + x);",Srt=Bt({opSnippet:wrt}),wF={kernelName:ef,backendName:"webgl",kernelFunc:Srt};var Crt="return float(a >= 1.0 && b >= 1.0);",Mrt=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Ert=be({opSnippet:Crt,packedOpSnippet:Mrt,dtype:"bool"}),SF={kernelName:nf,backendName:"webgl",kernelFunc:Ert};var Trt="return float(!(x >= 1.0));",Irt=Bt({opSnippet:Trt}),CF={kernelName:rf,backendName:"webgl",kernelFunc:Irt};var Art="return float(a >= 1.0 || b >= 1.0);",krt=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Rrt=be({opSnippet:Art,packedOpSnippet:krt,dtype:"bool"}),MF={kernelName:of,backendName:"webgl",kernelFunc:Rrt};var Sy=class{constructor(t,e,n,r,o){this.variableNames=["x"],this.outputShape=[];let s=e,a=t[3]-1;this.outputShape=t;let l,c=`float(${n}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${c})`:o===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${s}; j <= ${s}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}};var Cy=class{constructor(t,e,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let s=e,a=t[3]-1;this.outputShape=t;let l,c=`float(${n}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${c})`:o===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${s};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${s}; j <= ${s}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}};var Prt=i=>{let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{depthRadius:o,bias:s,alpha:a,beta:l}=n,c=ot().getBool("WEBGL_PACK_NORMALIZATION")?new Cy(r.shape,o,s,a,l):new Sy(r.shape,o,s,a,l);return e.runWebGLProgram(c,[r],r.dtype)},EF={kernelName:G1,backendName:"webgl",kernelFunc:Prt};var My=class{constructor(t,e,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${e})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${e} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${n});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${o})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}};var Nrt=i=>{let{inputs:t,backend:e,attrs:n}=i,{x:r,y:o,dy:s}=t,{depthRadius:a,bias:l,alpha:c,beta:u}=n,h=new My(r.shape,a,l,c,u);return e.runWebGLProgram(h,[r,o,s],r.dtype)},TF={kernelName:j1,backendName:"webgl",kernelFunc:Nrt};function IF(i,t,e,n){let r=L.sizeFromShape(t),s=L.sizeFromShape(i.shape)/r,a=Tt({inputs:{x:i},attrs:{shape:[s,r]},backend:n}),l=bi(a,i.dtype,"max",n),c=Tt({inputs:{x:l},attrs:{shape:e},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}function i3(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{reductionIndices:o,keepDims:s}=n,a=r.shape.length,l=L.parseAxisParam(o,r.shape),c=l,u=O.getAxesPermutation(c,a),h=u!=null,p=e.shouldExecuteOnCPU([r]),f=r;if(h){if(p){let b=e.texData.get(f.dataId).values,v=new Array(a);for(let E=0;E<v.length;E++)v[E]=r.shape[u[E]];let _=el(b,r.shape,r.dtype,u,v);f=e.makeTensorInfo(v,r.dtype);let S=e.texData.get(f.dataId);S.values=_}else f=Is(r,u,e);c=O.getInnerMostAxes(c.length,a)}O.assertAxesAreInnerMostDims("max",c,a);let[d,m]=O.computeOutAndReduceShapes(f.shape,c),x=d;s&&(x=O.expandShapeToKeepDim(d,l));let g;if(p){let b=e.texData.get(f.dataId).values,v=tD(b,L.sizeFromShape(m),x,r.dtype);g=e.makeTensorInfo(x,r.dtype);let _=e.texData.get(g.dataId);_.values=v}else g=IF(f,m,x,e);return h&&e.disposeIntermediateTensorInfo(f),g}var AF={kernelName:q1,backendName:"webgl",kernelFunc:i3};var Lrt=Px+`
  return max(a, b);
`,Drt=`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+Es+`
  return result;
`,zrt=be({opSnippet:Lrt,packedOpSnippet:Drt,cpuKernelImpl:eD}),kF={kernelName:sf,backendName:"webgl",kernelFunc:zrt};function Frt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t;Qr(r,"maxPool");let{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=n,c=1;L.assert(O.eitherStridesOrDilationsAreOne(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let u=O.computePool2DInfo(r.shape,o,s,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&L.arraysEqual(u.inShape,u.outShape))return Xe({inputs:{x:r},backend:e});let h=new vr(u,"max",!1);return e.runWebGLProgram(h,[r],r.dtype)}var RF={kernelName:X1,backendName:"webgl",kernelFunc:Frt};function Ort(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{filterSize:o,strides:s,pad:a,dataFormat:l,dimRoundingMode:c}=n,u=[1,1,1],h=O.computePool3DInfo(r.shape,o,s,u,a,c,l),p=new As(h,"max",!1);return e.runWebGLProgram(p,[r],r.dtype)}var PF={kernelName:Y1,backendName:"webgl",kernelFunc:Ort};var Ey=class{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;let e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,o=t.effectiveFilterHeight,s=t.effectiveFilterWidth,a=o-1-t.padInfo.top,l=s-1-t.padInfo.left,c=o*s-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${e}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${n}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${s} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}},Ty=class{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;let e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,a=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,u=t.effectiveFilterWidth,h=l-1-t.padInfo.front,p=c-1-t.padInfo.top,f=u-1-t.padInfo.left,d=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${h}, ${p}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${e}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${s}) {
            float dyR = float(dyRCorner + wR) / ${n}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${d} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Brt(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,input:o}=t,s=o,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=n,h=[1,1,1],p=O.computePool3DInfo(s.shape,a,l,h,c,u),f=new As(p,"max",!0),d=e.runWebGLProgram(f,[s],s.dtype),m=new Ty(p),x=e.runWebGLProgram(m,[r,d],s.dtype);return e.disposeIntermediateTensorInfo(d),x}var NF={kernelName:Z1,backendName:"webgl",kernelFunc:Brt};function Vrt(i){let{inputs:t,backend:e,attrs:n}=i,{dy:r,input:o,output:s}=t,a=o;Qr([o,s],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=n,p=O.computePool2DInfo(a.shape,l,c,1,u,h),f=!0,d=new vr(p,"max",f),m=e.runWebGLProgram(d,[a],a.dtype),x=new Ey(p),g=e.runWebGLProgram(x,[r,m],a.dtype);return e.disposeIntermediateTensorInfo(m),g}var LF={kernelName:K1,backendName:"webgl",kernelFunc:Vrt};function DF(i,t,e,n){let r=new vr(e,"max",!1),o=n.runWebGLProgram(r,[i],"float32");r=new vr(e,"max",!0,!0,t);let s=n.runWebGLProgram(r,[i],"float32");return[o,s]}var zF={kernelName:J1,backendName:"webgl",kernelFunc:({inputs:i,attrs:t,backend:e})=>{let{x:n}=i,{filterSize:r,strides:o,pad:s,includeBatchInIndex:a}=t,l=e;L.assert(n.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${n.shape.length}.`);let c=[1,1];L.assert(O.eitherStridesOrDilationsAreOne(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);let u=O.computePool2DInfo(n.shape,r,o,c,s),[h,p]=DF(n,a,u,l);return[h,p]}};function FF(i,t,e,n){let r=L.sizeFromShape(t),s=L.sizeFromShape(i.shape)/r,a=Tt({inputs:{x:i},attrs:{shape:[s,r]},backend:n}),l=bi(a,"float32","mean",n),c=Tt({inputs:{x:l},attrs:{shape:e},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}var OF={kernelName:Q1,backendName:"webgl",kernelFunc:({inputs:i,attrs:t,backend:e})=>{let{x:n}=i,{keepDims:r,axis:o}=t,s=e,a=n.shape.length,l=L.parseAxisParam(o,n.shape),c=l,u=O.getAxesPermutation(c,a),h=u!=null,p=s.shouldExecuteOnCPU([n]),f=[],d=n;if(h){if(p){let v=s.texData.get(d.dataId).values,_=new Array(a);for(let M=0;M<_.length;M++)_[M]=n.shape[u[M]];let S=el(v,n.shape,n.dtype,u,_);d=s.makeTensorInfo(_,n.dtype);let E=s.texData.get(d.dataId);E.values=S}else d=Is(n,u,s);f.push(d),c=O.getInnerMostAxes(c.length,a)}O.assertAxesAreInnerMostDims("sum",c,a);let[m,x]=O.computeOutAndReduceShapes(d.shape,c),g=m;r&&(g=O.expandShapeToKeepDim(m,l));let y=FF(d,x,g,s);for(let b of f)s.disposeIntermediateTensorInfo(b);return y}};function Hrt(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,keepDims:s}=n,a=r.shape.length,l=L.parseAxisParam(o,r.shape),c=l,u=O.getAxesPermutation(c,a),h=r;u!=null&&(h=Be({inputs:{x:r},backend:e,attrs:{perm:u}}),c=O.getInnerMostAxes(c.length,r.shape.length)),O.assertAxesAreInnerMostDims("min",c,a);let[p,f]=O.computeOutAndReduceShapes(h.shape,c),d=L.sizeFromShape(f),m=Tt({inputs:{x:h},backend:e,attrs:{shape:[-1,d]}}),x=bi(m,m.dtype,"min",e),g;if(s){let y=O.expandShapeToKeepDim(p,l);g=Tt({inputs:{x},backend:e,attrs:{shape:y}})}else g=Tt({inputs:{x},backend:e,attrs:{shape:p}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(x),u!=null&&e.disposeIntermediateTensorInfo(h),g}var BF={kernelName:t0,backendName:"webgl",kernelFunc:Hrt};var $rt=Px+`
  return min(a, b);
`,Urt=`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+Es+`
  return result;
`,Wrt=be({opSnippet:$rt,packedOpSnippet:Urt,cpuKernelImpl:nD}),VF={kernelName:af,backendName:"webgl",kernelFunc:Wrt};var Iy=class{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map((u,h)=>u[0]+t[h]+u[1]);let r=t.length,o=ie(r),s=e.map(u=>u[0]).join(","),a=e.map((u,h)=>u[0]+t[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=n==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${s};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${s});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}};var Ay=class{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((d,m)=>d[0]+t[m]+d[1]);let r=t.length,o=ie(r),s=e.map(d=>d[0]).join(","),a=e.map((d,m)=>d[0]+t[m]).join(","),l=qe("rc",r),c=qe("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,h=r===1?"source":`vec2(${c.slice(-2).join()})`,p=n==="reflect"?0:1,f="";if(r===1){let d=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${d}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[r-1]} += 1;
        if(${u}) {
          ${d}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
      `}else{let d=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${d}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[r-1]} += 1;
        if(${u}) {
          ${d}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${d}
          result[2] = getChannel(getX(${c.join()}), ${h});
          ${l[r-1]} += 1;
          if(${u}) {
            ${d}
            result[3] = getChannel(getX(${c.join()}), ${h});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${s});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}};var Grt=({inputs:i,backend:t,attrs:e})=>{let{x:n}=i,{paddings:r,mode:o}=e,s=ot().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ay(n.shape,r,o):new Iy(n.shape,r,o);return t.runWebGLProgram(s,[n],n.dtype)},HF={kernelName:e0,backendName:"webgl",kernelFunc:Grt};var jrt=`if (b == 0.0) return NAN;
  return mod(a, b);`,qrt=`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  `+Es+`
  return result;
`,Xrt=be({opSnippet:jrt,packedOpSnippet:qrt}),$F={kernelName:lf,backendName:"webgl",kernelFunc:Xrt};var ky=class{constructor(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${e-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${e-1}));
      }
    `}getCustomSetupFunc(t){return(e,n)=>{this.seedLoc==null&&(this.seedLoc=e.getUniformLocation(n,"seed")),e.gl.uniform1f(this.seedLoc,t)}}};var Krt=`
if (a == b) {
  return 1.0;
};
return a / b;`,Yrt=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,r3=be({opSnippet:Krt,packedOpSnippet:Yrt,checkOutOfBounds:!0}),UF={kernelName:Vp,backendName:"webgl",kernelFunc:r3};var WF="return a - b;",o3=be({opSnippet:WF,packedOpSnippet:WF,supportsComplex:!0,cpuKernelImpl:uD}),GF={kernelName:Ha,backendName:"webgl",kernelFunc:o3};function s3(i){let{inputs:t,backend:e,attrs:n}=i,{logits:r}=t,{dim:o}=n,s=L.parseAxisParam([o],r.shape),a=i3({inputs:{x:r},backend:e,attrs:{reductionIndices:s,keepDims:!1}}),l=O.expandShapeToKeepDim(a.shape,s),c=Tt({inputs:{x:a},backend:e,attrs:{shape:l}}),u=o3({inputs:{a:r,b:c},backend:e}),h=n3({inputs:{x:u},backend:e}),p=il({inputs:{x:h},backend:e,attrs:{axis:s,keepDims:!1}}),f=Tt({inputs:{x:p},backend:e,attrs:{shape:l}}),d=r3({inputs:{a:h,b:f},backend:e});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(f),d}var jF={kernelName:w0,backendName:"webgl",kernelFunc:s3};function Zrt(i){let{inputs:t,backend:e,attrs:n}=i,{logits:r}=t,{numSamples:o,seed:s,normalized:a}=n,l=a?r:s3({inputs:{logits:r},backend:e,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],h=new ky(c,u,o),p=h.getCustomSetupFunc(s),f=e.runWebGLProgram(h,[l],"int32",p);return a||e.disposeIntermediateTensorInfo(l),f}var qF={kernelName:n0,backendName:"webgl",kernelFunc:Zrt};var XF="return -x;";function Jrt(i){let{inputs:t,backend:e}=i,{x:n}=t;if(e.shouldExecuteOnCPU([n])){let o=e.texData.get(n.dataId),[s,a]=rD(o.values,n.shape,n.dtype);return e.makeTensorInfo(a,n.dtype,s)}let r;return ot().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Ji(n.shape,XF):r=new ti(n.shape,XF),e.runWebGLProgram(r,[n],n.dtype)}var KF={kernelName:i0,backendName:"webgl",kernelFunc:Jrt};var Qrt=Fn.nonMaxSuppressionV3Impl;function tot(i){O.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:e,attrs:n}=i,{boxes:r,scores:o}=t,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l}=n,c=e.readSync(r.dataId),u=e.readSync(o.dataId),{selectedIndices:h}=Qrt(c,u,s,a,l);return e.makeTensorInfo([h.length],"int32",new Int32Array(h))}var YF={kernelName:r0,backendName:"webgl",kernelFunc:tot};var eot=Fn.nonMaxSuppressionV4Impl;function not(i){O.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:e,attrs:n}=i,{boxes:r,scores:o}=t,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=n,u=e.readSync(r.dataId),h=e.readSync(o.dataId),{selectedIndices:p,validOutputs:f}=eot(u,h,s,a,l,c);return[e.makeTensorInfo([p.length],"int32",new Int32Array(p)),e.makeTensorInfo([],"int32",new Int32Array([f]))]}var ZF={kernelName:o0,backendName:"webgl",kernelFunc:not};var iot=Fn.nonMaxSuppressionV5Impl;function rot(i){O.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:e,attrs:n}=i,{boxes:r,scores:o}=t,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=n,u=e.readSync(r.dataId),h=e.readSync(o.dataId),p=s,f=a,d=l,m=c,{selectedIndices:x,selectedScores:g}=iot(u,h,p,f,d,m);return[e.makeTensorInfo([x.length],"int32",new Int32Array(x)),e.makeTensorInfo([g.length],"float32",new Float32Array(g))]}var JF={kernelName:s0,backendName:"webgl",kernelFunc:rot};var Ry=class{constructor(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${n}),
                      float(index == coords.y)));
      }
    `}};var oot=i=>{let{inputs:t,backend:e,attrs:n}=i,{indices:r}=t,{depth:o,onValue:s,offValue:a}=n,l=L.sizeFromShape(r.shape),c=new Ry(l,o,s,a),u=Tt({inputs:{x:r},backend:e,attrs:{shape:[l]}}),h=e.runWebGLProgram(c,[u],r.dtype);e.disposeIntermediateTensorInfo(u);let p=[...r.shape,o],f=Tt({inputs:{x:h},backend:e,attrs:{shape:p}});return e.disposeIntermediateTensorInfo(h),f},QF={kernelName:l0,backendName:"webgl",kernelFunc:oot};function qf(i){let{inputs:t,backend:e}=i,{x:n}=t;if(n.dtype==="complex64"){let r=Oo({inputs:{input:n},backend:e}),o=qf({inputs:{x:r},backend:e}),s=ol({inputs:{input:n},backend:e}),a=qf({inputs:{x:s},backend:e}),l=ui({inputs:{real:o,imag:a},backend:e});return e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(a),l}else return jf({attrs:{shape:n.shape,dtype:n.dtype,value:n.dtype==="string"?"":0},backend:e})}var t8={kernelName:P0,backendName:"webgl",kernelFunc:qf};function e8(i){let{inputs:t,backend:e}=i,{x:n}=t;if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(n.dtype==="complex64"){let r=Oo({inputs:{input:n},backend:e}),o=e8({inputs:{x:r},backend:e}),s=ol({inputs:{input:n},backend:e}),a=qf({inputs:{x:s},backend:e}),l=ui({inputs:{real:o,imag:a},backend:e});return e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(a),l}else return jf({attrs:{shape:n.shape,dtype:n.dtype,value:1},backend:e})}var n8={kernelName:a0,backendName:"webgl",kernelFunc:e8};function sot(i){let{inputs:t,backend:e,attrs:n}=i,{axis:r}=n;if(t.length===1)return my({inputs:{input:t[0]},backend:e,attrs:{dim:r}});let o=t[0].shape,s=t[0].dtype;t.forEach(u=>{L.assertShapesMatch(o,u.shape,"All tensors passed to stack must have matching shapes"),L.assert(s===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let a=[],l=t.map(u=>{let h=my({inputs:{input:u},backend:e,attrs:{dim:r}});return a.push(h),h}),c=e3({inputs:l,backend:e,attrs:{axis:r}});return a.forEach(u=>e.disposeIntermediateTensorInfo(u)),c}var i8={kernelName:c0,backendName:"webgl",kernelFunc:sot};var Py=class{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map((c,u)=>c[0]+t[u]+c[1]);let r=t.length,o=ie(r),s=e.map(c=>c[0]).join(","),a=e.map((c,u)=>c[0]+t[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${s};
        int end = ${a};
        uniform float value;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${s});
      ${o} end = ${o}(${a});
      uniform float value;

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}getCustomSetupFunc(t){return(e,n)=>{this.valueLoc==null&&(this.valueLoc=e.getUniformLocationNoThrow(n,"value")),e.gl.uniform1f(this.valueLoc,t)}}};var Ny=class{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((m,x)=>m[0]+t[x]+m[1]);let r=t.length,o=ie(r),s=e.map(m=>m[0]).join(","),a=e.map((m,x)=>m[0]+t[x]).join(","),l=qe("rc",r),c=qe("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,h=r===1?"source":`vec2(${c.slice(-2).join()})`,p=[`${o} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",d="";for(let m=0,x=r===1?2:4;m<x;m++)d+=`
        ${p[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${h});
        }
      `;d+=r===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${s});
      const ${o} end = ${o}(${a});
      uniform float value;

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${d}
        setOutput(result);
      }
    `}getCustomSetupFunc(t){return(e,n)=>{this.valueLoc==null&&(this.valueLoc=e.getUniformLocationNoThrow(n,"value")),e.gl.uniform1f(this.valueLoc,t)}}};var a3=i=>{let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{paddings:o,constantValue:s}=n,a=ot().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ny(r.shape,o,s):new Py(r.shape,o,s),l=a.getCustomSetupFunc(s);return e.runWebGLProgram(a,[r],r.dtype,l)},r8={kernelName:Fc,backendName:"webgl",kernelFunc:a3};var aot=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,lot=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  `+Es+`
  return result;
`,cot=be({opSnippet:aot,packedOpSnippet:lot}),o8={kernelName:uf,backendName:"webgl",kernelFunc:cot};function uot(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{axis:o,keepDims:s}=n,a=r.shape.length,l=[],c=L.parseAxisParam(o,r.shape),u=c,h=O.getAxesPermutation(u,a),p=r;h!=null&&(p=Be({inputs:{x:r},backend:e,attrs:{perm:h}}),u=O.getInnerMostAxes(u.length,a),l.push(p)),O.assertAxesAreInnerMostDims("prod",u,a);let f;if(e.shouldExecuteOnCPU([p])){let d=e.texData.get(p.dataId).values,{outVals:m,outShape:x,outDtype:g}=oD(p.shape,p.dtype,d,u);f=e.makeTensorInfo(x,g,m)}else{let[d,m]=O.computeOutAndReduceShapes(p.shape,u),x=L.sizeFromShape(m),g=Tt({inputs:{x:p},backend:e,attrs:{shape:[-1,x]}}),y=Ga(r.dtype),b=bi(g,y,"prod",e);f=Tt({inputs:{x:b},backend:e,attrs:{shape:d}}),l.push(g),l.push(b)}if(s){l.push(f);let d=O.expandShapeToKeepDim(f.shape,c);f=Tt({inputs:{x:f},backend:e,attrs:{shape:d}})}return l.forEach(d=>e.disposeIntermediateTensorInfo(d)),f}var s8={kernelName:u0,backendName:"webgl",kernelFunc:uot};var l3=i=>{let{backend:t,attrs:e}=i,{start:n,stop:r,step:o,dtype:s}=e,a=sD(n,r,o,s);return t.makeTensorInfo([a.length],s,a)},a8={kernelName:h0,backendName:"webgl",kernelFunc:l3};var hot="return 1.0 / x;",pot=Bt({opSnippet:hot}),l8={kernelName:hf,backendName:"webgl",kernelFunc:pot};var fot=bn+`
  return (x < 0.0) ? 0.0 : x;
`,dot=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,mot=Bt({opSnippet:fot,packedOpSnippet:dot}),c8={kernelName:Ba,backendName:"webgl",kernelFunc:mot};var got=bn+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,xot=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,yot=Bt({opSnippet:got,packedOpSnippet:xot}),u8={kernelName:Va,backendName:"webgl",kernelFunc:yot};var Ly=class{constructor(t,e,n,r,o){this.variableNames=["A"],this.outputShape=[];let[s,a,l,c]=t;this.outputShape=[s,e,n,c];let u=[r&&e>1?a-1:a,r&&n>1?l-1:l],h=[r&&e>1?e-1:e,r&&n>1?n-1:n],p;o?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}};var Dy=class{constructor(t,e,n,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[s,a,l,c]=t;this.outputShape=[s,e,n,c];let u=[r&&e>1?a-1:a,r&&n>1?l-1:l],h=[r&&e>1?e-1:e,r&&n>1?n-1:n],p;o?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${n-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}};function vot(i){let{inputs:t,backend:e,attrs:n}=i,{images:r}=t,{alignCorners:o,halfPixelCenters:s,size:a}=n,[l,c]=a,u=ot().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Dy(r.shape,l,c,o,s):new Ly(r.shape,l,c,o,s);return e.runWebGLProgram(u,[r],"float32")}var h8={kernelName:m0,backendName:"webgl",kernelFunc:vot};var zy=class{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;let[,r,o]=e,[,s,a]=t,l=[n&&s>1?r-1:r,n&&a>1?o-1:o],c=[n&&s>1?s-1:s,n&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],p=1/u,f=1/h,d=Math.ceil(p)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${f});

        const int winHeight = int(${d});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function bot(i){let{inputs:t,backend:e,attrs:n}=i,{images:r,dy:o}=t,{alignCorners:s}=n,a=new zy(o.shape,r.shape,s);return e.runWebGLProgram(a,[o],o.dtype)}var p8={kernelName:g0,backendName:"webgl",kernelFunc:bot};var Fy=class{constructor(t,e,n,r,o){this.variableNames=["A"],this.outputShape=[];let[s,a,l,c]=t;this.outputShape=[s,e,n,c];let u=[r&&e>1?a-1:a,r&&n>1?l-1:l],h=[r&&e>1?e-1:e,r&&n>1?n-1:n],p=r?"0.5":"0.0",f;o?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}};function _ot(i){let{inputs:t,backend:e,attrs:n}=i,{images:r}=t,{alignCorners:o,halfPixelCenters:s,size:a}=n,[l,c]=a,u=new Fy(r.shape,l,c,o,s);return e.runWebGLProgram(u,[r],r.dtype)}var f8={kernelName:f0,backendName:"webgl",kernelFunc:_ot};var Oy=class{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;let[,r,o]=e,[,s,a]=t,l=[n&&s>1?r-1:r,n&&a>1?o-1:o],c=[n&&s>1?s-1:s,n&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],p=1/u,f=1/h,d=Math.ceil(p)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${f});

        const int winHeight = int(${d});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${n} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${n} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function wot(i){let{inputs:t,backend:e,attrs:n}=i,{images:r,dy:o}=t,{alignCorners:s}=n,a=new Oy(o.shape,r.shape,s);return e.runWebGLProgram(a,[o],o.dtype)}var d8={kernelName:d0,backendName:"webgl",kernelFunc:wot};var By=class{constructor(t,e){this.variableNames=["x"];let n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=t,n===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}let r=a=>e.indexOf(a)!==-1&&t[a]!==1?`${t[a]} - coords[${a}] - 1`:`coords[${a}]`,o=t.map((a,l)=>r(l)).join(","),s=ie(n);this.userCode=`
      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}};var Vy=class{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=t;let r=qe("rc",n),o=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,s=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,a=ie(n);n===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${o}){
            result.g = ${c(r.slice())};
          }
          if(${s}) {
            result.b = ${u(r.slice())};
            if(${o}) {
              result.a = ${h(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(d){return p(d)}function c(d){return d[n-1]="("+d[n-1]+" + 1)",p(d)}function u(d){return d[n-2]="("+d[n-2]+" + 1)",p(d)}function h(d){return d[n-1]="("+d[n-1]+" + 1)",d[n-2]="("+d[n-2]+" + 1)",p(d)}function p(d){let m=t.map((y,b)=>f(b,d)),x=m.join(","),g=m.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${g}))`}function f(d,m){return e.indexOf(d)!==-1&&t[d]!==1?`${t[d]} - ${m[d]} - 1`:`${m[d]}`}}};function Sot(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{dims:o}=n,s=r.shape.length,a=L.parseAxisParam(o,r.shape);if(s===0)return Xe({inputs:{x:r},backend:e});let l=ot().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Vy(r.shape,a):new By(r.shape,a);return e.runWebGLProgram(l,[r],r.dtype)}var m8={kernelName:x0,backendName:"webgl",kernelFunc:Sot};var Hy=class{constructor(t,e){this.variableNames=["Image"],this.outputShape=[];let n=t[1],r=t[2];this.outputShape=t;let o="";typeof e=="number"?o=`float outputValue = ${e.toFixed(2)};`:o=`
        vec3 fill = vec3(${e.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        uniform vec4 params;
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}getCustomSetupFunc(t,e,n,r){return(o,s)=>{this.paramsLoc==null&&(this.paramsLoc=o.getUniformLocationNoThrow(s,"params")),o.gl.uniform4f(this.paramsLoc,t,e,n,r)}}};var g8={kernelName:N0,backendName:"webgl",kernelFunc:({inputs:i,attrs:t,backend:e})=>{let{image:n}=i,{radians:r,fillValue:o,center:s}=t,a=e,l=new Hy(n.shape,o),[c,u]=O.getImageCenter(s,n.shape[1],n.shape[2]),h=l.getCustomSetupFunc(c,u,Math.sin(r),Math.cos(r));return a.runWebGLProgram(l,[n],n.dtype,h)}};var Cot=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,Mot=Bt({opSnippet:Cot}),x8={kernelName:pf,backendName:"webgl",kernelFunc:Mot};var Eot="return inversesqrt(x);",Tot=Bt({opSnippet:Eot,cpuKernelImpl:aD}),y8={kernelName:ff,backendName:"webgl",kernelFunc:Tot};var mu=class{constructor(t,e,n,r,o,s,a=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;let l=ie(o.length),c=ie(s.length),u="";n===1?u="i":n===2&&(u="i, j");let h=`getIndices(${u})`,p="";r===1?p="i":r===2&&(p="i, coords[1]");let f=`getUpdates(${p})`,d=e>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${e}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${d};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}};function Iot(i){let{inputs:t,backend:e,attrs:n}=i,{indices:r,updates:o}=t,{shape:s}=n,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=O.calculateShapes(o,r,s),p=[h/c,c];if(h===0)return e.makeTensorInfo(s,r.dtype);let f=Tt({inputs:{x:r},backend:e,attrs:{shape:[l,a]}}),d=Tt({inputs:{x:o},backend:e,attrs:{shape:[l,c]}}),m=e.makeTensorInfo([],"float32",new Float32Array([0])),x=new mu(l,a,f.shape.length,d.shape.length,u,p),g=e.runWebGLProgram(x,[d,f,m],d.dtype),y=Tt({inputs:{x:g},backend:e,attrs:{shape:s}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(m),y}var v8={kernelName:y0,backendName:"webgl",kernelFunc:Iot};var $y=class{constructor(t,e,n){this.variableNames=["c","a","b"],this.outputShape=e;let r,o;if(n>4)throw Error(`Where for rank ${n} is not yet supported`);if(n===1)o="resRC",r="resRC";else{let a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<e.length;u++)c.push(`${a[u]}`),u<t&&l.push(`${a[u]}`);r=l.join(),o=c.join()}let s=ie(n);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}};function Aot(i){let{inputs:t,backend:e}=i,{condition:n,t:r,e:o}=t,s=new $y(n.shape.length,r.shape,r.shape.length);return e.runWebGLProgram(s,[n,r,o],dn(r.dtype,o.dtype))}var b8={kernelName:v0,backendName:"webgl",kernelFunc:Aot};var kot=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${O.SELU_SCALEALPHA};
  float scale = ${O.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Rot=Bt({opSnippet:kot}),_8={kernelName:df,backendName:"webgl",kernelFunc:Rot};var Pot="return 1.0 / (1.0 + exp(-1.0 * x));",Not=Bt({opSnippet:Pot}),w8={kernelName:yf,backendName:"webgl",kernelFunc:Not};var Lot=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Dot=Bt({opSnippet:Lot}),S8={kernelName:xf,backendName:"webgl",kernelFunc:Dot};var zot=Nx+`
  return sin(x);
`,Fot=Bt({opSnippet:zot}),C8={kernelName:mf,backendName:"webgl",kernelFunc:Fot};var Oot=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Bot=Bt({opSnippet:Oot}),M8={kernelName:gf,backendName:"webgl",kernelFunc:Bot};var Vot=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Hot=Bt({opSnippet:Vot}),E8={kernelName:vf,backendName:"webgl",kernelFunc:Hot};var $ot=i=>{let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{blockShape:o,paddings:s}=n;L.assert(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let a=o.reduce((g,y)=>g*y),l=[[0,0]];l.push(...s);for(let g=1+o.length;g<r.shape.length;++g)l.push([0,0]);let c=[],u=a3({inputs:{x:r},backend:e,attrs:{paddings:l,constantValue:0}}),h=O.getReshaped(u.shape,o,a,!1),p=O.getPermuted(h.length,o.length,!1),f=O.getReshapedPermuted(u.shape,o,a,!1),d=Tt({inputs:{x:u},backend:e,attrs:{shape:h}}),m=Be({inputs:{x:d},backend:e,attrs:{perm:p}}),x=Tt({inputs:{x:m},backend:e,attrs:{shape:f}});return c.push(u),c.push(d),c.push(m),c.forEach(g=>e.disposeIntermediateTensorInfo(g)),x},T8={kernelName:_0,backendName:"webgl",kernelFunc:$ot};function Uot(i){let{inputs:t,backend:e,attrs:n}=i,{sparseIndices:r,sparseValues:o,defaultValue:s}=t,{outputShape:a}=n,{sliceRank:l,numUpdates:c,strides:u,outputSize:h}=O.calculateShapes(o,r,a),p=!1,f=new mu(c,l,r.shape.length,o.shape.length,u,[h,1],p),d=e.runWebGLProgram(f,[o,r,s],o.dtype),m=Tt({inputs:{x:d},backend:e,attrs:{shape:a}});return e.disposeIntermediateTensorInfo(d),m}var I8={kernelName:C0,backendName:"webgl",kernelFunc:Uot};function Wot(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{numOrSizeSplits:o,axis:s}=n,a=L.parseAxisParam(s,r.shape)[0],l=O.prepareSplitSize(r,o,a),c=r.shape.length,u=new Array(c).fill(0),h=r.shape.slice();return l.map(p=>{let f=[...h];f[a]=p;let d=Fo({inputs:{x:r},backend:e,attrs:{begin:u,size:f}});return u[a]+=p,d})}var A8={kernelName:Hc,backendName:"webgl",kernelFunc:Wot};var Got="return sqrt(x);",jot=Bt({opSnippet:Got}),k8={kernelName:bf,backendName:"webgl",kernelFunc:jot};var qot="return x * x;",Xot=Bt({opSnippet:qot}),R8={kernelName:S0,backendName:"webgl",kernelFunc:Xot};var P8="return (a - b) * (a - b);",Kot=be({opSnippet:P8,packedOpSnippet:P8}),N8={kernelName:_f,backendName:"webgl",kernelFunc:Kot};function Yot({inputs:i,attrs:t,backend:e}){let{x:n}=i,r=bn+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,o=new ti(n.shape,r);return e.runWebGLProgram(o,[n],n.dtype)}var L8={kernelName:$a,backendName:"webgl",kernelFunc:Yot};var Uy=class{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;let r=n.length,o=ie(n.length),s=ie(n.length),a="";if(r===1)a="coords * strides + begin";else{let l=0;a=n.map((c,u)=>(l++,n.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${t});
      ${o} strides = ${o}(${e});

      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}};function Zot(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{begin:o,end:s,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:p}=n,{nonStrided:f,$begin:d,$strides:m,size:x,newShape:g,outShape:y}=zn.sliceInfo(r.shape,o,s,a,l,c,u,h,p),b=Tt({inputs:{x:r},backend:e,attrs:{shape:g}}),v;if(f){let S=Fo({inputs:{x:b},backend:e,attrs:{begin:d,size:x}});v=Tt({inputs:{x:S},backend:e,attrs:{shape:y}}),e.disposeIntermediateTensorInfo(S)}else if(y.some(S=>S===0))v=e.makeTensorInfo(y,r.dtype,[]);else if(e.shouldExecuteOnCPU([b])){let M=e.texData.get(b.dataId).values,N=Yt(b.shape,b.dtype,M),I=cD(y,N,m,d);v=e.makeTensorInfo(y,b.dtype,I.values)}else{let E=new Uy(d,m,y);v=e.runWebGLProgram(E,[b],b.dtype)}let _=Tt({inputs:{x:v},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(v),_}var D8={kernelName:M0,backendName:"webgl",kernelFunc:Zot};var Jot="return tan(x);",Qot=Bt({opSnippet:Jot}),z8={kernelName:wf,backendName:"webgl",kernelFunc:Qot};var tst=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,est=Bt({opSnippet:tst}),F8={kernelName:Sf,backendName:"webgl",kernelFunc:est};var Wy=class{constructor(t,e){this.variableNames=["A"];let n=new Array(t.length);for(let s=0;s<n.length;s++)n[s]=t[s]*e[s];this.outputShape=n,this.rank=n.length;let r=ie(this.rank),o=nst(t);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}};function nst(i){let t=i.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${i[0]})`;let e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],n=[];for(let r=0;r<i.length;r++)n.push(`imod(${e[r]}, ${i[r]})`);return n.join()}function c3(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{reps:o}=n;if(r.dtype==="string"){let c=e.readSync(r.dataId).map(p=>L.decodeString(p)),u=Yt(r.shape,r.dtype,c),h=hD(u,o);return e.makeTensorInfo(h.shape,h.dtype,h.values)}let s=new Wy(r.shape,o);return e.runWebGLProgram(s,[r],r.dtype)}var O8={kernelName:E0,backendName:"webgl",kernelFunc:c3};function ist(i){let{inputs:t,backend:e,attrs:n}=i,{x:r}=t,{k:o,sorted:s}=n,a=e.readSync(r.dataId),[l,c]=pD(a,r.shape,r.dtype,o,s);return[e.makeTensorInfo(l.shape,l.dtype,l.values),e.makeTensorInfo(c.shape,c.dtype,c.values)]}var B8={kernelName:T0,backendName:"webgl",kernelFunc:ist};var Gy=class{constructor(t,e,n,r,o,s){this.variableNames=["Image","Transforms"],this.outputShape=s;let a=n==="nearest"?1:2,l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${e}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${e}));
                float mapY = mapCoord(inY, float(${t}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}};function rst(i){let{inputs:t,backend:e,attrs:n}=i,{image:r,transforms:o}=t,{interpolation:s,fillMode:a,fillValue:l,outputShape:c}=n,[u,h,p,f]=r.shape,[d,m]=c!=null?c:[h,p],x=[u,d,m,f],g=new Gy(h,p,s,a,l,x);return e.runWebGLProgram(g,[r,o],"float32")}var V8={kernelName:I0,backendName:"webgl",kernelFunc:rst};function ost(i){let{inputs:t,attrs:e,backend:n}=i,{axis:r}=e,{x:o}=t;Qr(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let s=n.readSync(o.dataId),{outputValues:a,outputShape:l,indices:c}=fD(s,r,o.shape,o.dtype);return[n.makeTensorInfo(l,o.dtype,a),n.makeTensorInfo([c.length],"int32",c)]}var H8={kernelName:A0,backendName:"webgl",kernelFunc:ost};function sst(i){let{inputs:t,backend:e,attrs:n}=i,{value:r}=t,{axis:o}=n;o<0&&(o+=r.shape.length);let s=r,a=s.shape.length,l=r.shape[o],c=new Array(a-1),u=0;for(let m=0;m<a;m++)m!==o&&(c[u++]=s.shape[m]);let h=[],p=new Array(a).fill(0),f=s.shape.slice();f[o]=1;let d=new Array(l);for(let m=0;m<d.length;m++){p[o]=m;let x=Fo({inputs:{x:s},backend:e,attrs:{begin:p,size:f}}),g=Tt({inputs:{x},backend:e,attrs:{shape:c}});d[m]=g,h.push(x)}return h.forEach(m=>e.disposeIntermediateTensorInfo(m)),d}var $8={kernelName:k0,backendName:"webgl",kernelFunc:sst};var jy=class{constructor(t,e){this.variableNames=["x","segmentIds"];let n=t.windowSize,r=t.batchSize,o=t.inSize,s=t.numSegments,a=s*Math.ceil(o/n);this.outputShape=[r,a];let l="0.0",c="sumValue",u=Math.floor(n/4)*4,h=n%4,p=`
        sumValue += dot(values, segFilter);
    `,f="";o%n>0&&(f=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let d="";o%n>0&&(d=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${d}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${s})) * float(${n}));
        int currentSeg = int(mod(float(outIdx), float(${s})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${h===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${h===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${c});
      }
    `}};function ast(i){let{inputs:t,backend:e,attrs:n}=i,{x:r,segmentIds:o}=t,{numSegments:s}=n,a=r.shape.length,l=[],c=0,u=O.getAxesPermutation([c],a),h=r;u!=null&&(h=Be({inputs:{x:r},backend:e,attrs:{perm:u}}),l.push(h),c=O.getInnerMostAxes(1,a)[0]);let p=O.segment_util.computeOutShape(h.shape,c,s),f=L.sizeFromShape([h.shape[c]]),d=Tt({inputs:{x:h},backend:e,attrs:{shape:[-1,f]}});l.push(d);let m=Ga(r.dtype),x=(v,_,S,E,M)=>{let N=v.shape[0],I=v.shape[1],w=O.segment_util.segOpComputeOptimalWindowSize(I,M),R={windowSize:w,inSize:I,batchSize:N,numSegments:M},P=new jy(R,_),D=e.compileAndRun(P,[v,S],E);if(l.push(D),D.shape[1]===M)return D;let F=l3({backend:e,attrs:{start:0,stop:M,step:1,dtype:"float32"}}),z=c3({inputs:{x:F},backend:e,attrs:{reps:[I/w]}});return l.push(F),l.push(z),x(D,_,z,E,M)},g=x(d,"unsortedSegmentSum",o,m,s),y=Tt({inputs:{x:g},backend:e,attrs:{shape:p}}),b=y;if(u!=null){l.push(y);let v=O.getUndoAxesPermutation(u);b=Be({inputs:{x:b},backend:e,attrs:{perm:v}})}return l.forEach(v=>e.disposeIntermediateTensorInfo(v)),b}var U8={kernelName:R0,backendName:"webgl",kernelFunc:ast};var lst=[EF,TF,VD,$D,UD,WD,jD,qD,XD,KD,JD,QD,tz,ez,iz,nz,rz,sz,oz,az,lz,cz,uz,pz,fz,xz,vz,bz,wz,ID,Mz,Tz,Iz,Ez,kz,Rz,Az,Pz,Nz,Lz,Fz,Oz,Bz,Hz,$z,Vz,Uz,Wz,Gz,jz,qz,Xz,Kz,Zz,Jz,tF,eF,nF,iF,oF,sF,aF,lF,cF,uF,hF,pF,fF,TD,dF,Sz,mF,gF,xF,AD,yF,vF,bF,wF,_F,SF,CF,MF,AF,PF,RF,NF,LF,zF,kF,OF,BF,VF,HF,$F,qF,LD,KF,YF,ZF,JF,dz,QF,n8,i8,r8,o8,kD,s8,a8,mz,UF,l8,u8,c8,zD,h8,p8,f8,d8,m8,g8,x8,y8,v8,b8,_8,w8,S8,C8,M8,hz,jF,E8,T8,I8,A8,k8,R8,N8,L8,D8,GF,OD,z8,F8,O8,B8,V8,BD,H8,$8,U8,t8];for(let i of lst)O0(i);var u3=class{constructor(){this.arr=[]}push(t,e){this.arr.push({key:t,value:e}),this.bubbleUp(this.arr.length-1)}pop(){if(this.arr.length===0)throw new Error("pop() called on empty binary heap");let t=this.arr[0],e=this.arr.length-1;return this.arr[0]=this.arr[e],this.arr.pop(),e>0&&this.bubbleDown(0),t}peek(){return this.arr[0]}popPush(t,e){if(this.arr.length===0)throw new Error("pop() called on empty binary heap");let n=this.arr[0];return this.arr[0]={key:t,value:e},this.arr.length>0&&this.bubbleDown(0),n}size(){return this.arr.length}items(){return this.arr}swap(t,e){let n=this.arr[t];this.arr[t]=this.arr[e],this.arr[e]=n}bubbleDown(t){let e=(t<<1)+1,n=e+1,r=t;e<this.arr.length&&this.arr[e].key<this.arr[r].key&&(r=e),n<this.arr.length&&this.arr[n].key<this.arr[r].key&&(r=n),r!==t&&(this.swap(r,t),this.bubbleDown(r))}bubbleUp(t){if(t<=0)return;let e=t-1>>1;this.arr[t].key<this.arr[e].key&&(this.swap(t,e),this.bubbleUp(e))}},gu=class{constructor(t){this.maxHeap=new u3,this.k=t}add(t,e){if(this.maxHeap.size()<this.k){this.maxHeap.push(-t,e);return}let n=this.maxHeap.peek();t<-n.key&&this.maxHeap.popPush(-t,e)}getMinKItems(){let t=this.maxHeap.items();return t.sort((e,n)=>n.key-e.key),t.map(e=>e.value)}getSize(){return this.maxHeap.size()}getLargestKey(){return this.maxHeap.size()===0?null:-this.maxHeap.peek().key}};var xu=null,cst=0,qy=0;function G8(i){xu=i}function he(i,t=null,e=null,n=!1){var c;if(xu==null)return console.warn("Can't show modal message before the dom is initialized"),"";t==null&&(t=(cst++).toString());let r=(c=xu.shadowRoot)==null?void 0:c.querySelector("#notification-dialog");r.querySelector(".close-button").style.display=n?null:"none";let o=r.querySelector(".progress");o.style.display=n?"none":null,o.active=n?null:!0,r.querySelector("#notification-title").textContent=e;let s=r.querySelector("#notify-msgs");if(n)s.textContent="";else{let u=s.querySelectorAll(".error");for(let h=0;h<u.length;h++)s.removeChild(u[h])}let a=`notify-msg-${t}`,l=r.querySelector("#"+a);return l==null&&(l=document.createElement("div"),l.className="notify-msg "+(n?"error":""),l.id=a,s.insertBefore(l,s.firstChild),n?qy=0:qy++),i==null?(qy--,qy===0&&r.close(),l.remove()):(l.innerText=i,r.open()),t}function Ye(i,t){he(i,null,"Error "+(t!=null?t:""),!0)}function yu(i){var e;let t=(e=xu==null?void 0:xu.shadowRoot)==null?void 0:e.querySelector("#toast");t.text=i,t.duration=1e4,t.open()}var l4="137",yn={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},wl={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},ust=0,j8=1,hst=2;var T7=1,pst=2,id=3,ld=0,Tn=1,ju=2,I7=1;var Os=0,Bs=1,q8=2,X8=3,K8=4,fst=5,Ou=100,dst=101,mst=102,Y8=103,Z8=104,gst=200,xst=201,yst=202,vst=203,A7=204,k7=205,bst=206,_st=207,wst=208,Sst=209,Cst=210,Mst=0,Est=1,Tst=2,Y3=3,Ist=4,Ast=5,kst=6,Rst=7,r2=0,Pst=1,Nst=2,Vs=0,Lst=1,Dst=2,zst=3,Fst=4,Ost=5,R7=300,zd=301,Fd=302,Z3=303,J3=304,o2=306,c4=307,Q3=1e3,Li=1001,tM=1002,In=1003,J8=1004;var Q8=1005;var _n=1006,Bst=1007;var s2=1008;var Hs=1009,Vst=1010,Hst=1011,cd=1012,$st=1013,Tv=1014,hl=1015,$u=1016,Ust=1017,Wst=1018,Uu=1020,Gst=1021,pi=1023,jst=1024,qst=1025,fl=1026,qu=1027,Xst=1028,Kst=1029,Yst=1030,Zst=1031,Jst=1033,h3=33776,p3=33777,f3=33778,d3=33779,tO=35840,eO=35841,nO=35842,iO=35843,Qst=36196,rO=37492,oO=37496,sO=37808,aO=37809,lO=37810,cO=37811,uO=37812,hO=37813,pO=37814,fO=37815,dO=37816,mO=37817,gO=37818,xO=37819,yO=37820,vO=37821,bO=36492,tat=2200,eat=2201,nat=2202,Iv=2300,Av=2301,m3=2302,Bu=2400,Vu=2401,kv=2402,u4=2500,P7=2501,iat=0;var Ws=3e3,Ze=3001,rat=3200,oat=3201,rh=0,sat=1;var g3=7680;var aat=519,ud=35044,Rv=35048;var _O="300 es",eM=1035,Mr=class{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;let n=this._listeners;return n[t]!==void 0&&n[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;let r=this._listeners[t];if(r!==void 0){let o=r.indexOf(e);o!==-1&&r.splice(o,1)}}dispatchEvent(t){if(this._listeners===void 0)return;let n=this._listeners[t.type];if(n!==void 0){t.target=this;let r=n.slice(0);for(let o=0,s=r.length;o<s;o++)r[o].call(this,t);t.target=null}}},qn=[];for(let i=0;i<256;i++)qn[i]=(i<16?"0":"")+i.toString(16);var x3=Math.PI/180,nM=180/Math.PI;function Cr(){let i=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(qn[i&255]+qn[i>>8&255]+qn[i>>16&255]+qn[i>>24&255]+"-"+qn[t&255]+qn[t>>8&255]+"-"+qn[t>>16&15|64]+qn[t>>24&255]+"-"+qn[e&63|128]+qn[e>>8&255]+"-"+qn[e>>16&255]+qn[e>>24&255]+qn[n&255]+qn[n>>8&255]+qn[n>>16&255]+qn[n>>24&255]).toUpperCase()}function hi(i,t,e){return Math.max(t,Math.min(e,i))}function lat(i,t){return(i%t+t)%t}function y3(i,t,e){return(1-e)*i+e*t}function wO(i){return(i&i-1)===0&&i!==0}function cat(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}var Et=class{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){let e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){let n=Math.cos(e),r=Math.sin(e),o=this.x-t.x,s=this.y-t.y;return this.x=o*n-s*r+t.x,this.y=o*r+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}};Et.prototype.isVector2=!0;var An=class{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,o,s,a,l,c){let u=this.elements;return u[0]=t,u[1]=r,u[2]=a,u[3]=e,u[4]=o,u[5]=l,u[6]=n,u[7]=s,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){let e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){let e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let n=t.elements,r=e.elements,o=this.elements,s=n[0],a=n[3],l=n[6],c=n[1],u=n[4],h=n[7],p=n[2],f=n[5],d=n[8],m=r[0],x=r[3],g=r[6],y=r[1],b=r[4],v=r[7],_=r[2],S=r[5],E=r[8];return o[0]=s*m+a*y+l*_,o[3]=s*x+a*b+l*S,o[6]=s*g+a*v+l*E,o[1]=c*m+u*y+h*_,o[4]=c*x+u*b+h*S,o[7]=c*g+u*v+h*E,o[2]=p*m+f*y+d*_,o[5]=p*x+f*b+d*S,o[8]=p*g+f*v+d*E,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){let t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return e*s*u-e*a*c-n*o*u+n*a*l+r*o*c-r*s*l}invert(){let t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=u*s-a*c,p=a*l-u*o,f=c*o-s*l,d=e*h+n*p+r*f;if(d===0)return this.set(0,0,0,0,0,0,0,0,0);let m=1/d;return t[0]=h*m,t[1]=(r*c-u*n)*m,t[2]=(a*n-r*s)*m,t[3]=p*m,t[4]=(u*e-r*l)*m,t[5]=(r*o-a*e)*m,t[6]=f*m,t[7]=(n*l-c*e)*m,t[8]=(s*e-n*o)*m,this}transpose(){let t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){let e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,o,s,a){let l=Math.cos(o),c=Math.sin(o);return this.set(n*l,n*c,-n*(l*s+c*a)+s+t,-r*c,r*l,-r*(-c*s+l*a)+a+e,0,0,1),this}scale(t,e){let n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){let e=Math.cos(t),n=Math.sin(t),r=this.elements,o=r[0],s=r[3],a=r[6],l=r[1],c=r[4],u=r[7];return r[0]=e*o+n*l,r[3]=e*s+n*c,r[6]=e*a+n*u,r[1]=-n*o+e*l,r[4]=-n*s+e*c,r[7]=-n*a+e*u,this}translate(t,e){let n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){let e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){let n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}};An.prototype.isMatrix3=!0;function N7(i){for(let t=i.length-1;t>=0;--t)if(i[t]>65535)return!0;return!1}function hd(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}var L7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},br={h:0,s:0,l:0},Xy={h:0,s:0,l:0};function v3(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(t-i)*6*e:e<1/2?t:e<2/3?i+(t-i)*6*(2/3-e):i}function Wu(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function b3(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}var zt=class{constructor(t,e,n){return e===void 0&&n===void 0?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=lat(t,1),e=hi(e,0,1),n=hi(n,0,1),e===0)this.r=this.g=this.b=n;else{let r=n<=.5?n*(1+e):n+e-n*e,o=2*n-r;this.r=v3(o,r,t+1/3),this.g=v3(o,r,t),this.b=v3(o,r,t-1/3)}return this}setStyle(t){function e(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let r,o=n[1],s=n[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){let a=parseFloat(r[1])/360,l=parseInt(r[2],10)/100,c=parseInt(r[3],10)/100;return e(r[4]),this.setHSL(a,l,c)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){let r=n[1],o=r.length;if(o===3)return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,this;if(o===6)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){let e=L7[t.toLowerCase()];return e!==void 0?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Wu(t.r),this.g=Wu(t.g),this.b=Wu(t.b),this}copyLinearToSRGB(t){return this.r=b3(t.r),this.g=b3(t.g),this.b=b3(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){let e=this.r,n=this.g,r=this.b,o=Math.max(e,n,r),s=Math.min(e,n,r),a,l,c=(s+o)/2;if(s===o)a=0,l=0;else{let u=o-s;switch(l=c<=.5?u/(o+s):u/(2-o-s),o){case e:a=(n-r)/u+(n<r?6:0);break;case n:a=(r-e)/u+2;break;case r:a=(e-n)/u+4;break}a/=6}return t.h=a,t.s=l,t.l=c,t}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(t,e,n){return this.getHSL(br),br.h+=t,br.s+=e,br.l+=n,this.setHSL(br.h,br.s,br.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(br),t.getHSL(Xy);let n=y3(br.h,Xy.h,e),r=y3(br.s,Xy.s,e),o=y3(br.l,Xy.l,e);return this.setHSL(n,r,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}};zt.NAMES=L7;zt.prototype.isColor=!0;zt.prototype.r=1;zt.prototype.g=1;zt.prototype.b=1;var vu,Go=class{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement=="undefined")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{vu===void 0&&(vu=hd("canvas")),vu.width=t.width,vu.height=t.height;let n=vu.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=vu}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement!="undefined"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&t instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&t instanceof ImageBitmap){let e=hd("canvas");e.width=t.width,e.height=t.height;let n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);let r=n.getImageData(0,0,t.width,t.height),o=r.data;for(let s=0;s<o.length;s++)o[s]=Wu(o[s]/255)*255;return n.putImageData(r,0,0),e}else if(t.data){let e=t.data.slice(0);for(let n=0;n<e.length;n++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[n]=Math.floor(Wu(e[n]/255)*255):e[n]=Wu(e[n]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}},uat=0,ln=class extends Mr{constructor(t=ln.DEFAULT_IMAGE,e=ln.DEFAULT_MAPPING,n=Li,r=Li,o=_n,s=s2,a=pi,l=Hs,c=1,u=Ws){super(),Object.defineProperty(this,"id",{value:uat++}),this.uuid=Cr(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=r,this.magFilter=o,this.minFilter=s,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Et(0,0),this.repeat=new Et(1,1),this.center=new Et(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new An,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this}toJSON(t){let e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){let r=this.image;if(r.uuid===void 0&&(r.uuid=Cr()),!e&&t.images[r.uuid]===void 0){let o;if(Array.isArray(r)){o=[];for(let s=0,a=r.length;s<a;s++)r[s].isDataTexture?o.push(_3(r[s].image)):o.push(_3(r[s]))}else o=_3(r);t.images[r.uuid]={uuid:r.uuid,url:o}}n.image=r.uuid}return JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==R7)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Q3:t.x=t.x-Math.floor(t.x);break;case Li:t.x=t.x<0?0:1;break;case tM:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Q3:t.y=t.y-Math.floor(t.y);break;case Li:t.y=t.y<0?0:1;break;case tM:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&this.version++}};ln.DEFAULT_IMAGE=void 0;ln.DEFAULT_MAPPING=R7;ln.prototype.isTexture=!0;function _3(i){return typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&i instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&i instanceof ImageBitmap?Go.getDataURL(i):i.data?{data:Array.prototype.slice.call(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var ze=class{constructor(t=0,e=0,n=0,r=1){this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){let e=this.x,n=this.y,r=this.z,o=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r+s[12]*o,this.y=s[1]*e+s[5]*n+s[9]*r+s[13]*o,this.z=s[2]*e+s[6]*n+s[10]*r+s[14]*o,this.w=s[3]*e+s[7]*n+s[11]*r+s[15]*o,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);let e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,o,l=t.elements,c=l[0],u=l[4],h=l[8],p=l[1],f=l[5],d=l[9],m=l[2],x=l[6],g=l[10];if(Math.abs(u-p)<.01&&Math.abs(h-m)<.01&&Math.abs(d-x)<.01){if(Math.abs(u+p)<.1&&Math.abs(h+m)<.1&&Math.abs(d+x)<.1&&Math.abs(c+f+g-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;let b=(c+1)/2,v=(f+1)/2,_=(g+1)/2,S=(u+p)/4,E=(h+m)/4,M=(d+x)/4;return b>v&&b>_?b<.01?(n=0,r=.707106781,o=.707106781):(n=Math.sqrt(b),r=S/n,o=E/n):v>_?v<.01?(n=.707106781,r=0,o=.707106781):(r=Math.sqrt(v),n=S/r,o=M/r):_<.01?(n=.707106781,r=.707106781,o=0):(o=Math.sqrt(_),n=E/o,r=M/o),this.set(n,r,o,e),this}let y=Math.sqrt((x-d)*(x-d)+(h-m)*(h-m)+(p-u)*(p-u));return Math.abs(y)<.001&&(y=1),this.x=(x-d)/y,this.y=(h-m)/y,this.z=(p-u)/y,this.w=Math.acos((c+f+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}};ze.prototype.isVector4=!0;var ii=class extends Mr{constructor(t,e,n={}){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new ze(0,0,t,e),this.scissorTest=!1,this.viewport=new ze(0,0,t,e),this.texture=new ln(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:t,height:e,depth:1},this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:_n,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,e,n=1){(this.width!==t||this.height!==e||this.depth!==n)&&(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image=Object.assign({},t.texture.image),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}};ii.prototype.isWebGLRenderTarget=!0;var iM=class extends ii{constructor(t,e,n){super(t,e);let r=this.texture;this.texture=[];for(let o=0;o<n;o++)this.texture[o]=r.clone()}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let r=0,o=this.texture.length;r<o;r++)this.texture[r].image.width=t,this.texture[r].image.height=e,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone();return this}};iM.prototype.isWebGLMultipleRenderTargets=!0;var pd=class extends ii{constructor(t,e,n={}){super(t,e,n),this.samples=4,this.ignoreDepthForMultisampleCopy=n.ignoreDepth!==void 0?n.ignoreDepth:!0,this.useRenderToTexture=n.useRenderToTexture!==void 0?n.useRenderToTexture:!1,this.useRenderbuffer=this.useRenderToTexture===!1}copy(t){return super.copy.call(this,t),this.samples=t.samples,this.useRenderToTexture=t.useRenderToTexture,this.useRenderbuffer=t.useRenderbuffer,this}};pd.prototype.isWebGLMultisampleRenderTarget=!0;var kn=class{constructor(t=0,e=0,n=0,r=1){this._x=t,this._y=e,this._z=n,this._w=r}static slerp(t,e,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,r)}static slerpFlat(t,e,n,r,o,s,a){let l=n[r+0],c=n[r+1],u=n[r+2],h=n[r+3],p=o[s+0],f=o[s+1],d=o[s+2],m=o[s+3];if(a===0){t[e+0]=l,t[e+1]=c,t[e+2]=u,t[e+3]=h;return}if(a===1){t[e+0]=p,t[e+1]=f,t[e+2]=d,t[e+3]=m;return}if(h!==m||l!==p||c!==f||u!==d){let x=1-a,g=l*p+c*f+u*d+h*m,y=g>=0?1:-1,b=1-g*g;if(b>Number.EPSILON){let _=Math.sqrt(b),S=Math.atan2(_,g*y);x=Math.sin(x*S)/_,a=Math.sin(a*S)/_}let v=a*y;if(l=l*x+p*v,c=c*x+f*v,u=u*x+d*v,h=h*x+m*v,x===1-a){let _=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=_,c*=_,u*=_,h*=_}}t[e]=l,t[e+1]=c,t[e+2]=u,t[e+3]=h}static multiplyQuaternionsFlat(t,e,n,r,o,s){let a=n[r],l=n[r+1],c=n[r+2],u=n[r+3],h=o[s],p=o[s+1],f=o[s+2],d=o[s+3];return t[e]=a*d+u*h+l*f-c*p,t[e+1]=l*d+u*p+c*h-a*f,t[e+2]=c*d+u*f+a*p-l*h,t[e+3]=u*d-a*h-l*p-c*f,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");let n=t._x,r=t._y,o=t._z,s=t._order,a=Math.cos,l=Math.sin,c=a(n/2),u=a(r/2),h=a(o/2),p=l(n/2),f=l(r/2),d=l(o/2);switch(s){case"XYZ":this._x=p*u*h+c*f*d,this._y=c*f*h-p*u*d,this._z=c*u*d+p*f*h,this._w=c*u*h-p*f*d;break;case"YXZ":this._x=p*u*h+c*f*d,this._y=c*f*h-p*u*d,this._z=c*u*d-p*f*h,this._w=c*u*h+p*f*d;break;case"ZXY":this._x=p*u*h-c*f*d,this._y=c*f*h+p*u*d,this._z=c*u*d+p*f*h,this._w=c*u*h-p*f*d;break;case"ZYX":this._x=p*u*h-c*f*d,this._y=c*f*h+p*u*d,this._z=c*u*d-p*f*h,this._w=c*u*h+p*f*d;break;case"YZX":this._x=p*u*h+c*f*d,this._y=c*f*h+p*u*d,this._z=c*u*d-p*f*h,this._w=c*u*h-p*f*d;break;case"XZY":this._x=p*u*h-c*f*d,this._y=c*f*h-p*u*d,this._z=c*u*d+p*f*h,this._w=c*u*h+p*f*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){let n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){let e=t.elements,n=e[0],r=e[4],o=e[8],s=e[1],a=e[5],l=e[9],c=e[2],u=e[6],h=e[10],p=n+a+h;if(p>0){let f=.5/Math.sqrt(p+1);this._w=.25/f,this._x=(u-l)*f,this._y=(o-c)*f,this._z=(s-r)*f}else if(n>a&&n>h){let f=2*Math.sqrt(1+n-a-h);this._w=(u-l)/f,this._x=.25*f,this._y=(r+s)/f,this._z=(o+c)/f}else if(a>h){let f=2*Math.sqrt(1+a-n-h);this._w=(o-c)/f,this._x=(r+s)/f,this._y=.25*f,this._z=(l+u)/f}else{let f=2*Math.sqrt(1+h-n-a);this._w=(s-r)/f,this._x=(o+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(hi(this.dot(t),-1,1)))}rotateTowards(t,e){let n=this.angleTo(t);if(n===0)return this;let r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return e!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){let n=t._x,r=t._y,o=t._z,s=t._w,a=e._x,l=e._y,c=e._z,u=e._w;return this._x=n*u+s*a+r*c-o*l,this._y=r*u+s*l+o*a-n*c,this._z=o*u+s*c+n*l-r*a,this._w=s*u-n*a-r*l-o*c,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);let n=this._x,r=this._y,o=this._z,s=this._w,a=s*t._w+n*t._x+r*t._y+o*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=n,this._y=r,this._z=o,this;let l=1-a*a;if(l<=Number.EPSILON){let f=1-e;return this._w=f*s+e*this._w,this._x=f*n+e*this._x,this._y=f*r+e*this._y,this._z=f*o+e*this._z,this.normalize(),this._onChangeCallback(),this}let c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-e)*u)/c,p=Math.sin(e*u)/c;return this._w=s*h+this._w*p,this._x=n*h+this._x*p,this._y=r*h+this._y*p,this._z=o*h+this._z*p,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){let t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),r=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(e*Math.cos(r),n*Math.sin(o),n*Math.cos(o),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}};kn.prototype.isQuaternion=!0;var q=class{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return n===void 0&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(SO.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(SO.setFromAxisAngle(t,e))}applyMatrix3(t){let e=this.x,n=this.y,r=this.z,o=t.elements;return this.x=o[0]*e+o[3]*n+o[6]*r,this.y=o[1]*e+o[4]*n+o[7]*r,this.z=o[2]*e+o[5]*n+o[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){let e=this.x,n=this.y,r=this.z,o=t.elements,s=1/(o[3]*e+o[7]*n+o[11]*r+o[15]);return this.x=(o[0]*e+o[4]*n+o[8]*r+o[12])*s,this.y=(o[1]*e+o[5]*n+o[9]*r+o[13])*s,this.z=(o[2]*e+o[6]*n+o[10]*r+o[14])*s,this}applyQuaternion(t){let e=this.x,n=this.y,r=this.z,o=t.x,s=t.y,a=t.z,l=t.w,c=l*e+s*r-a*n,u=l*n+a*e-o*r,h=l*r+o*n-s*e,p=-o*e-s*n-a*r;return this.x=c*l+p*-o+u*-a-h*-s,this.y=u*l+p*-s+h*-o-c*-a,this.z=h*l+p*-a+c*-s-u*-o,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){let e=this.x,n=this.y,r=this.z,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r,this.y=o[1]*e+o[5]*n+o[9]*r,this.z=o[2]*e+o[6]*n+o[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return e!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){let n=t.x,r=t.y,o=t.z,s=e.x,a=e.y,l=e.z;return this.x=r*l-o*a,this.y=o*s-n*l,this.z=n*a-r*s,this}projectOnVector(t){let e=t.lengthSq();if(e===0)return this.set(0,0,0);let n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return w3.copy(this).projectOnVector(t),this.sub(w3)}reflect(t){return this.sub(w3.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){let e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;let n=this.dot(t)/e;return Math.acos(hi(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){let r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){let e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){let e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let t=(Math.random()-.5)*2,e=Math.random()*Math.PI*2,n=Math.sqrt(1-Vb(t,2));return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};q.prototype.isVector3=!0;var w3=new q,SO=new kn,Di=class{constructor(t=new q(1/0,1/0,1/0),e=new q(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,c=t.length;l<c;l+=3){let u=t[l],h=t[l+1],p=t[l+2];u<e&&(e=u),h<n&&(n=h),p<r&&(r=p),u>o&&(o=u),h>s&&(s=h),p>a&&(a=p)}return this.min.set(e,n,r),this.max.set(o,s,a),this}setFromBufferAttribute(t){let e=1/0,n=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,c=t.count;l<c;l++){let u=t.getX(l),h=t.getY(l),p=t.getZ(l);u<e&&(e=u),h<n&&(n=h),p<r&&(r=p),u>o&&(o=u),h>s&&(s=h),p>a&&(a=p)}return this.min.set(e,n,r),this.max.set(o,s,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let n=al.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);let n=t.geometry;if(n!==void 0)if(e&&n.attributes!=null&&n.attributes.position!==void 0){let o=n.attributes.position;for(let s=0,a=o.count;s<a;s++)al.fromBufferAttribute(o,s).applyMatrix4(t.matrixWorld),this.expandByPoint(al)}else n.boundingBox===null&&n.computeBoundingBox(),S3.copy(n.boundingBox),S3.applyMatrix4(t.matrixWorld),this.union(S3);let r=t.children;for(let o=0,s=r.length;o<s;o++)this.expandByObject(r[o],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,al),al.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Xf),Ky.subVectors(this.max,Xf),bu.subVectors(t.a,Xf),_u.subVectors(t.b,Xf),wu.subVectors(t.c,Xf),ks.subVectors(_u,bu),Rs.subVectors(wu,_u),ll.subVectors(bu,wu);let e=[0,-ks.z,ks.y,0,-Rs.z,Rs.y,0,-ll.z,ll.y,ks.z,0,-ks.x,Rs.z,0,-Rs.x,ll.z,0,-ll.x,-ks.y,ks.x,0,-Rs.y,Rs.x,0,-ll.y,ll.x,0];return!C3(e,bu,_u,wu,Ky)||(e=[1,0,0,0,1,0,0,0,1],!C3(e,bu,_u,wu,Ky))?!1:(Yy.crossVectors(ks,Rs),e=[Yy.x,Yy.y,Yy.z],C3(e,bu,_u,wu,Ky))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return al.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=this.getSize(al).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Bo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Bo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Bo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Bo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Bo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Bo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Bo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Bo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Bo),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}};Di.prototype.isBox3=!0;var Bo=[new q,new q,new q,new q,new q,new q,new q,new q],al=new q,S3=new Di,bu=new q,_u=new q,wu=new q,ks=new q,Rs=new q,ll=new q,Xf=new q,Ky=new q,Yy=new q,cl=new q;function C3(i,t,e,n,r){for(let o=0,s=i.length-3;o<=s;o+=3){cl.fromArray(i,o);let a=r.x*Math.abs(cl.x)+r.y*Math.abs(cl.y)+r.z*Math.abs(cl.z),l=t.dot(cl),c=e.dot(cl),u=n.dot(cl);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}var hat=new Di,CO=new q,Zy=new q,M3=new q,Gs=class{constructor(t=new q,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){let n=this.center;e!==void 0?n.copy(e):hat.setFromPoints(t).getCenter(n);let r=0;for(let o=0,s=t.length;o<s;o++)r=Math.max(r,n.distanceToSquared(t[o]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){let e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){let n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){M3.subVectors(t,this.center);let e=M3.lengthSq();if(e>this.radius*this.radius){let n=Math.sqrt(e),r=(n-this.radius)*.5;this.center.add(M3.multiplyScalar(r/n)),this.radius+=r}return this}union(t){return this.center.equals(t.center)===!0?Zy.set(0,0,1).multiplyScalar(t.radius):Zy.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(CO.copy(t.center).add(Zy)),this.expandByPoint(CO.copy(t.center).sub(Zy)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}},Vo=new q,E3=new q,Jy=new q,Ps=new q,T3=new q,Qy=new q,I3=new q,js=class{constructor(t=new q,e=new q(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Vo)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);let n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){let e=Vo.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Vo.copy(this.direction).multiplyScalar(e).add(this.origin),Vo.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){E3.copy(t).add(e).multiplyScalar(.5),Jy.copy(e).sub(t).normalize(),Ps.copy(this.origin).sub(E3);let o=t.distanceTo(e)*.5,s=-this.direction.dot(Jy),a=Ps.dot(this.direction),l=-Ps.dot(Jy),c=Ps.lengthSq(),u=Math.abs(1-s*s),h,p,f,d;if(u>0)if(h=s*l-a,p=s*a-l,d=o*u,h>=0)if(p>=-d)if(p<=d){let m=1/u;h*=m,p*=m,f=h*(h+s*p+2*a)+p*(s*h+p+2*l)+c}else p=o,h=Math.max(0,-(s*p+a)),f=-h*h+p*(p+2*l)+c;else p=-o,h=Math.max(0,-(s*p+a)),f=-h*h+p*(p+2*l)+c;else p<=-d?(h=Math.max(0,-(-s*o+a)),p=h>0?-o:Math.min(Math.max(-o,-l),o),f=-h*h+p*(p+2*l)+c):p<=d?(h=0,p=Math.min(Math.max(-o,-l),o),f=p*(p+2*l)+c):(h=Math.max(0,-(s*o+a)),p=h>0?o:Math.min(Math.max(-o,-l),o),f=-h*h+p*(p+2*l)+c);else p=s>0?-o:o,h=Math.max(0,-(s*p+a)),f=-h*h+p*(p+2*l)+c;return n&&n.copy(this.direction).multiplyScalar(h).add(this.origin),r&&r.copy(Jy).multiplyScalar(p).add(E3),f}intersectSphere(t,e){Vo.subVectors(t.center,this.origin);let n=Vo.dot(this.direction),r=Vo.dot(Vo)-n*n,o=t.radius*t.radius;if(r>o)return null;let s=Math.sqrt(o-r),a=n-s,l=n+s;return a<0&&l<0?null:a<0?this.at(l,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){let e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){let n=this.distanceToPlane(t);return n===null?null:this.at(n,e)}intersectsPlane(t){let e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,o,s,a,l,c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,p=this.origin;return c>=0?(n=(t.min.x-p.x)*c,r=(t.max.x-p.x)*c):(n=(t.max.x-p.x)*c,r=(t.min.x-p.x)*c),u>=0?(o=(t.min.y-p.y)*u,s=(t.max.y-p.y)*u):(o=(t.max.y-p.y)*u,s=(t.min.y-p.y)*u),n>s||o>r||((o>n||n!==n)&&(n=o),(s<r||r!==r)&&(r=s),h>=0?(a=(t.min.z-p.z)*h,l=(t.max.z-p.z)*h):(a=(t.max.z-p.z)*h,l=(t.min.z-p.z)*h),n>l||a>r)||((a>n||n!==n)&&(n=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,e)}intersectsBox(t){return this.intersectBox(t,Vo)!==null}intersectTriangle(t,e,n,r,o){T3.subVectors(e,t),Qy.subVectors(n,t),I3.crossVectors(T3,Qy);let s=this.direction.dot(I3),a;if(s>0){if(r)return null;a=1}else if(s<0)a=-1,s=-s;else return null;Ps.subVectors(this.origin,t);let l=a*this.direction.dot(Qy.crossVectors(Ps,Qy));if(l<0)return null;let c=a*this.direction.dot(T3.cross(Ps));if(c<0||l+c>s)return null;let u=-a*Ps.dot(I3);return u<0?null:this.at(u/s,o)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},te=class{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,o,s,a,l,c,u,h,p,f,d,m,x){let g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=o,g[5]=s,g[9]=a,g[13]=l,g[2]=c,g[6]=u,g[10]=h,g[14]=p,g[3]=f,g[7]=d,g[11]=m,g[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new te().fromArray(this.elements)}copy(t){let e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){let e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){let e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){let e=this.elements,n=t.elements,r=1/Su.setFromMatrixColumn(t,0).length(),o=1/Su.setFromMatrixColumn(t,1).length(),s=1/Su.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*o,e[5]=n[5]*o,e[6]=n[6]*o,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");let e=this.elements,n=t.x,r=t.y,o=t.z,s=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),u=Math.cos(o),h=Math.sin(o);if(t.order==="XYZ"){let p=s*u,f=s*h,d=a*u,m=a*h;e[0]=l*u,e[4]=-l*h,e[8]=c,e[1]=f+d*c,e[5]=p-m*c,e[9]=-a*l,e[2]=m-p*c,e[6]=d+f*c,e[10]=s*l}else if(t.order==="YXZ"){let p=l*u,f=l*h,d=c*u,m=c*h;e[0]=p+m*a,e[4]=d*a-f,e[8]=s*c,e[1]=s*h,e[5]=s*u,e[9]=-a,e[2]=f*a-d,e[6]=m+p*a,e[10]=s*l}else if(t.order==="ZXY"){let p=l*u,f=l*h,d=c*u,m=c*h;e[0]=p-m*a,e[4]=-s*h,e[8]=d+f*a,e[1]=f+d*a,e[5]=s*u,e[9]=m-p*a,e[2]=-s*c,e[6]=a,e[10]=s*l}else if(t.order==="ZYX"){let p=s*u,f=s*h,d=a*u,m=a*h;e[0]=l*u,e[4]=d*c-f,e[8]=p*c+m,e[1]=l*h,e[5]=m*c+p,e[9]=f*c-d,e[2]=-c,e[6]=a*l,e[10]=s*l}else if(t.order==="YZX"){let p=s*l,f=s*c,d=a*l,m=a*c;e[0]=l*u,e[4]=m-p*h,e[8]=d*h+f,e[1]=h,e[5]=s*u,e[9]=-a*u,e[2]=-c*u,e[6]=f*h+d,e[10]=p-m*h}else if(t.order==="XZY"){let p=s*l,f=s*c,d=a*l,m=a*c;e[0]=l*u,e[4]=-h,e[8]=c*u,e[1]=p*h+m,e[5]=s*u,e[9]=f*h-d,e[2]=d*h-f,e[6]=a*u,e[10]=m*h+p}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(pat,t,fat)}lookAt(t,e,n){let r=this.elements;return Pi.subVectors(t,e),Pi.lengthSq()===0&&(Pi.z=1),Pi.normalize(),Ns.crossVectors(n,Pi),Ns.lengthSq()===0&&(Math.abs(n.z)===1?Pi.x+=1e-4:Pi.z+=1e-4,Pi.normalize(),Ns.crossVectors(n,Pi)),Ns.normalize(),tv.crossVectors(Pi,Ns),r[0]=Ns.x,r[4]=tv.x,r[8]=Pi.x,r[1]=Ns.y,r[5]=tv.y,r[9]=Pi.y,r[2]=Ns.z,r[6]=tv.z,r[10]=Pi.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let n=t.elements,r=e.elements,o=this.elements,s=n[0],a=n[4],l=n[8],c=n[12],u=n[1],h=n[5],p=n[9],f=n[13],d=n[2],m=n[6],x=n[10],g=n[14],y=n[3],b=n[7],v=n[11],_=n[15],S=r[0],E=r[4],M=r[8],N=r[12],I=r[1],w=r[5],R=r[9],P=r[13],D=r[2],F=r[6],z=r[10],V=r[14],H=r[3],X=r[7],U=r[11],Y=r[15];return o[0]=s*S+a*I+l*D+c*H,o[4]=s*E+a*w+l*F+c*X,o[8]=s*M+a*R+l*z+c*U,o[12]=s*N+a*P+l*V+c*Y,o[1]=u*S+h*I+p*D+f*H,o[5]=u*E+h*w+p*F+f*X,o[9]=u*M+h*R+p*z+f*U,o[13]=u*N+h*P+p*V+f*Y,o[2]=d*S+m*I+x*D+g*H,o[6]=d*E+m*w+x*F+g*X,o[10]=d*M+m*R+x*z+g*U,o[14]=d*N+m*P+x*V+g*Y,o[3]=y*S+b*I+v*D+_*H,o[7]=y*E+b*w+v*F+_*X,o[11]=y*M+b*R+v*z+_*U,o[15]=y*N+b*P+v*V+_*Y,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){let t=this.elements,e=t[0],n=t[4],r=t[8],o=t[12],s=t[1],a=t[5],l=t[9],c=t[13],u=t[2],h=t[6],p=t[10],f=t[14],d=t[3],m=t[7],x=t[11],g=t[15];return d*(+o*l*h-r*c*h-o*a*p+n*c*p+r*a*f-n*l*f)+m*(+e*l*f-e*c*p+o*s*p-r*s*f+r*c*u-o*l*u)+x*(+e*c*h-e*a*f-o*s*h+n*s*f+o*a*u-n*c*u)+g*(-r*a*u-e*l*h+e*a*p+r*s*h-n*s*p+n*l*u)}transpose(){let t=this.elements,e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){let r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){let t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],p=t[10],f=t[11],d=t[12],m=t[13],x=t[14],g=t[15],y=h*x*c-m*p*c+m*l*f-a*x*f-h*l*g+a*p*g,b=d*p*c-u*x*c-d*l*f+s*x*f+u*l*g-s*p*g,v=u*m*c-d*h*c+d*a*f-s*m*f-u*a*g+s*h*g,_=d*h*l-u*m*l-d*a*p+s*m*p+u*a*x-s*h*x,S=e*y+n*b+r*v+o*_;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let E=1/S;return t[0]=y*E,t[1]=(m*p*o-h*x*o-m*r*f+n*x*f+h*r*g-n*p*g)*E,t[2]=(a*x*o-m*l*o+m*r*c-n*x*c-a*r*g+n*l*g)*E,t[3]=(h*l*o-a*p*o-h*r*c+n*p*c+a*r*f-n*l*f)*E,t[4]=b*E,t[5]=(u*x*o-d*p*o+d*r*f-e*x*f-u*r*g+e*p*g)*E,t[6]=(d*l*o-s*x*o-d*r*c+e*x*c+s*r*g-e*l*g)*E,t[7]=(s*p*o-u*l*o+u*r*c-e*p*c-s*r*f+e*l*f)*E,t[8]=v*E,t[9]=(d*h*o-u*m*o-d*n*f+e*m*f+u*n*g-e*h*g)*E,t[10]=(s*m*o-d*a*o+d*n*c-e*m*c-s*n*g+e*a*g)*E,t[11]=(u*a*o-s*h*o-u*n*c+e*h*c+s*n*f-e*a*f)*E,t[12]=_*E,t[13]=(u*m*r-d*h*r+d*n*p-e*m*p-u*n*x+e*h*x)*E,t[14]=(d*a*r-s*m*r-d*n*l+e*m*l+s*n*x-e*a*x)*E,t[15]=(s*h*r-u*a*r+u*n*l-e*h*l-s*n*p+e*a*p)*E,this}scale(t){let e=this.elements,n=t.x,r=t.y,o=t.z;return e[0]*=n,e[4]*=r,e[8]*=o,e[1]*=n,e[5]*=r,e[9]*=o,e[2]*=n,e[6]*=r,e[10]*=o,e[3]*=n,e[7]*=r,e[11]*=o,this}getMaxScaleOnAxis(){let t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){let e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){let e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){let e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){let n=Math.cos(e),r=Math.sin(e),o=1-n,s=t.x,a=t.y,l=t.z,c=o*s,u=o*a;return this.set(c*s+n,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+n,u*l-r*s,0,c*l-r*a,u*l+r*s,o*l*l+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,o,s){return this.set(1,n,o,0,t,1,s,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){let r=this.elements,o=e._x,s=e._y,a=e._z,l=e._w,c=o+o,u=s+s,h=a+a,p=o*c,f=o*u,d=o*h,m=s*u,x=s*h,g=a*h,y=l*c,b=l*u,v=l*h,_=n.x,S=n.y,E=n.z;return r[0]=(1-(m+g))*_,r[1]=(f+v)*_,r[2]=(d-b)*_,r[3]=0,r[4]=(f-v)*S,r[5]=(1-(p+g))*S,r[6]=(x+y)*S,r[7]=0,r[8]=(d+b)*E,r[9]=(x-y)*E,r[10]=(1-(p+m))*E,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){let r=this.elements,o=Su.set(r[0],r[1],r[2]).length(),s=Su.set(r[4],r[5],r[6]).length(),a=Su.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),t.x=r[12],t.y=r[13],t.z=r[14],_r.copy(this);let c=1/o,u=1/s,h=1/a;return _r.elements[0]*=c,_r.elements[1]*=c,_r.elements[2]*=c,_r.elements[4]*=u,_r.elements[5]*=u,_r.elements[6]*=u,_r.elements[8]*=h,_r.elements[9]*=h,_r.elements[10]*=h,e.setFromRotationMatrix(_r),n.x=o,n.y=s,n.z=a,this}makePerspective(t,e,n,r,o,s){s===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");let a=this.elements,l=2*o/(e-t),c=2*o/(n-r),u=(e+t)/(e-t),h=(n+r)/(n-r),p=-(s+o)/(s-o),f=-2*s*o/(s-o);return a[0]=l,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=p,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,n,r,o,s){let a=this.elements,l=1/(e-t),c=1/(n-r),u=1/(s-o),h=(e+t)*l,p=(n+r)*c,f=(s+o)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-p,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){let e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){let n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}};te.prototype.isMatrix4=!0;var Su=new q,_r=new te,pat=new q(0,0,0),fat=new q(1,1,1),Ns=new q,tv=new q,Pi=new q,MO=new te,EO=new kn,qs=class{constructor(t=0,e=0,n=0,r=qs.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r=this._order){return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){let r=t.elements,o=r[0],s=r[4],a=r[8],l=r[1],c=r[5],u=r[9],h=r[2],p=r[6],f=r[10];switch(e){case"XYZ":this._y=Math.asin(hi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-hi(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(hi(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-s,c)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-hi(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(p,f),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-s,c));break;case"YZX":this._z=Math.asin(hi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-hi(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return MO.makeRotationFromQuaternion(t),this.setFromRotationMatrix(MO,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return EO.setFromEuler(this),this.setFromQuaternion(EO,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new q(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}};qs.prototype.isEuler=!0;qs.DefaultOrder="XYZ";qs.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var Pv=class{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}},dat=0,TO=new q,Cu=new kn,Ho=new te,ev=new q,Kf=new q,mat=new q,gat=new kn,IO=new q(1,0,0),AO=new q(0,1,0),kO=new q(0,0,1),xat={type:"added"},RO={type:"removed"},Re=class extends Mr{constructor(){super(),Object.defineProperty(this,"id",{value:dat++}),this.uuid=Cr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Re.DefaultUp.clone();let t=new q,e=new qs,n=new kn,r=new q(1,1,1);function o(){n.setFromEuler(e,!1)}function s(){e.setFromQuaternion(n,void 0,!1)}e._onChange(o),n._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new te},normalMatrix:{value:new An}}),this.matrix=new te,this.matrixWorld=new te,this.matrixAutoUpdate=Re.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Pv,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Cu.setFromAxisAngle(t,e),this.quaternion.multiply(Cu),this}rotateOnWorldAxis(t,e){return Cu.setFromAxisAngle(t,e),this.quaternion.premultiply(Cu),this}rotateX(t){return this.rotateOnAxis(IO,t)}rotateY(t){return this.rotateOnAxis(AO,t)}rotateZ(t){return this.rotateOnAxis(kO,t)}translateOnAxis(t,e){return TO.copy(t).applyQuaternion(this.quaternion),this.position.add(TO.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(IO,t)}translateY(t){return this.translateOnAxis(AO,t)}translateZ(t){return this.translateOnAxis(kO,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(Ho.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?ev.copy(t):ev.set(t,e,n);let r=this.parent;this.updateWorldMatrix(!0,!1),Kf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ho.lookAt(Kf,ev,this.up):Ho.lookAt(ev,Kf,this.up),this.quaternion.setFromRotationMatrix(Ho),r&&(Ho.extractRotation(r.matrixWorld),Cu.setFromRotationMatrix(Ho),this.quaternion.premultiply(Cu.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(xat)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}let e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(RO)),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){let e=this.children[t];e.parent=null,e.dispatchEvent(RO)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Ho.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Ho.multiply(t.parent.matrixWorld)),t.applyMatrix4(Ho),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){let s=this.children[n].getObjectByProperty(t,e);if(s!==void 0)return s}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kf,t,mat),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kf,gat,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);let e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){let e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){let n=this.parent;if(t===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){let r=this.children;for(let o=0,s=r.length;o<s;o++)r[o].updateWorldMatrix(!1,!0)}}toJSON(t){let e=t===void 0||typeof t=="string",n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function o(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(t)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(t.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){let h=l[c];o(t.shapes,h)}else o(t.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(o(t.materials,this.material[l]));r.material=a}else r.material=o(t.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){let l=this.animations[a];r.animations.push(o(t.animations,l))}}if(e){let a=s(t.geometries),l=s(t.materials),c=s(t.textures),u=s(t.images),h=s(t.shapes),p=s(t.skeletons),f=s(t.animations);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),u.length>0&&(n.images=u),h.length>0&&(n.shapes=h),p.length>0&&(n.skeletons=p),f.length>0&&(n.animations=f)}return n.object=r,n;function s(a){let l=[];for(let c in a){let u=a[c];delete u.metadata,l.push(u)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let n=0;n<t.children.length;n++){let r=t.children[n];this.add(r.clone())}return this}};Re.DefaultUp=new q(0,1,0);Re.DefaultMatrixAutoUpdate=!0;Re.prototype.isObject3D=!0;var wr=new q,$o=new q,A3=new q,Uo=new q,Mu=new q,Eu=new q,PO=new q,k3=new q,R3=new q,P3=new q,sn=class{constructor(t=new q,e=new q,n=new q){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),wr.subVectors(t,e),r.cross(wr);let o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(t,e,n,r,o){wr.subVectors(r,e),$o.subVectors(n,e),A3.subVectors(t,e);let s=wr.dot(wr),a=wr.dot($o),l=wr.dot(A3),c=$o.dot($o),u=$o.dot(A3),h=s*c-a*a;if(h===0)return o.set(-2,-1,-1);let p=1/h,f=(c*l-a*u)*p,d=(s*u-a*l)*p;return o.set(1-f-d,d,f)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,Uo),Uo.x>=0&&Uo.y>=0&&Uo.x+Uo.y<=1}static getUV(t,e,n,r,o,s,a,l){return this.getBarycoord(t,e,n,r,Uo),l.set(0,0),l.addScaledVector(o,Uo.x),l.addScaledVector(s,Uo.y),l.addScaledVector(a,Uo.z),l}static isFrontFacing(t,e,n,r){return wr.subVectors(n,e),$o.subVectors(t,e),wr.cross($o).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,n,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return wr.subVectors(this.c,this.b),$o.subVectors(this.a,this.b),wr.cross($o).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return sn.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return sn.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,o){return sn.getUV(t,this.a,this.b,this.c,e,n,r,o)}containsPoint(t){return sn.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return sn.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){let n=this.a,r=this.b,o=this.c,s,a;Mu.subVectors(r,n),Eu.subVectors(o,n),k3.subVectors(t,n);let l=Mu.dot(k3),c=Eu.dot(k3);if(l<=0&&c<=0)return e.copy(n);R3.subVectors(t,r);let u=Mu.dot(R3),h=Eu.dot(R3);if(u>=0&&h<=u)return e.copy(r);let p=l*h-u*c;if(p<=0&&l>=0&&u<=0)return s=l/(l-u),e.copy(n).addScaledVector(Mu,s);P3.subVectors(t,o);let f=Mu.dot(P3),d=Eu.dot(P3);if(d>=0&&f<=d)return e.copy(o);let m=f*c-l*d;if(m<=0&&c>=0&&d<=0)return a=c/(c-d),e.copy(n).addScaledVector(Eu,a);let x=u*d-f*h;if(x<=0&&h-u>=0&&f-d>=0)return PO.subVectors(o,r),a=(h-u)/(h-u+(f-d)),e.copy(r).addScaledVector(PO,a);let g=1/(x+m+p);return s=m*g,a=p*g,e.copy(n).addScaledVector(Mu,s).addScaledVector(Eu,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},yat=0,Hn=class extends Mr{constructor(){super(),Object.defineProperty(this,"id",{value:yat++}),this.uuid=Cr(),this.name="",this.type="Material",this.fog=!0,this.blending=Bs,this.side=ld,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=A7,this.blendDst=k7,this.blendEquation=Ou,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Y3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=aat,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=g3,this.stencilZFail=g3,this.stencilZPass=g3,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.alphaWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(let e in t){let n=t[e];if(n===void 0){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if(e==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===I7;continue}let r=this[e];if(r===void 0){console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.");continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n}}toJSON(t){let e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});let n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Bs&&(n.blending=this.blending),this.side!==ld&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.alphaWrite=this.alphaWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData);function r(o){let s=[];for(let a in o){let l=o[a];delete l.metadata,s.push(l)}return s}if(e){let o=r(t.textures),s=r(t.images);o.length>0&&(n.textures=o),s.length>0&&(n.images=s)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;let e=t.clippingPlanes,n=null;if(e!==null){let r=e.length;n=new Array(r);for(let o=0;o!==r;++o)n[o]=e[o].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.alphaWrite=t.alphaWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}};Hn.prototype.isMaterial=!0;var fd=class extends Hn{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new zt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=r2,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}};fd.prototype.isMeshBasicMaterial=!0;var We=new q,nv=new Et,we=class{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=n===!0,this.usage=ud,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){let e=this.array,n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),s=new zt),e[n++]=s.r,e[n++]=s.g,e[n++]=s.b}return this}copyVector2sArray(t){let e=this.array,n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),s=new Et),e[n++]=s.x,e[n++]=s.y}return this}copyVector3sArray(t){let e=this.array,n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),s=new q),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z}return this}copyVector4sArray(t){let e=this.array,n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),s=new ze),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z,e[n++]=s.w}return this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,n=this.count;e<n;e++)nv.fromBufferAttribute(this,e),nv.applyMatrix3(t),this.setXY(e,nv.x,nv.y);else if(this.itemSize===3)for(let e=0,n=this.count;e<n;e++)We.fromBufferAttribute(this,e),We.applyMatrix3(t),this.setXYZ(e,We.x,We.y,We.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)We.x=this.getX(e),We.y=this.getY(e),We.z=this.getZ(e),We.applyMatrix4(t),this.setXYZ(e,We.x,We.y,We.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)We.x=this.getX(e),We.y=this.getY(e),We.z=this.getZ(e),We.applyNormalMatrix(t),this.setXYZ(e,We.x,We.y,We.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)We.x=this.getX(e),We.y=this.getY(e),We.z=this.getZ(e),We.transformDirection(t),this.setXYZ(e,We.x,We.y,We.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,o){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=o,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==ud&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}};we.prototype.isBufferAttribute=!0;var Nv=class extends we{constructor(t,e,n){super(new Uint16Array(t),e,n)}};var Lv=class extends we{constructor(t,e,n){super(new Uint32Array(t),e,n)}},rM=class extends we{constructor(t,e,n){super(new Uint16Array(t),e,n)}};rM.prototype.isFloat16BufferAttribute=!0;var an=class extends we{constructor(t,e,n){super(new Float32Array(t),e,n)}};var vat=0,tr=new te,N3=new Re,Tu=new q,Ni=new Di,Yf=new Di,Vn=new q,Pe=class extends Mr{constructor(){super(),Object.defineProperty(this,"id",{value:vat++}),this.uuid=Cr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(N7(t)?Lv:Nv)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){let e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);let n=this.attributes.normal;if(n!==void 0){let o=new An().getNormalMatrix(t);n.applyNormalMatrix(o),n.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return tr.makeRotationFromQuaternion(t),this.applyMatrix4(tr),this}rotateX(t){return tr.makeRotationX(t),this.applyMatrix4(tr),this}rotateY(t){return tr.makeRotationY(t),this.applyMatrix4(tr),this}rotateZ(t){return tr.makeRotationZ(t),this.applyMatrix4(tr),this}translate(t,e,n){return tr.makeTranslation(t,e,n),this.applyMatrix4(tr),this}scale(t,e,n){return tr.makeScale(t,e,n),this.applyMatrix4(tr),this}lookAt(t){return N3.lookAt(t),N3.updateMatrix(),this.applyMatrix4(N3.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Tu).negate(),this.translate(Tu.x,Tu.y,Tu.z),this}setFromPoints(t){let e=[];for(let n=0,r=t.length;n<r;n++){let o=t[n];e.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new an(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Di);let t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new q(-1/0,-1/0,-1/0),new q(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++){let o=e[n];Ni.setFromBufferAttribute(o),this.morphTargetsRelative?(Vn.addVectors(this.boundingBox.min,Ni.min),this.boundingBox.expandByPoint(Vn),Vn.addVectors(this.boundingBox.max,Ni.max),this.boundingBox.expandByPoint(Vn)):(this.boundingBox.expandByPoint(Ni.min),this.boundingBox.expandByPoint(Ni.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Gs);let t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new q,1/0);return}if(t){let n=this.boundingSphere.center;if(Ni.setFromBufferAttribute(t),e)for(let o=0,s=e.length;o<s;o++){let a=e[o];Yf.setFromBufferAttribute(a),this.morphTargetsRelative?(Vn.addVectors(Ni.min,Yf.min),Ni.expandByPoint(Vn),Vn.addVectors(Ni.max,Yf.max),Ni.expandByPoint(Vn)):(Ni.expandByPoint(Yf.min),Ni.expandByPoint(Yf.max))}Ni.getCenter(n);let r=0;for(let o=0,s=t.count;o<s;o++)Vn.fromBufferAttribute(t,o),r=Math.max(r,n.distanceToSquared(Vn));if(e)for(let o=0,s=e.length;o<s;o++){let a=e[o],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Vn.fromBufferAttribute(a,c),l&&(Tu.fromBufferAttribute(t,c),Vn.add(Tu)),r=Math.max(r,n.distanceToSquared(Vn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let n=t.array,r=e.position.array,o=e.normal.array,s=e.uv.array,a=r.length/3;e.tangent===void 0&&this.setAttribute("tangent",new we(new Float32Array(4*a),4));let l=e.tangent.array,c=[],u=[];for(let I=0;I<a;I++)c[I]=new q,u[I]=new q;let h=new q,p=new q,f=new q,d=new Et,m=new Et,x=new Et,g=new q,y=new q;function b(I,w,R){h.fromArray(r,I*3),p.fromArray(r,w*3),f.fromArray(r,R*3),d.fromArray(s,I*2),m.fromArray(s,w*2),x.fromArray(s,R*2),p.sub(h),f.sub(h),m.sub(d),x.sub(d);let P=1/(m.x*x.y-x.x*m.y);!isFinite(P)||(g.copy(p).multiplyScalar(x.y).addScaledVector(f,-m.y).multiplyScalar(P),y.copy(f).multiplyScalar(m.x).addScaledVector(p,-x.x).multiplyScalar(P),c[I].add(g),c[w].add(g),c[R].add(g),u[I].add(y),u[w].add(y),u[R].add(y))}let v=this.groups;v.length===0&&(v=[{start:0,count:n.length}]);for(let I=0,w=v.length;I<w;++I){let R=v[I],P=R.start,D=R.count;for(let F=P,z=P+D;F<z;F+=3)b(n[F+0],n[F+1],n[F+2])}let _=new q,S=new q,E=new q,M=new q;function N(I){E.fromArray(o,I*3),M.copy(E);let w=c[I];_.copy(w),_.sub(E.multiplyScalar(E.dot(w))).normalize(),S.crossVectors(M,w);let P=S.dot(u[I])<0?-1:1;l[I*4]=_.x,l[I*4+1]=_.y,l[I*4+2]=_.z,l[I*4+3]=P}for(let I=0,w=v.length;I<w;++I){let R=v[I],P=R.start,D=R.count;for(let F=P,z=P+D;F<z;F+=3)N(n[F+0]),N(n[F+1]),N(n[F+2])}}computeVertexNormals(){let t=this.index,e=this.getAttribute("position");if(e!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new we(new Float32Array(e.count*3),3),this.setAttribute("normal",n);else for(let p=0,f=n.count;p<f;p++)n.setXYZ(p,0,0,0);let r=new q,o=new q,s=new q,a=new q,l=new q,c=new q,u=new q,h=new q;if(t)for(let p=0,f=t.count;p<f;p+=3){let d=t.getX(p+0),m=t.getX(p+1),x=t.getX(p+2);r.fromBufferAttribute(e,d),o.fromBufferAttribute(e,m),s.fromBufferAttribute(e,x),u.subVectors(s,o),h.subVectors(r,o),u.cross(h),a.fromBufferAttribute(n,d),l.fromBufferAttribute(n,m),c.fromBufferAttribute(n,x),a.add(u),l.add(u),c.add(u),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(x,c.x,c.y,c.z)}else for(let p=0,f=e.count;p<f;p+=3)r.fromBufferAttribute(e,p+0),o.fromBufferAttribute(e,p+1),s.fromBufferAttribute(e,p+2),u.subVectors(s,o),h.subVectors(r,o),u.cross(h),n.setXYZ(p+0,u.x,u.y,u.z),n.setXYZ(p+1,u.x,u.y,u.z),n.setXYZ(p+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!(t&&t.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);return}e===void 0&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));let n=this.attributes;for(let r in n){if(t.attributes[r]===void 0)continue;let s=n[r].array,a=t.attributes[r],l=a.array,c=a.itemSize*e,u=Math.min(l.length,s.length-c);for(let h=0,p=c;h<u;h++,p++)s[p]=l[h]}return this}normalizeNormals(){let t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Vn.fromBufferAttribute(t,e),Vn.normalize(),t.setXYZ(e,Vn.x,Vn.y,Vn.z)}toNonIndexed(){function t(a,l){let c=a.array,u=a.itemSize,h=a.normalized,p=new c.constructor(l.length*u),f=0,d=0;for(let m=0,x=l.length;m<x;m++){a.isInterleavedBufferAttribute?f=l[m]*a.data.stride+a.offset:f=l[m]*u;for(let g=0;g<u;g++)p[d++]=c[f++]}return new we(p,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let e=new Pe,n=this.index.array,r=this.attributes;for(let a in r){let l=r[a],c=t(l,n);e.setAttribute(a,c)}let o=this.morphAttributes;for(let a in o){let l=[],c=o[a];for(let u=0,h=c.length;u<h;u++){let p=c[u],f=t(p,n);l.push(f)}e.morphAttributes[a]=l}e.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let a=0,l=s.length;a<l;a++){let c=s[a];e.addGroup(c.start,c.count,c.materialIndex)}return e}toJSON(){let t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){let l=this.parameters;for(let c in l)l[c]!==void 0&&(t[c]=l[c]);return t}t.data={attributes:{}};let e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});let n=this.attributes;for(let l in n){let c=n[l];t.data.attributes[l]=c.toJSON(t.data)}let r={},o=!1;for(let l in this.morphAttributes){let c=this.morphAttributes[l],u=[];for(let h=0,p=c.length;h<p;h++){let f=c[h];u.push(f.toJSON(t.data))}u.length>0&&(r[l]=u,o=!0)}o&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));let a=this.boundingSphere;return a!==null&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let e={};this.name=t.name;let n=t.index;n!==null&&this.setIndex(n.clone(e));let r=t.attributes;for(let c in r){let u=r[c];this.setAttribute(c,u.clone(e))}let o=t.morphAttributes;for(let c in o){let u=[],h=o[c];for(let p=0,f=h.length;p<f;p++)u.push(h[p].clone(e));this.morphAttributes[c]=u}this.morphTargetsRelative=t.morphTargetsRelative;let s=t.groups;for(let c=0,u=s.length;c<u;c++){let h=s[c];this.addGroup(h.start,h.count,h.materialIndex)}let a=t.boundingBox;a!==null&&(this.boundingBox=a.clone());let l=t.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,t.parameters!==void 0&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}};Pe.prototype.isBufferGeometry=!0;var NO=new te,Iu=new js,L3=new Gs,Ls=new q,Ds=new q,zs=new q,D3=new q,z3=new q,F3=new q,iv=new q,rv=new q,ov=new q,sv=new Et,av=new Et,lv=new Et,O3=new q,cv=new q,ni=class extends Re{constructor(t=new Pe,e=new fd){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){let t=this.geometry;if(t.isBufferGeometry){let e=t.morphAttributes,n=Object.keys(e);if(n.length>0){let r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){let a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{let e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){let n=this.geometry,r=this.material,o=this.matrixWorld;if(r===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),L3.copy(n.boundingSphere),L3.applyMatrix4(o),t.ray.intersectsSphere(L3)===!1)||(NO.copy(o).invert(),Iu.copy(t.ray).applyMatrix4(NO),n.boundingBox!==null&&Iu.intersectsBox(n.boundingBox)===!1))return;let s;if(n.isBufferGeometry){let a=n.index,l=n.attributes.position,c=n.morphAttributes.position,u=n.morphTargetsRelative,h=n.attributes.uv,p=n.attributes.uv2,f=n.groups,d=n.drawRange;if(a!==null)if(Array.isArray(r))for(let m=0,x=f.length;m<x;m++){let g=f[m],y=r[g.materialIndex],b=Math.max(g.start,d.start),v=Math.min(a.count,Math.min(g.start+g.count,d.start+d.count));for(let _=b,S=v;_<S;_+=3){let E=a.getX(_),M=a.getX(_+1),N=a.getX(_+2);s=uv(this,y,t,Iu,l,c,u,h,p,E,M,N),s&&(s.faceIndex=Math.floor(_/3),s.face.materialIndex=g.materialIndex,e.push(s))}}else{let m=Math.max(0,d.start),x=Math.min(a.count,d.start+d.count);for(let g=m,y=x;g<y;g+=3){let b=a.getX(g),v=a.getX(g+1),_=a.getX(g+2);s=uv(this,r,t,Iu,l,c,u,h,p,b,v,_),s&&(s.faceIndex=Math.floor(g/3),e.push(s))}}else if(l!==void 0)if(Array.isArray(r))for(let m=0,x=f.length;m<x;m++){let g=f[m],y=r[g.materialIndex],b=Math.max(g.start,d.start),v=Math.min(l.count,Math.min(g.start+g.count,d.start+d.count));for(let _=b,S=v;_<S;_+=3){let E=_,M=_+1,N=_+2;s=uv(this,y,t,Iu,l,c,u,h,p,E,M,N),s&&(s.faceIndex=Math.floor(_/3),s.face.materialIndex=g.materialIndex,e.push(s))}}else{let m=Math.max(0,d.start),x=Math.min(l.count,d.start+d.count);for(let g=m,y=x;g<y;g+=3){let b=g,v=g+1,_=g+2;s=uv(this,r,t,Iu,l,c,u,h,p,b,v,_),s&&(s.faceIndex=Math.floor(g/3),e.push(s))}}}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}};ni.prototype.isMesh=!0;function bat(i,t,e,n,r,o,s,a){let l;if(t.side===Tn?l=n.intersectTriangle(s,o,r,!0,a):l=n.intersectTriangle(r,o,s,t.side!==ju,a),l===null)return null;cv.copy(a),cv.applyMatrix4(i.matrixWorld);let c=e.ray.origin.distanceTo(cv);return c<e.near||c>e.far?null:{distance:c,point:cv.clone(),object:i}}function uv(i,t,e,n,r,o,s,a,l,c,u,h){Ls.fromBufferAttribute(r,c),Ds.fromBufferAttribute(r,u),zs.fromBufferAttribute(r,h);let p=i.morphTargetInfluences;if(o&&p){iv.set(0,0,0),rv.set(0,0,0),ov.set(0,0,0);for(let d=0,m=o.length;d<m;d++){let x=p[d],g=o[d];x!==0&&(D3.fromBufferAttribute(g,c),z3.fromBufferAttribute(g,u),F3.fromBufferAttribute(g,h),s?(iv.addScaledVector(D3,x),rv.addScaledVector(z3,x),ov.addScaledVector(F3,x)):(iv.addScaledVector(D3.sub(Ls),x),rv.addScaledVector(z3.sub(Ds),x),ov.addScaledVector(F3.sub(zs),x)))}Ls.add(iv),Ds.add(rv),zs.add(ov)}i.isSkinnedMesh&&(i.boneTransform(c,Ls),i.boneTransform(u,Ds),i.boneTransform(h,zs));let f=bat(i,t,e,n,Ls,Ds,zs,O3);if(f){a&&(sv.fromBufferAttribute(a,c),av.fromBufferAttribute(a,u),lv.fromBufferAttribute(a,h),f.uv=sn.getUV(O3,Ls,Ds,zs,sv,av,lv,new Et)),l&&(sv.fromBufferAttribute(l,c),av.fromBufferAttribute(l,u),lv.fromBufferAttribute(l,h),f.uv2=sn.getUV(O3,Ls,Ds,zs,sv,av,lv,new Et));let d={a:c,b:u,c:h,normal:new q,materialIndex:0};sn.getNormal(Ls,Ds,zs,d.normal),f.face=d}return f}var dl=class extends Pe{constructor(t=1,e=1,n=1,r=1,o=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:o,depthSegments:s};let a=this;r=Math.floor(r),o=Math.floor(o),s=Math.floor(s);let l=[],c=[],u=[],h=[],p=0,f=0;d("z","y","x",-1,-1,n,e,t,s,o,0),d("z","y","x",1,-1,n,e,-t,s,o,1),d("x","z","y",1,1,t,n,e,r,s,2),d("x","z","y",1,-1,t,n,-e,r,s,3),d("x","y","z",1,-1,t,e,n,r,o,4),d("x","y","z",-1,-1,t,e,-n,r,o,5),this.setIndex(l),this.setAttribute("position",new an(c,3)),this.setAttribute("normal",new an(u,3)),this.setAttribute("uv",new an(h,2));function d(m,x,g,y,b,v,_,S,E,M,N){let I=v/E,w=_/M,R=v/2,P=_/2,D=S/2,F=E+1,z=M+1,V=0,H=0,X=new q;for(let U=0;U<z;U++){let Y=U*w-P;for(let Z=0;Z<F;Z++){let K=Z*I-R;X[m]=K*y,X[x]=Y*b,X[g]=D,c.push(X.x,X.y,X.z),X[m]=0,X[x]=0,X[g]=S>0?1:-1,u.push(X.x,X.y,X.z),h.push(Z/E),h.push(1-U/M),V+=1}}for(let U=0;U<M;U++)for(let Y=0;Y<E;Y++){let Z=p+Y+F*U,K=p+Y+F*(U+1),J=p+(Y+1)+F*(U+1),G=p+(Y+1)+F*U;l.push(Z,K,G),l.push(K,J,G),H+=6}a.addGroup(f,H,N),f+=H,p+=V}}static fromJSON(t){return new dl(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}};function Xu(i){let t={};for(let e in i){t[e]={};for(let n in i[e]){let r=i[e][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?t[e][n]=r.clone():Array.isArray(r)?t[e][n]=r.slice():t[e][n]=r}}return t}function ei(i){let t={};for(let e=0;e<i.length;e++){let n=Xu(i[e]);for(let r in n)t[r]=n[r]}return t}var _at={clone:Xu,merge:ei},wat=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Sat=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,er=class extends Hn{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=wat,this.fragmentShader=Sat,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Xu(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){let e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(let r in this.uniforms){let s=this.uniforms[r].value;s&&s.isTexture?e.uniforms[r]={type:"t",value:s.toJSON(t).uuid}:s&&s.isColor?e.uniforms[r]={type:"c",value:s.getHex()}:s&&s.isVector2?e.uniforms[r]={type:"v2",value:s.toArray()}:s&&s.isVector3?e.uniforms[r]={type:"v3",value:s.toArray()}:s&&s.isVector4?e.uniforms[r]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?e.uniforms[r]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?e.uniforms[r]={type:"m4",value:s.toArray()}:e.uniforms[r]={value:s}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;let n={};for(let r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}};er.prototype.isShaderMaterial=!0;var dd=class extends Re{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new te,this.projectionMatrix=new te,this.projectionMatrixInverse=new te}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};dd.prototype.isCamera=!0;var xn=class extends dd{constructor(t=50,e=1,n=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){let e=.5*this.getFilmHeight()/t;this.fov=nM*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){let t=Math.tan(x3*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return nM*2*Math.atan(Math.tan(x3*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,r,o,s){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=this.near,e=t*Math.tan(x3*.5*this.fov)/this.zoom,n=2*e,r=this.aspect*n,o=-.5*r,s=this.view;if(this.view!==null&&this.view.enabled){let l=s.fullWidth,c=s.fullHeight;o+=s.offsetX*r/l,e-=s.offsetY*n/c,r*=s.width/l,n*=s.height/c}let a=this.filmOffset;a!==0&&(o+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}};xn.prototype.isPerspectiveCamera=!0;var Au=90,ku=1,md=class extends Re{constructor(t,e,n){if(super(),this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=n;let r=new xn(Au,ku,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new q(1,0,0)),this.add(r);let o=new xn(Au,ku,t,e);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new q(-1,0,0)),this.add(o);let s=new xn(Au,ku,t,e);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new q(0,1,0)),this.add(s);let a=new xn(Au,ku,t,e);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new q(0,-1,0)),this.add(a);let l=new xn(Au,ku,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new q(0,0,1)),this.add(l);let c=new xn(Au,ku,t,e);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new q(0,0,-1)),this.add(c)}update(t,e){this.parent===null&&this.updateMatrixWorld();let n=this.renderTarget,[r,o,s,a,l,c]=this.children,u=t.xr.enabled,h=t.getRenderTarget();t.xr.enabled=!1;let p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,o),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,a),t.setRenderTarget(n,4),t.render(e,l),n.texture.generateMipmaps=p,t.setRenderTarget(n,5),t.render(e,c),t.setRenderTarget(h),t.xr.enabled=u,n.texture.needsPMREMUpdate=!0}},Ku=class extends ln{constructor(t,e,n,r,o,s,a,l,c,u){t=t!==void 0?t:[],e=e!==void 0?e:zd,super(t,e,n,r,o,s,a,l,c,u),this.flipY=!1}get images(){return this.image}set images(t){this.image=t}};Ku.prototype.isCubeTexture=!0;var Dv=class extends ii{constructor(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),super(t,t,e),e=e||{},this.texture=new Ku(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=e.generateMipmaps!==void 0?e.generateMipmaps:!1,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:_n}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=pi,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new dl(5,5,5),o=new er({name:"CubemapFromEquirect",uniforms:Xu(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Tn,blending:Os});o.uniforms.tEquirect.value=e;let s=new ni(r,o),a=e.minFilter;return e.minFilter===s2&&(e.minFilter=_n),new md(1,10,this).update(t,s),e.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,n,r){let o=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,r);t.setRenderTarget(o)}};Dv.prototype.isWebGLCubeRenderTarget=!0;var B3=new q,Cat=new q,Mat=new An,Sr=class{constructor(t=new q(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){let r=B3.subVectors(n,e).cross(Cat.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){let t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){let n=t.delta(B3),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;let o=-(t.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:e.copy(n).multiplyScalar(o).add(t.start)}intersectsLine(t){let e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){let n=e||Mat.getNormalMatrix(t),r=this.coplanarPoint(B3).applyMatrix4(t),o=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(o),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}};Sr.prototype.isPlane=!0;var Ru=new Gs,hv=new q,Yu=class{constructor(t=new Sr,e=new Sr,n=new Sr,r=new Sr,o=new Sr,s=new Sr){this.planes=[t,e,n,r,o,s]}set(t,e,n,r,o,s){let a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(o),a[5].copy(s),this}copy(t){let e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){let e=this.planes,n=t.elements,r=n[0],o=n[1],s=n[2],a=n[3],l=n[4],c=n[5],u=n[6],h=n[7],p=n[8],f=n[9],d=n[10],m=n[11],x=n[12],g=n[13],y=n[14],b=n[15];return e[0].setComponents(a-r,h-l,m-p,b-x).normalize(),e[1].setComponents(a+r,h+l,m+p,b+x).normalize(),e[2].setComponents(a+o,h+c,m+f,b+g).normalize(),e[3].setComponents(a-o,h-c,m-f,b-g).normalize(),e[4].setComponents(a-s,h-u,m-d,b-y).normalize(),e[5].setComponents(a+s,h+u,m+d,b+y).normalize(),this}intersectsObject(t){let e=t.geometry;return e.boundingSphere===null&&e.computeBoundingSphere(),Ru.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ru)}intersectsSprite(t){return Ru.center.set(0,0,0),Ru.radius=.7071067811865476,Ru.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ru)}intersectsSphere(t){let e=this.planes,n=t.center,r=-t.radius;for(let o=0;o<6;o++)if(e[o].distanceToPoint(n)<r)return!1;return!0}intersectsBox(t){let e=this.planes;for(let n=0;n<6;n++){let r=e[n];if(hv.x=r.normal.x>0?t.max.x:t.min.x,hv.y=r.normal.y>0?t.max.y:t.min.y,hv.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(hv)<0)return!1}return!0}containsPoint(t){let e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function D7(){let i=null,t=!1,e=null,n=null;function r(o,s){e(o,s),n=i.requestAnimationFrame(r)}return{start:function(){t!==!0&&e!==null&&(n=i.requestAnimationFrame(r),t=!0)},stop:function(){i.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(o){e=o},setContext:function(o){i=o}}}function Eat(i,t){let e=t.isWebGL2,n=new WeakMap;function r(c,u){let h=c.array,p=c.usage,f=i.createBuffer();i.bindBuffer(u,f),i.bufferData(u,h,p),c.onUploadCallback();let d=5126;return h instanceof Float32Array?d=5126:h instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):h instanceof Uint16Array?c.isFloat16BufferAttribute?e?d=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):d=5123:h instanceof Int16Array?d=5122:h instanceof Uint32Array?d=5125:h instanceof Int32Array?d=5124:h instanceof Int8Array?d=5120:(h instanceof Uint8Array||h instanceof Uint8ClampedArray)&&(d=5121),{buffer:f,type:d,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}function o(c,u,h){let p=u.array,f=u.updateRange;i.bindBuffer(h,c),f.count===-1?i.bufferSubData(h,0,p):(e?i.bufferSubData(h,f.offset*p.BYTES_PER_ELEMENT,p,f.offset,f.count):i.bufferSubData(h,f.offset*p.BYTES_PER_ELEMENT,p.subarray(f.offset,f.offset+f.count)),f.count=-1)}function s(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);let u=n.get(c);u&&(i.deleteBuffer(u.buffer),n.delete(c))}function l(c,u){if(c.isGLBufferAttribute){let p=n.get(c);(!p||p.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let h=n.get(c);h===void 0?n.set(c,r(c,u)):h.version<c.version&&(o(h.buffer,c,u),h.version=c.version)}return{get:s,remove:a,update:l}}var gd=class extends Pe{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};let o=t/2,s=e/2,a=Math.floor(n),l=Math.floor(r),c=a+1,u=l+1,h=t/a,p=e/l,f=[],d=[],m=[],x=[];for(let g=0;g<u;g++){let y=g*p-s;for(let b=0;b<c;b++){let v=b*h-o;d.push(v,-y,0),m.push(0,0,1),x.push(b/a),x.push(1-g/l)}}for(let g=0;g<l;g++)for(let y=0;y<a;y++){let b=y+c*g,v=y+c*(g+1),_=y+1+c*(g+1),S=y+1+c*g;f.push(b,v,S),f.push(v,_,S)}this.setIndex(f),this.setAttribute("position",new an(d,3)),this.setAttribute("normal",new an(m,3)),this.setAttribute("uv",new an(x,2))}static fromJSON(t){return new gd(t.width,t.height,t.widthSegments,t.heightSegments)}},Tat=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,Iat=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Aat=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,kat=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Rat=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Pat=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Nat="vec3 transformed = vec3( position );",Lat=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Dat=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,zat=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Fat=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Oat=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Bat=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Vat=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Hat=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,$at=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Uat=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Wat=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Gat=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,jat=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		return texture2D( envMap, uv ).rgb;
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,qat=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Xat=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Kat=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Yat=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Zat=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Jat="gl_FragColor = linearToOutputTexel( gl_FragColor );",Qat=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,tlt=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,elt=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,nlt=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,ilt=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,rlt=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,olt=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,slt=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,alt=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,llt=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,clt=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,ult=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		lightMapIrradiance *= PI;
	#endif
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,hlt=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,plt=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,flt=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,dlt=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec;
			#ifdef ENVMAP_MODE_REFLECTION
				reflectVec = reflect( - viewDir, normal );
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			#else
				reflectVec = refract( - viewDir, normal, refractionRatio );
			#endif
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,mlt=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,glt=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,xlt=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,ylt=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,vlt=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,blt=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,_lt=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,wlt=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Slt=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Clt=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Mlt=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Elt=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Tlt=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Ilt=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Alt=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,klt=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Rlt=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Plt=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Nlt=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Llt=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Dlt=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform vec2 morphTargetsTextureSize;
		vec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {
			float texelIndex = float( vertexIndex * stride + offset );
			float y = floor( texelIndex / morphTargetsTextureSize.x );
			float x = texelIndex - y * morphTargetsTextureSize.x;
			vec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );
			return texture( morphTargetsTexture, morphUV ).xyz;
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,zlt=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			#ifndef USE_MORPHNORMALS
				if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];
			#else
				if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];
			#endif
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Flt=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Olt=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Blt=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Vlt=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Hlt=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,$lt=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,Ult=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Wlt=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,Glt=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,jlt=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,qlt=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Xlt=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Klt=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Ylt=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Zlt=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Jlt=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Qlt=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,tct=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,ect=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,nct=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,ict=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,rct=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,oct=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,sct=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,act=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,lct=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,cct=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,uct=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,hct=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,pct=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,fct=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef TEXTURE_LOD_EXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,dct=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,mct=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,gct=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,xct=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,yct=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,vct=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,bct=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,_ct=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,wct=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Sct=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Cct=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Mct=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Ect=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Tct=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Ict=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Act=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,kct=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Rct=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Pct=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Nct=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Lct=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Dct=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zct=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Fct=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Oct=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Bct=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Vct=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,Hct=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$ct=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Uct=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Wct=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Gct=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,jct=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qct=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Xct=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Kct=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Yct=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Zct=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Jct=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,pe={alphamap_fragment:Tat,alphamap_pars_fragment:Iat,alphatest_fragment:Aat,alphatest_pars_fragment:kat,aomap_fragment:Rat,aomap_pars_fragment:Pat,begin_vertex:Nat,beginnormal_vertex:Lat,bsdfs:Dat,bumpmap_pars_fragment:zat,clipping_planes_fragment:Fat,clipping_planes_pars_fragment:Oat,clipping_planes_pars_vertex:Bat,clipping_planes_vertex:Vat,color_fragment:Hat,color_pars_fragment:$at,color_pars_vertex:Uat,color_vertex:Wat,common:Gat,cube_uv_reflection_fragment:jat,defaultnormal_vertex:qat,displacementmap_pars_vertex:Xat,displacementmap_vertex:Kat,emissivemap_fragment:Yat,emissivemap_pars_fragment:Zat,encodings_fragment:Jat,encodings_pars_fragment:Qat,envmap_fragment:tlt,envmap_common_pars_fragment:elt,envmap_pars_fragment:nlt,envmap_pars_vertex:ilt,envmap_physical_pars_fragment:dlt,envmap_vertex:rlt,fog_vertex:olt,fog_pars_vertex:slt,fog_fragment:alt,fog_pars_fragment:llt,gradientmap_pars_fragment:clt,lightmap_fragment:ult,lightmap_pars_fragment:hlt,lights_lambert_vertex:plt,lights_pars_begin:flt,lights_toon_fragment:mlt,lights_toon_pars_fragment:glt,lights_phong_fragment:xlt,lights_phong_pars_fragment:ylt,lights_physical_fragment:vlt,lights_physical_pars_fragment:blt,lights_fragment_begin:_lt,lights_fragment_maps:wlt,lights_fragment_end:Slt,logdepthbuf_fragment:Clt,logdepthbuf_pars_fragment:Mlt,logdepthbuf_pars_vertex:Elt,logdepthbuf_vertex:Tlt,map_fragment:Ilt,map_pars_fragment:Alt,map_particle_fragment:klt,map_particle_pars_fragment:Rlt,metalnessmap_fragment:Plt,metalnessmap_pars_fragment:Nlt,morphnormal_vertex:Llt,morphtarget_pars_vertex:Dlt,morphtarget_vertex:zlt,normal_fragment_begin:Flt,normal_fragment_maps:Olt,normal_pars_fragment:Blt,normal_pars_vertex:Vlt,normal_vertex:Hlt,normalmap_pars_fragment:$lt,clearcoat_normal_fragment_begin:Ult,clearcoat_normal_fragment_maps:Wlt,clearcoat_pars_fragment:Glt,output_fragment:jlt,packing:qlt,premultiplied_alpha_fragment:Xlt,project_vertex:Klt,dithering_fragment:Ylt,dithering_pars_fragment:Zlt,roughnessmap_fragment:Jlt,roughnessmap_pars_fragment:Qlt,shadowmap_pars_fragment:tct,shadowmap_pars_vertex:ect,shadowmap_vertex:nct,shadowmask_pars_fragment:ict,skinbase_vertex:rct,skinning_pars_vertex:oct,skinning_vertex:sct,skinnormal_vertex:act,specularmap_fragment:lct,specularmap_pars_fragment:cct,tonemapping_fragment:uct,tonemapping_pars_fragment:hct,transmission_fragment:pct,transmission_pars_fragment:fct,uv_pars_fragment:dct,uv_pars_vertex:mct,uv_vertex:gct,uv2_pars_fragment:xct,uv2_pars_vertex:yct,uv2_vertex:vct,worldpos_vertex:bct,background_vert:_ct,background_frag:wct,cube_vert:Sct,cube_frag:Cct,depth_vert:Mct,depth_frag:Ect,distanceRGBA_vert:Tct,distanceRGBA_frag:Ict,equirect_vert:Act,equirect_frag:kct,linedashed_vert:Rct,linedashed_frag:Pct,meshbasic_vert:Nct,meshbasic_frag:Lct,meshlambert_vert:Dct,meshlambert_frag:zct,meshmatcap_vert:Fct,meshmatcap_frag:Oct,meshnormal_vert:Bct,meshnormal_frag:Vct,meshphong_vert:Hct,meshphong_frag:$ct,meshphysical_vert:Uct,meshphysical_frag:Wct,meshtoon_vert:Gct,meshtoon_frag:jct,points_vert:qct,points_frag:Xct,shadow_vert:Kct,shadow_frag:Yct,sprite_vert:Zct,sprite_frag:Jct},Lt={common:{diffuse:{value:new zt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new An},uv2Transform:{value:new An},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Et(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new zt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new zt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new An}},sprite:{diffuse:{value:new zt(16777215)},opacity:{value:1},center:{value:new Et(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new An}}},no={basic:{uniforms:ei([Lt.common,Lt.specularmap,Lt.envmap,Lt.aomap,Lt.lightmap,Lt.fog]),vertexShader:pe.meshbasic_vert,fragmentShader:pe.meshbasic_frag},lambert:{uniforms:ei([Lt.common,Lt.specularmap,Lt.envmap,Lt.aomap,Lt.lightmap,Lt.emissivemap,Lt.fog,Lt.lights,{emissive:{value:new zt(0)}}]),vertexShader:pe.meshlambert_vert,fragmentShader:pe.meshlambert_frag},phong:{uniforms:ei([Lt.common,Lt.specularmap,Lt.envmap,Lt.aomap,Lt.lightmap,Lt.emissivemap,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.fog,Lt.lights,{emissive:{value:new zt(0)},specular:{value:new zt(1118481)},shininess:{value:30}}]),vertexShader:pe.meshphong_vert,fragmentShader:pe.meshphong_frag},standard:{uniforms:ei([Lt.common,Lt.envmap,Lt.aomap,Lt.lightmap,Lt.emissivemap,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.roughnessmap,Lt.metalnessmap,Lt.fog,Lt.lights,{emissive:{value:new zt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:pe.meshphysical_vert,fragmentShader:pe.meshphysical_frag},toon:{uniforms:ei([Lt.common,Lt.aomap,Lt.lightmap,Lt.emissivemap,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.gradientmap,Lt.fog,Lt.lights,{emissive:{value:new zt(0)}}]),vertexShader:pe.meshtoon_vert,fragmentShader:pe.meshtoon_frag},matcap:{uniforms:ei([Lt.common,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.fog,{matcap:{value:null}}]),vertexShader:pe.meshmatcap_vert,fragmentShader:pe.meshmatcap_frag},points:{uniforms:ei([Lt.points,Lt.fog]),vertexShader:pe.points_vert,fragmentShader:pe.points_frag},dashed:{uniforms:ei([Lt.common,Lt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:pe.linedashed_vert,fragmentShader:pe.linedashed_frag},depth:{uniforms:ei([Lt.common,Lt.displacementmap]),vertexShader:pe.depth_vert,fragmentShader:pe.depth_frag},normal:{uniforms:ei([Lt.common,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,{opacity:{value:1}}]),vertexShader:pe.meshnormal_vert,fragmentShader:pe.meshnormal_frag},sprite:{uniforms:ei([Lt.sprite,Lt.fog]),vertexShader:pe.sprite_vert,fragmentShader:pe.sprite_frag},background:{uniforms:{uvTransform:{value:new An},t2D:{value:null}},vertexShader:pe.background_vert,fragmentShader:pe.background_frag},cube:{uniforms:ei([Lt.envmap,{opacity:{value:1}}]),vertexShader:pe.cube_vert,fragmentShader:pe.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:pe.equirect_vert,fragmentShader:pe.equirect_frag},distanceRGBA:{uniforms:ei([Lt.common,Lt.displacementmap,{referencePosition:{value:new q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:pe.distanceRGBA_vert,fragmentShader:pe.distanceRGBA_frag},shadow:{uniforms:ei([Lt.lights,Lt.fog,{color:{value:new zt(0)},opacity:{value:1}}]),vertexShader:pe.shadow_vert,fragmentShader:pe.shadow_frag}};no.physical={uniforms:ei([no.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Et(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new zt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Et},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new zt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new zt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:pe.meshphysical_vert,fragmentShader:pe.meshphysical_frag};function Qct(i,t,e,n,r,o){let s=new zt(0),a=r===!0?0:1,l,c,u=null,h=0,p=null;function f(m,x){let g=!1,y=x.isScene===!0?x.background:null;y&&y.isTexture&&(y=t.get(y));let b=i.xr,v=b.getSession&&b.getSession();v&&v.environmentBlendMode==="additive"&&(y=null),y===null?d(s,a):y&&y.isColor&&(d(y,1),g=!0),(i.autoClear||g)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),y&&(y.isCubeTexture||y.mapping===o2)?(c===void 0&&(c=new ni(new dl(1,1,1),new er({name:"BackgroundCubeMaterial",uniforms:Xu(no.cube.uniforms),vertexShader:no.cube.vertexShader,fragmentShader:no.cube.fragmentShader,side:Tn,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(_,S,E){this.matrixWorld.copyPosition(E.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(c)),c.material.uniforms.envMap.value=y,c.material.uniforms.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,(u!==y||h!==y.version||p!==i.toneMapping)&&(c.material.needsUpdate=!0,u=y,h=y.version,p=i.toneMapping),m.unshift(c,c.geometry,c.material,0,0,null)):y&&y.isTexture&&(l===void 0&&(l=new ni(new gd(2,2),new er({name:"BackgroundMaterial",uniforms:Xu(no.background.uniforms),vertexShader:no.background.vertexShader,fragmentShader:no.background.fragmentShader,side:ld,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(l)),l.material.uniforms.t2D.value=y,y.matrixAutoUpdate===!0&&y.updateMatrix(),l.material.uniforms.uvTransform.value.copy(y.matrix),(u!==y||h!==y.version||p!==i.toneMapping)&&(l.material.needsUpdate=!0,u=y,h=y.version,p=i.toneMapping),m.unshift(l,l.geometry,l.material,0,0,null))}function d(m,x){e.buffers.color.setClear(m.r,m.g,m.b,x,o)}return{getClearColor:function(){return s},setClearColor:function(m,x=1){s.set(m),a=x,d(s,a)},getClearAlpha:function(){return a},setClearAlpha:function(m){a=m,d(s,a)},render:f}}function tut(i,t,e,n){let r=i.getParameter(34921),o=n.isWebGL2?null:t.get("OES_vertex_array_object"),s=n.isWebGL2||o!==null,a={},l=m(null),c=l;function u(P,D,F,z,V){let H=!1;if(s){let X=d(z,F,D);c!==X&&(c=X,p(c.object)),H=x(z,V),H&&g(z,V)}else{let X=D.wireframe===!0;(c.geometry!==z.id||c.program!==F.id||c.wireframe!==X)&&(c.geometry=z.id,c.program=F.id,c.wireframe=X,H=!0)}P.isInstancedMesh===!0&&(H=!0),V!==null&&e.update(V,34963),H&&(E(P,D,F,z),V!==null&&i.bindBuffer(34963,e.get(V).buffer))}function h(){return n.isWebGL2?i.createVertexArray():o.createVertexArrayOES()}function p(P){return n.isWebGL2?i.bindVertexArray(P):o.bindVertexArrayOES(P)}function f(P){return n.isWebGL2?i.deleteVertexArray(P):o.deleteVertexArrayOES(P)}function d(P,D,F){let z=F.wireframe===!0,V=a[P.id];V===void 0&&(V={},a[P.id]=V);let H=V[D.id];H===void 0&&(H={},V[D.id]=H);let X=H[z];return X===void 0&&(X=m(h()),H[z]=X),X}function m(P){let D=[],F=[],z=[];for(let V=0;V<r;V++)D[V]=0,F[V]=0,z[V]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:D,enabledAttributes:F,attributeDivisors:z,object:P,attributes:{},index:null}}function x(P,D){let F=c.attributes,z=P.attributes,V=0;for(let H in z){let X=F[H],U=z[H];if(X===void 0||X.attribute!==U||X.data!==U.data)return!0;V++}return c.attributesNum!==V||c.index!==D}function g(P,D){let F={},z=P.attributes,V=0;for(let H in z){let X=z[H],U={};U.attribute=X,X.data&&(U.data=X.data),F[H]=U,V++}c.attributes=F,c.attributesNum=V,c.index=D}function y(){let P=c.newAttributes;for(let D=0,F=P.length;D<F;D++)P[D]=0}function b(P){v(P,0)}function v(P,D){let F=c.newAttributes,z=c.enabledAttributes,V=c.attributeDivisors;F[P]=1,z[P]===0&&(i.enableVertexAttribArray(P),z[P]=1),V[P]!==D&&((n.isWebGL2?i:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](P,D),V[P]=D)}function _(){let P=c.newAttributes,D=c.enabledAttributes;for(let F=0,z=D.length;F<z;F++)D[F]!==P[F]&&(i.disableVertexAttribArray(F),D[F]=0)}function S(P,D,F,z,V,H){n.isWebGL2===!0&&(F===5124||F===5125)?i.vertexAttribIPointer(P,D,F,V,H):i.vertexAttribPointer(P,D,F,z,V,H)}function E(P,D,F,z){if(n.isWebGL2===!1&&(P.isInstancedMesh||z.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;y();let V=z.attributes,H=F.getAttributes(),X=D.defaultAttributeValues;for(let U in H){let Y=H[U];if(Y.location>=0){let Z=V[U];if(Z===void 0&&(U==="instanceMatrix"&&P.instanceMatrix&&(Z=P.instanceMatrix),U==="instanceColor"&&P.instanceColor&&(Z=P.instanceColor)),Z!==void 0){let K=Z.normalized,J=Z.itemSize,G=e.get(Z);if(G===void 0)continue;let nt=G.buffer,et=G.type,at=G.bytesPerElement;if(Z.isInterleavedBufferAttribute){let it=Z.data,St=it.stride,yt=Z.offset;if(it&&it.isInstancedInterleavedBuffer){for(let rt=0;rt<Y.locationSize;rt++)v(Y.location+rt,it.meshPerAttribute);P.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=it.meshPerAttribute*it.count)}else for(let rt=0;rt<Y.locationSize;rt++)b(Y.location+rt);i.bindBuffer(34962,nt);for(let rt=0;rt<Y.locationSize;rt++)S(Y.location+rt,J/Y.locationSize,et,K,St*at,(yt+J/Y.locationSize*rt)*at)}else{if(Z.isInstancedBufferAttribute){for(let it=0;it<Y.locationSize;it++)v(Y.location+it,Z.meshPerAttribute);P.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=Z.meshPerAttribute*Z.count)}else for(let it=0;it<Y.locationSize;it++)b(Y.location+it);i.bindBuffer(34962,nt);for(let it=0;it<Y.locationSize;it++)S(Y.location+it,J/Y.locationSize,et,K,J*at,J/Y.locationSize*it*at)}}else if(X!==void 0){let K=X[U];if(K!==void 0)switch(K.length){case 2:i.vertexAttrib2fv(Y.location,K);break;case 3:i.vertexAttrib3fv(Y.location,K);break;case 4:i.vertexAttrib4fv(Y.location,K);break;default:i.vertexAttrib1fv(Y.location,K)}}}}_()}function M(){w();for(let P in a){let D=a[P];for(let F in D){let z=D[F];for(let V in z)f(z[V].object),delete z[V];delete D[F]}delete a[P]}}function N(P){if(a[P.id]===void 0)return;let D=a[P.id];for(let F in D){let z=D[F];for(let V in z)f(z[V].object),delete z[V];delete D[F]}delete a[P.id]}function I(P){for(let D in a){let F=a[D];if(F[P.id]===void 0)continue;let z=F[P.id];for(let V in z)f(z[V].object),delete z[V];delete F[P.id]}}function w(){R(),c!==l&&(c=l,p(c.object))}function R(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:w,resetDefaultState:R,dispose:M,releaseStatesOfGeometry:N,releaseStatesOfProgram:I,initAttributes:y,enableAttribute:b,disableUnusedAttributes:_}}function eut(i,t,e,n){let r=n.isWebGL2,o;function s(c){o=c}function a(c,u){i.drawArrays(o,c,u),e.update(u,o,1)}function l(c,u,h){if(h===0)return;let p,f;if(r)p=i,f="drawArraysInstanced";else if(p=t.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[f](o,c,u,h),e.update(u,o,h)}this.setMode=s,this.render=a,this.renderInstances=l}function nut(i,t,e){let n;function r(){if(n!==void 0)return n;if(t.has("EXT_texture_filter_anisotropic")===!0){let E=t.get("EXT_texture_filter_anisotropic");n=i.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function o(E){if(E==="highp"){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";E="mediump"}return E==="mediump"&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let s=typeof WebGL2RenderingContext!="undefined"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&i instanceof WebGL2ComputeRenderingContext,a=e.precision!==void 0?e.precision:"highp",l=o(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);let c=s||t.has("WEBGL_draw_buffers"),u=e.logarithmicDepthBuffer===!0,h=i.getParameter(34930),p=i.getParameter(35660),f=i.getParameter(3379),d=i.getParameter(34076),m=i.getParameter(34921),x=i.getParameter(36347),g=i.getParameter(36348),y=i.getParameter(36349),b=p>0,v=s||t.has("OES_texture_float"),_=b&&v,S=s?i.getParameter(36183):0;return{isWebGL2:s,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:o,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:p,maxTextureSize:f,maxCubemapSize:d,maxAttributes:m,maxVertexUniforms:x,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:b,floatFragmentTextures:v,floatVertexTextures:_,maxSamples:S}}function iut(i){let t=this,e=null,n=0,r=!1,o=!1,s=new Sr,a=new An,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,p,f){let d=h.length!==0||p||n!==0||r;return r=p,e=u(h,f,0),n=h.length,d},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1,c()},this.setState=function(h,p,f){let d=h.clippingPlanes,m=h.clipIntersection,x=h.clipShadows,g=i.get(h);if(!r||d===null||d.length===0||o&&!x)o?u(null):c();else{let y=o?0:n,b=y*4,v=g.clippingState||null;l.value=v,v=u(d,p,b,f);for(let _=0;_!==b;++_)v[_]=e[_];g.clippingState=v,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==e&&(l.value=e,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(h,p,f,d){let m=h!==null?h.length:0,x=null;if(m!==0){if(x=l.value,d!==!0||x===null){let g=f+m*4,y=p.matrixWorldInverse;a.getNormalMatrix(y),(x===null||x.length<g)&&(x=new Float32Array(g));for(let b=0,v=f;b!==m;++b,v+=4)s.copy(h[b]).applyMatrix4(y,a),s.normal.toArray(x,v),x[v+3]=s.constant}l.value=x,l.needsUpdate=!0}return t.numPlanes=m,t.numIntersection=0,x}}function rut(i){let t=new WeakMap;function e(s,a){return a===Z3?s.mapping=zd:a===J3&&(s.mapping=Fd),s}function n(s){if(s&&s.isTexture&&s.isRenderTargetTexture===!1){let a=s.mapping;if(a===Z3||a===J3)if(t.has(s)){let l=t.get(s).texture;return e(l,s.mapping)}else{let l=s.image;if(l&&l.height>0){let c=new Dv(l.height/2);return c.fromEquirectangularTexture(i,s),t.set(s,c),s.addEventListener("dispose",r),e(c.texture,s.mapping)}else return null}}return s}function r(s){let a=s.target;a.removeEventListener("dispose",r);let l=t.get(a);l!==void 0&&(t.delete(a),l.dispose())}function o(){t=new WeakMap}return{get:n,dispose:o}}var ml=class extends dd{constructor(t=-1,e=1,n=1,r=-1,o=.1,s=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=o,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,o,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,o=n-t,s=n+t,a=r+e,l=r-e;if(this.view!==null&&this.view.enabled){let c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=c*this.view.offsetX,s=o+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(o,s,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}};ml.prototype.isOrthographicCamera=!0;var Zu=class extends er{constructor(t){super(t),this.type="RawShaderMaterial"}};Zu.prototype.isRawShaderMaterial=!0;var Gu=4,$s=8,eo=Math.pow(2,$s),z7=[.125,.215,.35,.446,.526,.582],F7=$s-Gu+1+z7.length,Pu=20,V3=new ml,{_lodPlanes:Zf,_sizeLods:LO,_sigmas:pv}=out(),DO=new zt,H3=null,ul=(1+Math.sqrt(5))/2,Nu=1/ul,zO=[new q(1,1,1),new q(-1,1,1),new q(1,1,-1),new q(-1,1,-1),new q(0,ul,Nu),new q(0,ul,-Nu),new q(Nu,0,ul),new q(-Nu,0,ul),new q(ul,Nu,0),new q(-ul,Nu,0)],zv=class{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=sut(Pu),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,r=100){H3=this._renderer.getRenderTarget();let o=this._allocateTargets();return this._sceneToCubeUV(t,n,r,o),e>0&&this._blur(o,0,0,e),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=BO(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=OO(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let t=0;t<Zf.length;t++)Zf[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(H3),t.scissorTest=!1,fv(t,0,0,t.width,t.height)}_fromTexture(t,e){H3=this._renderer.getRenderTarget();let n=e||this._allocateTargets(t);return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(t){let e={magFilter:_n,minFilter:_n,generateMipmaps:!1,type:$u,format:pi,encoding:Ws,depthBuffer:!1},n=FO(e);return n.depthBuffer=!t,this._pingPongRenderTarget===null&&(this._pingPongRenderTarget=FO(e)),n}_compileMaterial(t){let e=new ni(Zf[0],t);this._renderer.compile(e,V3)}_sceneToCubeUV(t,e,n,r){let a=new xn(90,1,e,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,p=u.toneMapping;u.getClearColor(DO),u.toneMapping=Vs,u.autoClear=!1;let f=new fd({name:"PMREM.Background",side:Tn,depthWrite:!1,depthTest:!1}),d=new ni(new dl,f),m=!1,x=t.background;x?x.isColor&&(f.color.copy(x),t.background=null,m=!0):(f.color.copy(DO),m=!0);for(let g=0;g<6;g++){let y=g%3;y===0?(a.up.set(0,l[g],0),a.lookAt(c[g],0,0)):y===1?(a.up.set(0,0,l[g]),a.lookAt(0,c[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,c[g])),fv(r,y*eo,g>2?eo:0,eo,eo),u.setRenderTarget(r),m&&u.render(d,a),u.render(t,a)}d.geometry.dispose(),d.material.dispose(),u.toneMapping=p,u.autoClear=h,t.background=x}_textureToCubeUV(t,e){let n=this._renderer,r=t.mapping===zd||t.mapping===Fd;r?(this._cubemapShader===null&&(this._cubemapShader=BO()),this._cubemapShader.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectShader===null&&(this._equirectShader=OO());let o=r?this._cubemapShader:this._equirectShader,s=new ni(Zf[0],o),a=o.uniforms;a.envMap.value=t,r||a.texelSize.value.set(1/t.image.width,1/t.image.height),fv(e,0,0,3*eo,2*eo),n.setRenderTarget(e),n.render(s,V3)}_applyPMREM(t){let e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let r=1;r<F7;r++){let o=Math.sqrt(pv[r]*pv[r]-pv[r-1]*pv[r-1]),s=zO[(r-1)%zO.length];this._blur(t,r-1,r,o,s)}e.autoClear=n}_blur(t,e,n,r,o){let s=this._pingPongRenderTarget;this._halfBlur(t,s,e,n,r,"latitudinal",o),this._halfBlur(s,t,n,n,r,"longitudinal",o)}_halfBlur(t,e,n,r,o,s,a){let l=this._renderer,c=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let u=3,h=new ni(Zf[r],c),p=c.uniforms,f=LO[n]-1,d=isFinite(o)?Math.PI/(2*f):2*Math.PI/(2*Pu-1),m=o/d,x=isFinite(o)?1+Math.floor(u*m):Pu;x>Pu&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${Pu}`);let g=[],y=0;for(let S=0;S<Pu;++S){let E=S/m,M=Math.exp(-E*E/2);g.push(M),S===0?y+=M:S<x&&(y+=2*M)}for(let S=0;S<g.length;S++)g[S]=g[S]/y;p.envMap.value=t.texture,p.samples.value=x,p.weights.value=g,p.latitudinal.value=s==="latitudinal",a&&(p.poleAxis.value=a),p.dTheta.value=d,p.mipInt.value=$s-n;let b=LO[r],v=3*Math.max(0,eo-2*b),_=(r===0?0:2*eo)+2*b*(r>$s-Gu?r-$s+Gu:0);fv(e,v,_,3*b,2*b),l.setRenderTarget(e),l.render(h,V3)}};function out(){let i=[],t=[],e=[],n=$s;for(let r=0;r<F7;r++){let o=Math.pow(2,n);t.push(o);let s=1/o;r>$s-Gu?s=z7[r-$s+Gu-1]:r===0&&(s=0),e.push(s);let a=1/(o-1),l=-a/2,c=1+a/2,u=[l,l,c,l,c,c,l,l,c,c,l,c],h=6,p=6,f=3,d=2,m=1,x=new Float32Array(f*p*h),g=new Float32Array(d*p*h),y=new Float32Array(m*p*h);for(let v=0;v<h;v++){let _=v%3*2/3-1,S=v>2?0:-1,E=[_,S,0,_+2/3,S,0,_+2/3,S+1,0,_,S,0,_+2/3,S+1,0,_,S+1,0];x.set(E,f*p*v),g.set(u,d*p*v);let M=[v,v,v,v,v,v];y.set(M,m*p*v)}let b=new Pe;b.setAttribute("position",new we(x,f)),b.setAttribute("uv",new we(g,d)),b.setAttribute("faceIndex",new we(y,m)),i.push(b),n>Gu&&n--}return{_lodPlanes:i,_sizeLods:t,_sigmas:e}}function FO(i){let t=new ii(3*eo,3*eo,i);return t.texture.mapping=o2,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function fv(i,t,e,n,r){i.viewport.set(t,e,n,r),i.scissor.set(t,e,n,r)}function sut(i){let t=new Float32Array(i),e=new q(0,1,0);return new Zu({name:"SphericalGaussianBlur",defines:{n:i},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:e}},vertexShader:h4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Os,depthTest:!1,depthWrite:!1})}function OO(){let i=new Et(1,1);return new Zu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:i}},vertexShader:h4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = texture2D ( envMap, uv ).rgb;
				uv.x += texelSize.x;
				vec3 tr = texture2D ( envMap, uv ).rgb;
				uv.y += texelSize.y;
				vec3 br = texture2D ( envMap, uv ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = texture2D ( envMap, uv ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

			}
		`,blending:Os,depthTest:!1,depthWrite:!1})}function BO(){return new Zu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:h4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Os,depthTest:!1,depthWrite:!1})}function h4(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function aut(i){let t=new WeakMap,e=null;function n(a){if(a&&a.isTexture){let l=a.mapping,c=l===Z3||l===J3,u=l===zd||l===Fd;if(c||u)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let h=t.get(a);return e===null&&(e=new zv(i)),h=c?e.fromEquirectangular(a,h):e.fromCubemap(a,h),t.set(a,h),h.texture}else{if(t.has(a))return t.get(a).texture;{let h=a.image;if(c&&h&&h.height>0||u&&h&&r(h)){e===null&&(e=new zv(i));let p=c?e.fromEquirectangular(a):e.fromCubemap(a);return t.set(a,p),a.addEventListener("dispose",o),p.texture}else return null}}}return a}function r(a){let l=0,c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function o(a){let l=a.target;l.removeEventListener("dispose",o);let c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function s(){t=new WeakMap,e!==null&&(e.dispose(),e=null)}return{get:n,dispose:s}}function lut(i){let t={};function e(n){if(t[n]!==void 0)return t[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return t[n]=r,r}return{has:function(n){return e(n)!==null},init:function(n){n.isWebGL2?e("EXT_color_buffer_float"):(e("WEBGL_depth_texture"),e("OES_texture_float"),e("OES_texture_half_float"),e("OES_texture_half_float_linear"),e("OES_standard_derivatives"),e("OES_element_index_uint"),e("OES_vertex_array_object"),e("ANGLE_instanced_arrays")),e("OES_texture_float_linear"),e("EXT_color_buffer_half_float"),e("WEBGL_multisampled_render_to_texture")},get:function(n){let r=e(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function cut(i,t,e,n){let r={},o=new WeakMap;function s(h){let p=h.target;p.index!==null&&t.remove(p.index);for(let d in p.attributes)t.remove(p.attributes[d]);p.removeEventListener("dispose",s),delete r[p.id];let f=o.get(p);f&&(t.remove(f),o.delete(p)),n.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,e.memory.geometries--}function a(h,p){return r[p.id]===!0||(p.addEventListener("dispose",s),r[p.id]=!0,e.memory.geometries++),p}function l(h){let p=h.attributes;for(let d in p)t.update(p[d],34962);let f=h.morphAttributes;for(let d in f){let m=f[d];for(let x=0,g=m.length;x<g;x++)t.update(m[x],34962)}}function c(h){let p=[],f=h.index,d=h.attributes.position,m=0;if(f!==null){let y=f.array;m=f.version;for(let b=0,v=y.length;b<v;b+=3){let _=y[b+0],S=y[b+1],E=y[b+2];p.push(_,S,S,E,E,_)}}else{let y=d.array;m=d.version;for(let b=0,v=y.length/3-1;b<v;b+=3){let _=b+0,S=b+1,E=b+2;p.push(_,S,S,E,E,_)}}let x=new(N7(p)?Lv:Nv)(p,1);x.version=m;let g=o.get(h);g&&t.remove(g),o.set(h,x)}function u(h){let p=o.get(h);if(p){let f=h.index;f!==null&&p.version<f.version&&c(h)}else c(h);return o.get(h)}return{get:a,update:l,getWireframeAttribute:u}}function uut(i,t,e,n){let r=n.isWebGL2,o;function s(p){o=p}let a,l;function c(p){a=p.type,l=p.bytesPerElement}function u(p,f){i.drawElements(o,f,a,p*l),e.update(f,o,1)}function h(p,f,d){if(d===0)return;let m,x;if(r)m=i,x="drawElementsInstanced";else if(m=t.get("ANGLE_instanced_arrays"),x="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[x](o,f,a,p*l,d),e.update(f,o,d)}this.setMode=s,this.setIndex=c,this.render=u,this.renderInstances=h}function hut(i){let t={geometries:0,textures:0},e={frame:0,calls:0,triangles:0,points:0,lines:0};function n(o,s,a){switch(e.calls++,s){case 4:e.triangles+=a*(o/3);break;case 1:e.lines+=a*(o/2);break;case 3:e.lines+=a*(o-1);break;case 2:e.lines+=a*o;break;case 0:e.points+=a*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s);break}}function r(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0}return{memory:t,render:e,programs:null,autoReset:!0,reset:r,update:n}}var xd=class extends ln{constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=In,this.minFilter=In,this.wrapR=Li,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};xd.prototype.isDataTexture2DArray=!0;function put(i,t){return i[0]-t[0]}function fut(i,t){return Math.abs(t[1])-Math.abs(i[1])}function VO(i,t){let e=1,n=t.isInterleavedBufferAttribute?t.data.array:t.array;n instanceof Int8Array?e=127:n instanceof Int16Array?e=32767:n instanceof Int32Array?e=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),i.divideScalar(e)}function dut(i,t,e){let n={},r=new Float32Array(8),o=new WeakMap,s=new q,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,u,h,p){let f=c.morphTargetInfluences;if(t.isWebGL2===!0){let d=u.morphAttributes.position.length,m=o.get(u);if(m===void 0||m.count!==d){let R=function(){I.dispose(),o.delete(u),u.removeEventListener("dispose",R)};m!==void 0&&m.texture.dispose();let y=u.morphAttributes.normal!==void 0,b=u.morphAttributes.position,v=u.morphAttributes.normal||[],_=u.attributes.position.count,S=y===!0?2:1,E=_*S,M=1;E>t.maxTextureSize&&(M=Math.ceil(E/t.maxTextureSize),E=t.maxTextureSize);let N=new Float32Array(E*M*4*d),I=new xd(N,E,M,d);I.format=pi,I.type=hl,I.needsUpdate=!0;let w=S*4;for(let P=0;P<d;P++){let D=b[P],F=v[P],z=E*M*4*P;for(let V=0;V<D.count;V++){s.fromBufferAttribute(D,V),D.normalized===!0&&VO(s,D);let H=V*w;N[z+H+0]=s.x,N[z+H+1]=s.y,N[z+H+2]=s.z,N[z+H+3]=0,y===!0&&(s.fromBufferAttribute(F,V),F.normalized===!0&&VO(s,F),N[z+H+4]=s.x,N[z+H+5]=s.y,N[z+H+6]=s.z,N[z+H+7]=0)}}m={count:d,texture:I,size:new Et(E,M)},o.set(u,m),u.addEventListener("dispose",R)}let x=0;for(let y=0;y<f.length;y++)x+=f[y];let g=u.morphTargetsRelative?1:1-x;p.getUniforms().setValue(i,"morphTargetBaseInfluence",g),p.getUniforms().setValue(i,"morphTargetInfluences",f),p.getUniforms().setValue(i,"morphTargetsTexture",m.texture,e),p.getUniforms().setValue(i,"morphTargetsTextureSize",m.size)}else{let d=f===void 0?0:f.length,m=n[u.id];if(m===void 0||m.length!==d){m=[];for(let v=0;v<d;v++)m[v]=[v,0];n[u.id]=m}for(let v=0;v<d;v++){let _=m[v];_[0]=v,_[1]=f[v]}m.sort(fut);for(let v=0;v<8;v++)v<d&&m[v][1]?(a[v][0]=m[v][0],a[v][1]=m[v][1]):(a[v][0]=Number.MAX_SAFE_INTEGER,a[v][1]=0);a.sort(put);let x=u.morphAttributes.position,g=u.morphAttributes.normal,y=0;for(let v=0;v<8;v++){let _=a[v],S=_[0],E=_[1];S!==Number.MAX_SAFE_INTEGER&&E?(x&&u.getAttribute("morphTarget"+v)!==x[S]&&u.setAttribute("morphTarget"+v,x[S]),g&&u.getAttribute("morphNormal"+v)!==g[S]&&u.setAttribute("morphNormal"+v,g[S]),r[v]=E,y+=E):(x&&u.hasAttribute("morphTarget"+v)===!0&&u.deleteAttribute("morphTarget"+v),g&&u.hasAttribute("morphNormal"+v)===!0&&u.deleteAttribute("morphNormal"+v),r[v]=0)}let b=u.morphTargetsRelative?1:1-y;p.getUniforms().setValue(i,"morphTargetBaseInfluence",b),p.getUniforms().setValue(i,"morphTargetInfluences",r)}}return{update:l}}function mut(i,t,e,n){let r=new WeakMap;function o(l){let c=n.render.frame,u=l.geometry,h=t.get(l,u);return r.get(h)!==c&&(t.update(h),r.set(h,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),e.update(l.instanceMatrix,34962),l.instanceColor!==null&&e.update(l.instanceColor,34962)),h}function s(){r=new WeakMap}function a(l){let c=l.target;c.removeEventListener("dispose",a),e.remove(c.instanceMatrix),c.instanceColor!==null&&e.remove(c.instanceColor)}return{update:o,dispose:s}}var Fv=class extends ln{constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=In,this.minFilter=In,this.wrapR=Li,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};Fv.prototype.isDataTexture3D=!0;var O7=new ln,B7=new xd,V7=new Fv,H7=new Ku,HO=[],$O=[],UO=new Float32Array(16),WO=new Float32Array(9),GO=new Float32Array(4);function oh(i,t,e){let n=i[0];if(n<=0||n>0)return i;let r=t*e,o=HO[r];if(o===void 0&&(o=new Float32Array(r),HO[r]=o),t!==0){n.toArray(o,0);for(let s=1,a=0;s!==t;++s)a+=e,i[s].toArray(o,a)}return o}function fi(i,t){if(i.length!==t.length)return!1;for(let e=0,n=i.length;e<n;e++)if(i[e]!==t[e])return!1;return!0}function ri(i,t){for(let e=0,n=t.length;e<n;e++)i[e]=t[e]}function a2(i,t){let e=$O[t];e===void 0&&(e=new Int32Array(t),$O[t]=e);for(let n=0;n!==t;++n)e[n]=i.allocateTextureUnit();return e}function gut(i,t){let e=this.cache;e[0]!==t&&(i.uniform1f(this.addr,t),e[0]=t)}function xut(i,t){let e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y)&&(i.uniform2f(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(fi(e,t))return;i.uniform2fv(this.addr,t),ri(e,t)}}function yut(i,t){let e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(i.uniform3f(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else if(t.r!==void 0)(e[0]!==t.r||e[1]!==t.g||e[2]!==t.b)&&(i.uniform3f(this.addr,t.r,t.g,t.b),e[0]=t.r,e[1]=t.g,e[2]=t.b);else{if(fi(e,t))return;i.uniform3fv(this.addr,t),ri(e,t)}}function vut(i,t){let e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(i.uniform4f(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(fi(e,t))return;i.uniform4fv(this.addr,t),ri(e,t)}}function but(i,t){let e=this.cache,n=t.elements;if(n===void 0){if(fi(e,t))return;i.uniformMatrix2fv(this.addr,!1,t),ri(e,t)}else{if(fi(e,n))return;GO.set(n),i.uniformMatrix2fv(this.addr,!1,GO),ri(e,n)}}function _ut(i,t){let e=this.cache,n=t.elements;if(n===void 0){if(fi(e,t))return;i.uniformMatrix3fv(this.addr,!1,t),ri(e,t)}else{if(fi(e,n))return;WO.set(n),i.uniformMatrix3fv(this.addr,!1,WO),ri(e,n)}}function wut(i,t){let e=this.cache,n=t.elements;if(n===void 0){if(fi(e,t))return;i.uniformMatrix4fv(this.addr,!1,t),ri(e,t)}else{if(fi(e,n))return;UO.set(n),i.uniformMatrix4fv(this.addr,!1,UO),ri(e,n)}}function Sut(i,t){let e=this.cache;e[0]!==t&&(i.uniform1i(this.addr,t),e[0]=t)}function Cut(i,t){let e=this.cache;fi(e,t)||(i.uniform2iv(this.addr,t),ri(e,t))}function Mut(i,t){let e=this.cache;fi(e,t)||(i.uniform3iv(this.addr,t),ri(e,t))}function Eut(i,t){let e=this.cache;fi(e,t)||(i.uniform4iv(this.addr,t),ri(e,t))}function Tut(i,t){let e=this.cache;e[0]!==t&&(i.uniform1ui(this.addr,t),e[0]=t)}function Iut(i,t){let e=this.cache;fi(e,t)||(i.uniform2uiv(this.addr,t),ri(e,t))}function Aut(i,t){let e=this.cache;fi(e,t)||(i.uniform3uiv(this.addr,t),ri(e,t))}function kut(i,t){let e=this.cache;fi(e,t)||(i.uniform4uiv(this.addr,t),ri(e,t))}function Rut(i,t,e){let n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.safeSetTexture2D(t||O7,r)}function Put(i,t,e){let n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture3D(t||V7,r)}function Nut(i,t,e){let n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.safeSetTextureCube(t||H7,r)}function Lut(i,t,e){let n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture2DArray(t||B7,r)}function Dut(i){switch(i){case 5126:return gut;case 35664:return xut;case 35665:return yut;case 35666:return vut;case 35674:return but;case 35675:return _ut;case 35676:return wut;case 5124:case 35670:return Sut;case 35667:case 35671:return Cut;case 35668:case 35672:return Mut;case 35669:case 35673:return Eut;case 5125:return Tut;case 36294:return Iut;case 36295:return Aut;case 36296:return kut;case 35678:case 36198:case 36298:case 36306:case 35682:return Rut;case 35679:case 36299:case 36307:return Put;case 35680:case 36300:case 36308:case 36293:return Nut;case 36289:case 36303:case 36311:case 36292:return Lut}}function zut(i,t){i.uniform1fv(this.addr,t)}function Fut(i,t){let e=oh(t,this.size,2);i.uniform2fv(this.addr,e)}function Out(i,t){let e=oh(t,this.size,3);i.uniform3fv(this.addr,e)}function But(i,t){let e=oh(t,this.size,4);i.uniform4fv(this.addr,e)}function Vut(i,t){let e=oh(t,this.size,4);i.uniformMatrix2fv(this.addr,!1,e)}function Hut(i,t){let e=oh(t,this.size,9);i.uniformMatrix3fv(this.addr,!1,e)}function $ut(i,t){let e=oh(t,this.size,16);i.uniformMatrix4fv(this.addr,!1,e)}function Uut(i,t){i.uniform1iv(this.addr,t)}function Wut(i,t){i.uniform2iv(this.addr,t)}function Gut(i,t){i.uniform3iv(this.addr,t)}function jut(i,t){i.uniform4iv(this.addr,t)}function qut(i,t){i.uniform1uiv(this.addr,t)}function Xut(i,t){i.uniform2uiv(this.addr,t)}function Kut(i,t){i.uniform3uiv(this.addr,t)}function Yut(i,t){i.uniform4uiv(this.addr,t)}function Zut(i,t,e){let n=t.length,r=a2(e,n);i.uniform1iv(this.addr,r);for(let o=0;o!==n;++o)e.safeSetTexture2D(t[o]||O7,r[o])}function Jut(i,t,e){let n=t.length,r=a2(e,n);i.uniform1iv(this.addr,r);for(let o=0;o!==n;++o)e.setTexture3D(t[o]||V7,r[o])}function Qut(i,t,e){let n=t.length,r=a2(e,n);i.uniform1iv(this.addr,r);for(let o=0;o!==n;++o)e.safeSetTextureCube(t[o]||H7,r[o])}function tht(i,t,e){let n=t.length,r=a2(e,n);i.uniform1iv(this.addr,r);for(let o=0;o!==n;++o)e.setTexture2DArray(t[o]||B7,r[o])}function eht(i){switch(i){case 5126:return zut;case 35664:return Fut;case 35665:return Out;case 35666:return But;case 35674:return Vut;case 35675:return Hut;case 35676:return $ut;case 5124:case 35670:return Uut;case 35667:case 35671:return Wut;case 35668:case 35672:return Gut;case 35669:case 35673:return jut;case 5125:return qut;case 36294:return Xut;case 36295:return Kut;case 36296:return Yut;case 35678:case 36198:case 36298:case 36306:case 35682:return Zut;case 35679:case 36299:case 36307:return Jut;case 35680:case 36300:case 36308:case 36293:return Qut;case 36289:case 36303:case 36311:case 36292:return tht}}function nht(i,t,e){this.id=i,this.addr=e,this.cache=[],this.setValue=Dut(t.type)}function $7(i,t,e){this.id=i,this.addr=e,this.cache=[],this.size=t.size,this.setValue=eht(t.type)}$7.prototype.updateCache=function(i){let t=this.cache;i instanceof Float32Array&&t.length!==i.length&&(this.cache=new Float32Array(i.length)),ri(t,i)};function U7(i){this.id=i,this.seq=[],this.map={}}U7.prototype.setValue=function(i,t,e){let n=this.seq;for(let r=0,o=n.length;r!==o;++r){let s=n[r];s.setValue(i,t[s.id],e)}};var $3=/(\w+)(\])?(\[|\.)?/g;function jO(i,t){i.seq.push(t),i.map[t.id]=t}function iht(i,t,e){let n=i.name,r=n.length;for($3.lastIndex=0;;){let o=$3.exec(n),s=$3.lastIndex,a=o[1],l=o[2]==="]",c=o[3];if(l&&(a=a|0),c===void 0||c==="["&&s+2===r){jO(e,c===void 0?new nht(a,i,t):new $7(a,i,t));break}else{let h=e.map[a];h===void 0&&(h=new U7(a),jO(e,h)),e=h}}}function Us(i,t){this.seq=[],this.map={};let e=i.getProgramParameter(t,35718);for(let n=0;n<e;++n){let r=i.getActiveUniform(t,n),o=i.getUniformLocation(t,r.name);iht(r,o,this)}}Us.prototype.setValue=function(i,t,e,n){let r=this.map[t];r!==void 0&&r.setValue(i,e,n)};Us.prototype.setOptional=function(i,t,e){let n=t[e];n!==void 0&&this.setValue(i,e,n)};Us.upload=function(i,t,e,n){for(let r=0,o=t.length;r!==o;++r){let s=t[r],a=e[s.id];a.needsUpdate!==!1&&s.setValue(i,a.value,n)}};Us.seqWithValue=function(i,t){let e=[];for(let n=0,r=i.length;n!==r;++n){let o=i[n];o.id in t&&e.push(o)}return e};function qO(i,t,e){let n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),n}var rht=0;function oht(i){let t=i.split(`
`);for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join(`
`)}function sht(i){switch(i){case Ws:return["Linear","( value )"];case Ze:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}function XO(i,t,e){let n=i.getShaderParameter(t,35713),r=i.getShaderInfoLog(t).trim();return n&&r===""?"":e.toUpperCase()+`

`+r+`

`+oht(i.getShaderSource(t))}function aht(i,t){let e=sht(t);return"vec4 "+i+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}function lht(i,t){let e;switch(t){case Lst:e="Linear";break;case Dst:e="Reinhard";break;case zst:e="OptimizedCineon";break;case Fst:e="ACESFilmic";break;case Ost:e="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),e="Linear"}return"vec3 "+i+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}function cht(i){return[i.extensionDerivatives||i.envMapCubeUV||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(rd).join(`
`)}function uht(i){let t=[];for(let e in i){let n=i[e];n!==!1&&t.push("#define "+e+" "+n)}return t.join(`
`)}function hht(i,t){let e={},n=i.getProgramParameter(t,35721);for(let r=0;r<n;r++){let o=i.getActiveAttrib(t,r),s=o.name,a=1;o.type===35674&&(a=2),o.type===35675&&(a=3),o.type===35676&&(a=4),e[s]={type:o.type,location:i.getAttribLocation(t,s),locationSize:a}}return e}function rd(i){return i!==""}function KO(i,t){return i.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function YO(i,t){return i.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var pht=/^[ \t]*#include +<([\w\d./]+)>/gm;function oM(i){return i.replace(pht,fht)}function fht(i,t){let e=pe[t];if(e===void 0)throw new Error("Can not resolve #include <"+t+">");return oM(e)}var dht=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,mht=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ZO(i){return i.replace(mht,W7).replace(dht,ght)}function ght(i,t,e,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),W7(i,t,e,n)}function W7(i,t,e,n){let r="";for(let o=parseInt(t);o<parseInt(e);o++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function JO(i){let t="precision "+i.precision+` float;
precision `+i.precision+" int;";return i.precision==="highp"?t+=`
#define HIGH_PRECISION`:i.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function xht(i){let t="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===T7?t="SHADOWMAP_TYPE_PCF":i.shadowMapType===pst?t="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===id&&(t="SHADOWMAP_TYPE_VSM"),t}function yht(i){let t="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case zd:case Fd:t="ENVMAP_TYPE_CUBE";break;case o2:case c4:t="ENVMAP_TYPE_CUBE_UV";break}return t}function vht(i){let t="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case Fd:case c4:t="ENVMAP_MODE_REFRACTION";break}return t}function bht(i){let t="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case r2:t="ENVMAP_BLENDING_MULTIPLY";break;case Pst:t="ENVMAP_BLENDING_MIX";break;case Nst:t="ENVMAP_BLENDING_ADD";break}return t}function _ht(i,t,e,n){let r=i.getContext(),o=e.defines,s=e.vertexShader,a=e.fragmentShader,l=xht(e),c=yht(e),u=vht(e),h=bht(e),p=e.isWebGL2?"":cht(e),f=uht(o),d=r.createProgram(),m,x,g=e.glslVersion?"#version "+e.glslVersion+`
`:"";e.isRawShaderMaterial?(m=[f].filter(rd).join(`
`),m.length>0&&(m+=`
`),x=[p,f].filter(rd).join(`
`),x.length>0&&(x+=`
`)):(m=[JO(e),"#define SHADER_NAME "+e.shaderName,f,e.instancing?"#define USE_INSTANCING":"",e.instancingColor?"#define USE_INSTANCING_COLOR":"",e.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+e.maxBones,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+u:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.displacementMap&&e.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",e.specularColorMap?"#define USE_SPECULARCOLORMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.sheenColorMap?"#define USE_SHEENCOLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.useVertexTexture?"#define BONE_TEXTURE":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&e.flatShading===!1?"#define USE_MORPHNORMALS":"",e.morphTargets&&e.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",e.morphTargets&&e.isWebGL2?"#define MORPHTARGETS_COUNT "+e.morphTargetsCount:"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+l:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(rd).join(`
`),x=[p,JO(e),"#define SHADER_NAME "+e.shaderName,f,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+c:"",e.envMap?"#define "+u:"",e.envMap?"#define "+h:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoat?"#define USE_CLEARCOAT":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",e.specularColorMap?"#define USE_SPECULARCOLORMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.alphaTest?"#define USE_ALPHATEST":"",e.sheen?"#define USE_SHEEN":"",e.sheenColorMap?"#define USE_SHEENCOLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors||e.instancingColor?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+l:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",e.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",e.toneMapping!==Vs?"#define TONE_MAPPING":"",e.toneMapping!==Vs?pe.tonemapping_pars_fragment:"",e.toneMapping!==Vs?lht("toneMapping",e.toneMapping):"",e.dithering?"#define DITHERING":"",e.alphaWrite?"":"#define OPAQUE",pe.encodings_pars_fragment,aht("linearToOutputTexel",e.outputEncoding),e.depthPacking?"#define DEPTH_PACKING "+e.depthPacking:"",`
`].filter(rd).join(`
`)),s=oM(s),s=KO(s,e),s=YO(s,e),a=oM(a),a=KO(a,e),a=YO(a,e),s=ZO(s),a=ZO(a),e.isWebGL2&&e.isRawShaderMaterial!==!0&&(g=`#version 300 es
`,m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,x=["#define varying in",e.glslVersion===_O?"":"layout(location = 0) out highp vec4 pc_fragColor;",e.glslVersion===_O?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+x);let y=g+m+s,b=g+x+a,v=qO(r,35633,y),_=qO(r,35632,b);if(r.attachShader(d,v),r.attachShader(d,_),e.index0AttributeName!==void 0?r.bindAttribLocation(d,0,e.index0AttributeName):e.morphTargets===!0&&r.bindAttribLocation(d,0,"position"),r.linkProgram(d),i.debug.checkShaderErrors){let M=r.getProgramInfoLog(d).trim(),N=r.getShaderInfoLog(v).trim(),I=r.getShaderInfoLog(_).trim(),w=!0,R=!0;if(r.getProgramParameter(d,35714)===!1){w=!1;let P=XO(r,v,"vertex"),D=XO(r,_,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(d,35715)+`

Program Info Log: `+M+`
`+P+`
`+D)}else M!==""?console.warn("THREE.WebGLProgram: Program Info Log:",M):(N===""||I==="")&&(R=!1);R&&(this.diagnostics={runnable:w,programLog:M,vertexShader:{log:N,prefix:m},fragmentShader:{log:I,prefix:x}})}r.deleteShader(v),r.deleteShader(_);let S;this.getUniforms=function(){return S===void 0&&(S=new Us(r,d)),S};let E;return this.getAttributes=function(){return E===void 0&&(E=hht(r,d)),E},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(d),this.program=void 0},this.name=e.shaderName,this.id=rht++,this.cacheKey=t,this.usedTimes=1,this.program=d,this.vertexShader=v,this.fragmentShader=_,this}var wht=0,sM=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){let e=t.vertexShader,n=t.fragmentShader,r=this._getShaderStage(e),o=this._getShaderStage(n),s=this._getShaderCacheForMaterial(t);return s.has(r)===!1&&(s.add(r),r.usedTimes++),s.has(o)===!1&&(s.add(o),o.usedTimes++),this}remove(t){let e=this.materialCache.get(t);for(let n of e)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){let e=this.materialCache;return e.has(t)===!1&&e.set(t,new Set),e.get(t)}_getShaderStage(t){let e=this.shaderCache;if(e.has(t)===!1){let n=new aM;e.set(t,n)}return e.get(t)}},aM=class{constructor(){this.id=wht++,this.usedTimes=0}};function Sht(i,t,e,n,r,o,s){let a=new Pv,l=new sM,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,p=r.floatVertexTextures,f=r.maxVertexUniforms,d=r.vertexTextures,m=r.precision,x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(w){let P=w.skeleton.bones;if(p)return 1024;{let F=Math.floor((f-20)/4),z=Math.min(F,P.length);return z<P.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+P.length+" bones. This GPU supports "+z+"."),0):z}}function y(w,R,P,D,F){let z=D.fog,V=w.isMeshStandardMaterial?D.environment:null,H=(w.isMeshStandardMaterial?e:t).get(w.envMap||V),X=x[w.type],U=F.isSkinnedMesh?g(F):0;w.precision!==null&&(m=r.getMaxPrecision(w.precision),m!==w.precision&&console.warn("THREE.WebGLProgram.getParameters:",w.precision,"not supported, using",m,"instead."));let Y,Z,K,J;if(X){let it=no[X];Y=it.vertexShader,Z=it.fragmentShader}else Y=w.vertexShader,Z=w.fragmentShader,l.update(w),K=l.getVertexShaderID(w),J=l.getFragmentShaderID(w);let G=i.getRenderTarget(),nt=w.alphaTest>0,et=w.clearcoat>0;return{isWebGL2:u,shaderID:X,shaderName:w.type,vertexShader:Y,fragmentShader:Z,defines:w.defines,customVertexShaderID:K,customFragmentShaderID:J,isRawShaderMaterial:w.isRawShaderMaterial===!0,glslVersion:w.glslVersion,precision:m,instancing:F.isInstancedMesh===!0,instancingColor:F.isInstancedMesh===!0&&F.instanceColor!==null,supportsVertexTextures:d,outputEncoding:G===null?i.outputEncoding:G.isXRRenderTarget===!0?G.texture.encoding:Ws,map:!!w.map,matcap:!!w.matcap,envMap:!!H,envMapMode:H&&H.mapping,envMapCubeUV:!!H&&(H.mapping===o2||H.mapping===c4),lightMap:!!w.lightMap,aoMap:!!w.aoMap,emissiveMap:!!w.emissiveMap,bumpMap:!!w.bumpMap,normalMap:!!w.normalMap,objectSpaceNormalMap:w.normalMapType===sat,tangentSpaceNormalMap:w.normalMapType===rh,decodeVideoTexture:!!w.map&&w.map.isVideoTexture===!0&&w.map.encoding===Ze,clearcoat:et,clearcoatMap:et&&!!w.clearcoatMap,clearcoatRoughnessMap:et&&!!w.clearcoatRoughnessMap,clearcoatNormalMap:et&&!!w.clearcoatNormalMap,displacementMap:!!w.displacementMap,roughnessMap:!!w.roughnessMap,metalnessMap:!!w.metalnessMap,specularMap:!!w.specularMap,specularIntensityMap:!!w.specularIntensityMap,specularColorMap:!!w.specularColorMap,alphaMap:!!w.alphaMap,alphaTest:nt,alphaWrite:w.alphaWrite||w.transparent,gradientMap:!!w.gradientMap,sheen:w.sheen>0,sheenColorMap:!!w.sheenColorMap,sheenRoughnessMap:!!w.sheenRoughnessMap,transmission:w.transmission>0,transmissionMap:!!w.transmissionMap,thicknessMap:!!w.thicknessMap,combine:w.combine,vertexTangents:!!w.normalMap&&!!F.geometry&&!!F.geometry.attributes.tangent,vertexColors:w.vertexColors,vertexAlphas:w.vertexColors===!0&&!!F.geometry&&!!F.geometry.attributes.color&&F.geometry.attributes.color.itemSize===4,vertexUvs:!!w.map||!!w.bumpMap||!!w.normalMap||!!w.specularMap||!!w.alphaMap||!!w.emissiveMap||!!w.roughnessMap||!!w.metalnessMap||!!w.clearcoatMap||!!w.clearcoatRoughnessMap||!!w.clearcoatNormalMap||!!w.displacementMap||!!w.transmissionMap||!!w.thicknessMap||!!w.specularIntensityMap||!!w.specularColorMap||!!w.sheenColorMap||!!w.sheenRoughnessMap,uvsVertexOnly:!(!!w.map||!!w.bumpMap||!!w.normalMap||!!w.specularMap||!!w.alphaMap||!!w.emissiveMap||!!w.roughnessMap||!!w.metalnessMap||!!w.clearcoatNormalMap||w.transmission>0||!!w.transmissionMap||!!w.thicknessMap||!!w.specularIntensityMap||!!w.specularColorMap||w.sheen>0||!!w.sheenColorMap||!!w.sheenRoughnessMap)&&!!w.displacementMap,fog:!!z,useFog:w.fog,fogExp2:z&&z.isFogExp2,flatShading:!!w.flatShading,sizeAttenuation:w.sizeAttenuation,logarithmicDepthBuffer:h,skinning:F.isSkinnedMesh===!0&&U>0,maxBones:U,useVertexTexture:p,morphTargets:!!F.geometry&&!!F.geometry.morphAttributes.position,morphNormals:!!F.geometry&&!!F.geometry.morphAttributes.normal,morphTargetsCount:!!F.geometry&&!!F.geometry.morphAttributes.position?F.geometry.morphAttributes.position.length:0,numDirLights:R.directional.length,numPointLights:R.point.length,numSpotLights:R.spot.length,numRectAreaLights:R.rectArea.length,numHemiLights:R.hemi.length,numDirLightShadows:R.directionalShadowMap.length,numPointLightShadows:R.pointShadowMap.length,numSpotLightShadows:R.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:w.dithering,shadowMapEnabled:i.shadowMap.enabled&&P.length>0,shadowMapType:i.shadowMap.type,toneMapping:w.toneMapped?i.toneMapping:Vs,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:w.premultipliedAlpha,doubleSided:w.side===ju,flipSided:w.side===Tn,depthPacking:w.depthPacking!==void 0?w.depthPacking:!1,index0AttributeName:w.index0AttributeName,extensionDerivatives:w.extensions&&w.extensions.derivatives,extensionFragDepth:w.extensions&&w.extensions.fragDepth,extensionDrawBuffers:w.extensions&&w.extensions.drawBuffers,extensionShaderTextureLOD:w.extensions&&w.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:w.customProgramCacheKey()}}function b(w){let R=[];if(w.shaderID?R.push(w.shaderID):(R.push(w.customVertexShaderID),R.push(w.customFragmentShaderID)),w.defines!==void 0)for(let P in w.defines)R.push(P),R.push(w.defines[P]);return w.isRawShaderMaterial===!1&&(v(R,w),_(R,w),R.push(i.outputEncoding)),R.push(w.customProgramCacheKey),R.join()}function v(w,R){w.push(R.precision),w.push(R.outputEncoding),w.push(R.envMapMode),w.push(R.combine),w.push(R.vertexUvs),w.push(R.fogExp2),w.push(R.sizeAttenuation),w.push(R.maxBones),w.push(R.morphTargetsCount),w.push(R.numDirLights),w.push(R.numPointLights),w.push(R.numSpotLights),w.push(R.numHemiLights),w.push(R.numRectAreaLights),w.push(R.numDirLightShadows),w.push(R.numPointLightShadows),w.push(R.numSpotLightShadows),w.push(R.shadowMapType),w.push(R.toneMapping),w.push(R.numClippingPlanes),w.push(R.numClipIntersection),w.push(R.alphaWrite)}function _(w,R){a.disableAll(),R.isWebGL2&&a.enable(0),R.supportsVertexTextures&&a.enable(1),R.instancing&&a.enable(2),R.instancingColor&&a.enable(3),R.map&&a.enable(4),R.matcap&&a.enable(5),R.envMap&&a.enable(6),R.envMapCubeUV&&a.enable(7),R.lightMap&&a.enable(8),R.aoMap&&a.enable(9),R.emissiveMap&&a.enable(10),R.bumpMap&&a.enable(11),R.normalMap&&a.enable(12),R.objectSpaceNormalMap&&a.enable(13),R.tangentSpaceNormalMap&&a.enable(14),R.clearcoat&&a.enable(15),R.clearcoatMap&&a.enable(16),R.clearcoatRoughnessMap&&a.enable(17),R.clearcoatNormalMap&&a.enable(18),R.displacementMap&&a.enable(19),R.specularMap&&a.enable(20),R.roughnessMap&&a.enable(21),R.metalnessMap&&a.enable(22),R.gradientMap&&a.enable(23),R.alphaMap&&a.enable(24),R.alphaTest&&a.enable(25),R.vertexColors&&a.enable(26),R.vertexAlphas&&a.enable(27),R.vertexUvs&&a.enable(28),R.vertexTangents&&a.enable(29),R.uvsVertexOnly&&a.enable(30),R.fog&&a.enable(31),w.push(a.mask),a.disableAll(),R.useFog&&a.enable(0),R.flatShading&&a.enable(1),R.logarithmicDepthBuffer&&a.enable(2),R.skinning&&a.enable(3),R.useVertexTexture&&a.enable(4),R.morphTargets&&a.enable(5),R.morphNormals&&a.enable(6),R.premultipliedAlpha&&a.enable(7),R.shadowMapEnabled&&a.enable(8),R.physicallyCorrectLights&&a.enable(9),R.doubleSided&&a.enable(10),R.flipSided&&a.enable(11),R.depthPacking&&a.enable(12),R.dithering&&a.enable(13),R.specularIntensityMap&&a.enable(14),R.specularColorMap&&a.enable(15),R.transmission&&a.enable(16),R.transmissionMap&&a.enable(17),R.thicknessMap&&a.enable(18),R.sheen&&a.enable(19),R.sheenColorMap&&a.enable(20),R.sheenRoughnessMap&&a.enable(21),R.decodeVideoTexture&&a.enable(22),w.push(a.mask)}function S(w){let R=x[w.type],P;if(R){let D=no[R];P=_at.clone(D.uniforms)}else P=w.uniforms;return P}function E(w,R){let P;for(let D=0,F=c.length;D<F;D++){let z=c[D];if(z.cacheKey===R){P=z,++P.usedTimes;break}}return P===void 0&&(P=new _ht(i,R,w,o),c.push(P)),P}function M(w){if(--w.usedTimes===0){let R=c.indexOf(w);c[R]=c[c.length-1],c.pop(),w.destroy()}}function N(w){l.remove(w)}function I(){l.dispose()}return{getParameters:y,getProgramCacheKey:b,getUniforms:S,acquireProgram:E,releaseProgram:M,releaseShaderCache:N,programs:c,dispose:I}}function Cht(){let i=new WeakMap;function t(o){let s=i.get(o);return s===void 0&&(s={},i.set(o,s)),s}function e(o){i.delete(o)}function n(o,s,a){i.get(o)[s]=a}function r(){i=new WeakMap}return{get:t,remove:e,update:n,dispose:r}}function Mht(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.material.id!==t.material.id?i.material.id-t.material.id:i.z!==t.z?i.z-t.z:i.id-t.id}function QO(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.z!==t.z?t.z-i.z:i.id-t.id}function t7(){let i=[],t=0,e=[],n=[],r=[];function o(){t=0,e.length=0,n.length=0,r.length=0}function s(h,p,f,d,m,x){let g=i[t];return g===void 0?(g={id:h.id,object:h,geometry:p,material:f,groupOrder:d,renderOrder:h.renderOrder,z:m,group:x},i[t]=g):(g.id=h.id,g.object=h,g.geometry=p,g.material=f,g.groupOrder=d,g.renderOrder=h.renderOrder,g.z=m,g.group=x),t++,g}function a(h,p,f,d,m,x){let g=s(h,p,f,d,m,x);f.transmission>0?n.push(g):f.transparent===!0?r.push(g):e.push(g)}function l(h,p,f,d,m,x){let g=s(h,p,f,d,m,x);f.transmission>0?n.unshift(g):f.transparent===!0?r.unshift(g):e.unshift(g)}function c(h,p){e.length>1&&e.sort(h||Mht),n.length>1&&n.sort(p||QO),r.length>1&&r.sort(p||QO)}function u(){for(let h=t,p=i.length;h<p;h++){let f=i[h];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:e,transmissive:n,transparent:r,init:o,push:a,unshift:l,finish:u,sort:c}}function Eht(){let i=new WeakMap;function t(n,r){let o;return i.has(n)===!1?(o=new t7,i.set(n,[o])):r>=i.get(n).length?(o=new t7,i.get(n).push(o)):o=i.get(n)[r],o}function e(){i=new WeakMap}return{get:t,dispose:e}}function Tht(){let i={};return{get:function(t){if(i[t.id]!==void 0)return i[t.id];let e;switch(t.type){case"DirectionalLight":e={direction:new q,color:new zt};break;case"SpotLight":e={position:new q,direction:new q,color:new zt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new q,color:new zt,distance:0,decay:0};break;case"HemisphereLight":e={direction:new q,skyColor:new zt,groundColor:new zt};break;case"RectAreaLight":e={color:new zt,position:new q,halfWidth:new q,halfHeight:new q};break}return i[t.id]=e,e}}}function Iht(){let i={};return{get:function(t){if(i[t.id]!==void 0)return i[t.id];let e;switch(t.type){case"DirectionalLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Et};break;case"SpotLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Et};break;case"PointLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Et,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[t.id]=e,e}}}var Aht=0;function kht(i,t){return(t.castShadow?1:0)-(i.castShadow?1:0)}function Rht(i,t){let e=new Tht,n=Iht(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)r.probe.push(new q);let o=new q,s=new te,a=new te;function l(u,h){let p=0,f=0,d=0;for(let N=0;N<9;N++)r.probe[N].set(0,0,0);let m=0,x=0,g=0,y=0,b=0,v=0,_=0,S=0;u.sort(kht);let E=h!==!0?Math.PI:1;for(let N=0,I=u.length;N<I;N++){let w=u[N],R=w.color,P=w.intensity,D=w.distance,F=w.shadow&&w.shadow.map?w.shadow.map.texture:null;if(w.isAmbientLight)p+=R.r*P*E,f+=R.g*P*E,d+=R.b*P*E;else if(w.isLightProbe)for(let z=0;z<9;z++)r.probe[z].addScaledVector(w.sh.coefficients[z],P);else if(w.isDirectionalLight){let z=e.get(w);if(z.color.copy(w.color).multiplyScalar(w.intensity*E),w.castShadow){let V=w.shadow,H=n.get(w);H.shadowBias=V.bias,H.shadowNormalBias=V.normalBias,H.shadowRadius=V.radius,H.shadowMapSize=V.mapSize,r.directionalShadow[m]=H,r.directionalShadowMap[m]=F,r.directionalShadowMatrix[m]=w.shadow.matrix,v++}r.directional[m]=z,m++}else if(w.isSpotLight){let z=e.get(w);if(z.position.setFromMatrixPosition(w.matrixWorld),z.color.copy(R).multiplyScalar(P*E),z.distance=D,z.coneCos=Math.cos(w.angle),z.penumbraCos=Math.cos(w.angle*(1-w.penumbra)),z.decay=w.decay,w.castShadow){let V=w.shadow,H=n.get(w);H.shadowBias=V.bias,H.shadowNormalBias=V.normalBias,H.shadowRadius=V.radius,H.shadowMapSize=V.mapSize,r.spotShadow[g]=H,r.spotShadowMap[g]=F,r.spotShadowMatrix[g]=w.shadow.matrix,S++}r.spot[g]=z,g++}else if(w.isRectAreaLight){let z=e.get(w);z.color.copy(R).multiplyScalar(P),z.halfWidth.set(w.width*.5,0,0),z.halfHeight.set(0,w.height*.5,0),r.rectArea[y]=z,y++}else if(w.isPointLight){let z=e.get(w);if(z.color.copy(w.color).multiplyScalar(w.intensity*E),z.distance=w.distance,z.decay=w.decay,w.castShadow){let V=w.shadow,H=n.get(w);H.shadowBias=V.bias,H.shadowNormalBias=V.normalBias,H.shadowRadius=V.radius,H.shadowMapSize=V.mapSize,H.shadowCameraNear=V.camera.near,H.shadowCameraFar=V.camera.far,r.pointShadow[x]=H,r.pointShadowMap[x]=F,r.pointShadowMatrix[x]=w.shadow.matrix,_++}r.point[x]=z,x++}else if(w.isHemisphereLight){let z=e.get(w);z.skyColor.copy(w.color).multiplyScalar(P*E),z.groundColor.copy(w.groundColor).multiplyScalar(P*E),r.hemi[b]=z,b++}}y>0&&(t.isWebGL2||i.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Lt.LTC_FLOAT_1,r.rectAreaLTC2=Lt.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=Lt.LTC_HALF_1,r.rectAreaLTC2=Lt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=f,r.ambient[2]=d;let M=r.hash;(M.directionalLength!==m||M.pointLength!==x||M.spotLength!==g||M.rectAreaLength!==y||M.hemiLength!==b||M.numDirectionalShadows!==v||M.numPointShadows!==_||M.numSpotShadows!==S)&&(r.directional.length=m,r.spot.length=g,r.rectArea.length=y,r.point.length=x,r.hemi.length=b,r.directionalShadow.length=v,r.directionalShadowMap.length=v,r.pointShadow.length=_,r.pointShadowMap.length=_,r.spotShadow.length=S,r.spotShadowMap.length=S,r.directionalShadowMatrix.length=v,r.pointShadowMatrix.length=_,r.spotShadowMatrix.length=S,M.directionalLength=m,M.pointLength=x,M.spotLength=g,M.rectAreaLength=y,M.hemiLength=b,M.numDirectionalShadows=v,M.numPointShadows=_,M.numSpotShadows=S,r.version=Aht++)}function c(u,h){let p=0,f=0,d=0,m=0,x=0,g=h.matrixWorldInverse;for(let y=0,b=u.length;y<b;y++){let v=u[y];if(v.isDirectionalLight){let _=r.directional[p];_.direction.setFromMatrixPosition(v.matrixWorld),o.setFromMatrixPosition(v.target.matrixWorld),_.direction.sub(o),_.direction.transformDirection(g),p++}else if(v.isSpotLight){let _=r.spot[d];_.position.setFromMatrixPosition(v.matrixWorld),_.position.applyMatrix4(g),_.direction.setFromMatrixPosition(v.matrixWorld),o.setFromMatrixPosition(v.target.matrixWorld),_.direction.sub(o),_.direction.transformDirection(g),d++}else if(v.isRectAreaLight){let _=r.rectArea[m];_.position.setFromMatrixPosition(v.matrixWorld),_.position.applyMatrix4(g),a.identity(),s.copy(v.matrixWorld),s.premultiply(g),a.extractRotation(s),_.halfWidth.set(v.width*.5,0,0),_.halfHeight.set(0,v.height*.5,0),_.halfWidth.applyMatrix4(a),_.halfHeight.applyMatrix4(a),m++}else if(v.isPointLight){let _=r.point[f];_.position.setFromMatrixPosition(v.matrixWorld),_.position.applyMatrix4(g),f++}else if(v.isHemisphereLight){let _=r.hemi[x];_.direction.setFromMatrixPosition(v.matrixWorld),_.direction.transformDirection(g),_.direction.normalize(),x++}}}return{setup:l,setupView:c,state:r}}function e7(i,t){let e=new Rht(i,t),n=[],r=[];function o(){n.length=0,r.length=0}function s(h){n.push(h)}function a(h){r.push(h)}function l(h){e.setup(n,h)}function c(h){e.setupView(n,h)}return{init:o,state:{lightsArray:n,shadowsArray:r,lights:e},setupLights:l,setupLightsView:c,pushLight:s,pushShadow:a}}function Pht(i,t){let e=new WeakMap;function n(o,s=0){let a;return e.has(o)===!1?(a=new e7(i,t),e.set(o,[a])):s>=e.get(o).length?(a=new e7(i,t),e.get(o).push(a)):a=e.get(o)[s],a}function r(){e=new WeakMap}return{get:n,dispose:r}}var Ov=class extends Hn{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=rat,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}};Ov.prototype.isMeshDepthMaterial=!0;var Bv=class extends Hn{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new q,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}};Bv.prototype.isMeshDistanceMaterial=!0;var Nht=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Lht=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function G7(i,t,e){let n=new Yu,r=new Et,o=new Et,s=new ze,a=new Ov({depthPacking:oat}),l=new Bv,c={},u=e.maxTextureSize,h={0:Tn,1:ld,2:ju},p=new er({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Et},radius:{value:4}},vertexShader:Nht,fragmentShader:Lht}),f=p.clone();f.defines.HORIZONTAL_PASS=1;let d=new Pe;d.setAttribute("position",new we(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new ni(d,p),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=T7,this.render=function(v,_,S){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||v.length===0)return;let E=i.getRenderTarget(),M=i.getActiveCubeFace(),N=i.getActiveMipmapLevel(),I=i.state;I.setBlending(Os),I.buffers.color.setClear(1,1,1,1),I.buffers.depth.setTest(!0),I.setScissorTest(!1);for(let w=0,R=v.length;w<R;w++){let P=v[w],D=P.shadow;if(D===void 0){console.warn("THREE.WebGLShadowMap:",P,"has no shadow.");continue}if(D.autoUpdate===!1&&D.needsUpdate===!1)continue;r.copy(D.mapSize);let F=D.getFrameExtents();if(r.multiply(F),o.copy(D.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(o.x=Math.floor(u/F.x),r.x=o.x*F.x,D.mapSize.x=o.x),r.y>u&&(o.y=Math.floor(u/F.y),r.y=o.y*F.y,D.mapSize.y=o.y)),D.map===null&&!D.isPointLightShadow&&this.type===id){let V={minFilter:_n,magFilter:_n,format:pi};D.map=new ii(r.x,r.y,V),D.map.texture.name=P.name+".shadowMap",D.mapPass=new ii(r.x,r.y,V),D.camera.updateProjectionMatrix()}if(D.map===null){let V={minFilter:In,magFilter:In,format:pi};D.map=new ii(r.x,r.y,V),D.map.texture.name=P.name+".shadowMap",D.camera.updateProjectionMatrix()}i.setRenderTarget(D.map),i.clear();let z=D.getViewportCount();for(let V=0;V<z;V++){let H=D.getViewport(V);s.set(o.x*H.x,o.y*H.y,o.x*H.z,o.y*H.w),I.viewport(s),D.updateMatrices(P,V),n=D.getFrustum(),b(_,S,D.camera,P,this.type)}!D.isPointLightShadow&&this.type===id&&g(D,S),D.needsUpdate=!1}x.needsUpdate=!1,i.setRenderTarget(E,M,N)};function g(v,_){let S=t.update(m);p.defines.VSM_SAMPLES!==v.blurSamples&&(p.defines.VSM_SAMPLES=v.blurSamples,f.defines.VSM_SAMPLES=v.blurSamples,p.needsUpdate=!0,f.needsUpdate=!0),p.uniforms.shadow_pass.value=v.map.texture,p.uniforms.resolution.value=v.mapSize,p.uniforms.radius.value=v.radius,i.setRenderTarget(v.mapPass),i.clear(),i.renderBufferDirect(_,null,S,p,m,null),f.uniforms.shadow_pass.value=v.mapPass.texture,f.uniforms.resolution.value=v.mapSize,f.uniforms.radius.value=v.radius,i.setRenderTarget(v.map),i.clear(),i.renderBufferDirect(_,null,S,f,m,null)}function y(v,_,S,E,M,N,I){let w=null,R=E.isPointLight===!0?v.customDistanceMaterial:v.customDepthMaterial;if(R!==void 0?w=R:w=E.isPointLight===!0?l:a,i.localClippingEnabled&&S.clipShadows===!0&&S.clippingPlanes.length!==0||S.displacementMap&&S.displacementScale!==0||S.alphaMap&&S.alphaTest>0){let P=w.uuid,D=S.uuid,F=c[P];F===void 0&&(F={},c[P]=F);let z=F[D];z===void 0&&(z=w.clone(),F[D]=z),w=z}return w.visible=S.visible,w.wireframe=S.wireframe,I===id?w.side=S.shadowSide!==null?S.shadowSide:S.side:w.side=S.shadowSide!==null?S.shadowSide:h[S.side],w.alphaMap=S.alphaMap,w.alphaTest=S.alphaTest,w.clipShadows=S.clipShadows,w.clippingPlanes=S.clippingPlanes,w.clipIntersection=S.clipIntersection,w.displacementMap=S.displacementMap,w.displacementScale=S.displacementScale,w.displacementBias=S.displacementBias,w.wireframeLinewidth=S.wireframeLinewidth,w.linewidth=S.linewidth,E.isPointLight===!0&&w.isMeshDistanceMaterial===!0&&(w.referencePosition.setFromMatrixPosition(E.matrixWorld),w.nearDistance=M,w.farDistance=N),w}function b(v,_,S,E,M){if(v.visible===!1)return;if(v.layers.test(_.layers)&&(v.isMesh||v.isLine||v.isPoints)&&(v.castShadow||v.receiveShadow&&M===id)&&(!v.frustumCulled||n.intersectsObject(v))){v.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,v.matrixWorld);let w=t.update(v),R=v.material;if(Array.isArray(R)){let P=w.groups;for(let D=0,F=P.length;D<F;D++){let z=P[D],V=R[z.materialIndex];if(V&&V.visible){let H=y(v,w,V,E,S.near,S.far,M);i.renderBufferDirect(S,null,w,H,v,z)}}}else if(R.visible){let P=y(v,w,R,E,S.near,S.far,M);i.renderBufferDirect(S,null,w,P,v,null)}}let I=v.children;for(let w=0,R=I.length;w<R;w++)b(I[w],_,S,E,M)}}function Dht(i,t,e){let n=e.isWebGL2;function r(){let tt=!1,Ht=new ze,Ft=null,ne=new ze(0,0,0,0);return{setMask:function(bt){Ft!==bt&&!tt&&(i.colorMask(bt,bt,bt,bt),Ft=bt)},setLocked:function(bt){tt=bt},setClear:function(bt,Xt,_e,Qe,Ci){Ci===!0&&(bt*=Qe,Xt*=Qe,_e*=Qe),Ht.set(bt,Xt,_e,Qe),ne.equals(Ht)===!1&&(i.clearColor(bt,Xt,_e,Qe),ne.copy(Ht))},reset:function(){tt=!1,Ft=null,ne.set(-1,0,0,0)}}}function o(){let tt=!1,Ht=null,Ft=null,ne=null;return{setTest:function(bt){bt?G(2929):nt(2929)},setMask:function(bt){Ht!==bt&&!tt&&(i.depthMask(bt),Ht=bt)},setFunc:function(bt){if(Ft!==bt){if(bt)switch(bt){case Mst:i.depthFunc(512);break;case Est:i.depthFunc(519);break;case Tst:i.depthFunc(513);break;case Y3:i.depthFunc(515);break;case Ist:i.depthFunc(514);break;case Ast:i.depthFunc(518);break;case kst:i.depthFunc(516);break;case Rst:i.depthFunc(517);break;default:i.depthFunc(515)}else i.depthFunc(515);Ft=bt}},setLocked:function(bt){tt=bt},setClear:function(bt){ne!==bt&&(i.clearDepth(bt),ne=bt)},reset:function(){tt=!1,Ht=null,Ft=null,ne=null}}}function s(){let tt=!1,Ht=null,Ft=null,ne=null,bt=null,Xt=null,_e=null,Qe=null,Ci=null;return{setTest:function(nn){tt||(nn?G(2960):nt(2960))},setMask:function(nn){Ht!==nn&&!tt&&(i.stencilMask(nn),Ht=nn)},setFunc:function(nn,Rr,mo){(Ft!==nn||ne!==Rr||bt!==mo)&&(i.stencilFunc(nn,Rr,mo),Ft=nn,ne=Rr,bt=mo)},setOp:function(nn,Rr,mo){(Xt!==nn||_e!==Rr||Qe!==mo)&&(i.stencilOp(nn,Rr,mo),Xt=nn,_e=Rr,Qe=mo)},setLocked:function(nn){tt=nn},setClear:function(nn){Ci!==nn&&(i.clearStencil(nn),Ci=nn)},reset:function(){tt=!1,Ht=null,Ft=null,ne=null,bt=null,Xt=null,_e=null,Qe=null,Ci=null}}}let a=new r,l=new o,c=new s,u={},h={},p=new WeakMap,f=[],d=null,m=!1,x=null,g=null,y=null,b=null,v=null,_=null,S=null,E=!1,M=null,N=null,I=null,w=null,R=null,P=i.getParameter(35661),D=!1,F=0,z=i.getParameter(7938);z.indexOf("WebGL")!==-1?(F=parseFloat(/^WebGL (\d)/.exec(z)[1]),D=F>=1):z.indexOf("OpenGL ES")!==-1&&(F=parseFloat(/^OpenGL ES (\d)/.exec(z)[1]),D=F>=2);let V=null,H={},X=i.getParameter(3088),U=i.getParameter(2978),Y=new ze().fromArray(X),Z=new ze().fromArray(U);function K(tt,Ht,Ft){let ne=new Uint8Array(4),bt=i.createTexture();i.bindTexture(tt,bt),i.texParameteri(tt,10241,9728),i.texParameteri(tt,10240,9728);for(let Xt=0;Xt<Ft;Xt++)i.texImage2D(Ht+Xt,0,6408,1,1,0,6408,5121,ne);return bt}let J={};J[3553]=K(3553,3553,1),J[34067]=K(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),G(2929),l.setFunc(Y3),ct(!1),_t(j8),G(2884),rt(Os);function G(tt){u[tt]!==!0&&(i.enable(tt),u[tt]=!0)}function nt(tt){u[tt]!==!1&&(i.disable(tt),u[tt]=!1)}function et(tt,Ht){return h[tt]!==Ht?(i.bindFramebuffer(tt,Ht),h[tt]=Ht,n&&(tt===36009&&(h[36160]=Ht),tt===36160&&(h[36009]=Ht)),!0):!1}function at(tt,Ht){let Ft=f,ne=!1;if(tt)if(Ft=p.get(Ht),Ft===void 0&&(Ft=[],p.set(Ht,Ft)),tt.isWebGLMultipleRenderTargets){let bt=tt.texture;if(Ft.length!==bt.length||Ft[0]!==36064){for(let Xt=0,_e=bt.length;Xt<_e;Xt++)Ft[Xt]=36064+Xt;Ft.length=bt.length,ne=!0}}else Ft[0]!==36064&&(Ft[0]=36064,ne=!0);else Ft[0]!==1029&&(Ft[0]=1029,ne=!0);ne&&(e.isWebGL2?i.drawBuffers(Ft):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ft))}function it(tt){return d!==tt?(i.useProgram(tt),d=tt,!0):!1}let St={[Ou]:32774,[dst]:32778,[mst]:32779};if(n)St[Y8]=32775,St[Z8]=32776;else{let tt=t.get("EXT_blend_minmax");tt!==null&&(St[Y8]=tt.MIN_EXT,St[Z8]=tt.MAX_EXT)}let yt={[gst]:0,[xst]:1,[yst]:768,[A7]:770,[Cst]:776,[wst]:774,[bst]:772,[vst]:769,[k7]:771,[Sst]:775,[_st]:773};function rt(tt,Ht,Ft,ne,bt,Xt,_e,Qe){if(tt===Os){m===!0&&(nt(3042),m=!1);return}if(m===!1&&(G(3042),m=!0),tt!==fst){if(tt!==x||Qe!==E){if((g!==Ou||v!==Ou)&&(i.blendEquation(32774),g=Ou,v=Ou),Qe)switch(tt){case Bs:i.blendFuncSeparate(1,771,1,771);break;case q8:i.blendFunc(1,1);break;case X8:i.blendFuncSeparate(0,769,0,1);break;case K8:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",tt);break}else switch(tt){case Bs:i.blendFuncSeparate(770,771,1,771);break;case q8:i.blendFunc(770,1);break;case X8:i.blendFuncSeparate(0,769,0,1);break;case K8:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",tt);break}y=null,b=null,_=null,S=null,x=tt,E=Qe}return}bt=bt||Ht,Xt=Xt||Ft,_e=_e||ne,(Ht!==g||bt!==v)&&(i.blendEquationSeparate(St[Ht],St[bt]),g=Ht,v=bt),(Ft!==y||ne!==b||Xt!==_||_e!==S)&&(i.blendFuncSeparate(yt[Ft],yt[ne],yt[Xt],yt[_e]),y=Ft,b=ne,_=Xt,S=_e),x=tt,E=null}function vt(tt,Ht){tt.side===ju?nt(2884):G(2884);let Ft=tt.side===Tn;Ht&&(Ft=!Ft),ct(Ft),tt.blending===Bs&&tt.transparent===!1?rt(Os):rt(tt.blending,tt.blendEquation,tt.blendSrc,tt.blendDst,tt.blendEquationAlpha,tt.blendSrcAlpha,tt.blendDstAlpha,tt.premultipliedAlpha),l.setFunc(tt.depthFunc),l.setTest(tt.depthTest),l.setMask(tt.depthWrite),a.setMask(tt.colorWrite);let ne=tt.stencilWrite;c.setTest(ne),ne&&(c.setMask(tt.stencilWriteMask),c.setFunc(tt.stencilFunc,tt.stencilRef,tt.stencilFuncMask),c.setOp(tt.stencilFail,tt.stencilZFail,tt.stencilZPass)),Pt(tt.polygonOffset,tt.polygonOffsetFactor,tt.polygonOffsetUnits),tt.alphaToCoverage===!0?G(32926):nt(32926)}function ct(tt){M!==tt&&(tt?i.frontFace(2304):i.frontFace(2305),M=tt)}function _t(tt){tt!==ust?(G(2884),tt!==N&&(tt===j8?i.cullFace(1029):tt===hst?i.cullFace(1028):i.cullFace(1032))):nt(2884),N=tt}function gt(tt){tt!==I&&(D&&i.lineWidth(tt),I=tt)}function Pt(tt,Ht,Ft){tt?(G(32823),(w!==Ht||R!==Ft)&&(i.polygonOffset(Ht,Ft),w=Ht,R=Ft)):nt(32823)}function Dt(tt){tt?G(3089):nt(3089)}function Jt(tt){tt===void 0&&(tt=33984+P-1),V!==tt&&(i.activeTexture(tt),V=tt)}function Qt(tt,Ht){V===null&&Jt();let Ft=H[V];Ft===void 0&&(Ft={type:void 0,texture:void 0},H[V]=Ft),(Ft.type!==tt||Ft.texture!==Ht)&&(i.bindTexture(tt,Ht||J[tt]),Ft.type=tt,Ft.texture=Ht)}function re(){let tt=H[V];tt!==void 0&&tt.type!==void 0&&(i.bindTexture(tt.type,null),tt.type=void 0,tt.texture=void 0)}function j(){try{i.compressedTexImage2D.apply(i,arguments)}catch(tt){console.error("THREE.WebGLState:",tt)}}function $(){try{i.texSubImage2D.apply(i,arguments)}catch(tt){console.error("THREE.WebGLState:",tt)}}function ft(){try{i.texSubImage3D.apply(i,arguments)}catch(tt){console.error("THREE.WebGLState:",tt)}}function kt(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(tt){console.error("THREE.WebGLState:",tt)}}function Vt(){try{i.texStorage2D.apply(i,arguments)}catch(tt){console.error("THREE.WebGLState:",tt)}}function mt(){try{i.texStorage3D.apply(i,arguments)}catch(tt){console.error("THREE.WebGLState:",tt)}}function Ut(){try{i.texImage2D.apply(i,arguments)}catch(tt){console.error("THREE.WebGLState:",tt)}}function Q(){try{i.texImage3D.apply(i,arguments)}catch(tt){console.error("THREE.WebGLState:",tt)}}function xt(tt){Y.equals(tt)===!1&&(i.scissor(tt.x,tt.y,tt.z,tt.w),Y.copy(tt))}function At(tt){Z.equals(tt)===!1&&(i.viewport(tt.x,tt.y,tt.z,tt.w),Z.copy(tt))}function jt(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),n===!0&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),u={},V=null,H={},h={},p=new WeakMap,f=[],d=null,m=!1,x=null,g=null,y=null,b=null,v=null,_=null,S=null,E=!1,M=null,N=null,I=null,w=null,R=null,Y.set(0,0,i.canvas.width,i.canvas.height),Z.set(0,0,i.canvas.width,i.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:G,disable:nt,bindFramebuffer:et,drawBuffers:at,useProgram:it,setBlending:rt,setMaterial:vt,setFlipSided:ct,setCullFace:_t,setLineWidth:gt,setPolygonOffset:Pt,setScissorTest:Dt,activeTexture:Jt,bindTexture:Qt,unbindTexture:re,compressedTexImage2D:j,texImage2D:Ut,texImage3D:Q,texStorage2D:Vt,texStorage3D:mt,texSubImage2D:$,texSubImage3D:ft,compressedTexSubImage2D:kt,scissor:xt,viewport:At,reset:jt}}function zht(i,t,e,n,r,o,s){let a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,f=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):void 0,d=new WeakMap,m,x=!1;try{x=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(j){}function g(j,$){return x?new OffscreenCanvas(j,$):hd("canvas")}function y(j,$,ft,kt){let Vt=1;if((j.width>kt||j.height>kt)&&(Vt=kt/Math.max(j.width,j.height)),Vt<1||$===!0)if(typeof HTMLImageElement!="undefined"&&j instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&j instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&j instanceof ImageBitmap){let mt=$?cat:Math.floor,Ut=mt(Vt*j.width),Q=mt(Vt*j.height);m===void 0&&(m=g(Ut,Q));let xt=ft?g(Ut,Q):m;return xt.width=Ut,xt.height=Q,xt.getContext("2d").drawImage(j,0,0,Ut,Q),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+j.width+"x"+j.height+") to ("+Ut+"x"+Q+")."),xt}else return"data"in j&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+j.width+"x"+j.height+")."),j;return j}function b(j){return wO(j.width)&&wO(j.height)}function v(j){return a?!1:j.wrapS!==Li||j.wrapT!==Li||j.minFilter!==In&&j.minFilter!==_n}function _(j,$){return j.generateMipmaps&&$&&j.minFilter!==In&&j.minFilter!==_n}function S(j){i.generateMipmap(j)}function E(j,$,ft,kt,Vt=!1){if(a===!1)return $;if(j!==null){if(i[j]!==void 0)return i[j];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+j+"'")}let mt=$;return $===6403&&(ft===5126&&(mt=33326),ft===5131&&(mt=33325),ft===5121&&(mt=33321)),$===33319&&(ft===5126&&(mt=33328),ft===5131&&(mt=33327),ft===5121&&(mt=33323)),$===6408&&(ft===5126&&(mt=34836),ft===5131&&(mt=34842),ft===5121&&(mt=kt===Ze&&Vt===!1?35907:32856),ft===32819&&(mt=32854),ft===32820&&(mt=32855)),(mt===33325||mt===33326||mt===33327||mt===33328||mt===34842||mt===34836)&&t.get("EXT_color_buffer_float"),mt}function M(j,$,ft){return _(j,ft)===!0||j.isFramebufferTexture&&j.minFilter!==In&&j.minFilter!==_n?Math.log2(Math.max($.width,$.height))+1:j.mipmaps!==void 0&&j.mipmaps.length>0?j.mipmaps.length:j.isCompressedTexture&&Array.isArray(j.image)?$.mipmaps.length:1}function N(j){return j===In||j===J8||j===Q8?9728:9729}function I(j){let $=j.target;$.removeEventListener("dispose",I),R($),$.isVideoTexture&&d.delete($),s.memory.textures--}function w(j){let $=j.target;$.removeEventListener("dispose",w),P($)}function R(j){let $=n.get(j);$.__webglInit!==void 0&&(i.deleteTexture($.__webglTexture),n.remove(j))}function P(j){let $=j.texture,ft=n.get(j),kt=n.get($);if(!!j){if(kt.__webglTexture!==void 0&&(i.deleteTexture(kt.__webglTexture),s.memory.textures--),j.depthTexture&&j.depthTexture.dispose(),j.isWebGLCubeRenderTarget)for(let Vt=0;Vt<6;Vt++)i.deleteFramebuffer(ft.__webglFramebuffer[Vt]),ft.__webglDepthbuffer&&i.deleteRenderbuffer(ft.__webglDepthbuffer[Vt]);else i.deleteFramebuffer(ft.__webglFramebuffer),ft.__webglDepthbuffer&&i.deleteRenderbuffer(ft.__webglDepthbuffer),ft.__webglMultisampledFramebuffer&&i.deleteFramebuffer(ft.__webglMultisampledFramebuffer),ft.__webglColorRenderbuffer&&i.deleteRenderbuffer(ft.__webglColorRenderbuffer),ft.__webglDepthRenderbuffer&&i.deleteRenderbuffer(ft.__webglDepthRenderbuffer);if(j.isWebGLMultipleRenderTargets)for(let Vt=0,mt=$.length;Vt<mt;Vt++){let Ut=n.get($[Vt]);Ut.__webglTexture&&(i.deleteTexture(Ut.__webglTexture),s.memory.textures--),n.remove($[Vt])}n.remove($),n.remove(j)}}let D=0;function F(){D=0}function z(){let j=D;return j>=l&&console.warn("THREE.WebGLTextures: Trying to use "+j+" texture units while this GPU supports only "+l),D+=1,j}function V(j,$){let ft=n.get(j);if(j.isVideoTexture&&gt(j),j.version>0&&ft.__version!==j.version){let kt=j.image;if(kt===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(kt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{G(ft,j,$);return}}e.activeTexture(33984+$),e.bindTexture(3553,ft.__webglTexture)}function H(j,$){let ft=n.get(j);if(j.version>0&&ft.__version!==j.version){G(ft,j,$);return}e.activeTexture(33984+$),e.bindTexture(35866,ft.__webglTexture)}function X(j,$){let ft=n.get(j);if(j.version>0&&ft.__version!==j.version){G(ft,j,$);return}e.activeTexture(33984+$),e.bindTexture(32879,ft.__webglTexture)}function U(j,$){let ft=n.get(j);if(j.version>0&&ft.__version!==j.version){nt(ft,j,$);return}e.activeTexture(33984+$),e.bindTexture(34067,ft.__webglTexture)}let Y={[Q3]:10497,[Li]:33071,[tM]:33648},Z={[In]:9728,[J8]:9984,[Q8]:9986,[_n]:9729,[Bst]:9985,[s2]:9987};function K(j,$,ft){if(ft?(i.texParameteri(j,10242,Y[$.wrapS]),i.texParameteri(j,10243,Y[$.wrapT]),(j===32879||j===35866)&&i.texParameteri(j,32882,Y[$.wrapR]),i.texParameteri(j,10240,Z[$.magFilter]),i.texParameteri(j,10241,Z[$.minFilter])):(i.texParameteri(j,10242,33071),i.texParameteri(j,10243,33071),(j===32879||j===35866)&&i.texParameteri(j,32882,33071),($.wrapS!==Li||$.wrapT!==Li)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(j,10240,N($.magFilter)),i.texParameteri(j,10241,N($.minFilter)),$.minFilter!==In&&$.minFilter!==_n&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){let kt=t.get("EXT_texture_filter_anisotropic");if($.type===hl&&t.has("OES_texture_float_linear")===!1||a===!1&&$.type===$u&&t.has("OES_texture_half_float_linear")===!1)return;($.anisotropy>1||n.get($).__currentAnisotropy)&&(i.texParameterf(j,kt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min($.anisotropy,r.getMaxAnisotropy())),n.get($).__currentAnisotropy=$.anisotropy)}}function J(j,$){j.__webglInit===void 0&&(j.__webglInit=!0,$.addEventListener("dispose",I),j.__webglTexture=i.createTexture(),s.memory.textures++)}function G(j,$,ft){let kt=3553;$.isDataTexture2DArray&&(kt=35866),$.isDataTexture3D&&(kt=32879),J(j,$),e.activeTexture(33984+ft),e.bindTexture(kt,j.__webglTexture),i.pixelStorei(37440,$.flipY),i.pixelStorei(37441,$.premultiplyAlpha),i.pixelStorei(3317,$.unpackAlignment),i.pixelStorei(37443,0);let Vt=v($)&&b($.image)===!1,mt=y($.image,Vt,!1,u);mt=Pt($,mt);let Ut=b(mt)||a,Q=o.convert($.format,$.encoding),xt=o.convert($.type),At=E($.internalFormat,Q,xt,$.encoding,$.isVideoTexture);K(kt,$,Ut);let jt,tt=$.mipmaps,Ht=a&&$.isVideoTexture!==!0,Ft=j.__version===void 0,ne=M($,mt,Ut);if($.isDepthTexture)At=6402,a?$.type===hl?At=36012:$.type===Tv?At=33190:$.type===Uu?At=35056:At=33189:$.type===hl&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),$.format===fl&&At===6402&&$.type!==cd&&$.type!==Tv&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),$.type=cd,xt=o.convert($.type)),$.format===qu&&At===6402&&(At=34041,$.type!==Uu&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),$.type=Uu,xt=o.convert($.type))),Ht&&Ft?e.texStorage2D(3553,1,At,mt.width,mt.height):e.texImage2D(3553,0,At,mt.width,mt.height,0,Q,xt,null);else if($.isDataTexture)if(tt.length>0&&Ut){Ht&&Ft&&e.texStorage2D(3553,ne,At,tt[0].width,tt[0].height);for(let bt=0,Xt=tt.length;bt<Xt;bt++)jt=tt[bt],Ht?e.texSubImage2D(3553,0,0,0,jt.width,jt.height,Q,xt,jt.data):e.texImage2D(3553,bt,At,jt.width,jt.height,0,Q,xt,jt.data);$.generateMipmaps=!1}else Ht?(Ft&&e.texStorage2D(3553,ne,At,mt.width,mt.height),e.texSubImage2D(3553,0,0,0,mt.width,mt.height,Q,xt,mt.data)):e.texImage2D(3553,0,At,mt.width,mt.height,0,Q,xt,mt.data);else if($.isCompressedTexture){Ht&&Ft&&e.texStorage2D(3553,ne,At,tt[0].width,tt[0].height);for(let bt=0,Xt=tt.length;bt<Xt;bt++)jt=tt[bt],$.format!==pi?Q!==null?Ht?e.compressedTexSubImage2D(3553,bt,0,0,jt.width,jt.height,Q,jt.data):e.compressedTexImage2D(3553,bt,At,jt.width,jt.height,0,jt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ht?e.texSubImage2D(3553,bt,0,0,jt.width,jt.height,Q,xt,jt.data):e.texImage2D(3553,bt,At,jt.width,jt.height,0,Q,xt,jt.data)}else if($.isDataTexture2DArray)Ht?(Ft&&e.texStorage3D(35866,ne,At,mt.width,mt.height,mt.depth),e.texSubImage3D(35866,0,0,0,0,mt.width,mt.height,mt.depth,Q,xt,mt.data)):e.texImage3D(35866,0,At,mt.width,mt.height,mt.depth,0,Q,xt,mt.data);else if($.isDataTexture3D)Ht?(Ft&&e.texStorage3D(32879,ne,At,mt.width,mt.height,mt.depth),e.texSubImage3D(32879,0,0,0,0,mt.width,mt.height,mt.depth,Q,xt,mt.data)):e.texImage3D(32879,0,At,mt.width,mt.height,mt.depth,0,Q,xt,mt.data);else if($.isFramebufferTexture)Ht&&Ft?e.texStorage2D(3553,ne,At,mt.width,mt.height):e.texImage2D(3553,0,At,mt.width,mt.height,0,Q,xt,null);else if(tt.length>0&&Ut){Ht&&Ft&&e.texStorage2D(3553,ne,At,tt[0].width,tt[0].height);for(let bt=0,Xt=tt.length;bt<Xt;bt++)jt=tt[bt],Ht?e.texSubImage2D(3553,bt,0,0,Q,xt,jt):e.texImage2D(3553,bt,At,Q,xt,jt);$.generateMipmaps=!1}else Ht?(Ft&&e.texStorage2D(3553,ne,At,mt.width,mt.height),e.texSubImage2D(3553,0,0,0,Q,xt,mt)):e.texImage2D(3553,0,At,Q,xt,mt);_($,Ut)&&S(kt),j.__version=$.version,$.onUpdate&&$.onUpdate($)}function nt(j,$,ft){if($.image.length!==6)return;J(j,$),e.activeTexture(33984+ft),e.bindTexture(34067,j.__webglTexture),i.pixelStorei(37440,$.flipY),i.pixelStorei(37441,$.premultiplyAlpha),i.pixelStorei(3317,$.unpackAlignment),i.pixelStorei(37443,0);let kt=$&&($.isCompressedTexture||$.image[0].isCompressedTexture),Vt=$.image[0]&&$.image[0].isDataTexture,mt=[];for(let bt=0;bt<6;bt++)!kt&&!Vt?mt[bt]=y($.image[bt],!1,!0,c):mt[bt]=Vt?$.image[bt].image:$.image[bt],mt[bt]=Pt($,mt[bt]);let Ut=mt[0],Q=b(Ut)||a,xt=o.convert($.format,$.encoding),At=o.convert($.type),jt=E($.internalFormat,xt,At,$.encoding),tt=a&&$.isVideoTexture!==!0,Ht=j.__version===void 0,Ft=M($,Ut,Q);K(34067,$,Q);let ne;if(kt){tt&&Ht&&e.texStorage2D(34067,Ft,jt,Ut.width,Ut.height);for(let bt=0;bt<6;bt++){ne=mt[bt].mipmaps;for(let Xt=0;Xt<ne.length;Xt++){let _e=ne[Xt];$.format!==pi?xt!==null?tt?e.compressedTexSubImage2D(34069+bt,Xt,0,0,_e.width,_e.height,xt,_e.data):e.compressedTexImage2D(34069+bt,Xt,jt,_e.width,_e.height,0,_e.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):tt?e.texSubImage2D(34069+bt,Xt,0,0,_e.width,_e.height,xt,At,_e.data):e.texImage2D(34069+bt,Xt,jt,_e.width,_e.height,0,xt,At,_e.data)}}}else{ne=$.mipmaps,tt&&Ht&&(ne.length>0&&Ft++,e.texStorage2D(34067,Ft,jt,mt[0].width,mt[0].height));for(let bt=0;bt<6;bt++)if(Vt){tt?e.texSubImage2D(34069+bt,0,0,0,mt[bt].width,mt[bt].height,xt,At,mt[bt].data):e.texImage2D(34069+bt,0,jt,mt[bt].width,mt[bt].height,0,xt,At,mt[bt].data);for(let Xt=0;Xt<ne.length;Xt++){let Qe=ne[Xt].image[bt].image;tt?e.texSubImage2D(34069+bt,Xt+1,0,0,Qe.width,Qe.height,xt,At,Qe.data):e.texImage2D(34069+bt,Xt+1,jt,Qe.width,Qe.height,0,xt,At,Qe.data)}}else{tt?e.texSubImage2D(34069+bt,0,0,0,xt,At,mt[bt]):e.texImage2D(34069+bt,0,jt,xt,At,mt[bt]);for(let Xt=0;Xt<ne.length;Xt++){let _e=ne[Xt];tt?e.texSubImage2D(34069+bt,Xt+1,0,0,xt,At,_e.image[bt]):e.texImage2D(34069+bt,Xt+1,jt,xt,At,_e.image[bt])}}}_($,Q)&&S(34067),j.__version=$.version,$.onUpdate&&$.onUpdate($)}function et(j,$,ft,kt,Vt){let mt=o.convert(ft.format,ft.encoding),Ut=o.convert(ft.type),Q=E(ft.internalFormat,mt,Ut,ft.encoding);n.get($).__hasExternalTextures||(Vt===32879||Vt===35866?e.texImage3D(Vt,0,Q,$.width,$.height,$.depth,0,mt,Ut,null):e.texImage2D(Vt,0,Q,$.width,$.height,0,mt,Ut,null)),e.bindFramebuffer(36160,j),$.useRenderToTexture?f.framebufferTexture2DMultisampleEXT(36160,kt,Vt,n.get(ft).__webglTexture,0,_t($)):i.framebufferTexture2D(36160,kt,Vt,n.get(ft).__webglTexture,0),e.bindFramebuffer(36160,null)}function at(j,$,ft){if(i.bindRenderbuffer(36161,j),$.depthBuffer&&!$.stencilBuffer){let kt=33189;if(ft||$.useRenderToTexture){let Vt=$.depthTexture;Vt&&Vt.isDepthTexture&&(Vt.type===hl?kt=36012:Vt.type===Tv&&(kt=33190));let mt=_t($);$.useRenderToTexture?f.renderbufferStorageMultisampleEXT(36161,mt,kt,$.width,$.height):i.renderbufferStorageMultisample(36161,mt,kt,$.width,$.height)}else i.renderbufferStorage(36161,kt,$.width,$.height);i.framebufferRenderbuffer(36160,36096,36161,j)}else if($.depthBuffer&&$.stencilBuffer){let kt=_t($);ft&&$.useRenderbuffer?i.renderbufferStorageMultisample(36161,kt,35056,$.width,$.height):$.useRenderToTexture?f.renderbufferStorageMultisampleEXT(36161,kt,35056,$.width,$.height):i.renderbufferStorage(36161,34041,$.width,$.height),i.framebufferRenderbuffer(36160,33306,36161,j)}else{let kt=$.isWebGLMultipleRenderTargets===!0?$.texture[0]:$.texture,Vt=o.convert(kt.format,kt.encoding),mt=o.convert(kt.type),Ut=E(kt.internalFormat,Vt,mt,kt.encoding),Q=_t($);ft&&$.useRenderbuffer?i.renderbufferStorageMultisample(36161,Q,Ut,$.width,$.height):$.useRenderToTexture?f.renderbufferStorageMultisampleEXT(36161,Q,Ut,$.width,$.height):i.renderbufferStorage(36161,Ut,$.width,$.height)}i.bindRenderbuffer(36161,null)}function it(j,$){if($&&$.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,j),!($.depthTexture&&$.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get($.depthTexture).__webglTexture||$.depthTexture.image.width!==$.width||$.depthTexture.image.height!==$.height)&&($.depthTexture.image.width=$.width,$.depthTexture.image.height=$.height,$.depthTexture.needsUpdate=!0),V($.depthTexture,0);let kt=n.get($.depthTexture).__webglTexture,Vt=_t($);if($.depthTexture.format===fl)$.useRenderToTexture?f.framebufferTexture2DMultisampleEXT(36160,36096,3553,kt,0,Vt):i.framebufferTexture2D(36160,36096,3553,kt,0);else if($.depthTexture.format===qu)$.useRenderToTexture?f.framebufferTexture2DMultisampleEXT(36160,33306,3553,kt,0,Vt):i.framebufferTexture2D(36160,33306,3553,kt,0);else throw new Error("Unknown depthTexture format")}function St(j){let $=n.get(j),ft=j.isWebGLCubeRenderTarget===!0;if(j.depthTexture&&!$.__autoAllocateDepthBuffer){if(ft)throw new Error("target.depthTexture not supported in Cube render targets");it($.__webglFramebuffer,j)}else if(ft){$.__webglDepthbuffer=[];for(let kt=0;kt<6;kt++)e.bindFramebuffer(36160,$.__webglFramebuffer[kt]),$.__webglDepthbuffer[kt]=i.createRenderbuffer(),at($.__webglDepthbuffer[kt],j,!1)}else e.bindFramebuffer(36160,$.__webglFramebuffer),$.__webglDepthbuffer=i.createRenderbuffer(),at($.__webglDepthbuffer,j,!1);e.bindFramebuffer(36160,null)}function yt(j,$,ft){let kt=n.get(j);$!==void 0&&et(kt.__webglFramebuffer,j,j.texture,36064,3553),ft!==void 0&&St(j)}function rt(j){let $=j.texture,ft=n.get(j),kt=n.get($);j.addEventListener("dispose",w),j.isWebGLMultipleRenderTargets!==!0&&(kt.__webglTexture===void 0&&(kt.__webglTexture=i.createTexture()),kt.__version=$.version,s.memory.textures++);let Vt=j.isWebGLCubeRenderTarget===!0,mt=j.isWebGLMultipleRenderTargets===!0,Ut=$.isDataTexture3D||$.isDataTexture2DArray,Q=b(j)||a;if(Vt){ft.__webglFramebuffer=[];for(let xt=0;xt<6;xt++)ft.__webglFramebuffer[xt]=i.createFramebuffer()}else if(ft.__webglFramebuffer=i.createFramebuffer(),mt)if(r.drawBuffers){let xt=j.texture;for(let At=0,jt=xt.length;At<jt;At++){let tt=n.get(xt[At]);tt.__webglTexture===void 0&&(tt.__webglTexture=i.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(j.useRenderbuffer)if(a){ft.__webglMultisampledFramebuffer=i.createFramebuffer(),ft.__webglColorRenderbuffer=i.createRenderbuffer(),i.bindRenderbuffer(36161,ft.__webglColorRenderbuffer);let xt=o.convert($.format,$.encoding),At=o.convert($.type),jt=E($.internalFormat,xt,At,$.encoding),tt=_t(j);i.renderbufferStorageMultisample(36161,tt,jt,j.width,j.height),e.bindFramebuffer(36160,ft.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064,36161,ft.__webglColorRenderbuffer),i.bindRenderbuffer(36161,null),j.depthBuffer&&(ft.__webglDepthRenderbuffer=i.createRenderbuffer(),at(ft.__webglDepthRenderbuffer,j,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Vt){e.bindTexture(34067,kt.__webglTexture),K(34067,$,Q);for(let xt=0;xt<6;xt++)et(ft.__webglFramebuffer[xt],j,$,36064,34069+xt);_($,Q)&&S(34067),e.unbindTexture()}else if(mt){let xt=j.texture;for(let At=0,jt=xt.length;At<jt;At++){let tt=xt[At],Ht=n.get(tt);e.bindTexture(3553,Ht.__webglTexture),K(3553,tt,Q),et(ft.__webglFramebuffer,j,tt,36064+At,3553),_(tt,Q)&&S(3553)}e.unbindTexture()}else{let xt=3553;Ut&&(a?xt=$.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),e.bindTexture(xt,kt.__webglTexture),K(xt,$,Q),et(ft.__webglFramebuffer,j,$,36064,xt),_($,Q)&&S(xt),e.unbindTexture()}j.depthBuffer&&St(j)}function vt(j){let $=b(j)||a,ft=j.isWebGLMultipleRenderTargets===!0?j.texture:[j.texture];for(let kt=0,Vt=ft.length;kt<Vt;kt++){let mt=ft[kt];if(_(mt,$)){let Ut=j.isWebGLCubeRenderTarget?34067:3553,Q=n.get(mt).__webglTexture;e.bindTexture(Ut,Q),S(Ut),e.unbindTexture()}}}function ct(j){if(j.useRenderbuffer)if(a){let $=j.width,ft=j.height,kt=16384,Vt=[36064],mt=j.stencilBuffer?33306:36096;j.depthBuffer&&Vt.push(mt),j.ignoreDepthForMultisampleCopy||(j.depthBuffer&&(kt|=256),j.stencilBuffer&&(kt|=1024));let Ut=n.get(j);e.bindFramebuffer(36008,Ut.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,Ut.__webglFramebuffer),j.ignoreDepthForMultisampleCopy&&(i.invalidateFramebuffer(36008,[mt]),i.invalidateFramebuffer(36009,[mt])),i.blitFramebuffer(0,0,$,ft,0,0,$,ft,kt,9728),i.invalidateFramebuffer(36008,Vt),e.bindFramebuffer(36008,null),e.bindFramebuffer(36009,Ut.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function _t(j){return a&&(j.useRenderbuffer||j.useRenderToTexture)?Math.min(h,j.samples):0}function gt(j){let $=s.render.frame;d.get(j)!==$&&(d.set(j,$),j.update())}function Pt(j,$){let ft=j.encoding,kt=j.format,Vt=j.type;return j.isCompressedTexture===!0||j.isVideoTexture===!0||j.format===eM||ft!==Ws&&(ft===Ze?a===!1?t.has("EXT_sRGB")===!0&&kt===pi?(j.format=eM,j.minFilter=_n,j.generateMipmaps=!1):$=Go.sRGBToLinear($):(kt!==pi||Vt!==Hs)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ft)),$}let Dt=!1,Jt=!1;function Qt(j,$){j&&j.isWebGLRenderTarget&&(Dt===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Dt=!0),j=j.texture),V(j,$)}function re(j,$){j&&j.isWebGLCubeRenderTarget&&(Jt===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Jt=!0),j=j.texture),U(j,$)}this.allocateTextureUnit=z,this.resetTextureUnits=F,this.setTexture2D=V,this.setTexture2DArray=H,this.setTexture3D=X,this.setTextureCube=U,this.rebindTextures=yt,this.setupRenderTarget=rt,this.updateRenderTargetMipmap=vt,this.updateMultisampleRenderTarget=ct,this.setupDepthRenderbuffer=St,this.setupFrameBufferTexture=et,this.safeSetTexture2D=Qt,this.safeSetTextureCube=re}function Fht(i,t,e){let n=e.isWebGL2;function r(o,s=null){let a;if(o===Hs)return 5121;if(o===Ust)return 32819;if(o===Wst)return 32820;if(o===Vst)return 5120;if(o===Hst)return 5122;if(o===cd)return 5123;if(o===$st)return 5124;if(o===Tv)return 5125;if(o===hl)return 5126;if(o===$u)return n?5131:(a=t.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(o===Gst)return 6406;if(o===pi)return 6408;if(o===jst)return 6409;if(o===qst)return 6410;if(o===fl)return 6402;if(o===qu)return 34041;if(o===Xst)return 6403;if(o===eM)return a=t.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(o===Kst)return 36244;if(o===Yst)return 33319;if(o===Zst)return 33320;if(o===Jst)return 36249;if(o===h3||o===p3||o===f3||o===d3)if(s===Ze)if(a=t.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(o===h3)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(o===p3)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(o===f3)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(o===d3)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=t.get("WEBGL_compressed_texture_s3tc"),a!==null){if(o===h3)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===p3)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===f3)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===d3)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===tO||o===eO||o===nO||o===iO)if(a=t.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(o===tO)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===eO)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===nO)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===iO)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===Qst)return a=t.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(o===rO||o===oO)if(a=t.get("WEBGL_compressed_texture_etc"),a!==null){if(o===rO)return s===Ze?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(o===oO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(o===sO||o===aO||o===lO||o===cO||o===uO||o===hO||o===pO||o===fO||o===dO||o===mO||o===gO||o===xO||o===yO||o===vO)if(a=t.get("WEBGL_compressed_texture_astc"),a!==null){if(o===sO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(o===aO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(o===lO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(o===cO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(o===uO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(o===hO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(o===pO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(o===fO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(o===dO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(o===mO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(o===gO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(o===xO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(o===yO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(o===vO)return s===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(o===bO)if(a=t.get("EXT_texture_compression_bptc"),a!==null){if(o===bO)return s===Ze?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(o===Uu)return n?34042:(a=t.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:r}}var Vv=class extends xn{constructor(t=[]){super(),this.cameras=t}};Vv.prototype.isArrayCamera=!0;var pl=class extends Re{constructor(){super(),this.type="Group"}};pl.prototype.isGroup=!0;var Oht={type:"move"},od=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new pl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new pl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new q),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new pl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new q),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,e,n){let r=null,o=null,s=null,a=this._targetRay,l=this._grip,c=this._hand;if(t&&e.session.visibilityState!=="visible-blurred")if(a!==null&&(r=e.getPose(t.targetRaySpace,n),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Oht))),c&&t.hand){s=!0;for(let m of t.hand.values()){let x=e.getJointPose(m,n);if(c.joints[m.jointName]===void 0){let y=new pl;y.matrixAutoUpdate=!1,y.visible=!1,c.joints[m.jointName]=y,c.add(y)}let g=c.joints[m.jointName];x!==null&&(g.matrix.fromArray(x.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=x.radius),g.visible=x!==null}let u=c.joints["index-finger-tip"],h=c.joints["thumb-tip"],p=u.position.distanceTo(h.position),f=.02,d=.005;c.inputState.pinching&&p>f+d?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!c.inputState.pinching&&p<=f-d&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else l!==null&&t.gripSpace&&(o=e.getPose(t.gripSpace,n),o!==null&&(l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),o.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(o.linearVelocity)):l.hasLinearVelocity=!1,o.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(o.angularVelocity)):l.hasAngularVelocity=!1));return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=o!==null),c!==null&&(c.visible=s!==null),this}},yd=class extends ln{constructor(t,e,n,r,o,s,a,l,c,u){if(u=u!==void 0?u:fl,u!==fl&&u!==qu)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&u===fl&&(n=cd),n===void 0&&u===qu&&(n=Uu),super(null,r,o,s,a,l,u,n,c),this.image={width:t,height:e},this.magFilter=a!==void 0?a:In,this.minFilter=l!==void 0?l:In,this.flipY=!1,this.generateMipmaps=!1}};yd.prototype.isDepthTexture=!0;var lM=class extends Mr{constructor(t,e){super();let n=this,r=null,o=1,s=null,a="local-floor",l=t.extensions.has("WEBGL_multisampled_render_to_texture"),c=null,u=null,h=null,p=null,f=!1,d=null,m=e.getContextAttributes(),x=null,g=null,y=[],b=new Map,v=new xn;v.layers.enable(1),v.viewport=new ze;let _=new xn;_.layers.enable(2),_.viewport=new ze;let S=[v,_],E=new Vv;E.layers.enable(1),E.layers.enable(2);let M=null,N=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(U){let Y=y[U];return Y===void 0&&(Y=new od,y[U]=Y),Y.getTargetRaySpace()},this.getControllerGrip=function(U){let Y=y[U];return Y===void 0&&(Y=new od,y[U]=Y),Y.getGripSpace()},this.getHand=function(U){let Y=y[U];return Y===void 0&&(Y=new od,y[U]=Y),Y.getHandSpace()};function I(U){let Y=b.get(U.inputSource);Y&&Y.dispatchEvent({type:U.type,data:U.inputSource})}function w(){b.forEach(function(U,Y){U.disconnect(Y)}),b.clear(),M=null,N=null,t.setRenderTarget(x),p=null,h=null,u=null,r=null,g=null,X.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(U){o=U,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(U){a=U,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return s},this.getBaseLayer=function(){return h!==null?h:p},this.getBinding=function(){return u},this.getFrame=function(){return d},this.getSession=function(){return r},this.setSession=function(U){return $t(this,null,function*(){if(r=U,r!==null){if(x=t.getRenderTarget(),r.addEventListener("select",I),r.addEventListener("selectstart",I),r.addEventListener("selectend",I),r.addEventListener("squeeze",I),r.addEventListener("squeezestart",I),r.addEventListener("squeezeend",I),r.addEventListener("end",w),r.addEventListener("inputsourceschange",R),m.xrCompatible!==!0&&(yield e.makeXRCompatible()),r.renderState.layers===void 0||t.capabilities.isWebGL2===!1){let Y={antialias:r.renderState.layers===void 0?m.antialias:!0,alpha:m.alpha,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:o};p=new XRWebGLLayer(r,e,Y),r.updateRenderState({baseLayer:p}),g=new ii(p.framebufferWidth,p.framebufferHeight,{format:pi,type:Hs,encoding:t.outputEncoding})}else{f=m.antialias;let Y=null,Z=null,K=null;m.depth&&(K=m.stencil?35056:33190,Y=m.stencil?qu:fl,Z=m.stencil?Uu:cd);let J={colorFormat:t.outputEncoding===Ze?35907:32856,depthFormat:K,scaleFactor:o};u=new XRWebGLBinding(r,e),h=u.createProjectionLayer(J),r.updateRenderState({layers:[h]}),f?g=new pd(h.textureWidth,h.textureHeight,{format:pi,type:Hs,depthTexture:new yd(h.textureWidth,h.textureHeight,Z,void 0,void 0,void 0,void 0,void 0,void 0,Y),stencilBuffer:m.stencil,ignoreDepth:h.ignoreDepthValues,useRenderToTexture:l,encoding:t.outputEncoding}):g=new ii(h.textureWidth,h.textureHeight,{format:pi,type:Hs,depthTexture:new yd(h.textureWidth,h.textureHeight,Z,void 0,void 0,void 0,void 0,void 0,void 0,Y),stencilBuffer:m.stencil,ignoreDepth:h.ignoreDepthValues,encoding:t.outputEncoding})}g.isXRRenderTarget=!0,this.setFoveation(1),s=yield r.requestReferenceSpace(a),X.setContext(r),X.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}})};function R(U){let Y=r.inputSources;for(let Z=0;Z<y.length;Z++)b.set(Y[Z],y[Z]);for(let Z=0;Z<U.removed.length;Z++){let K=U.removed[Z],J=b.get(K);J&&(J.dispatchEvent({type:"disconnected",data:K}),b.delete(K))}for(let Z=0;Z<U.added.length;Z++){let K=U.added[Z],J=b.get(K);J&&J.dispatchEvent({type:"connected",data:K})}}let P=new q,D=new q;function F(U,Y,Z){P.setFromMatrixPosition(Y.matrixWorld),D.setFromMatrixPosition(Z.matrixWorld);let K=P.distanceTo(D),J=Y.projectionMatrix.elements,G=Z.projectionMatrix.elements,nt=J[14]/(J[10]-1),et=J[14]/(J[10]+1),at=(J[9]+1)/J[5],it=(J[9]-1)/J[5],St=(J[8]-1)/J[0],yt=(G[8]+1)/G[0],rt=nt*St,vt=nt*yt,ct=K/(-St+yt),_t=ct*-St;Y.matrixWorld.decompose(U.position,U.quaternion,U.scale),U.translateX(_t),U.translateZ(ct),U.matrixWorld.compose(U.position,U.quaternion,U.scale),U.matrixWorldInverse.copy(U.matrixWorld).invert();let gt=nt+ct,Pt=et+ct,Dt=rt-_t,Jt=vt+(K-_t),Qt=at*et/Pt*gt,re=it*et/Pt*gt;U.projectionMatrix.makePerspective(Dt,Jt,Qt,re,gt,Pt)}function z(U,Y){Y===null?U.matrixWorld.copy(U.matrix):U.matrixWorld.multiplyMatrices(Y.matrixWorld,U.matrix),U.matrixWorldInverse.copy(U.matrixWorld).invert()}this.updateCamera=function(U){if(r===null)return;E.near=_.near=v.near=U.near,E.far=_.far=v.far=U.far,(M!==E.near||N!==E.far)&&(r.updateRenderState({depthNear:E.near,depthFar:E.far}),M=E.near,N=E.far);let Y=U.parent,Z=E.cameras;z(E,Y);for(let J=0;J<Z.length;J++)z(Z[J],Y);E.matrixWorld.decompose(E.position,E.quaternion,E.scale),U.position.copy(E.position),U.quaternion.copy(E.quaternion),U.scale.copy(E.scale),U.matrix.copy(E.matrix),U.matrixWorld.copy(E.matrixWorld);let K=U.children;for(let J=0,G=K.length;J<G;J++)K[J].updateMatrixWorld(!0);Z.length===2?F(E,v,_):E.projectionMatrix.copy(v.projectionMatrix)},this.getCamera=function(){return E},this.getFoveation=function(){if(h!==null)return h.fixedFoveation;if(p!==null)return p.fixedFoveation},this.setFoveation=function(U){h!==null&&(h.fixedFoveation=U),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=U)};let V=null;function H(U,Y){if(c=Y.getViewerPose(s),d=Y,c!==null){let K=c.views;p!==null&&(t.setRenderTargetFramebuffer(g,p.framebuffer),t.setRenderTarget(g));let J=!1;K.length!==E.cameras.length&&(E.cameras.length=0,J=!0);for(let G=0;G<K.length;G++){let nt=K[G],et=null;if(p!==null)et=p.getViewport(nt);else{let it=u.getViewSubImage(h,nt);et=it.viewport,G===0&&(t.setRenderTargetTextures(g,it.colorTexture,h.ignoreDepthValues?void 0:it.depthStencilTexture),t.setRenderTarget(g))}let at=S[G];at.matrix.fromArray(nt.transform.matrix),at.projectionMatrix.fromArray(nt.projectionMatrix),at.viewport.set(et.x,et.y,et.width,et.height),G===0&&E.matrix.copy(at.matrix),J===!0&&E.cameras.push(at)}}let Z=r.inputSources;for(let K=0;K<y.length;K++){let J=y[K],G=Z[K];J.update(G,Y,s)}V&&V(U,Y),d=null}let X=new D7;X.setAnimationLoop(H),this.setAnimationLoop=function(U){V=U},this.dispose=function(){}}};function Bht(i){function t(g,y){g.fogColor.value.copy(y.color),y.isFog?(g.fogNear.value=y.near,g.fogFar.value=y.far):y.isFogExp2&&(g.fogDensity.value=y.density)}function e(g,y,b,v,_){y.isMeshBasicMaterial?n(g,y):y.isMeshLambertMaterial?(n(g,y),l(g,y)):y.isMeshToonMaterial?(n(g,y),u(g,y)):y.isMeshPhongMaterial?(n(g,y),c(g,y)):y.isMeshStandardMaterial?(n(g,y),y.isMeshPhysicalMaterial?p(g,y,_):h(g,y)):y.isMeshMatcapMaterial?(n(g,y),f(g,y)):y.isMeshDepthMaterial?(n(g,y),d(g,y)):y.isMeshDistanceMaterial?(n(g,y),m(g,y)):y.isMeshNormalMaterial?(n(g,y),x(g,y)):y.isLineBasicMaterial?(r(g,y),y.isLineDashedMaterial&&o(g,y)):y.isPointsMaterial?s(g,y,b,v):y.isSpriteMaterial?a(g,y):y.isShadowMaterial?(g.color.value.copy(y.color),g.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function n(g,y){g.opacity.value=y.opacity,y.color&&g.diffuse.value.copy(y.color),y.emissive&&g.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(g.map.value=y.map),y.alphaMap&&(g.alphaMap.value=y.alphaMap),y.specularMap&&(g.specularMap.value=y.specularMap),y.alphaTest>0&&(g.alphaTest.value=y.alphaTest);let b=i.get(y).envMap;b&&(g.envMap.value=b,g.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=y.reflectivity,g.ior.value=y.ior,g.refractionRatio.value=y.refractionRatio),y.lightMap&&(g.lightMap.value=y.lightMap,g.lightMapIntensity.value=y.lightMapIntensity),y.aoMap&&(g.aoMap.value=y.aoMap,g.aoMapIntensity.value=y.aoMapIntensity);let v;y.map?v=y.map:y.specularMap?v=y.specularMap:y.displacementMap?v=y.displacementMap:y.normalMap?v=y.normalMap:y.bumpMap?v=y.bumpMap:y.roughnessMap?v=y.roughnessMap:y.metalnessMap?v=y.metalnessMap:y.alphaMap?v=y.alphaMap:y.emissiveMap?v=y.emissiveMap:y.clearcoatMap?v=y.clearcoatMap:y.clearcoatNormalMap?v=y.clearcoatNormalMap:y.clearcoatRoughnessMap?v=y.clearcoatRoughnessMap:y.specularIntensityMap?v=y.specularIntensityMap:y.specularColorMap?v=y.specularColorMap:y.transmissionMap?v=y.transmissionMap:y.thicknessMap?v=y.thicknessMap:y.sheenColorMap?v=y.sheenColorMap:y.sheenRoughnessMap&&(v=y.sheenRoughnessMap),v!==void 0&&(v.isWebGLRenderTarget&&(v=v.texture),v.matrixAutoUpdate===!0&&v.updateMatrix(),g.uvTransform.value.copy(v.matrix));let _;y.aoMap?_=y.aoMap:y.lightMap&&(_=y.lightMap),_!==void 0&&(_.isWebGLRenderTarget&&(_=_.texture),_.matrixAutoUpdate===!0&&_.updateMatrix(),g.uv2Transform.value.copy(_.matrix))}function r(g,y){g.diffuse.value.copy(y.color),g.opacity.value=y.opacity}function o(g,y){g.dashSize.value=y.dashSize,g.totalSize.value=y.dashSize+y.gapSize,g.scale.value=y.scale}function s(g,y,b,v){g.diffuse.value.copy(y.color),g.opacity.value=y.opacity,g.size.value=y.size*b,g.scale.value=v*.5,y.map&&(g.map.value=y.map),y.alphaMap&&(g.alphaMap.value=y.alphaMap),y.alphaTest>0&&(g.alphaTest.value=y.alphaTest);let _;y.map?_=y.map:y.alphaMap&&(_=y.alphaMap),_!==void 0&&(_.matrixAutoUpdate===!0&&_.updateMatrix(),g.uvTransform.value.copy(_.matrix))}function a(g,y){g.diffuse.value.copy(y.color),g.opacity.value=y.opacity,g.rotation.value=y.rotation,y.map&&(g.map.value=y.map),y.alphaMap&&(g.alphaMap.value=y.alphaMap),y.alphaTest>0&&(g.alphaTest.value=y.alphaTest);let b;y.map?b=y.map:y.alphaMap&&(b=y.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),g.uvTransform.value.copy(b.matrix))}function l(g,y){y.emissiveMap&&(g.emissiveMap.value=y.emissiveMap)}function c(g,y){g.specular.value.copy(y.specular),g.shininess.value=Math.max(y.shininess,1e-4),y.emissiveMap&&(g.emissiveMap.value=y.emissiveMap),y.bumpMap&&(g.bumpMap.value=y.bumpMap,g.bumpScale.value=y.bumpScale,y.side===Tn&&(g.bumpScale.value*=-1)),y.normalMap&&(g.normalMap.value=y.normalMap,g.normalScale.value.copy(y.normalScale),y.side===Tn&&g.normalScale.value.negate()),y.displacementMap&&(g.displacementMap.value=y.displacementMap,g.displacementScale.value=y.displacementScale,g.displacementBias.value=y.displacementBias)}function u(g,y){y.gradientMap&&(g.gradientMap.value=y.gradientMap),y.emissiveMap&&(g.emissiveMap.value=y.emissiveMap),y.bumpMap&&(g.bumpMap.value=y.bumpMap,g.bumpScale.value=y.bumpScale,y.side===Tn&&(g.bumpScale.value*=-1)),y.normalMap&&(g.normalMap.value=y.normalMap,g.normalScale.value.copy(y.normalScale),y.side===Tn&&g.normalScale.value.negate()),y.displacementMap&&(g.displacementMap.value=y.displacementMap,g.displacementScale.value=y.displacementScale,g.displacementBias.value=y.displacementBias)}function h(g,y){g.roughness.value=y.roughness,g.metalness.value=y.metalness,y.roughnessMap&&(g.roughnessMap.value=y.roughnessMap),y.metalnessMap&&(g.metalnessMap.value=y.metalnessMap),y.emissiveMap&&(g.emissiveMap.value=y.emissiveMap),y.bumpMap&&(g.bumpMap.value=y.bumpMap,g.bumpScale.value=y.bumpScale,y.side===Tn&&(g.bumpScale.value*=-1)),y.normalMap&&(g.normalMap.value=y.normalMap,g.normalScale.value.copy(y.normalScale),y.side===Tn&&g.normalScale.value.negate()),y.displacementMap&&(g.displacementMap.value=y.displacementMap,g.displacementScale.value=y.displacementScale,g.displacementBias.value=y.displacementBias),i.get(y).envMap&&(g.envMapIntensity.value=y.envMapIntensity)}function p(g,y,b){h(g,y),g.ior.value=y.ior,y.sheen>0&&(g.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),g.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(g.sheenColorMap.value=y.sheenColorMap),y.sheenRoughnessMap&&(g.sheenRoughnessMap.value=y.sheenRoughnessMap)),y.clearcoat>0&&(g.clearcoat.value=y.clearcoat,g.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(g.clearcoatMap.value=y.clearcoatMap),y.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap),y.clearcoatNormalMap&&(g.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),g.clearcoatNormalMap.value=y.clearcoatNormalMap,y.side===Tn&&g.clearcoatNormalScale.value.negate())),y.transmission>0&&(g.transmission.value=y.transmission,g.transmissionSamplerMap.value=b.texture,g.transmissionSamplerSize.value.set(b.width,b.height),y.transmissionMap&&(g.transmissionMap.value=y.transmissionMap),g.thickness.value=y.thickness,y.thicknessMap&&(g.thicknessMap.value=y.thicknessMap),g.attenuationDistance.value=y.attenuationDistance,g.attenuationColor.value.copy(y.attenuationColor)),g.specularIntensity.value=y.specularIntensity,g.specularColor.value.copy(y.specularColor),y.specularIntensityMap&&(g.specularIntensityMap.value=y.specularIntensityMap),y.specularColorMap&&(g.specularColorMap.value=y.specularColorMap)}function f(g,y){y.matcap&&(g.matcap.value=y.matcap),y.bumpMap&&(g.bumpMap.value=y.bumpMap,g.bumpScale.value=y.bumpScale,y.side===Tn&&(g.bumpScale.value*=-1)),y.normalMap&&(g.normalMap.value=y.normalMap,g.normalScale.value.copy(y.normalScale),y.side===Tn&&g.normalScale.value.negate()),y.displacementMap&&(g.displacementMap.value=y.displacementMap,g.displacementScale.value=y.displacementScale,g.displacementBias.value=y.displacementBias)}function d(g,y){y.displacementMap&&(g.displacementMap.value=y.displacementMap,g.displacementScale.value=y.displacementScale,g.displacementBias.value=y.displacementBias)}function m(g,y){y.displacementMap&&(g.displacementMap.value=y.displacementMap,g.displacementScale.value=y.displacementScale,g.displacementBias.value=y.displacementBias),g.referencePosition.value.copy(y.referencePosition),g.nearDistance.value=y.nearDistance,g.farDistance.value=y.farDistance}function x(g,y){y.bumpMap&&(g.bumpMap.value=y.bumpMap,g.bumpScale.value=y.bumpScale,y.side===Tn&&(g.bumpScale.value*=-1)),y.normalMap&&(g.normalMap.value=y.normalMap,g.normalScale.value.copy(y.normalScale),y.side===Tn&&g.normalScale.value.negate()),y.displacementMap&&(g.displacementMap.value=y.displacementMap,g.displacementScale.value=y.displacementScale,g.displacementBias.value=y.displacementBias)}return{refreshFogUniforms:t,refreshMaterialUniforms:e}}function Vht(){let i=hd("canvas");return i.style.display="block",i}function Ne(i={}){let t=i.canvas!==void 0?i.canvas:Vht(),e=i.context!==void 0?i.context:null,n=i.alpha!==void 0?i.alpha:!1,r=i.depth!==void 0?i.depth:!0,o=i.stencil!==void 0?i.stencil:!0,s=i.antialias!==void 0?i.antialias:!1,a=i.premultipliedAlpha!==void 0?i.premultipliedAlpha:!0,l=i.preserveDrawingBuffer!==void 0?i.preserveDrawingBuffer:!1,c=i.powerPreference!==void 0?i.powerPreference:"default",u=i.failIfMajorPerformanceCaveat!==void 0?i.failIfMajorPerformanceCaveat:!1,h=null,p=null,f=[],d=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ws,this.physicallyCorrectLights=!1,this.toneMapping=Vs,this.toneMappingExposure=1;let m=this,x=!1,g=0,y=0,b=null,v=-1,_=null,S=new ze,E=new ze,M=null,N=t.width,I=t.height,w=1,R=null,P=null,D=new ze(0,0,N,I),F=new ze(0,0,N,I),z=!1,V=new Yu,H=!1,X=!1,U=null,Y=new te,Z=new q,K={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function J(){return b===null?w:1}let G=e;function nt(W,st){for(let dt=0;dt<W.length;dt++){let lt=W[dt],Ct=t.getContext(lt,st);if(Ct!==null)return Ct}return null}try{let W={alpha:!0,depth:r,stencil:o,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${l4}`),t.addEventListener("webglcontextlost",jt,!1),t.addEventListener("webglcontextrestored",tt,!1),G===null){let st=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&st.shift(),G=nt(st,W),G===null)throw nt(st)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}G.getShaderPrecisionFormat===void 0&&(G.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(W){throw console.error("THREE.WebGLRenderer: "+W.message),W}let et,at,it,St,yt,rt,vt,ct,_t,gt,Pt,Dt,Jt,Qt,re,j,$,ft,kt,Vt,mt,Ut,Q;function xt(){et=new lut(G),at=new nut(G,et,i),et.init(at),Ut=new Fht(G,et,at),it=new Dht(G,et,at),St=new hut(G),yt=new Cht,rt=new zht(G,et,it,yt,at,Ut,St),vt=new rut(m),ct=new aut(m),_t=new Eat(G,at),Q=new tut(G,et,_t,at),gt=new cut(G,_t,St,Q),Pt=new mut(G,gt,_t,St),kt=new dut(G,at,rt),j=new iut(yt),Dt=new Sht(m,vt,ct,et,at,Q,j),Jt=new Bht(yt),Qt=new Eht,re=new Pht(et,at),ft=new Qct(m,vt,it,Pt,n,a),$=new G7(m,Pt,at),Vt=new eut(G,et,St,at),mt=new uut(G,et,St,at),St.programs=Dt.programs,m.capabilities=at,m.extensions=et,m.properties=yt,m.renderLists=Qt,m.shadowMap=$,m.state=it,m.info=St}xt();let At=new lM(m,G);this.xr=At,this.getContext=function(){return G},this.getContextAttributes=function(){return G.getContextAttributes()},this.forceContextLoss=function(){let W=et.get("WEBGL_lose_context");W&&W.loseContext()},this.forceContextRestore=function(){let W=et.get("WEBGL_lose_context");W&&W.restoreContext()},this.getPixelRatio=function(){return w},this.setPixelRatio=function(W){W!==void 0&&(w=W,this.setSize(N,I,!1))},this.getSize=function(W){return W.set(N,I)},this.setSize=function(W,st,dt){if(At.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}N=W,I=st,t.width=Math.floor(W*w),t.height=Math.floor(st*w),dt!==!1&&(t.style.width=W+"px",t.style.height=st+"px"),this.setViewport(0,0,W,st)},this.getDrawingBufferSize=function(W){return W.set(N*w,I*w).floor()},this.setDrawingBufferSize=function(W,st,dt){N=W,I=st,w=dt,t.width=Math.floor(W*dt),t.height=Math.floor(st*dt),this.setViewport(0,0,W,st)},this.getCurrentViewport=function(W){return W.copy(S)},this.getViewport=function(W){return W.copy(D)},this.setViewport=function(W,st,dt,lt){W.isVector4?D.set(W.x,W.y,W.z,W.w):D.set(W,st,dt,lt),it.viewport(S.copy(D).multiplyScalar(w).floor())},this.getScissor=function(W){return W.copy(F)},this.setScissor=function(W,st,dt,lt){W.isVector4?F.set(W.x,W.y,W.z,W.w):F.set(W,st,dt,lt),it.scissor(E.copy(F).multiplyScalar(w).floor())},this.getScissorTest=function(){return z},this.setScissorTest=function(W){it.setScissorTest(z=W)},this.setOpaqueSort=function(W){R=W},this.setTransparentSort=function(W){P=W},this.getClearColor=function(W){return W.copy(ft.getClearColor())},this.setClearColor=function(){ft.setClearColor.apply(ft,arguments)},this.getClearAlpha=function(){return ft.getClearAlpha()},this.setClearAlpha=function(){ft.setClearAlpha.apply(ft,arguments)},this.clear=function(W,st,dt){let lt=0;(W===void 0||W)&&(lt|=16384),(st===void 0||st)&&(lt|=256),(dt===void 0||dt)&&(lt|=1024),G.clear(lt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",jt,!1),t.removeEventListener("webglcontextrestored",tt,!1),Qt.dispose(),re.dispose(),yt.dispose(),vt.dispose(),ct.dispose(),Pt.dispose(),Q.dispose(),Dt.dispose(),At.dispose(),At.removeEventListener("sessionstart",_e),At.removeEventListener("sessionend",Qe),U&&(U.dispose(),U=null),Ci.stop()};function jt(W){W.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function tt(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;let W=St.autoReset,st=$.enabled,dt=$.autoUpdate,lt=$.needsUpdate,Ct=$.type;xt(),St.autoReset=W,$.enabled=st,$.autoUpdate=dt,$.needsUpdate=lt,$.type=Ct}function Ht(W){let st=W.target;st.removeEventListener("dispose",Ht),Ft(st)}function Ft(W){ne(W),yt.remove(W)}function ne(W){let st=yt.get(W).programs;st!==void 0&&(st.forEach(function(dt){Dt.releaseProgram(dt)}),W.isShaderMaterial&&Dt.releaseShaderCache(W))}this.renderBufferDirect=function(W,st,dt,lt,Ct,oe){st===null&&(st=K);let ae=Ct.isMesh&&Ct.matrixWorld.determinant()<0,ge=H$(W,st,dt,lt,Ct);it.setMaterial(lt,ae);let de=dt.index,Le=dt.attributes.position;if(de===null){if(Le===void 0||Le.count===0)return}else if(de.count===0)return;let Me=1;lt.wireframe===!0&&(de=gt.getWireframeAttribute(dt),Me=2),Q.setup(Ct,lt,ge,dt,de);let Ee,rn=Vt;de!==null&&(Ee=_t.get(de),rn=mt,rn.setIndex(Ee));let ua=de!==null?de.count:Le.count,Ul=dt.drawRange.start*Me,Ae=dt.drawRange.count*Me,Pr=oe!==null?oe.start*Me:0,wn=oe!==null?oe.count*Me:1/0,Nr=Math.max(Ul,Pr),Cm=Math.min(ua,Ul+Ae,Pr+wn)-1,Lr=Math.max(0,Cm-Nr+1);if(Lr!==0){if(Ct.isMesh)lt.wireframe===!0?(it.setLineWidth(lt.wireframeLinewidth*J()),rn.setMode(1)):rn.setMode(4);else if(Ct.isLine){let go=lt.linewidth;go===void 0&&(go=1),it.setLineWidth(go*J()),Ct.isLineSegments?rn.setMode(1):Ct.isLineLoop?rn.setMode(2):rn.setMode(3)}else Ct.isPoints?rn.setMode(0):Ct.isSprite&&rn.setMode(4);if(Ct.isInstancedMesh)rn.renderInstances(Nr,Lr,Ct.count);else if(dt.isInstancedBufferGeometry){let go=Math.min(dt.instanceCount,dt._maxInstanceCount);rn.renderInstances(Nr,Lr,go)}else rn.render(Nr,Lr)}},this.compile=function(W,st){p=re.get(W),p.init(),d.push(p),W.traverseVisible(function(dt){dt.isLight&&dt.layers.test(st.layers)&&(p.pushLight(dt),dt.castShadow&&p.pushShadow(dt))}),p.setupLights(m.physicallyCorrectLights),W.traverse(function(dt){let lt=dt.material;if(lt)if(Array.isArray(lt))for(let Ct=0;Ct<lt.length;Ct++){let oe=lt[Ct];Bb(oe,W,dt)}else Bb(lt,W,dt)}),d.pop(),p=null};let bt=null;function Xt(W){bt&&bt(W)}function _e(){Ci.stop()}function Qe(){Ci.start()}let Ci=new D7;Ci.setAnimationLoop(Xt),typeof window!="undefined"&&Ci.setContext(window),this.setAnimationLoop=function(W){bt=W,At.setAnimationLoop(W),W===null?Ci.stop():Ci.start()},At.addEventListener("sessionstart",_e),At.addEventListener("sessionend",Qe),this.render=function(W,st){if(st!==void 0&&st.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(x===!0)return;W.autoUpdate===!0&&W.updateMatrixWorld(),st.parent===null&&st.updateMatrixWorld(),At.enabled===!0&&At.isPresenting===!0&&(At.cameraAutoUpdate===!0&&At.updateCamera(st),st=At.getCamera()),W.isScene===!0&&W.onBeforeRender(m,W,st,b),p=re.get(W,d.length),p.init(),d.push(p),Y.multiplyMatrices(st.projectionMatrix,st.matrixWorldInverse),V.setFromProjectionMatrix(Y),X=this.localClippingEnabled,H=j.init(this.clippingPlanes,X,st),h=Qt.get(W,f.length),h.init(),f.push(h),nn(W,st,0,m.sortObjects),h.finish(),m.sortObjects===!0&&h.sort(R,P),H===!0&&j.beginShadows();let dt=p.state.shadowsArray;if($.render(dt,W,st),H===!0&&j.endShadows(),this.info.autoReset===!0&&this.info.reset(),ft.render(h,W),p.setupLights(m.physicallyCorrectLights),st.isArrayCamera){let lt=st.cameras;for(let Ct=0,oe=lt.length;Ct<oe;Ct++){let ae=lt[Ct];Rr(h,W,ae,ae.viewport)}}else Rr(h,W,st);b!==null&&(rt.updateMultisampleRenderTarget(b),rt.updateRenderTargetMipmap(b)),W.isScene===!0&&W.onAfterRender(m,W,st),it.buffers.depth.setTest(!0),it.buffers.depth.setMask(!0),it.buffers.color.setMask(!0),it.setPolygonOffset(!1),Q.resetDefaultState(),v=-1,_=null,d.pop(),d.length>0?p=d[d.length-1]:p=null,f.pop(),f.length>0?h=f[f.length-1]:h=null};function nn(W,st,dt,lt){if(W.visible===!1)return;if(W.layers.test(st.layers)){if(W.isGroup)dt=W.renderOrder;else if(W.isLOD)W.autoUpdate===!0&&W.update(st);else if(W.isLight)p.pushLight(W),W.castShadow&&p.pushShadow(W);else if(W.isSprite){if(!W.frustumCulled||V.intersectsSprite(W)){lt&&Z.setFromMatrixPosition(W.matrixWorld).applyMatrix4(Y);let ae=Pt.update(W),ge=W.material;ge.visible&&h.push(W,ae,ge,dt,Z.z,null)}}else if((W.isMesh||W.isLine||W.isPoints)&&(W.isSkinnedMesh&&W.skeleton.frame!==St.render.frame&&(W.skeleton.update(),W.skeleton.frame=St.render.frame),!W.frustumCulled||V.intersectsObject(W))){lt&&Z.setFromMatrixPosition(W.matrixWorld).applyMatrix4(Y);let ae=Pt.update(W),ge=W.material;if(Array.isArray(ge)){let de=ae.groups;for(let Le=0,Me=de.length;Le<Me;Le++){let Ee=de[Le],rn=ge[Ee.materialIndex];rn&&rn.visible&&h.push(W,ae,rn,dt,Z.z,Ee)}}else ge.visible&&h.push(W,ae,ge,dt,Z.z,null)}}let oe=W.children;for(let ae=0,ge=oe.length;ae<ge;ae++)nn(oe[ae],st,dt,lt)}function Rr(W,st,dt,lt){let Ct=W.opaque,oe=W.transmissive,ae=W.transparent;p.setupLightsView(dt),oe.length>0&&mo(Ct,st,dt),lt&&it.viewport(S.copy(lt)),Ct.length>0&&Sm(Ct,st,dt),oe.length>0&&Sm(oe,st,dt),ae.length>0&&Sm(ae,st,dt)}function mo(W,st,dt){if(U===null){let ae=s===!0&&at.isWebGL2===!0?pd:ii;U=new ae(1024,1024,{generateMipmaps:!0,type:Ut.convert($u)!==null?$u:Hs,minFilter:s2,magFilter:In,wrapS:Li,wrapT:Li,useRenderToTexture:et.has("WEBGL_multisampled_render_to_texture")})}let lt=m.getRenderTarget();m.setRenderTarget(U),m.clear();let Ct=m.toneMapping;m.toneMapping=Vs,Sm(W,st,dt),m.toneMapping=Ct,rt.updateMultisampleRenderTarget(U),rt.updateRenderTargetMipmap(U),m.setRenderTarget(lt)}function Sm(W,st,dt){let lt=st.isScene===!0?st.overrideMaterial:null;for(let Ct=0,oe=W.length;Ct<oe;Ct++){let ae=W[Ct],ge=ae.object,de=ae.geometry,Le=lt===null?ae.material:lt,Me=ae.group;ge.layers.test(dt.layers)&&V$(ge,st,dt,de,Le,Me)}}function V$(W,st,dt,lt,Ct,oe){W.onBeforeRender(m,st,dt,lt,Ct,oe),W.modelViewMatrix.multiplyMatrices(dt.matrixWorldInverse,W.matrixWorld),W.normalMatrix.getNormalMatrix(W.modelViewMatrix),Ct.onBeforeRender(m,st,dt,lt,W,oe),Ct.transparent===!0&&Ct.side===ju?(Ct.side=Tn,Ct.needsUpdate=!0,m.renderBufferDirect(dt,st,lt,Ct,W,oe),Ct.side=ld,Ct.needsUpdate=!0,m.renderBufferDirect(dt,st,lt,Ct,W,oe),Ct.side=ju):m.renderBufferDirect(dt,st,lt,Ct,W,oe),W.onAfterRender(m,st,dt,lt,Ct,oe)}function Bb(W,st,dt){st.isScene!==!0&&(st=K);let lt=yt.get(W),Ct=p.state.lights,oe=p.state.shadowsArray,ae=Ct.state.version,ge=Dt.getParameters(W,Ct.state,oe,st,dt),de=Dt.getProgramCacheKey(ge),Le=lt.programs;lt.environment=W.isMeshStandardMaterial?st.environment:null,lt.fog=st.fog,lt.envMap=(W.isMeshStandardMaterial?ct:vt).get(W.envMap||lt.environment),Le===void 0&&(W.addEventListener("dispose",Ht),Le=new Map,lt.programs=Le);let Me=Le.get(de);if(Me!==void 0){if(lt.currentProgram===Me&&lt.lightsStateVersion===ae)return VE(W,ge),Me}else ge.uniforms=Dt.getUniforms(W),W.onBuild(dt,ge,m),W.onBeforeCompile(ge,m),Me=Dt.acquireProgram(ge,de),Le.set(de,Me),lt.uniforms=ge.uniforms;let Ee=lt.uniforms;(!W.isShaderMaterial&&!W.isRawShaderMaterial||W.clipping===!0)&&(Ee.clippingPlanes=j.uniform),VE(W,ge),lt.needsLights=U$(W),lt.lightsStateVersion=ae,lt.needsLights&&(Ee.ambientLightColor.value=Ct.state.ambient,Ee.lightProbe.value=Ct.state.probe,Ee.directionalLights.value=Ct.state.directional,Ee.directionalLightShadows.value=Ct.state.directionalShadow,Ee.spotLights.value=Ct.state.spot,Ee.spotLightShadows.value=Ct.state.spotShadow,Ee.rectAreaLights.value=Ct.state.rectArea,Ee.ltc_1.value=Ct.state.rectAreaLTC1,Ee.ltc_2.value=Ct.state.rectAreaLTC2,Ee.pointLights.value=Ct.state.point,Ee.pointLightShadows.value=Ct.state.pointShadow,Ee.hemisphereLights.value=Ct.state.hemi,Ee.directionalShadowMap.value=Ct.state.directionalShadowMap,Ee.directionalShadowMatrix.value=Ct.state.directionalShadowMatrix,Ee.spotShadowMap.value=Ct.state.spotShadowMap,Ee.spotShadowMatrix.value=Ct.state.spotShadowMatrix,Ee.pointShadowMap.value=Ct.state.pointShadowMap,Ee.pointShadowMatrix.value=Ct.state.pointShadowMatrix);let rn=Me.getUniforms(),ua=Us.seqWithValue(rn.seq,Ee);return lt.currentProgram=Me,lt.uniformsList=ua,Me}function VE(W,st){let dt=yt.get(W);dt.outputEncoding=st.outputEncoding,dt.instancing=st.instancing,dt.skinning=st.skinning,dt.morphTargets=st.morphTargets,dt.morphNormals=st.morphNormals,dt.morphTargetsCount=st.morphTargetsCount,dt.numClippingPlanes=st.numClippingPlanes,dt.numIntersection=st.numClipIntersection,dt.vertexAlphas=st.vertexAlphas,dt.vertexTangents=st.vertexTangents,dt.toneMapping=st.toneMapping}function H$(W,st,dt,lt,Ct){st.isScene!==!0&&(st=K),rt.resetTextureUnits();let oe=st.fog,ae=lt.isMeshStandardMaterial?st.environment:null,ge=b===null?m.outputEncoding:b.isXRRenderTarget===!0?b.texture.encoding:Ws,de=(lt.isMeshStandardMaterial?ct:vt).get(lt.envMap||ae),Le=lt.vertexColors===!0&&!!dt.attributes.color&&dt.attributes.color.itemSize===4,Me=!!lt.normalMap&&!!dt.attributes.tangent,Ee=!!dt.morphAttributes.position,rn=!!dt.morphAttributes.normal,ua=dt.morphAttributes.position?dt.morphAttributes.position.length:0,Ul=lt.toneMapped?m.toneMapping:Vs,Ae=yt.get(lt),Pr=p.state.lights;if(H===!0&&(X===!0||W!==_)){let lr=W===_&&lt.id===v;j.setState(lt,W,lr)}let wn=!1;lt.version===Ae.__version?(Ae.needsLights&&Ae.lightsStateVersion!==Pr.state.version||Ae.outputEncoding!==ge||Ct.isInstancedMesh&&Ae.instancing===!1||!Ct.isInstancedMesh&&Ae.instancing===!0||Ct.isSkinnedMesh&&Ae.skinning===!1||!Ct.isSkinnedMesh&&Ae.skinning===!0||Ae.envMap!==de||lt.fog&&Ae.fog!==oe||Ae.numClippingPlanes!==void 0&&(Ae.numClippingPlanes!==j.numPlanes||Ae.numIntersection!==j.numIntersection)||Ae.vertexAlphas!==Le||Ae.vertexTangents!==Me||Ae.morphTargets!==Ee||Ae.morphNormals!==rn||Ae.toneMapping!==Ul||at.isWebGL2===!0&&Ae.morphTargetsCount!==ua)&&(wn=!0):(wn=!0,Ae.__version=lt.version);let Nr=Ae.currentProgram;wn===!0&&(Nr=Bb(lt,st,Ct));let Cm=!1,Lr=!1,go=!1,Kn=Nr.getUniforms(),Lh=Ae.uniforms;if(it.useProgram(Nr.program)&&(Cm=!0,Lr=!0,go=!0),lt.id!==v&&(v=lt.id,Lr=!0),Cm||_!==W){if(Kn.setValue(G,"projectionMatrix",W.projectionMatrix),at.logarithmicDepthBuffer&&Kn.setValue(G,"logDepthBufFC",2/(Math.log(W.far+1)/Math.LN2)),_!==W&&(_=W,Lr=!0,go=!0),lt.isShaderMaterial||lt.isMeshPhongMaterial||lt.isMeshToonMaterial||lt.isMeshStandardMaterial||lt.envMap){let lr=Kn.map.cameraPosition;lr!==void 0&&lr.setValue(G,Z.setFromMatrixPosition(W.matrixWorld))}(lt.isMeshPhongMaterial||lt.isMeshToonMaterial||lt.isMeshLambertMaterial||lt.isMeshBasicMaterial||lt.isMeshStandardMaterial||lt.isShaderMaterial)&&Kn.setValue(G,"isOrthographic",W.isOrthographicCamera===!0),(lt.isMeshPhongMaterial||lt.isMeshToonMaterial||lt.isMeshLambertMaterial||lt.isMeshBasicMaterial||lt.isMeshStandardMaterial||lt.isShaderMaterial||lt.isShadowMaterial||Ct.isSkinnedMesh)&&Kn.setValue(G,"viewMatrix",W.matrixWorldInverse)}if(Ct.isSkinnedMesh){Kn.setOptional(G,Ct,"bindMatrix"),Kn.setOptional(G,Ct,"bindMatrixInverse");let lr=Ct.skeleton;lr&&(at.floatVertexTextures?(lr.boneTexture===null&&lr.computeBoneTexture(),Kn.setValue(G,"boneTexture",lr.boneTexture,rt),Kn.setValue(G,"boneTextureSize",lr.boneTextureSize)):Kn.setOptional(G,lr,"boneMatrices"))}return!!dt&&(dt.morphAttributes.position!==void 0||dt.morphAttributes.normal!==void 0)&&kt.update(Ct,dt,lt,Nr),(Lr||Ae.receiveShadow!==Ct.receiveShadow)&&(Ae.receiveShadow=Ct.receiveShadow,Kn.setValue(G,"receiveShadow",Ct.receiveShadow)),Lr&&(Kn.setValue(G,"toneMappingExposure",m.toneMappingExposure),Ae.needsLights&&$$(Lh,go),oe&&lt.fog&&Jt.refreshFogUniforms(Lh,oe),Jt.refreshMaterialUniforms(Lh,lt,w,I,U),Us.upload(G,Ae.uniformsList,Lh,rt)),lt.isShaderMaterial&&lt.uniformsNeedUpdate===!0&&(Us.upload(G,Ae.uniformsList,Lh,rt),lt.uniformsNeedUpdate=!1),lt.isSpriteMaterial&&Kn.setValue(G,"center",Ct.center),Kn.setValue(G,"modelViewMatrix",Ct.modelViewMatrix),Kn.setValue(G,"normalMatrix",Ct.normalMatrix),Kn.setValue(G,"modelMatrix",Ct.matrixWorld),Nr}function $$(W,st){W.ambientLightColor.needsUpdate=st,W.lightProbe.needsUpdate=st,W.directionalLights.needsUpdate=st,W.directionalLightShadows.needsUpdate=st,W.pointLights.needsUpdate=st,W.pointLightShadows.needsUpdate=st,W.spotLights.needsUpdate=st,W.spotLightShadows.needsUpdate=st,W.rectAreaLights.needsUpdate=st,W.hemisphereLights.needsUpdate=st}function U$(W){return W.isMeshLambertMaterial||W.isMeshToonMaterial||W.isMeshPhongMaterial||W.isMeshStandardMaterial||W.isShadowMaterial||W.isShaderMaterial&&W.lights===!0}this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(W,st,dt){yt.get(W.texture).__webglTexture=st,yt.get(W.depthTexture).__webglTexture=dt;let lt=yt.get(W);lt.__hasExternalTextures=!0,lt.__hasExternalTextures&&(lt.__autoAllocateDepthBuffer=dt===void 0,lt.__autoAllocateDepthBuffer||W.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),W.useRenderToTexture=!1,W.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(W,st){let dt=yt.get(W);dt.__webglFramebuffer=st,dt.__useDefaultFramebuffer=st===void 0},this.setRenderTarget=function(W,st=0,dt=0){b=W,g=st,y=dt;let lt=!0;if(W){let de=yt.get(W);de.__useDefaultFramebuffer!==void 0?(it.bindFramebuffer(36160,null),lt=!1):de.__webglFramebuffer===void 0?rt.setupRenderTarget(W):de.__hasExternalTextures&&rt.rebindTextures(W,yt.get(W.texture).__webglTexture,yt.get(W.depthTexture).__webglTexture)}let Ct=null,oe=!1,ae=!1;if(W){let de=W.texture;(de.isDataTexture3D||de.isDataTexture2DArray)&&(ae=!0);let Le=yt.get(W).__webglFramebuffer;W.isWebGLCubeRenderTarget?(Ct=Le[st],oe=!0):W.useRenderbuffer?Ct=yt.get(W).__webglMultisampledFramebuffer:Ct=Le,S.copy(W.viewport),E.copy(W.scissor),M=W.scissorTest}else S.copy(D).multiplyScalar(w).floor(),E.copy(F).multiplyScalar(w).floor(),M=z;if(it.bindFramebuffer(36160,Ct)&&at.drawBuffers&&lt&&it.drawBuffers(W,Ct),it.viewport(S),it.scissor(E),it.setScissorTest(M),oe){let de=yt.get(W.texture);G.framebufferTexture2D(36160,36064,34069+st,de.__webglTexture,dt)}else if(ae){let de=yt.get(W.texture),Le=st||0;G.framebufferTextureLayer(36160,36064,de.__webglTexture,dt||0,Le)}v=-1},this.readRenderTargetPixels=function(W,st,dt,lt,Ct,oe,ae){if(!(W&&W.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ge=yt.get(W).__webglFramebuffer;if(W.isWebGLCubeRenderTarget&&ae!==void 0&&(ge=ge[ae]),ge){it.bindFramebuffer(36160,ge);try{let de=W.texture,Le=de.format,Me=de.type;if(Le!==pi&&Ut.convert(Le)!==G.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Ee=Me===$u&&(et.has("EXT_color_buffer_half_float")||at.isWebGL2&&et.has("EXT_color_buffer_float"));if(Me!==Hs&&Ut.convert(Me)!==G.getParameter(35738)&&!(Me===hl&&(at.isWebGL2||et.has("OES_texture_float")||et.has("WEBGL_color_buffer_float")))&&!Ee){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}G.checkFramebufferStatus(36160)===36053?st>=0&&st<=W.width-lt&&dt>=0&&dt<=W.height-Ct&&G.readPixels(st,dt,lt,Ct,Ut.convert(Le),Ut.convert(Me),oe):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{let de=b!==null?yt.get(b).__webglFramebuffer:null;it.bindFramebuffer(36160,de)}}},this.copyFramebufferToTexture=function(W,st,dt=0){if(st.isFramebufferTexture!==!0){console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");return}let lt=Math.pow(2,-dt),Ct=Math.floor(st.image.width*lt),oe=Math.floor(st.image.height*lt);rt.setTexture2D(st,0),G.copyTexSubImage2D(3553,dt,0,0,W.x,W.y,Ct,oe),it.unbindTexture()},this.copyTextureToTexture=function(W,st,dt,lt=0){let Ct=st.image.width,oe=st.image.height,ae=Ut.convert(dt.format),ge=Ut.convert(dt.type);rt.setTexture2D(dt,0),G.pixelStorei(37440,dt.flipY),G.pixelStorei(37441,dt.premultiplyAlpha),G.pixelStorei(3317,dt.unpackAlignment),st.isDataTexture?G.texSubImage2D(3553,lt,W.x,W.y,Ct,oe,ae,ge,st.image.data):st.isCompressedTexture?G.compressedTexSubImage2D(3553,lt,W.x,W.y,st.mipmaps[0].width,st.mipmaps[0].height,ae,st.mipmaps[0].data):G.texSubImage2D(3553,lt,W.x,W.y,ae,ge,st.image),lt===0&&dt.generateMipmaps&&G.generateMipmap(3553),it.unbindTexture()},this.copyTextureToTexture3D=function(W,st,dt,lt,Ct=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let oe=W.max.x-W.min.x+1,ae=W.max.y-W.min.y+1,ge=W.max.z-W.min.z+1,de=Ut.convert(lt.format),Le=Ut.convert(lt.type),Me;if(lt.isDataTexture3D)rt.setTexture3D(lt,0),Me=32879;else if(lt.isDataTexture2DArray)rt.setTexture2DArray(lt,0),Me=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}G.pixelStorei(37440,lt.flipY),G.pixelStorei(37441,lt.premultiplyAlpha),G.pixelStorei(3317,lt.unpackAlignment);let Ee=G.getParameter(3314),rn=G.getParameter(32878),ua=G.getParameter(3316),Ul=G.getParameter(3315),Ae=G.getParameter(32877),Pr=dt.isCompressedTexture?dt.mipmaps[0]:dt.image;G.pixelStorei(3314,Pr.width),G.pixelStorei(32878,Pr.height),G.pixelStorei(3316,W.min.x),G.pixelStorei(3315,W.min.y),G.pixelStorei(32877,W.min.z),dt.isDataTexture||dt.isDataTexture3D?G.texSubImage3D(Me,Ct,st.x,st.y,st.z,oe,ae,ge,de,Le,Pr.data):dt.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),G.compressedTexSubImage3D(Me,Ct,st.x,st.y,st.z,oe,ae,ge,de,Pr.data)):G.texSubImage3D(Me,Ct,st.x,st.y,st.z,oe,ae,ge,de,Le,Pr),G.pixelStorei(3314,Ee),G.pixelStorei(32878,rn),G.pixelStorei(3316,ua),G.pixelStorei(3315,Ul),G.pixelStorei(32877,Ae),Ct===0&&lt.generateMipmaps&&G.generateMipmap(Me),it.unbindTexture()},this.initTexture=function(W){rt.setTexture2D(W,0),it.unbindTexture()},this.resetState=function(){g=0,y=0,b=null,it.reset(),Q.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Ne.prototype.isWebGLRenderer=!0;var cM=class extends Ne{};cM.prototype.isWebGL1Renderer=!0;var vd=class{constructor(t,e=25e-5){this.name="",this.color=new zt(t),this.density=e}clone(){return new vd(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}};vd.prototype.isFogExp2=!0;var gl=class{constructor(t,e=1,n=1e3){this.name="",this.color=new zt(t),this.near=e,this.far=n}clone(){return new gl(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}};gl.prototype.isFog=!0;var Ju=class extends Re{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){let e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),e}};Ju.prototype.isScene=!0;var xl=class{constructor(t,e){this.array=t,this.stride=e,this.count=t!==void 0?t.length/e:0,this.usage=ud,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Cr()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,o=this.stride;r<o;r++)this.array[t+r]=e.array[n+r];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Cr()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Cr()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};xl.prototype.isInterleavedBuffer=!0;var gn=new q,yl=class{constructor(t,e,n,r=!1){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=r===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)gn.x=this.getX(e),gn.y=this.getY(e),gn.z=this.getZ(e),gn.applyMatrix4(t),this.setXYZ(e,gn.x,gn.y,gn.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)gn.x=this.getX(e),gn.y=this.getY(e),gn.z=this.getZ(e),gn.applyNormalMatrix(t),this.setXYZ(e,gn.x,gn.y,gn.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)gn.x=this.getX(e),gn.y=this.getY(e),gn.z=this.getZ(e),gn.transformDirection(t),this.setXYZ(e,gn.x,gn.y,gn.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,e,n,r,o){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=o,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");let e=[];for(let n=0;n<this.count;n++){let r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)e.push(this.data.array[r+o])}return new we(new this.array.constructor(e),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new yl(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");let e=[];for(let n=0;n<this.count;n++){let r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)e.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};yl.prototype.isInterleavedBufferAttribute=!0;var Hv=class extends Hn{constructor(t){super(),this.type="SpriteMaterial",this.color=new zt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}};Hv.prototype.isSpriteMaterial=!0;var Lu,Jf=new q,Du=new q,zu=new q,Fu=new Et,Qf=new Et,j7=new te,dv=new q,td=new q,mv=new q,n7=new Et,U3=new Et,i7=new Et,uM=class extends Re{constructor(t){if(super(),this.type="Sprite",Lu===void 0){Lu=new Pe;let e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new xl(e,5);Lu.setIndex([0,1,2,0,2,3]),Lu.setAttribute("position",new yl(n,3,0,!1)),Lu.setAttribute("uv",new yl(n,2,3,!1))}this.geometry=Lu,this.material=t!==void 0?t:new Hv,this.center=new Et(.5,.5)}raycast(t,e){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Du.setFromMatrixScale(this.matrixWorld),j7.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),zu.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Du.multiplyScalar(-zu.z);let n=this.material.rotation,r,o;n!==0&&(o=Math.cos(n),r=Math.sin(n));let s=this.center;gv(dv.set(-.5,-.5,0),zu,s,Du,r,o),gv(td.set(.5,-.5,0),zu,s,Du,r,o),gv(mv.set(.5,.5,0),zu,s,Du,r,o),n7.set(0,0),U3.set(1,0),i7.set(1,1);let a=t.ray.intersectTriangle(dv,td,mv,!1,Jf);if(a===null&&(gv(td.set(-.5,.5,0),zu,s,Du,r,o),U3.set(0,1),a=t.ray.intersectTriangle(dv,mv,td,!1,Jf),a===null))return;let l=t.ray.origin.distanceTo(Jf);l<t.near||l>t.far||e.push({distance:l,point:Jf.clone(),uv:sn.getUV(Jf,dv,td,mv,n7,U3,i7,new Et),face:null,object:this})}copy(t){return super.copy(t),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}};uM.prototype.isSprite=!0;function gv(i,t,e,n,r,o){Fu.subVectors(i,e).addScalar(.5).multiply(n),r!==void 0?(Qf.x=o*Fu.x-r*Fu.y,Qf.y=r*Fu.x+o*Fu.y):Qf.copy(Fu),i.copy(t),i.x+=Qf.x,i.y+=Qf.y,i.applyMatrix4(j7)}var r7=new q,o7=new ze,s7=new ze,Hht=new q,a7=new te,$v=class extends ni{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new te,this.bindMatrixInverse=new te}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let t=new ze,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);let o=1/t.manhattanLength();o!==1/0?t.multiplyScalar(o):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){let n=this.skeleton,r=this.geometry;o7.fromBufferAttribute(r.attributes.skinIndex,t),s7.fromBufferAttribute(r.attributes.skinWeight,t),r7.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let o=0;o<4;o++){let s=s7.getComponent(o);if(s!==0){let a=o7.getComponent(o);a7.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),e.addScaledVector(Hht.copy(r7).applyMatrix4(a7),s)}}return e.applyMatrix4(this.bindMatrixInverse)}};$v.prototype.isSkinnedMesh=!0;var hM=class extends Re{constructor(){super(),this.type="Bone"}};hM.prototype.isBone=!0;var pM=class extends ln{constructor(t=null,e=1,n=1,r,o,s,a,l,c=In,u=In,h,p){super(null,s,a,l,c,u,r,o,h,p),this.image={data:t,width:e,height:n},this.magFilter=c,this.minFilter=u,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};pM.prototype.isDataTexture=!0;var bd=class extends we{constructor(t,e,n,r=1){typeof n=="number"&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){let t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}};bd.prototype.isInstancedBufferAttribute=!0;var l7=new te,c7=new te,xv=[],ed=new ni,fM=class extends ni{constructor(t,e,n){super(t,e),this.instanceMatrix=new bd(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),t.instanceColor!==null&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,t*3)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,t*16)}raycast(t,e){let n=this.matrixWorld,r=this.count;if(ed.geometry=this.geometry,ed.material=this.material,ed.material!==void 0)for(let o=0;o<r;o++){this.getMatrixAt(o,l7),c7.multiplyMatrices(n,l7),ed.matrixWorld=c7,ed.raycast(t,xv);for(let s=0,a=xv.length;s<a;s++){let l=xv[s];l.instanceId=o,l.object=this,e.push(l)}xv.length=0}}setColorAt(t,e){this.instanceColor===null&&(this.instanceColor=new bd(new Float32Array(this.instanceMatrix.count*3),3)),e.toArray(this.instanceColor.array,t*3)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,t*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}};fM.prototype.isInstancedMesh=!0;var ro=class extends Hn{constructor(t){super(),this.type="LineBasicMaterial",this.color=new zt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this}};ro.prototype.isLineBasicMaterial=!0;var u7=new q,h7=new q,p7=new te,W3=new js,yv=new Gs,_d=class extends Re{constructor(t=new Pe,e=new ro){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){let t=this.geometry;if(t.isBufferGeometry)if(t.index===null){let e=t.attributes.position,n=[0];for(let r=1,o=e.count;r<o;r++)u7.fromBufferAttribute(e,r-1),h7.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=u7.distanceTo(h7);t.setAttribute("lineDistance",new an(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){let n=this.geometry,r=this.matrixWorld,o=t.params.Line.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),yv.copy(n.boundingSphere),yv.applyMatrix4(r),yv.radius+=o,t.ray.intersectsSphere(yv)===!1)return;p7.copy(r).invert(),W3.copy(t.ray).applyMatrix4(p7);let a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new q,u=new q,h=new q,p=new q,f=this.isLineSegments?2:1;if(n.isBufferGeometry){let d=n.index,x=n.attributes.position;if(d!==null){let g=Math.max(0,s.start),y=Math.min(d.count,s.start+s.count);for(let b=g,v=y-1;b<v;b+=f){let _=d.getX(b),S=d.getX(b+1);if(c.fromBufferAttribute(x,_),u.fromBufferAttribute(x,S),W3.distanceSqToSegment(c,u,p,h)>l)continue;p.applyMatrix4(this.matrixWorld);let M=t.ray.origin.distanceTo(p);M<t.near||M>t.far||e.push({distance:M,point:h.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}else{let g=Math.max(0,s.start),y=Math.min(x.count,s.start+s.count);for(let b=g,v=y-1;b<v;b+=f){if(c.fromBufferAttribute(x,b),u.fromBufferAttribute(x,b+1),W3.distanceSqToSegment(c,u,p,h)>l)continue;p.applyMatrix4(this.matrixWorld);let S=t.ray.origin.distanceTo(p);S<t.near||S>t.far||e.push({distance:S,point:h.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){let t=this.geometry;if(t.isBufferGeometry){let e=t.morphAttributes,n=Object.keys(e);if(n.length>0){let r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){let a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{let e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}};_d.prototype.isLine=!0;var f7=new q,d7=new q,Xs=class extends _d{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){let t=this.geometry;if(t.isBufferGeometry)if(t.index===null){let e=t.attributes.position,n=[];for(let r=0,o=e.count;r<o;r+=2)f7.fromBufferAttribute(e,r),d7.fromBufferAttribute(e,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+f7.distanceTo(d7);t.setAttribute("lineDistance",new an(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}};Xs.prototype.isLineSegments=!0;var dM=class extends _d{constructor(t,e){super(t,e),this.type="LineLoop"}};dM.prototype.isLineLoop=!0;var Uv=class extends Hn{constructor(t){super(),this.type="PointsMaterial",this.color=new zt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this}};Uv.prototype.isPointsMaterial=!0;var m7=new te,mM=new js,vv=new Gs,bv=new q,wd=class extends Re{constructor(t=new Pe,e=new Uv){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){let n=this.geometry,r=this.matrixWorld,o=t.params.Points.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),vv.copy(n.boundingSphere),vv.applyMatrix4(r),vv.radius+=o,t.ray.intersectsSphere(vv)===!1)return;m7.copy(r).invert(),mM.copy(t.ray).applyMatrix4(m7);let a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a;if(n.isBufferGeometry){let c=n.index,h=n.attributes.position;if(c!==null){let p=Math.max(0,s.start),f=Math.min(c.count,s.start+s.count);for(let d=p,m=f;d<m;d++){let x=c.getX(d);bv.fromBufferAttribute(h,x),g7(bv,x,l,r,t,e,this)}}else{let p=Math.max(0,s.start),f=Math.min(h.count,s.start+s.count);for(let d=p,m=f;d<m;d++)bv.fromBufferAttribute(h,d),g7(bv,d,l,r,t,e,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){let t=this.geometry;if(t.isBufferGeometry){let e=t.morphAttributes,n=Object.keys(e);if(n.length>0){let r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){let a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{let e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}};wd.prototype.isPoints=!0;function g7(i,t,e,n,r,o,s){let a=mM.distanceSqToPoint(i);if(a<e){let l=new q;mM.closestPointToPoint(i,l),l.applyMatrix4(n);let c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;o.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:t,face:null,object:s})}}var gM=class extends ln{constructor(t,e,n,r,o,s,a,l,c){super(t,e,n,r,o,s,a,l,c),this.minFilter=s!==void 0?s:_n,this.magFilter=o!==void 0?o:_n,this.generateMipmaps=!1;let u=this;function h(){u.needsUpdate=!0,t.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){let t=this.image;"requestVideoFrameCallback"in t===!1&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}};gM.prototype.isVideoTexture=!0;var xM=class extends ln{constructor(t,e,n){super({width:t,height:e}),this.format=n,this.magFilter=In,this.minFilter=In,this.generateMipmaps=!1,this.needsUpdate=!0}};xM.prototype.isFramebufferTexture=!0;var yM=class extends ln{constructor(t,e,n,r,o,s,a,l,c,u,h,p){super(null,s,a,l,c,u,r,o,h,p),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}};yM.prototype.isCompressedTexture=!0;var vM=class extends ln{constructor(t,e,n,r,o,s,a,l,c){super(t,e,n,r,o,s,a,l,c),this.needsUpdate=!0}};vM.prototype.isCanvasTexture=!0;var jle=new q,qle=new q,Xle=new q,Kle=new sn;var _i=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){let n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){let e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){let e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){let t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let e=[],n,r=this.getPoint(0),o=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),o+=n.distanceTo(r),e.push(o),r=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){let n=this.getLengths(),r=0,o=n.length,s;e?s=e:s=t*n[o-1];let a=0,l=o-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=n[r]-s,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,n[r]===s)return r/(o-1);let u=n[r],p=n[r+1]-u,f=(s-u)/p;return(r+f)/(o-1)}getTangent(t,e){let r=t-1e-4,o=t+1e-4;r<0&&(r=0),o>1&&(o=1);let s=this.getPoint(r),a=this.getPoint(o),l=e||(s.isVector2?new Et:new q);return l.copy(a).sub(s).normalize(),l}getTangentAt(t,e){let n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){let n=new q,r=[],o=[],s=[],a=new q,l=new te;for(let f=0;f<=t;f++){let d=f/t;r[f]=this.getTangentAt(d,new q)}o[0]=new q,s[0]=new q;let c=Number.MAX_VALUE,u=Math.abs(r[0].x),h=Math.abs(r[0].y),p=Math.abs(r[0].z);u<=c&&(c=u,n.set(1,0,0)),h<=c&&(c=h,n.set(0,1,0)),p<=c&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),o[0].crossVectors(r[0],a),s[0].crossVectors(r[0],o[0]);for(let f=1;f<=t;f++){if(o[f]=o[f-1].clone(),s[f]=s[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();let d=Math.acos(hi(r[f-1].dot(r[f]),-1,1));o[f].applyMatrix4(l.makeRotationAxis(a,d))}s[f].crossVectors(r[f],o[f])}if(e===!0){let f=Math.acos(hi(o[0].dot(o[t]),-1,1));f/=t,r[0].dot(a.crossVectors(o[0],o[t]))>0&&(f=-f);for(let d=1;d<=t;d++)o[d].applyMatrix4(l.makeRotationAxis(r[d],f*d)),s[d].crossVectors(r[d],o[d])}return{tangents:r,normals:o,binormals:s}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){let t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}},Qu=class extends _i{constructor(t=0,e=0,n=1,r=1,o=0,s=Math.PI*2,a=!1,l=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=o,this.aEndAngle=s,this.aClockwise=a,this.aRotation=l}getPoint(t,e){let n=e||new Et,r=Math.PI*2,o=this.aEndAngle-this.aStartAngle,s=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(s?o=0:o=r),this.aClockwise===!0&&!s&&(o===r?o=-r:o=o-r);let a=this.aStartAngle+t*o,l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),p=l-this.aX,f=c-this.aY;l=p*u-f*h+this.aX,c=p*h+f*u+this.aY}return n.set(l,c)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){let t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}};Qu.prototype.isEllipseCurve=!0;var Wv=class extends Qu{constructor(t,e,n,r,o,s){super(t,e,n,n,r,o,s),this.type="ArcCurve"}};Wv.prototype.isArcCurve=!0;function p4(){let i=0,t=0,e=0,n=0;function r(o,s,a,l){i=o,t=a,e=-3*o+3*s-2*a-l,n=2*o-2*s+a+l}return{initCatmullRom:function(o,s,a,l,c){r(s,a,c*(a-o),c*(l-s))},initNonuniformCatmullRom:function(o,s,a,l,c,u,h){let p=(s-o)/c-(a-o)/(c+u)+(a-s)/u,f=(a-s)/u-(l-s)/(u+h)+(l-a)/h;p*=u,f*=u,r(s,a,p,f)},calc:function(o){let s=o*o,a=s*o;return i+t*o+e*s+n*a}}}var _v=new q,G3=new p4,j3=new p4,q3=new p4,Gv=class extends _i{constructor(t=[],e=!1,n="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=r}getPoint(t,e=new q){let n=e,r=this.points,o=r.length,s=(o-(this.closed?0:1))*t,a=Math.floor(s),l=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/o)+1)*o:l===0&&a===o-1&&(a=o-2,l=1);let c,u;this.closed||a>0?c=r[(a-1)%o]:(_v.subVectors(r[0],r[1]).add(r[0]),c=_v);let h=r[a%o],p=r[(a+1)%o];if(this.closed||a+2<o?u=r[(a+2)%o]:(_v.subVectors(r[o-1],r[o-2]).add(r[o-1]),u=_v),this.curveType==="centripetal"||this.curveType==="chordal"){let f=this.curveType==="chordal"?.5:.25,d=Math.pow(c.distanceToSquared(h),f),m=Math.pow(h.distanceToSquared(p),f),x=Math.pow(p.distanceToSquared(u),f);m<1e-4&&(m=1),d<1e-4&&(d=m),x<1e-4&&(x=m),G3.initNonuniformCatmullRom(c.x,h.x,p.x,u.x,d,m,x),j3.initNonuniformCatmullRom(c.y,h.y,p.y,u.y,d,m,x),q3.initNonuniformCatmullRom(c.z,h.z,p.z,u.z,d,m,x)}else this.curveType==="catmullrom"&&(G3.initCatmullRom(c.x,h.x,p.x,u.x,this.tension),j3.initCatmullRom(c.y,h.y,p.y,u.y,this.tension),q3.initCatmullRom(c.z,h.z,p.z,u.z,this.tension));return n.set(G3.calc(l),j3.calc(l),q3.calc(l)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){let r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let r=t.points[e];this.points.push(new q().fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}};Gv.prototype.isCatmullRomCurve3=!0;function x7(i,t,e,n,r){let o=(n-t)*.5,s=(r-e)*.5,a=i*i,l=i*a;return(2*e-2*n+o+s)*l+(-3*e+3*n-2*o-s)*a+o*i+e}function $ht(i,t){let e=1-i;return e*e*t}function Uht(i,t){return 2*(1-i)*i*t}function Wht(i,t){return i*i*t}function sd(i,t,e,n){return $ht(i,t)+Uht(i,e)+Wht(i,n)}function Ght(i,t){let e=1-i;return e*e*e*t}function jht(i,t){let e=1-i;return 3*e*e*i*t}function qht(i,t){return 3*(1-i)*i*i*t}function Xht(i,t){return i*i*i*t}function ad(i,t,e,n,r){return Ght(i,t)+jht(i,e)+qht(i,n)+Xht(i,r)}var Sd=class extends _i{constructor(t=new Et,e=new Et,n=new Et,r=new Et){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new Et){let n=e,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return n.set(ad(t,r.x,o.x,s.x,a.x),ad(t,r.y,o.y,s.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}};Sd.prototype.isCubicBezierCurve=!0;var jv=class extends _i{constructor(t=new q,e=new q,n=new q,r=new q){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new q){let n=e,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return n.set(ad(t,r.x,o.x,s.x,a.x),ad(t,r.y,o.y,s.y,a.y),ad(t,r.z,o.z,s.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}};jv.prototype.isCubicBezierCurve3=!0;var th=class extends _i{constructor(t=new Et,e=new Et){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Et){let n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){let n=e||new Et;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}};th.prototype.isLineCurve=!0;var bM=class extends _i{constructor(t=new q,e=new q){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=e}getPoint(t,e=new q){let n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},Cd=class extends _i{constructor(t=new Et,e=new Et,n=new Et){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Et){let n=e,r=this.v0,o=this.v1,s=this.v2;return n.set(sd(t,r.x,o.x,s.x),sd(t,r.y,o.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}};Cd.prototype.isQuadraticBezierCurve=!0;var qv=class extends _i{constructor(t=new q,e=new q,n=new q){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new q){let n=e,r=this.v0,o=this.v1,s=this.v2;return n.set(sd(t,r.x,o.x,s.x),sd(t,r.y,o.y,s.y),sd(t,r.z,o.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}};qv.prototype.isQuadraticBezierCurve3=!0;var Md=class extends _i{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new Et){let n=e,r=this.points,o=(r.length-1)*t,s=Math.floor(o),a=o-s,l=r[s===0?s:s-1],c=r[s],u=r[s>r.length-2?r.length-1:s+1],h=r[s>r.length-3?r.length-1:s+2];return n.set(x7(a,l.x,c.x,u.x,h.x),x7(a,l.y,c.y,u.y,h.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let r=t.points[e];this.points.push(r.clone())}return this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){let r=this.points[e];t.points.push(r.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let r=t.points[e];this.points.push(new Et().fromArray(r))}return this}};Md.prototype.isSplineCurve=!0;var q7=Object.freeze({__proto__:null,ArcCurve:Wv,CatmullRomCurve3:Gv,CubicBezierCurve:Sd,CubicBezierCurve3:jv,EllipseCurve:Qu,LineCurve:th,LineCurve3:bM,QuadraticBezierCurve:Cd,QuadraticBezierCurve3:qv,SplineCurve:Md}),_M=class extends _i{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){let t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new th(e,t))}getPoint(t,e){let n=t*this.getLength(),r=this.getCurveLengths(),o=0;for(;o<r.length;){if(r[o]>=n){let s=r[o]-n,a=this.curves[o],l=a.getLength(),c=l===0?0:1-s/l;return a.getPointAt(c,e)}o++}return null}getLength(){let t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let t=[],e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){let e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){let e=[],n;for(let r=0,o=this.curves;r<o.length;r++){let s=o[r],a=s&&s.isEllipseCurve?t*2:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?t*s.points.length:t,l=s.getPoints(a);for(let c=0;c<l.length;c++){let u=l[c];n&&n.equals(u)||(e.push(u),n=u)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){let r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this}toJSON(){let t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){let r=this.curves[e];t.curves.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){let r=t.curves[e];this.curves.push(new q7[r.type]().fromJSON(r))}return this}},Ed=class extends _M{constructor(t){super(),this.type="Path",this.currentPoint=new Et,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){let n=new th(this.currentPoint.clone(),new Et(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,r){let o=new Cd(this.currentPoint.clone(),new Et(t,e),new Et(n,r));return this.curves.push(o),this.currentPoint.set(n,r),this}bezierCurveTo(t,e,n,r,o,s){let a=new Sd(this.currentPoint.clone(),new Et(t,e),new Et(n,r),new Et(o,s));return this.curves.push(a),this.currentPoint.set(o,s),this}splineThru(t){let e=[this.currentPoint.clone()].concat(t),n=new Md(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,r,o,s){let a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(t+a,e+l,n,r,o,s),this}absarc(t,e,n,r,o,s){return this.absellipse(t,e,n,n,r,o,s),this}ellipse(t,e,n,r,o,s,a,l){let c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+c,e+u,n,r,o,s,a,l),this}absellipse(t,e,n,r,o,s,a,l){let c=new Qu(t,e,n,r,o,s,a,l);if(this.curves.length>0){let h=c.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(c);let u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){let t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}},vl=class extends Ed{constructor(t){super(t),this.uuid=Cr(),this.type="Shape",this.holes=[]}getPointsHoles(t){let e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){let r=t.holes[e];this.holes.push(r.clone())}return this}toJSON(){let t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){let r=this.holes[e];t.holes.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){let r=t.holes[e];this.holes.push(new Ed().fromJSON(r))}return this}},Kht={triangulate:function(i,t,e=2){let n=t&&t.length,r=n?t[0]*e:i.length,o=X7(i,0,r,e,!0),s=[];if(!o||o.next===o.prev)return s;let a,l,c,u,h,p,f;if(n&&(o=tpt(i,t,o,e)),i.length>80*e){a=c=i[0],l=u=i[1];for(let d=e;d<r;d+=e)h=i[d],p=i[d+1],h<a&&(a=h),p<l&&(l=p),h>c&&(c=h),p>u&&(u=p);f=Math.max(c-a,u-l),f=f!==0?1/f:0}return Td(o,s,e,a,l,f),s}};function X7(i,t,e,n,r){let o,s;if(r===hpt(i,t,e,n)>0)for(o=t;o<e;o+=n)s=y7(o,i[o],i[o+1],s);else for(o=e-n;o>=t;o-=n)s=y7(o,i[o],i[o+1],s);return s&&l2(s,s.next)&&(Ad(s),s=s.next),s}function Ks(i,t){if(!i)return i;t||(t=i);let e=i,n;do if(n=!1,!e.steiner&&(l2(e,e.next)||tn(e.prev,e,e.next)===0)){if(Ad(e),e=t=e.prev,e===e.next)break;n=!0}else e=e.next;while(n||e!==t);return t}function Td(i,t,e,n,r,o,s){if(!i)return;!s&&o&&opt(i,n,r,o);let a=i,l,c;for(;i.prev!==i.next;){if(l=i.prev,c=i.next,o?Zht(i,n,r,o):Yht(i)){t.push(l.i/e),t.push(i.i/e),t.push(c.i/e),Ad(i),i=c.next,a=c.next;continue}if(i=c,i===a){s?s===1?(i=Jht(Ks(i),t,e),Td(i,t,e,n,r,o,2)):s===2&&Qht(i,t,e,n,r,o):Td(Ks(i),t,e,n,r,o,1);break}}}function Yht(i){let t=i.prev,e=i,n=i.next;if(tn(t,e,n)>=0)return!1;let r=i.next.next;for(;r!==i.prev;){if(Hu(t.x,t.y,e.x,e.y,n.x,n.y,r.x,r.y)&&tn(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Zht(i,t,e,n){let r=i.prev,o=i,s=i.next;if(tn(r,o,s)>=0)return!1;let a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,l=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,c=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,u=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,h=wM(a,l,t,e,n),p=wM(c,u,t,e,n),f=i.prevZ,d=i.nextZ;for(;f&&f.z>=h&&d&&d.z<=p;){if(f!==i.prev&&f!==i.next&&Hu(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&tn(f.prev,f,f.next)>=0||(f=f.prevZ,d!==i.prev&&d!==i.next&&Hu(r.x,r.y,o.x,o.y,s.x,s.y,d.x,d.y)&&tn(d.prev,d,d.next)>=0))return!1;d=d.nextZ}for(;f&&f.z>=h;){if(f!==i.prev&&f!==i.next&&Hu(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&tn(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;d&&d.z<=p;){if(d!==i.prev&&d!==i.next&&Hu(r.x,r.y,o.x,o.y,s.x,s.y,d.x,d.y)&&tn(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Jht(i,t,e){let n=i;do{let r=n.prev,o=n.next.next;!l2(r,o)&&K7(r,n,n.next,o)&&Id(r,o)&&Id(o,r)&&(t.push(r.i/e),t.push(n.i/e),t.push(o.i/e),Ad(n),Ad(n.next),n=i=o),n=n.next}while(n!==i);return Ks(n)}function Qht(i,t,e,n,r,o){let s=i;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&lpt(s,a)){let l=Y7(s,a);s=Ks(s,s.next),l=Ks(l,l.next),Td(s,t,e,n,r,o),Td(l,t,e,n,r,o);return}a=a.next}s=s.next}while(s!==i)}function tpt(i,t,e,n){let r=[],o,s,a,l,c;for(o=0,s=t.length;o<s;o++)a=t[o]*n,l=o<s-1?t[o+1]*n:i.length,c=X7(i,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(apt(c));for(r.sort(ept),o=0;o<r.length;o++)npt(r[o],e),e=Ks(e,e.next);return e}function ept(i,t){return i.x-t.x}function npt(i,t){if(t=ipt(i,t),t){let e=Y7(t,i);Ks(t,t.next),Ks(e,e.next)}}function ipt(i,t){let e=t,n=i.x,r=i.y,o=-1/0,s;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){let p=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(p<=n&&p>o){if(o=p,p===n){if(r===e.y)return e;if(r===e.next.y)return e.next}s=e.x<e.next.x?e:e.next}}e=e.next}while(e!==t);if(!s)return null;if(n===o)return s;let a=s,l=s.x,c=s.y,u=1/0,h;e=s;do n>=e.x&&e.x>=l&&n!==e.x&&Hu(r<c?n:o,r,l,c,r<c?o:n,r,e.x,e.y)&&(h=Math.abs(r-e.y)/(n-e.x),Id(e,i)&&(h<u||h===u&&(e.x>s.x||e.x===s.x&&rpt(s,e)))&&(s=e,u=h)),e=e.next;while(e!==a);return s}function rpt(i,t){return tn(i.prev,i,t.prev)<0&&tn(t.next,i,i.next)<0}function opt(i,t,e,n){let r=i;do r.z===null&&(r.z=wM(r.x,r.y,t,e,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,spt(r)}function spt(i){let t,e,n,r,o,s,a,l,c=1;do{for(e=i,i=null,o=null,s=0;e;){for(s++,n=e,a=0,t=0;t<c&&(a++,n=n.nextZ,!!n);t++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||e.z<=n.z)?(r=e,e=e.nextZ,a--):(r=n,n=n.nextZ,l--),o?o.nextZ=r:i=r,r.prevZ=o,o=r;e=n}o.nextZ=null,c*=2}while(s>1);return i}function wM(i,t,e,n,r){return i=32767*(i-e)*r,t=32767*(t-n)*r,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function apt(i){let t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function Hu(i,t,e,n,r,o,s,a){return(r-s)*(t-a)-(i-s)*(o-a)>=0&&(i-s)*(n-a)-(e-s)*(t-a)>=0&&(e-s)*(o-a)-(r-s)*(n-a)>=0}function lpt(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!cpt(i,t)&&(Id(i,t)&&Id(t,i)&&upt(i,t)&&(tn(i.prev,i,t.prev)||tn(i,t.prev,t))||l2(i,t)&&tn(i.prev,i,i.next)>0&&tn(t.prev,t,t.next)>0)}function tn(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function l2(i,t){return i.x===t.x&&i.y===t.y}function K7(i,t,e,n){let r=Sv(tn(i,t,e)),o=Sv(tn(i,t,n)),s=Sv(tn(e,n,i)),a=Sv(tn(e,n,t));return!!(r!==o&&s!==a||r===0&&wv(i,e,t)||o===0&&wv(i,n,t)||s===0&&wv(e,i,n)||a===0&&wv(e,t,n))}function wv(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function Sv(i){return i>0?1:i<0?-1:0}function cpt(i,t){let e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&K7(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function Id(i,t){return tn(i.prev,i,i.next)<0?tn(i,t,i.next)>=0&&tn(i,i.prev,t)>=0:tn(i,t,i.prev)<0||tn(i,i.next,t)<0}function upt(i,t){let e=i,n=!1,r=(i.x+t.x)/2,o=(i.y+t.y)/2;do e.y>o!=e.next.y>o&&e.next.y!==e.y&&r<(e.next.x-e.x)*(o-e.y)/(e.next.y-e.y)+e.x&&(n=!n),e=e.next;while(e!==i);return n}function Y7(i,t){let e=new SM(i.i,i.x,i.y),n=new SM(t.i,t.x,t.y),r=i.next,o=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,n.next=e,e.prev=n,o.next=n,n.prev=o,n}function y7(i,t,e,n){let r=new SM(i,t,e);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Ad(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function SM(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function hpt(i,t,e,n){let r=0;for(let o=t,s=e-n;o<e;o+=n)r+=(i[s]-i[o])*(i[o+1]+i[s+1]),s=o;return r}var io=class{static area(t){let e=t.length,n=0;for(let r=e-1,o=0;o<e;r=o++)n+=t[r].x*t[o].y-t[o].x*t[r].y;return n*.5}static isClockWise(t){return io.area(t)<0}static triangulateShape(t,e){let n=[],r=[],o=[];v7(t),b7(n,t);let s=t.length;e.forEach(v7);for(let l=0;l<e.length;l++)r.push(s),s+=e[l].length,b7(n,e[l]);let a=Kht.triangulate(n,r);for(let l=0;l<a.length;l+=3)o.push(a.slice(l,l+3));return o}};function v7(i){let t=i.length;t>2&&i[t-1].equals(i[0])&&i.pop()}function b7(i,t){for(let e=0;e<t.length;e++)i.push(t[e].x),i.push(t[e].y)}var Ys=class extends Pe{constructor(t=new vl([new Et(.5,.5),new Et(-.5,.5),new Et(-.5,-.5),new Et(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];let n=this,r=[],o=[];for(let a=0,l=t.length;a<l;a++){let c=t[a];s(c)}this.setAttribute("position",new an(r,3)),this.setAttribute("uv",new an(o,2)),this.computeVertexNormals();function s(a){let l=[],c=e.curveSegments!==void 0?e.curveSegments:12,u=e.steps!==void 0?e.steps:1,h=e.depth!==void 0?e.depth:1,p=e.bevelEnabled!==void 0?e.bevelEnabled:!0,f=e.bevelThickness!==void 0?e.bevelThickness:.2,d=e.bevelSize!==void 0?e.bevelSize:f-.1,m=e.bevelOffset!==void 0?e.bevelOffset:0,x=e.bevelSegments!==void 0?e.bevelSegments:3,g=e.extrudePath,y=e.UVGenerator!==void 0?e.UVGenerator:ppt;e.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),h=e.amount);let b,v=!1,_,S,E,M;g&&(b=g.getSpacedPoints(u),v=!0,p=!1,_=g.computeFrenetFrames(u,!1),S=new q,E=new q,M=new q),p||(x=0,f=0,d=0,m=0);let N=a.extractPoints(c),I=N.shape,w=N.holes;if(!io.isClockWise(I)){I=I.reverse();for(let rt=0,vt=w.length;rt<vt;rt++){let ct=w[rt];io.isClockWise(ct)&&(w[rt]=ct.reverse())}}let P=io.triangulateShape(I,w),D=I;for(let rt=0,vt=w.length;rt<vt;rt++){let ct=w[rt];I=I.concat(ct)}function F(rt,vt,ct){return vt||console.error("THREE.ExtrudeGeometry: vec does not exist"),vt.clone().multiplyScalar(ct).add(rt)}let z=I.length,V=P.length;function H(rt,vt,ct){let _t,gt,Pt,Dt=rt.x-vt.x,Jt=rt.y-vt.y,Qt=ct.x-rt.x,re=ct.y-rt.y,j=Dt*Dt+Jt*Jt,$=Dt*re-Jt*Qt;if(Math.abs($)>Number.EPSILON){let ft=Math.sqrt(j),kt=Math.sqrt(Qt*Qt+re*re),Vt=vt.x-Jt/ft,mt=vt.y+Dt/ft,Ut=ct.x-re/kt,Q=ct.y+Qt/kt,xt=((Ut-Vt)*re-(Q-mt)*Qt)/(Dt*re-Jt*Qt);_t=Vt+Dt*xt-rt.x,gt=mt+Jt*xt-rt.y;let At=_t*_t+gt*gt;if(At<=2)return new Et(_t,gt);Pt=Math.sqrt(At/2)}else{let ft=!1;Dt>Number.EPSILON?Qt>Number.EPSILON&&(ft=!0):Dt<-Number.EPSILON?Qt<-Number.EPSILON&&(ft=!0):Math.sign(Jt)===Math.sign(re)&&(ft=!0),ft?(_t=-Jt,gt=Dt,Pt=Math.sqrt(j)):(_t=Dt,gt=Jt,Pt=Math.sqrt(j/2))}return new Et(_t/Pt,gt/Pt)}let X=[];for(let rt=0,vt=D.length,ct=vt-1,_t=rt+1;rt<vt;rt++,ct++,_t++)ct===vt&&(ct=0),_t===vt&&(_t=0),X[rt]=H(D[rt],D[ct],D[_t]);let U=[],Y,Z=X.concat();for(let rt=0,vt=w.length;rt<vt;rt++){let ct=w[rt];Y=[];for(let _t=0,gt=ct.length,Pt=gt-1,Dt=_t+1;_t<gt;_t++,Pt++,Dt++)Pt===gt&&(Pt=0),Dt===gt&&(Dt=0),Y[_t]=H(ct[_t],ct[Pt],ct[Dt]);U.push(Y),Z=Z.concat(Y)}for(let rt=0;rt<x;rt++){let vt=rt/x,ct=f*Math.cos(vt*Math.PI/2),_t=d*Math.sin(vt*Math.PI/2)+m;for(let gt=0,Pt=D.length;gt<Pt;gt++){let Dt=F(D[gt],X[gt],_t);et(Dt.x,Dt.y,-ct)}for(let gt=0,Pt=w.length;gt<Pt;gt++){let Dt=w[gt];Y=U[gt];for(let Jt=0,Qt=Dt.length;Jt<Qt;Jt++){let re=F(Dt[Jt],Y[Jt],_t);et(re.x,re.y,-ct)}}}let K=d+m;for(let rt=0;rt<z;rt++){let vt=p?F(I[rt],Z[rt],K):I[rt];v?(E.copy(_.normals[0]).multiplyScalar(vt.x),S.copy(_.binormals[0]).multiplyScalar(vt.y),M.copy(b[0]).add(E).add(S),et(M.x,M.y,M.z)):et(vt.x,vt.y,0)}for(let rt=1;rt<=u;rt++)for(let vt=0;vt<z;vt++){let ct=p?F(I[vt],Z[vt],K):I[vt];v?(E.copy(_.normals[rt]).multiplyScalar(ct.x),S.copy(_.binormals[rt]).multiplyScalar(ct.y),M.copy(b[rt]).add(E).add(S),et(M.x,M.y,M.z)):et(ct.x,ct.y,h/u*rt)}for(let rt=x-1;rt>=0;rt--){let vt=rt/x,ct=f*Math.cos(vt*Math.PI/2),_t=d*Math.sin(vt*Math.PI/2)+m;for(let gt=0,Pt=D.length;gt<Pt;gt++){let Dt=F(D[gt],X[gt],_t);et(Dt.x,Dt.y,h+ct)}for(let gt=0,Pt=w.length;gt<Pt;gt++){let Dt=w[gt];Y=U[gt];for(let Jt=0,Qt=Dt.length;Jt<Qt;Jt++){let re=F(Dt[Jt],Y[Jt],_t);v?et(re.x,re.y+b[u-1].y,b[u-1].x+ct):et(re.x,re.y,h+ct)}}}J(),G();function J(){let rt=r.length/3;if(p){let vt=0,ct=z*vt;for(let _t=0;_t<V;_t++){let gt=P[_t];at(gt[2]+ct,gt[1]+ct,gt[0]+ct)}vt=u+x*2,ct=z*vt;for(let _t=0;_t<V;_t++){let gt=P[_t];at(gt[0]+ct,gt[1]+ct,gt[2]+ct)}}else{for(let vt=0;vt<V;vt++){let ct=P[vt];at(ct[2],ct[1],ct[0])}for(let vt=0;vt<V;vt++){let ct=P[vt];at(ct[0]+z*u,ct[1]+z*u,ct[2]+z*u)}}n.addGroup(rt,r.length/3-rt,0)}function G(){let rt=r.length/3,vt=0;nt(D,vt),vt+=D.length;for(let ct=0,_t=w.length;ct<_t;ct++){let gt=w[ct];nt(gt,vt),vt+=gt.length}n.addGroup(rt,r.length/3-rt,1)}function nt(rt,vt){let ct=rt.length;for(;--ct>=0;){let _t=ct,gt=ct-1;gt<0&&(gt=rt.length-1);for(let Pt=0,Dt=u+x*2;Pt<Dt;Pt++){let Jt=z*Pt,Qt=z*(Pt+1),re=vt+_t+Jt,j=vt+gt+Jt,$=vt+gt+Qt,ft=vt+_t+Qt;it(re,j,$,ft)}}}function et(rt,vt,ct){l.push(rt),l.push(vt),l.push(ct)}function at(rt,vt,ct){St(rt),St(vt),St(ct);let _t=r.length/3,gt=y.generateTopUV(n,r,_t-3,_t-2,_t-1);yt(gt[0]),yt(gt[1]),yt(gt[2])}function it(rt,vt,ct,_t){St(rt),St(vt),St(_t),St(vt),St(ct),St(_t);let gt=r.length/3,Pt=y.generateSideWallUV(n,r,gt-6,gt-3,gt-2,gt-1);yt(Pt[0]),yt(Pt[1]),yt(Pt[3]),yt(Pt[1]),yt(Pt[2]),yt(Pt[3])}function St(rt){r.push(l[rt*3+0]),r.push(l[rt*3+1]),r.push(l[rt*3+2])}function yt(rt){o.push(rt.x),o.push(rt.y)}}}toJSON(){let t=super.toJSON(),e=this.parameters.shapes,n=this.parameters.options;return fpt(e,n,t)}static fromJSON(t,e){let n=[];for(let o=0,s=t.shapes.length;o<s;o++){let a=e[t.shapes[o]];n.push(a)}let r=t.options.extrudePath;return r!==void 0&&(t.options.extrudePath=new q7[r.type]().fromJSON(r)),new Ys(n,t.options)}},ppt={generateTopUV:function(i,t,e,n,r){let o=t[e*3],s=t[e*3+1],a=t[n*3],l=t[n*3+1],c=t[r*3],u=t[r*3+1];return[new Et(o,s),new Et(a,l),new Et(c,u)]},generateSideWallUV:function(i,t,e,n,r,o){let s=t[e*3],a=t[e*3+1],l=t[e*3+2],c=t[n*3],u=t[n*3+1],h=t[n*3+2],p=t[r*3],f=t[r*3+1],d=t[r*3+2],m=t[o*3],x=t[o*3+1],g=t[o*3+2];return Math.abs(a-u)<Math.abs(s-c)?[new Et(s,1-l),new Et(c,1-h),new Et(p,1-d),new Et(m,1-g)]:[new Et(a,1-l),new Et(u,1-h),new Et(f,1-d),new Et(x,1-g)]}};function fpt(i,t,e){if(e.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){let o=i[n];e.shapes.push(o.uuid)}else e.shapes.push(i.uuid);return t.extrudePath!==void 0&&(e.options.extrudePath=t.extrudePath.toJSON()),e}var kd=class extends Pe{constructor(t=new vl([new Et(0,.5),new Et(-.5,-.5),new Et(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};let n=[],r=[],o=[],s=[],a=0,l=0;if(Array.isArray(t)===!1)c(t);else for(let u=0;u<t.length;u++)c(t[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(n),this.setAttribute("position",new an(r,3)),this.setAttribute("normal",new an(o,3)),this.setAttribute("uv",new an(s,2));function c(u){let h=r.length/3,p=u.extractPoints(e),f=p.shape,d=p.holes;io.isClockWise(f)===!1&&(f=f.reverse());for(let x=0,g=d.length;x<g;x++){let y=d[x];io.isClockWise(y)===!0&&(d[x]=y.reverse())}let m=io.triangulateShape(f,d);for(let x=0,g=d.length;x<g;x++){let y=d[x];f=f.concat(y)}for(let x=0,g=f.length;x<g;x++){let y=f[x];r.push(y.x,y.y,0),o.push(0,0,1),s.push(y.x,y.y)}for(let x=0,g=m.length;x<g;x++){let y=m[x],b=y[0]+h,v=y[1]+h,_=y[2]+h;n.push(b,v,_),l+=3}}}toJSON(){let t=super.toJSON(),e=this.parameters.shapes;return dpt(e,t)}static fromJSON(t,e){let n=[];for(let r=0,o=t.shapes.length;r<o;r++){let s=e[t.shapes[r]];n.push(s)}return new kd(n,t.curveSegments)}};function dpt(i,t){if(t.shapes=[],Array.isArray(i))for(let e=0,n=i.length;e<n;e++){let r=i[e];t.shapes.push(r.uuid)}else t.shapes.push(i.uuid);return t}var CM=class extends Hn{constructor(t){super(),this.type="ShadowMaterial",this.color=new zt(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}};CM.prototype.isShadowMaterial=!0;var Xv=class extends Hn{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new zt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new zt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=rh,this.normalScale=new Et(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}};Xv.prototype.isMeshStandardMaterial=!0;var MM=class extends Xv{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Et(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return hi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.sheenColor=new zt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new zt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new zt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}};MM.prototype.isMeshPhysicalMaterial=!0;var EM=class extends Hn{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new zt(16777215),this.specular=new zt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new zt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=rh,this.normalScale=new Et(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=r2,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}};EM.prototype.isMeshPhongMaterial=!0;var TM=class extends Hn{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new zt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new zt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=rh,this.normalScale=new Et(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}};TM.prototype.isMeshToonMaterial=!0;var IM=class extends Hn{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=rh,this.normalScale=new Et(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}};IM.prototype.isMeshNormalMaterial=!0;var AM=class extends Hn{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new zt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new zt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=r2,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}};AM.prototype.isMeshLambertMaterial=!0;var kM=class extends Hn{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new zt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=rh,this.normalScale=new Et(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this}};kM.prototype.isMeshMatcapMaterial=!0;var RM=class extends ro{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}};RM.prototype.isLineDashedMaterial=!0;var Je={arraySlice:function(i,t,e){return Je.isTypedArray(i)?new i.constructor(i.subarray(t,e!==void 0?e:i.length)):i.slice(t,e)},convertArray:function(i,t,e){return!i||!e&&i.constructor===t?i:typeof t.BYTES_PER_ELEMENT=="number"?new t(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){function t(r,o){return i[r]-i[o]}let e=i.length,n=new Array(e);for(let r=0;r!==e;++r)n[r]=r;return n.sort(t),n},sortedArray:function(i,t,e){let n=i.length,r=new i.constructor(n);for(let o=0,s=0;s!==n;++o){let a=e[o]*t;for(let l=0;l!==t;++l)r[s++]=i[a+l]}return r},flattenJSON:function(i,t,e,n){let r=1,o=i[0];for(;o!==void 0&&o[n]===void 0;)o=i[r++];if(o===void 0)return;let s=o[n];if(s!==void 0)if(Array.isArray(s))do s=o[n],s!==void 0&&(t.push(o.time),e.push.apply(e,s)),o=i[r++];while(o!==void 0);else if(s.toArray!==void 0)do s=o[n],s!==void 0&&(t.push(o.time),s.toArray(e,e.length)),o=i[r++];while(o!==void 0);else do s=o[n],s!==void 0&&(t.push(o.time),e.push(s)),o=i[r++];while(o!==void 0)},subclip:function(i,t,e,n,r=30){let o=i.clone();o.name=t;let s=[];for(let l=0;l<o.tracks.length;++l){let c=o.tracks[l],u=c.getValueSize(),h=[],p=[];for(let f=0;f<c.times.length;++f){let d=c.times[f]*r;if(!(d<e||d>=n)){h.push(c.times[f]);for(let m=0;m<u;++m)p.push(c.values[f*u+m])}}h.length!==0&&(c.times=Je.convertArray(h,c.times.constructor),c.values=Je.convertArray(p,c.values.constructor),s.push(c))}o.tracks=s;let a=1/0;for(let l=0;l<o.tracks.length;++l)a>o.tracks[l].times[0]&&(a=o.tracks[l].times[0]);for(let l=0;l<o.tracks.length;++l)o.tracks[l].shift(-1*a);return o.resetDuration(),o},makeClipAdditive:function(i,t=0,e=i,n=30){n<=0&&(n=30);let r=e.tracks.length,o=t/n;for(let s=0;s<r;++s){let a=e.tracks[s],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;let c=i.tracks.find(function(g){return g.name===a.name&&g.ValueTypeName===l});if(c===void 0)continue;let u=0,h=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);let p=0,f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=f/3);let d=a.times.length-1,m;if(o<=a.times[0]){let g=u,y=h-u;m=Je.arraySlice(a.values,g,y)}else if(o>=a.times[d]){let g=d*h+u,y=g+h-u;m=Je.arraySlice(a.values,g,y)}else{let g=a.createInterpolant(),y=u,b=h-u;g.evaluate(o),m=Je.arraySlice(g.resultBuffer,y,b)}l==="quaternion"&&new kn().fromArray(m).normalize().conjugate().toArray(m);let x=c.times.length;for(let g=0;g<x;++g){let y=g*f+p;if(l==="quaternion")kn.multiplyQuaternionsFlat(c.values,y,m,0,c.values,y);else{let b=f-p*2;for(let v=0;v<b;++v)c.values[y+v]-=m[v]}}}return i.blendMode=P7,i}},oo=class{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){let e=this.parameterPositions,n=this._cachedIndex,r=e[n],o=e[n-1];t:{e:{let s;n:{i:if(!(t<r)){for(let a=n+2;;){if(r===void 0){if(t<o)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,o)}if(n===a)break;if(o=r,r=e[++n],t<r)break e}s=e.length;break n}if(!(t>=o)){let a=e[1];t<a&&(n=2,o=a);for(let l=n-2;;){if(o===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===l)break;if(r=o,o=e[--n-1],t>=o)break e}s=n,n=0;break n}break t}for(;n<s;){let a=n+s>>>1;t<e[a]?s=a:n=a+1}if(r=e[n],o=e[n-1],o===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(r===void 0)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,o,t)}this._cachedIndex=n,this.intervalChanged_(n,o,r)}return this.interpolate_(n,o,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){let e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=t*r;for(let s=0;s!==r;++s)e[s]=n[o+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}};oo.prototype.beforeStart_=oo.prototype.copySampleValue_;oo.prototype.afterEnd_=oo.prototype.copySampleValue_;var PM=class extends oo{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Bu,endingEnd:Bu}}intervalChanged_(t,e,n){let r=this.parameterPositions,o=t-2,s=t+1,a=r[o],l=r[s];if(a===void 0)switch(this.getSettings_().endingStart){case Vu:o=t,a=2*e-n;break;case kv:o=r.length-2,a=e+r[o]-r[o+1];break;default:o=t,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case Vu:s=t,l=2*n-e;break;case kv:s=1,l=n+r[1]-r[0];break;default:s=t-1,l=e}let c=(n-e)*.5,u=this.valueSize;this._weightPrev=c/(e-a),this._weightNext=c/(l-n),this._offsetPrev=o*u,this._offsetNext=s*u}interpolate_(t,e,n,r){let o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=t*a,c=l-a,u=this._offsetPrev,h=this._offsetNext,p=this._weightPrev,f=this._weightNext,d=(n-e)/(r-e),m=d*d,x=m*d,g=-p*x+2*p*m-p*d,y=(1+p)*x+(-1.5-2*p)*m+(-.5+p)*d+1,b=(-1-f)*x+(1.5+f)*m+.5*d,v=f*x-f*m;for(let _=0;_!==a;++_)o[_]=g*s[u+_]+y*s[c+_]+b*s[l+_]+v*s[h+_];return o}},Kv=class extends oo{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){let o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=t*a,c=l-a,u=(n-e)/(r-e),h=1-u;for(let p=0;p!==a;++p)o[p]=s[c+p]*h+s[l+p]*u;return o}},NM=class extends oo{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}},nr=class{constructor(t,e,n,r){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Je.convertArray(e,this.TimeBufferType),this.values=Je.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){let e=t.constructor,n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:Je.convertArray(t.times,Array),values:Je.convertArray(t.values,Array)};let r=t.getInterpolation();r!==t.DefaultInterpolation&&(n.interpolation=r)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new NM(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new Kv(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new PM(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case Iv:e=this.InterpolantFactoryMethodDiscrete;break;case Av:e=this.InterpolantFactoryMethodLinear;break;case m3:e=this.InterpolantFactoryMethodSmooth;break}if(e===void 0){let n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Iv;case this.InterpolantFactoryMethodLinear:return Av;case this.InterpolantFactoryMethodSmooth:return m3}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){let e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(t!==1){let e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){let n=this.times,r=n.length,o=0,s=r-1;for(;o!==r&&n[o]<t;)++o;for(;s!==-1&&n[s]>e;)--s;if(++s,o!==0||s!==r){o>=s&&(s=Math.max(s,1),o=s-1);let a=this.getValueSize();this.times=Je.arraySlice(n,o,s),this.values=Je.arraySlice(this.values,o*a,s*a)}return this}validate(){let t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);let n=this.times,r=this.values,o=n.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let a=0;a!==o;a++){let l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),t=!1;break}if(s!==null&&s>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,s),t=!1;break}s=l}if(r!==void 0&&Je.isTypedArray(r))for(let a=0,l=r.length;a!==l;++a){let c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),t=!1;break}}return t}optimize(){let t=Je.arraySlice(this.times),e=Je.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===m3,o=t.length-1,s=1;for(let a=1;a<o;++a){let l=!1,c=t[a],u=t[a+1];if(c!==u&&(a!==1||c!==t[0]))if(r)l=!0;else{let h=a*n,p=h-n,f=h+n;for(let d=0;d!==n;++d){let m=e[h+d];if(m!==e[p+d]||m!==e[f+d]){l=!0;break}}}if(l){if(a!==s){t[s]=t[a];let h=a*n,p=s*n;for(let f=0;f!==n;++f)e[p+f]=e[h+f]}++s}}if(o>0){t[s]=t[o];for(let a=o*n,l=s*n,c=0;c!==n;++c)e[l+c]=e[a+c];++s}return s!==t.length?(this.times=Je.arraySlice(t,0,s),this.values=Je.arraySlice(e,0,s*n)):(this.times=t,this.values=e),this}clone(){let t=Je.arraySlice(this.times,0),e=Je.arraySlice(this.values,0),n=this.constructor,r=new n(this.name,t,e);return r.createInterpolant=this.createInterpolant,r}};nr.prototype.TimeBufferType=Float32Array;nr.prototype.ValueBufferType=Float32Array;nr.prototype.DefaultInterpolation=Av;var Zs=class extends nr{};Zs.prototype.ValueTypeName="bool";Zs.prototype.ValueBufferType=Array;Zs.prototype.DefaultInterpolation=Iv;Zs.prototype.InterpolantFactoryMethodLinear=void 0;Zs.prototype.InterpolantFactoryMethodSmooth=void 0;var Yv=class extends nr{};Yv.prototype.ValueTypeName="color";var eh=class extends nr{};eh.prototype.ValueTypeName="number";var LM=class extends oo{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){let o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=(n-e)/(r-e),c=t*a;for(let u=c+a;c!==u;c+=4)kn.slerpFlat(o,0,s,c-a,s,c,l);return o}},bl=class extends nr{InterpolantFactoryMethodLinear(t){return new LM(this.times,this.values,this.getValueSize(),t)}};bl.prototype.ValueTypeName="quaternion";bl.prototype.DefaultInterpolation=Av;bl.prototype.InterpolantFactoryMethodSmooth=void 0;var Js=class extends nr{};Js.prototype.ValueTypeName="string";Js.prototype.ValueBufferType=Array;Js.prototype.DefaultInterpolation=Iv;Js.prototype.InterpolantFactoryMethodLinear=void 0;Js.prototype.InterpolantFactoryMethodSmooth=void 0;var nh=class extends nr{};nh.prototype.ValueTypeName="vector";var Zv=class{constructor(t,e=-1,n,r=u4){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=Cr(),this.duration<0&&this.resetDuration()}static parse(t){let e=[],n=t.tracks,r=1/(t.fps||1);for(let s=0,a=n.length;s!==a;++s)e.push(gpt(n[s]).scale(r));let o=new this(t.name,t.duration,e,t.blendMode);return o.uuid=t.uuid,o}static toJSON(t){let e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let o=0,s=n.length;o!==s;++o)e.push(nr.toJSON(n[o]));return r}static CreateFromMorphTargetSequence(t,e,n,r){let o=e.length,s=[];for(let a=0;a<o;a++){let l=[],c=[];l.push((a+o-1)%o,a,(a+1)%o),c.push(0,1,0);let u=Je.getKeyframeOrder(l);l=Je.sortedArray(l,1,u),c=Je.sortedArray(c,1,u),!r&&l[0]===0&&(l.push(o),c.push(c[0])),s.push(new eh(".morphTargetInfluences["+e[a].name+"]",l,c).scale(1/n))}return new this(t,-1,s)}static findByName(t,e){let n=t;if(!Array.isArray(t)){let r=t;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null}static CreateClipsFromMorphTargetSequences(t,e,n){let r={},o=/^([\w-]*?)([\d]+)$/;for(let a=0,l=t.length;a<l;a++){let c=t[a],u=c.name.match(o);if(u&&u.length>1){let h=u[1],p=r[h];p||(r[h]=p=[]),p.push(c)}}let s=[];for(let a in r)s.push(this.CreateFromMorphTargetSequence(a,r[a],e,n));return s}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let n=function(h,p,f,d,m){if(f.length!==0){let x=[],g=[];Je.flattenJSON(f,x,g,d),x.length!==0&&m.push(new h(p,x,g))}},r=[],o=t.name||"default",s=t.fps||30,a=t.blendMode,l=t.length||-1,c=t.hierarchy||[];for(let h=0;h<c.length;h++){let p=c[h].keys;if(!(!p||p.length===0))if(p[0].morphTargets){let f={},d;for(d=0;d<p.length;d++)if(p[d].morphTargets)for(let m=0;m<p[d].morphTargets.length;m++)f[p[d].morphTargets[m]]=-1;for(let m in f){let x=[],g=[];for(let y=0;y!==p[d].morphTargets.length;++y){let b=p[d];x.push(b.time),g.push(b.morphTarget===m?1:0)}r.push(new eh(".morphTargetInfluence["+m+"]",x,g))}l=f.length*(s||1)}else{let f=".bones["+e[h].name+"]";n(nh,f+".position",p,"pos",r),n(bl,f+".quaternion",p,"rot",r),n(nh,f+".scale",p,"scl",r)}}return r.length===0?null:new this(o,l,r,a)}resetDuration(){let t=this.tracks,e=0;for(let n=0,r=t.length;n!==r;++n){let o=this.tracks[n];e=Math.max(e,o.times[o.times.length-1])}return this.duration=e,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){let t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function mpt(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return eh;case"vector":case"vector2":case"vector3":case"vector4":return nh;case"color":return Yv;case"quaternion":return bl;case"bool":case"boolean":return Zs;case"string":return Js}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function gpt(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=mpt(i.type);if(i.times===void 0){let e=[],n=[];Je.flattenJSON(i.keys,e,n,"value"),i.times=e,i.values=n}return t.parse!==void 0?t.parse(i):new t(i.name,i.times,i.values,i.interpolation)}var ih={enabled:!1,files:{},add:function(i,t){this.enabled!==!1&&(this.files[i]=t)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}},DM=class{constructor(t,e,n){let r=this,o=!1,s=0,a=0,l,c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(u){a++,o===!1&&r.onStart!==void 0&&r.onStart(u,s,a),o=!0},this.itemEnd=function(u){s++,r.onProgress!==void 0&&r.onProgress(u,s,a),s===a&&(o=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,h){return c.push(u,h),this},this.removeHandler=function(u){let h=c.indexOf(u);return h!==-1&&c.splice(h,2),this},this.getHandler=function(u){for(let h=0,p=c.length;h<p;h+=2){let f=c[h],d=c[h+1];if(f.global&&(f.lastIndex=0),f.test(u))return d}return null}}},xpt=new DM,so=class{constructor(t){this.manager=t!==void 0?t:xpt,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){let n=this;return new Promise(function(r,o){n.load(t,r,e,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}},Wo={},zM=class extends so{constructor(t){super(t)}load(t,e,n,r){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);let o=ih.get(t);if(o!==void 0)return this.manager.itemStart(t),setTimeout(()=>{e&&e(o),this.manager.itemEnd(t)},0),o;if(Wo[t]!==void 0){Wo[t].push({onLoad:e,onProgress:n,onError:r});return}Wo[t]=[],Wo[t].push({onLoad:e,onProgress:n,onError:r});let s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(s).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream=="undefined"||c.body.getReader===void 0)return c;let u=Wo[t],h=c.body.getReader(),p=c.headers.get("Content-Length"),f=p?parseInt(p):0,d=f!==0,m=0,x=new ReadableStream({start(g){y();function y(){h.read().then(({done:b,value:v})=>{if(b)g.close();else{m+=v.byteLength;let _=new ProgressEvent("progress",{lengthComputable:d,loaded:m,total:f});for(let S=0,E=u.length;S<E;S++){let M=u[S];M.onProgress&&M.onProgress(_)}g.enqueue(v),y()}})}}});return new Response(x)}else throw Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return c.json();default:if(a===void 0)return c.text();{let h=/charset="?([^;"\s]*)"?/i.exec(a),p=h&&h[1]?h[1].toLowerCase():void 0,f=new TextDecoder(p);return c.arrayBuffer().then(d=>f.decode(d))}}}).then(c=>{ih.add(t,c);let u=Wo[t];delete Wo[t];for(let h=0,p=u.length;h<p;h++){let f=u[h];f.onLoad&&f.onLoad(c)}}).catch(c=>{let u=Wo[t];if(u===void 0)throw this.manager.itemError(t),c;delete Wo[t];for(let h=0,p=u.length;h<p;h++){let f=u[h];f.onError&&f.onError(c)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}};var Jv=class extends so{constructor(t){super(t)}load(t,e,n,r){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);let o=this,s=ih.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){e&&e(s),o.manager.itemEnd(t)},0),s;let a=hd("img");function l(){u(),ih.add(t,this),e&&e(this),o.manager.itemEnd(t)}function c(h){u(),r&&r(h),o.manager.itemError(t),o.manager.itemEnd(t)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),o.manager.itemStart(t),a.src=t,a}},FM=class extends so{constructor(t){super(t)}load(t,e,n,r){let o=new Ku,s=new Jv(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;function l(c){s.load(t[c],function(u){o.images[c]=u,a++,a===6&&(o.needsUpdate=!0,e&&e(o))},void 0,r)}for(let c=0;c<t.length;++c)l(c);return o}};var OM=class extends so{constructor(t){super(t)}load(t,e,n,r){let o=new ln,s=new Jv(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(a){o.image=a,o.needsUpdate=!0,e!==void 0&&e(o)},n,r),o}},ir=class extends Re{constructor(t,e=1){super(),this.type="Light",this.color=new zt(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){let e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}};ir.prototype.isLight=!0;var BM=class extends ir{constructor(t,e,n){super(t,n),this.type="HemisphereLight",this.position.copy(Re.DefaultUp),this.updateMatrix(),this.groundColor=new zt(e)}copy(t){return ir.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}};BM.prototype.isHemisphereLight=!0;var _7=new te,w7=new q,S7=new q,Rd=class{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Et(512,512),this.map=null,this.mapPass=null,this.matrix=new te,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Yu,this._frameExtents=new Et(1,1),this._viewportCount=1,this._viewports=[new ze(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){let e=this.camera,n=this.matrix;w7.setFromMatrixPosition(t.matrixWorld),e.position.copy(w7),S7.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(S7),e.updateMatrixWorld(),_7.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_7),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}},Qv=class extends Rd{constructor(){super(new xn(50,1,.5,500)),this.focus=1}updateMatrices(t){let e=this.camera,n=nM*2*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,o=t.distance||e.far;(n!==e.fov||r!==e.aspect||o!==e.far)&&(e.fov=n,e.aspect=r,e.far=o,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}};Qv.prototype.isSpotLightShadow=!0;var VM=class extends ir{constructor(t,e,n=0,r=Math.PI/3,o=0,s=1){super(t,e),this.type="SpotLight",this.position.copy(Re.DefaultUp),this.updateMatrix(),this.target=new Re,this.distance=n,this.angle=r,this.penumbra=o,this.decay=s,this.shadow=new Qv}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}};VM.prototype.isSpotLight=!0;var C7=new te,nd=new q,X3=new q,t2=class extends Rd{constructor(){super(new xn(90,1,.5,500)),this._frameExtents=new Et(4,2),this._viewportCount=6,this._viewports=[new ze(2,1,1,1),new ze(0,1,1,1),new ze(3,1,1,1),new ze(1,1,1,1),new ze(3,0,1,1),new ze(1,0,1,1)],this._cubeDirections=[new q(1,0,0),new q(-1,0,0),new q(0,0,1),new q(0,0,-1),new q(0,1,0),new q(0,-1,0)],this._cubeUps=[new q(0,1,0),new q(0,1,0),new q(0,1,0),new q(0,1,0),new q(0,0,1),new q(0,0,-1)]}updateMatrices(t,e=0){let n=this.camera,r=this.matrix,o=t.distance||n.far;o!==n.far&&(n.far=o,n.updateProjectionMatrix()),nd.setFromMatrixPosition(t.matrixWorld),n.position.copy(nd),X3.copy(n.position),X3.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(X3),n.updateMatrixWorld(),r.makeTranslation(-nd.x,-nd.y,-nd.z),C7.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(C7)}};t2.prototype.isPointLightShadow=!0;var Pd=class extends ir{constructor(t,e,n=0,r=1){super(t,e),this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new t2}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}};Pd.prototype.isPointLight=!0;var e2=class extends Rd{constructor(){super(new ml(-5,5,5,-5,.5,500))}};e2.prototype.isDirectionalLightShadow=!0;var HM=class extends ir{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(Re.DefaultUp),this.updateMatrix(),this.target=new Re,this.shadow=new e2}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}};HM.prototype.isDirectionalLight=!0;var $M=class extends ir{constructor(t,e){super(t,e),this.type="AmbientLight"}};$M.prototype.isAmbientLight=!0;var UM=class extends ir{constructor(t,e,n=10,r=10){super(t,e),this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){let e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}};UM.prototype.isRectAreaLight=!0;var n2=class{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new q)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){let n=t.x,r=t.y,o=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.282095),e.addScaledVector(s[1],.488603*r),e.addScaledVector(s[2],.488603*o),e.addScaledVector(s[3],.488603*n),e.addScaledVector(s[4],1.092548*(n*r)),e.addScaledVector(s[5],1.092548*(r*o)),e.addScaledVector(s[6],.315392*(3*o*o-1)),e.addScaledVector(s[7],1.092548*(n*o)),e.addScaledVector(s[8],.546274*(n*n-r*r)),e}getIrradianceAt(t,e){let n=t.x,r=t.y,o=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.886227),e.addScaledVector(s[1],2*.511664*r),e.addScaledVector(s[2],2*.511664*o),e.addScaledVector(s[3],2*.511664*n),e.addScaledVector(s[4],2*.429043*n*r),e.addScaledVector(s[5],2*.429043*r*o),e.addScaledVector(s[6],.743125*o*o-.247708),e.addScaledVector(s[7],2*.429043*n*o),e.addScaledVector(s[8],.429043*(n*n-r*r)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(t,e=0){let n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+r*3);return this}toArray(t=[],e=0){let n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+r*3);return t}static getBasisAt(t,e){let n=t.x,r=t.y,o=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*o,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*o,e[6]=.315392*(3*o*o-1),e[7]=1.092548*n*o,e[8]=.546274*(n*n-r*r)}};n2.prototype.isSphericalHarmonics3=!0;var Nd=class extends ir{constructor(t=new n2,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){let e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}};Nd.prototype.isLightProbe=!0;var WM=class{static decodeText(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);let e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(n){return e}}static extractUrlBase(t){let e=t.lastIndexOf("/");return e===-1?"./":t.substr(0,e+1)}static resolveURL(t,e){return typeof t!="string"||t===""?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}},GM=class extends Pe{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){let t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}};GM.prototype.isInstancedBufferGeometry=!0;var jM=class extends so{constructor(t){super(t),typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,r){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);let o=this,s=ih.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){e&&e(s),o.manager.itemEnd(t)},0),s;let a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(t,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(l){ih.add(t,l),e&&e(l),o.manager.itemEnd(t)}).catch(function(l){r&&r(l),o.manager.itemError(t),o.manager.itemEnd(t)}),o.manager.itemStart(t)}};jM.prototype.isImageBitmapLoader=!0;var Cv,ypt={getContext:function(){return Cv===void 0&&(Cv=new(window.AudioContext||window.webkitAudioContext)),Cv},setContext:function(i){Cv=i}},qM=class extends so{constructor(t){super(t)}load(t,e,n,r){let o=this,s=new zM(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(a){try{let l=a.slice(0);ypt.getContext().decodeAudioData(l,function(u){e(u)})}catch(l){r?r(l):console.error(l),o.manager.itemError(t)}},n,r)}},XM=class extends Nd{constructor(t,e,n=1){super(void 0,n);let r=new zt().set(t),o=new zt().set(e),s=new q(r.r,r.g,r.b),a=new q(o.r,o.g,o.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(s).sub(a).multiplyScalar(c)}};XM.prototype.isHemisphereLightProbe=!0;var KM=class extends Nd{constructor(t,e=1){super(void 0,e);let n=new zt().set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}};KM.prototype.isAmbientLightProbe=!0;var YM=class extends Re{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+t;let e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),this._connected===!0?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}};var ZM=class{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0,e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}},JM=class{constructor(t,e,n){this.binding=t,this.valueSize=n;let r,o,s;switch(e){case"quaternion":r=this._slerp,o=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,o=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,o=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=o,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){let n=this.buffer,r=this.valueSize,o=t*r+r,s=this.cumulativeWeight;if(s===0){for(let a=0;a!==r;++a)n[o+a]=n[a];s=e}else{s+=e;let a=e/s;this._mixBufferRegion(n,o,0,a,r)}this.cumulativeWeight=s}accumulateAdditive(t){let e=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){let e=this.valueSize,n=this.buffer,r=t*e+e,o=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){let l=e*this._origIndex;this._mixBufferRegion(n,r,l,1-o,e)}s>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let l=e,c=e+e;l!==c;++l)if(n[l]!==n[l+e]){a.setValue(n,r);break}}saveOriginalState(){let t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(let o=n,s=r;o!==s;++o)e[o]=e[r+o%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let t=this.valueSize*3;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){let t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,r,o){if(r>=.5)for(let s=0;s!==o;++s)t[e+s]=t[n+s]}_slerp(t,e,n,r){kn.slerpFlat(t,e,t,e,t,n,r)}_slerpAdditive(t,e,n,r,o){let s=this._workIndex*o;kn.multiplyQuaternionsFlat(t,s,t,e,t,n),kn.slerpFlat(t,e,t,e,t,s,r)}_lerp(t,e,n,r,o){let s=1-r;for(let a=0;a!==o;++a){let l=e+a;t[l]=t[l]*s+t[n+a]*r}}_lerpAdditive(t,e,n,r,o){for(let s=0;s!==o;++s){let a=e+s;t[a]=t[a]+t[n+s]*r}}},f4="\\[\\]\\.:\\/",vpt=new RegExp("["+f4+"]","g"),d4="[^"+f4+"]",bpt="[^"+f4.replace("\\.","")+"]",_pt=/((?:WC+[\/:])*)/.source.replace("WC",d4),wpt=/(WCOD+)?/.source.replace("WCOD",bpt),Spt=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",d4),Cpt=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",d4),Mpt=new RegExp("^"+_pt+wpt+Spt+Cpt+"$"),Ept=["material","materials","bones"],QM=class{constructor(t,e,n){let r=n||Ce.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();let n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(t,e)}setValue(t,e){let n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=n.length;r!==o;++r)n[r].setValue(t,e)}bind(){let t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){let t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},Ce=class{constructor(t,e,n){this.path=e,this.parsedPath=n||Ce.parseTrackName(e),this.node=Ce.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new Ce.Composite(t,e,n):new Ce(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(vpt,"")}static parseTrackName(t){let e=Mpt.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){let o=n.nodeName.substring(r+1);Ept.indexOf(o)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=o)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(!e||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){let n=t.skeleton.getBoneByName(e);if(n!==void 0)return n}if(t.children){let n=function(o){for(let s=0;s<o.length;s++){let a=o[s];if(a.name===e||a.uuid===e)return a;let l=n(a.children);if(l)return l}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){let n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)t[e++]=n[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){let n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){let n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){let n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,o=e.propertyIndex;if(t||(t=Ce.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let c=e.objectIndex;switch(n){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===c){c=u;break}break;default:if(t[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[n]}if(c!==void 0){if(t[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[c]}}let s=t[r];if(s===void 0){let c=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",t);return}let a=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(o!==void 0){if(r==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[o]!==void 0&&(o=t.morphTargetDictionary[o])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=o}else s.fromArray!==void 0&&s.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};Ce.Composite=QM;Ce.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ce.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ce.prototype.GetterByBindingType=[Ce.prototype._getValue_direct,Ce.prototype._getValue_array,Ce.prototype._getValue_arrayElement,Ce.prototype._getValue_toArray];Ce.prototype.SetterByBindingTypeAndVersioning=[[Ce.prototype._setValue_direct,Ce.prototype._setValue_direct_setNeedsUpdate,Ce.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ce.prototype._setValue_array,Ce.prototype._setValue_array_setNeedsUpdate,Ce.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ce.prototype._setValue_arrayElement,Ce.prototype._setValue_arrayElement_setNeedsUpdate,Ce.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ce.prototype._setValue_fromArray,Ce.prototype._setValue_fromArray_setNeedsUpdate,Ce.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var t4=class{constructor(){this.uuid=Cr(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;let t={};this._indicesByUUID=t;for(let n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};let e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){let t=this._objects,e=this._indicesByUUID,n=this._paths,r=this._parsedPaths,o=this._bindings,s=o.length,a,l=t.length,c=this.nCachedObjects_;for(let u=0,h=arguments.length;u!==h;++u){let p=arguments[u],f=p.uuid,d=e[f];if(d===void 0){d=l++,e[f]=d,t.push(p);for(let m=0,x=s;m!==x;++m)o[m].push(new Ce(p,n[m],r[m]))}else if(d<c){a=t[d];let m=--c,x=t[m];e[x.uuid]=d,t[d]=x,e[f]=m,t[m]=p;for(let g=0,y=s;g!==y;++g){let b=o[g],v=b[m],_=b[d];b[d]=v,_===void 0&&(_=new Ce(p,n[g],r[g])),b[m]=_}}else t[d]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){let t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length,o=this.nCachedObjects_;for(let s=0,a=arguments.length;s!==a;++s){let l=arguments[s],c=l.uuid,u=e[c];if(u!==void 0&&u>=o){let h=o++,p=t[h];e[p.uuid]=u,t[u]=p,e[c]=h,t[h]=l;for(let f=0,d=r;f!==d;++f){let m=n[f],x=m[h],g=m[u];m[u]=x,m[h]=g}}}this.nCachedObjects_=o}uncache(){let t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length,o=this.nCachedObjects_,s=t.length;for(let a=0,l=arguments.length;a!==l;++a){let c=arguments[a],u=c.uuid,h=e[u];if(h!==void 0)if(delete e[u],h<o){let p=--o,f=t[p],d=--s,m=t[d];e[f.uuid]=h,t[h]=f,e[m.uuid]=p,t[p]=m,t.pop();for(let x=0,g=r;x!==g;++x){let y=n[x],b=y[p],v=y[d];y[h]=b,y[p]=v,y.pop()}}else{let p=--s,f=t[p];p>0&&(e[f.uuid]=h),t[h]=f,t.pop();for(let d=0,m=r;d!==m;++d){let x=n[d];x[h]=x[p],x.pop()}}}this.nCachedObjects_=o}subscribe_(t,e){let n=this._bindingsIndicesByPath,r=n[t],o=this._bindings;if(r!==void 0)return o[r];let s=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,h=new Array(c);r=o.length,n[t]=r,s.push(t),a.push(e),o.push(h);for(let p=u,f=l.length;p!==f;++p){let d=l[p];h[p]=new Ce(d,t,e)}return h}unsubscribe_(t){let e=this._bindingsIndicesByPath,n=e[t];if(n!==void 0){let r=this._paths,o=this._parsedPaths,s=this._bindings,a=s.length-1,l=s[a],c=t[a];e[c]=n,s[n]=l,s.pop(),o[n]=o[a],o.pop(),r[n]=r[a],r.pop()}}};t4.prototype.isAnimationObjectGroup=!0;var e4=class{constructor(t,e,n=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;let o=e.tracks,s=o.length,a=new Array(s),l={endingStart:Bu,endingEnd:Bu};for(let c=0;c!==s;++c){let u=o[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=eat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){let r=this._clip.duration,o=t._clip.duration,s=o/r,a=r/o;t.warp(1,s,e),this.warp(a,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){let t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){let r=this._mixer,o=r.time,s=this.timeScale,a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);let l=a.parameterPositions,c=a.sampleValues;return l[0]=o,l[1]=o+n,c[0]=t/s,c[1]=e/s,this}stopWarping(){let t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled){this._updateWeight(t);return}let o=this._startTime;if(o!==null){let l=(t-o)*n;if(l<0||n===0)return;this._startTime=null,e=n*l}e*=this._updateTimeScale(t);let s=this._updateTime(e),a=this._updateWeight(t);if(a>0){let l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case P7:for(let u=0,h=l.length;u!==h;++u)l[u].evaluate(s),c[u].accumulateAdditive(a);break;case u4:default:for(let u=0,h=l.length;u!==h;++u)l[u].evaluate(s),c[u].accumulate(r,a)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;let n=this._weightInterpolant;if(n!==null){let r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;let n=this._timeScaleInterpolant;n!==null&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(t){let e=this._clip.duration,n=this.loop,r=this.time+t,o=this._loopCount,s=n===nat;if(t===0)return o===-1?r:s&&(o&1)===1?e-r:r;if(n===tat){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else if(r<0)r=0;else{this.time=r;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(o===-1&&(t>=0?(o=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),r>=e||r<0){let a=Math.floor(r/e);r-=e*a,o+=Math.abs(a);let l=this.repetitions-o;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(l===1){let c=t<0;this._setEndings(c,!c,s)}else this._setEndings(!1,!1,s);this._loopCount=o,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(s&&(o&1)===1)return e-r}return r}_setEndings(t,e,n){let r=this._interpolantSettings;n?(r.endingStart=Vu,r.endingEnd=Vu):(t?r.endingStart=this.zeroSlopeAtStart?Vu:Bu:r.endingStart=kv,e?r.endingEnd=this.zeroSlopeAtEnd?Vu:Bu:r.endingEnd=kv)}_scheduleFading(t,e,n){let r=this._mixer,o=r.time,s=this._weightInterpolant;s===null&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,l=s.sampleValues;return a[0]=o,l[0]=e,a[1]=o+t,l[1]=n,this}},n4=class extends Mr{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){let n=t._localRoot||this._root,r=t._clip.tracks,o=r.length,s=t._propertyBindings,a=t._interpolants,l=n.uuid,c=this._bindingsByRootAndName,u=c[l];u===void 0&&(u={},c[l]=u);for(let h=0;h!==o;++h){let p=r[h],f=p.name,d=u[f];if(d!==void 0)++d.referenceCount,s[h]=d;else{if(d=s[h],d!==void 0){d._cacheIndex===null&&(++d.referenceCount,this._addInactiveBinding(d,l,f));continue}let m=e&&e._propertyBindings[h].binding.parsedPath;d=new JM(Ce.create(n,f,m),p.ValueTypeName,p.getValueSize()),++d.referenceCount,this._addInactiveBinding(d,l,f),s[h]=d}a[h].resultBuffer=d.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){let n=(t._localRoot||this._root).uuid,r=t._clip.uuid,o=this._actionsByClip[r];this._bindAction(t,o&&o.knownActions[0]),this._addInactiveAction(t,r,n)}let e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){let o=e[n];o.useCount++===0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){let e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){let o=e[n];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){let e=t._cacheIndex;return e!==null&&e<this._nActiveActions}_addInactiveAction(t,e,n){let r=this._actions,o=this._actionsByClip,s=o[e];if(s===void 0)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,o[e]=s;else{let a=s.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=r.length,r.push(t),s.actionByRoot[n]=t}_removeInactiveAction(t){let e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;let o=t._clip.uuid,s=this._actionsByClip,a=s[o],l=a.knownActions,c=l[l.length-1],u=t._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),t._byClipCacheIndex=null;let h=a.actionByRoot,p=(t._localRoot||this._root).uuid;delete h[p],l.length===0&&delete s[o],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){let e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){let o=e[n];--o.referenceCount===0&&this._removeInactiveBinding(o)}}_lendAction(t){let e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,o=e[r];t._cacheIndex=r,e[r]=t,o._cacheIndex=n,e[n]=o}_takeBackAction(t){let e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,o=e[r];t._cacheIndex=r,e[r]=t,o._cacheIndex=n,e[n]=o}_addInactiveBinding(t,e,n){let r=this._bindingsByRootAndName,o=this._bindings,s=r[e];s===void 0&&(s={},r[e]=s),s[n]=t,t._cacheIndex=o.length,o.push(t)}_removeInactiveBinding(t){let e=this._bindings,n=t.binding,r=n.rootNode.uuid,o=n.path,s=this._bindingsByRootAndName,a=s[r],l=e[e.length-1],c=t._cacheIndex;l._cacheIndex=c,e[c]=l,e.pop(),delete a[o],Object.keys(a).length===0&&delete s[r]}_lendBinding(t){let e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,o=e[r];t._cacheIndex=r,e[r]=t,o._cacheIndex=n,e[n]=o}_takeBackBinding(t){let e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,o=e[r];t._cacheIndex=r,e[r]=t,o._cacheIndex=n,e[n]=o}_lendControlInterpolant(){let t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return n===void 0&&(n=new Kv(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){let e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,o=e[r];t.__cacheIndex=r,e[r]=t,o.__cacheIndex=n,e[n]=o}clipAction(t,e,n){let r=e||this._root,o=r.uuid,s=typeof t=="string"?Zv.findByName(r,t):t,a=s!==null?s.uuid:t,l=this._actionsByClip[a],c=null;if(n===void 0&&(s!==null?n=s.blendMode:n=u4),l!==void 0){let h=l.actionByRoot[o];if(h!==void 0&&h.blendMode===n)return h;c=l.knownActions[0],s===null&&(s=c._clip)}if(s===null)return null;let u=new e4(this,s,e,n);return this._bindAction(u,c),this._addInactiveAction(u,a,o),u}existingAction(t,e){let n=e||this._root,r=n.uuid,o=typeof t=="string"?Zv.findByName(n,t):t,s=o?o.uuid:t,a=this._actionsByClip[s];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){let t=this._actions,e=this._nActiveActions;for(let n=e-1;n>=0;--n)t[n].stop();return this}update(t){t*=this.timeScale;let e=this._actions,n=this._nActiveActions,r=this.time+=t,o=Math.sign(t),s=this._accuIndex^=1;for(let c=0;c!==n;++c)e[c]._update(r,t,o,s);let a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(s);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){let e=this._actions,n=t.uuid,r=this._actionsByClip,o=r[n];if(o!==void 0){let s=o.knownActions;for(let a=0,l=s.length;a!==l;++a){let c=s[a];this._deactivateAction(c);let u=c._cacheIndex,h=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,h._cacheIndex=u,e[u]=h,e.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}}uncacheRoot(t){let e=t.uuid,n=this._actionsByClip;for(let s in n){let a=n[s].actionByRoot,l=a[e];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}let r=this._bindingsByRootAndName,o=r[e];if(o!==void 0)for(let s in o){let a=o[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(t,e){let n=this.existingAction(t,e);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}};n4.prototype._controlInterpolantsResultBuffer=new Float32Array(1);var Ld=class{constructor(t){typeof t=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new Ld(this.value.clone===void 0?this.value:this.value.clone())}},i4=class extends xl{constructor(t,e,n=1){super(t,e),this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){let e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){let e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}};i4.prototype.isInstancedInterleavedBuffer=!0;var r4=class{constructor(t,e,n,r,o){this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=r,this.count=o,this.version=0}set needsUpdate(t){t===!0&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,e){return this.type=t,this.elementSize=e,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}};r4.prototype.isGLBufferAttribute=!0;var Dd=class{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(hi(e/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}};var M7=new Et,_l=class{constructor(t=new Et(1/0,1/0),e=new Et(-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let n=M7.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return M7.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}};_l.prototype.isBox2=!0;var E7=new q,Mv=new q,o4=class{constructor(t=new q,e=new q){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){E7.subVectors(t,this.start),Mv.subVectors(this.end,this.start);let n=Mv.dot(Mv),o=Mv.dot(E7)/n;return e&&(o=hi(o,0,1)),o}closestPointToPoint(t,e,n){let r=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return new this.constructor().copy(this)}};var Fs=new q,Ev=new te,K3=new te,s4=class extends Xs{constructor(t){let e=Z7(t),n=new Pe,r=[],o=[],s=new zt(0,0,1),a=new zt(0,1,0);for(let c=0;c<e.length;c++){let u=e[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),o.push(s.r,s.g,s.b),o.push(a.r,a.g,a.b))}n.setAttribute("position",new an(r,3)),n.setAttribute("color",new an(o,3));let l=new ro({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){let e=this.bones,n=this.geometry,r=n.getAttribute("position");K3.copy(this.root.matrixWorld).invert();for(let o=0,s=0;o<e.length;o++){let a=e[o];a.parent&&a.parent.isBone&&(Ev.multiplyMatrices(K3,a.matrixWorld),Fs.setFromMatrixPosition(Ev),r.setXYZ(s,Fs.x,Fs.y,Fs.z),Ev.multiplyMatrices(K3,a.parent.matrixWorld),Fs.setFromMatrixPosition(Ev),r.setXYZ(s+1,Fs.x,Fs.y,Fs.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}};function Z7(i){let t=[];i&&i.isBone&&t.push(i);for(let e=0;e<i.children.length;e++)t.push.apply(t,Z7(i.children[e]));return t}var a4=class extends Xs{constructor(t=10,e=10,n=4473924,r=8947848){n=new zt(n),r=new zt(r);let o=e/2,s=t/e,a=t/2,l=[],c=[];for(let p=0,f=0,d=-a;p<=e;p++,d+=s){l.push(-a,0,d,a,0,d),l.push(d,0,-a,d,0,a);let m=p===o?n:r;m.toArray(c,f),f+=3,m.toArray(c,f),f+=3,m.toArray(c,f),f+=3,m.toArray(c,f),f+=3}let u=new Pe;u.setAttribute("position",new an(l,3)),u.setAttribute("color",new an(c,3));let h=new ro({vertexColors:!0,toneMapped:!1});super(u,h),this.type="GridHelper"}};var i2=class extends Xs{constructor(t=1){let e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Pe;r.setAttribute("position",new an(e,3)),r.setAttribute("color",new an(n,3));let o=new ro({vertexColors:!0,toneMapped:!1});super(r,o),this.type="AxesHelper"}setColors(t,e,n){let r=new zt,o=this.geometry.attributes.color.array;return r.set(t),r.toArray(o,0),r.toArray(o,3),r.set(e),r.toArray(o,6),r.toArray(o,9),r.set(n),r.toArray(o,12),r.toArray(o,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};var Tpt=new Float32Array(1),Yle=new Int32Array(Tpt.buffer);_i.create=function(i,t){return console.log("THREE.Curve.create() has been deprecated"),i.prototype=Object.create(_i.prototype),i.prototype.constructor=i,i.prototype.getPoint=t,i};Ed.prototype.fromPoints=function(i){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(i)};a4.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};s4.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};so.prototype.extractUrlBase=function(i){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),WM.extractUrlBase(i)};so.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};_l.prototype.center=function(i){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(i)};_l.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()};_l.prototype.isIntersectionBox=function(i){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)};_l.prototype.size=function(i){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(i)};Di.prototype.center=function(i){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(i)};Di.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()};Di.prototype.isIntersectionBox=function(i){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)};Di.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)};Di.prototype.size=function(i){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(i)};Gs.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()};Yu.prototype.setFromMatrix=function(i){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(i)};o4.prototype.center=function(i){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(i)};An.prototype.flattenToArrayOffset=function(i,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,t)};An.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)};An.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")};An.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)};An.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")};An.prototype.getInverse=function(i){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()};te.prototype.extractPosition=function(i){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(i)};te.prototype.flattenToArrayOffset=function(i,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,t)};te.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new q().setFromMatrixColumn(this,3)};te.prototype.setRotationFromQuaternion=function(i){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(i)};te.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")};te.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};te.prototype.multiplyVector4=function(i){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};te.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")};te.prototype.rotateAxis=function(i){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),i.transformDirection(this)};te.prototype.crossVector=function(i){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};te.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")};te.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")};te.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")};te.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")};te.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")};te.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};te.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")};te.prototype.makeFrustum=function(i,t,e,n,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(i,t,n,e,r,o)};te.prototype.getInverse=function(i){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()};Sr.prototype.isIntersectionLine=function(i){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(i)};kn.prototype.multiplyVector3=function(i){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),i.applyQuaternion(this)};kn.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()};js.prototype.isIntersectionBox=function(i){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)};js.prototype.isIntersectionPlane=function(i){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(i)};js.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)};sn.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()};sn.prototype.barycoordFromPoint=function(i,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(i,t)};sn.prototype.midpoint=function(i){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(i)};sn.prototypenormal=function(i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(i)};sn.prototype.plane=function(i){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(i)};sn.barycoordFromPoint=function(i,t,e,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),sn.getBarycoord(i,t,e,n,r)};sn.normal=function(i,t,e,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),sn.getNormal(i,t,e,n)};vl.prototype.extractAllPoints=function(i){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(i)};vl.prototype.extrude=function(i){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ys(this,i)};vl.prototype.makeGeometry=function(i){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new kd(this,i)};Et.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)};Et.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)};Et.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};q.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")};q.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")};q.prototype.getPositionFromMatrix=function(i){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(i)};q.prototype.getScaleFromMatrix=function(i){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(i)};q.prototype.getColumnFromMatrix=function(i,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,i)};q.prototype.applyProjection=function(i){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(i)};q.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)};q.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)};q.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};ze.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)};ze.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};Re.prototype.getChildByName=function(i){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(i)};Re.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")};Re.prototype.translate=function(i,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,i)};Re.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")};Re.prototype.applyMatrix=function(i){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)};Object.defineProperties(Re.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(i){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=i}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});ni.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")};Object.defineProperties(ni.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),iat},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});$v.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};xn.prototype.setLens=function(i,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(i)};Object.defineProperties(ir.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(i){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=i}},shadowCameraLeft:{set:function(i){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=i}},shadowCameraRight:{set:function(i){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=i}},shadowCameraTop:{set:function(i){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=i}},shadowCameraBottom:{set:function(i){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=i}},shadowCameraNear:{set:function(i){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=i}},shadowCameraFar:{set:function(i){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=i}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(i){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=i}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(i){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=i}},shadowMapHeight:{set:function(i){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=i}}});Object.defineProperties(we.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Rv},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Rv)}}});we.prototype.setDynamic=function(i){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?Rv:ud),this};we.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},we.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};Pe.prototype.addIndex=function(i){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(i)};Pe.prototype.addAttribute=function(i,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(t&&t.isBufferAttribute)&&!(t&&t.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(i,new we(arguments[1],arguments[2]))):i==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(i,t)};Pe.prototype.addDrawCall=function(i,t,e){e!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(i,t)};Pe.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()};Pe.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")};Pe.prototype.removeAttribute=function(i){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(i)};Pe.prototype.applyMatrix=function(i){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)};Object.defineProperties(Pe.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});xl.prototype.setDynamic=function(i){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?Rv:ud),this};xl.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};Ys.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")};Ys.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")};Ys.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")};Ju.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")};Ld.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this};Object.defineProperties(Hn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new zt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(i){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===I7}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(i){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=i}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}});Object.defineProperties(er.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(i){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=i}}});Ne.prototype.clearTarget=function(i,t,e,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(i),this.clear(t,e,n)};Ne.prototype.animate=function(i){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(i)};Ne.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()};Ne.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()};Ne.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision};Ne.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()};Ne.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")};Ne.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")};Ne.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")};Ne.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")};Ne.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")};Ne.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")};Ne.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures};Ne.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")};Ne.prototype.enableScissorTest=function(i){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(i)};Ne.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")};Ne.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")};Ne.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")};Ne.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")};Ne.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")};Ne.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")};Ne.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")};Ne.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")};Ne.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")};Ne.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()};Object.defineProperties(Ne.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=i}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=i}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(i){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=i===!0?Ze:Ws}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});Object.defineProperties(G7.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(ii.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=i}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=i}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=i}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=i}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(i){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=i}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(i){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=i}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(i){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=i}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(i){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=i}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(i){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=i}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(i){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=i}}});YM.prototype.load=function(i){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");let t=this;return new qM().load(i,function(n){t.setBuffer(n)}),this};ZM.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};md.prototype.updateCubeMap=function(i,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(i,t)};md.prototype.clear=function(i,t,e,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(i,t,e,n)};Go.crossOrigin=void 0;Go.loadTexture=function(i,t,e,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");let r=new OM;r.setCrossOrigin(this.crossOrigin);let o=r.load(i,e,void 0,n);return t&&(o.mapping=t),o};Go.loadTextureCube=function(i,t,e,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");let r=new FM;r.setCrossOrigin(this.crossOrigin);let o=r.load(i,e,void 0,n);return t&&(o.mapping=t),o};Go.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};Go.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:l4}}));typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=l4);var Ipt=200;function Q7(i){let t=i.length,e,n;for(;t;)n=Math.floor(Math.random()*t--),e=i[t],i[t]=i[n],i[n]=e;return i}function c2(i){let t=[];for(let e=0;e<i;e++)t.push(e);return t}function ao(i,t,e){let n=i.className.split(" ");if(e){if(t in n)return;n.push(t)}else{let r=n.indexOf(t);if(r===-1)return;n.splice(r,1)}i.className=n.join(" ")}function tB(i,t,e,n){let r=window.devicePixelRatio,o=new q().copy(n).project(i);return[(o.x+1)/2*t*r,-((o.y-1)/2*e)*r]}function Od(i,t){let e=t*3;return new q(i[e],i[e+1],i[e+2])}function eB(i,t,e){let n=1/0,r=0,o=new q().copy(e).sub(t),s=new q().copy(o).normalize(),a=i.length/3,l=0,c=new q,u=new q;for(let h=0;h<a;h++){c.x=i[l],c.y=i[l+1],c.z=i[l+2],l+=3,u.copy(c).sub(t);let p=s.dot(u);p<0||(r=p>r?p:r,n=p<n?p:n)}return[n,r]}function m4(i){let t=new ln(i);return t.needsUpdate=!0,t.minFilter=_n,t.generateMipmaps=!1,t.flipY=!1,t}function ah(i,t){if(!i)throw t=t||"Assertion failed",new Error(t)}function nB(i,t,e){let n;if(t){let r=new RegExp(i,"i");n=o=>r.test(o.metadata[e].toString())}else i=i.toLowerCase(),n=r=>r.metadata[e].toString().toLowerCase().indexOf(i)>=0;return n}function lo(i,t,e=null,n=Ipt){let r=e==null;return e=he(i,e),new Promise((o,s)=>{setTimeout(()=>{try{let a=t();r&&he(null,e),o(a)}catch(a){Ye(a.message),s(a)}return!0},n)})}function iB(i){if(!i)return{};let t=i.indexOf("?")!==-1?i.split("?")[1]:i;t.indexOf("#")&&(t=t.split("#")[0]);let e=t.split("&"),n={};for(let r=0;r<e.length;r++){let o=e[r].split("=");n[o[0].toLowerCase()]=decodeURIComponent(o[1])}return n}var J7=["/Adagrad"];function g4(i){for(let t=0;t<J7.length;t++)if(i.indexOf(J7[t])>=0)return!0;return!1}function x4(i,t){return(i||t)&&!(i&&t)}function u2(){return $t(this,null,function*(){try{let i=document.createElement("canvas"),t=i.getContext("webgl")||i.getContext("experimental-webgl");return yield dP(),t!=null&&mP()==="webgl"}catch(i){return!1}})}function co(i,t){return i<t?-1:i>t?1:i>=t?0:NaN}function h2(i){return i.length===1&&(i=Apt(i)),{left:function(t,e,n,r){for(n==null&&(n=0),r==null&&(r=t.length);n<r;){var o=n+r>>>1;i(t[o],e)<0?n=o+1:r=o}return n},right:function(t,e,n,r){for(n==null&&(n=0),r==null&&(r=t.length);n<r;){var o=n+r>>>1;i(t[o],e)>0?r=o:n=o+1}return n}}}function Apt(i){return function(t,e){return co(i(t),e)}}var rB=h2(co),oB=rB.right,kpt=rB.left,Qs=oB;function Sl(i,t){var e=i.length,n=-1,r,o,s;if(t==null){for(;++n<e;)if((r=i[n])!=null&&r>=r)for(o=s=r;++n<e;)(r=i[n])!=null&&(o>r&&(o=r),s<r&&(s=r))}else for(;++n<e;)if((r=t(i[n],n,i))!=null&&r>=r)for(o=s=r;++n<e;)(r=t(i[n],n,i))!=null&&(o>r&&(o=r),s<r&&(s=r));return[o,s]}var sB=Array.prototype,Ppt=sB.slice,Npt=sB.map;var y4=Math.sqrt(50),v4=Math.sqrt(10),b4=Math.sqrt(2);function f2(i,t,e){var n,r=-1,o,s,a;if(t=+t,i=+i,e=+e,i===t&&e>0)return[i];if((n=t<i)&&(o=i,i=t,t=o),(a=lh(i,t,e))===0||!isFinite(a))return[];if(a>0)for(i=Math.ceil(i/a),t=Math.floor(t/a),s=new Array(o=Math.ceil(t-i+1));++r<o;)s[r]=(i+r)*a;else for(i=Math.floor(i*a),t=Math.ceil(t*a),s=new Array(o=Math.ceil(i-t+1));++r<o;)s[r]=(i-r)/a;return n&&s.reverse(),s}function lh(i,t,e){var n=(t-i)/Math.max(0,e),r=Math.floor(Math.log(n)/Math.LN10),o=n/Math.pow(10,r);return r>=0?(o>=y4?10:o>=v4?5:o>=b4?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=y4?10:o>=v4?5:o>=b4?2:1)}function Cl(i,t,e){var n=Math.abs(t-i)/Math.max(0,e),r=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),o=n/r;return o>=y4?r*=10:o>=v4?r*=5:o>=b4&&(r*=2),t<i?-r:r}function ta(i,t){var e=i.length,n=-1,r,o;if(t==null){for(;++n<e;)if((r=i[n])!=null&&r>=r)for(o=r;++n<e;)(r=i[n])!=null&&r>o&&(o=r)}else for(;++n<e;)if((r=t(i[n],n,i))!=null&&r>=r)for(o=r;++n<e;)(r=t(i[n],n,i))!=null&&r>o&&(o=r);return o}function ea(i,t){var e=i.length,n=-1,r,o;if(t==null){for(;++n<e;)if((r=i[n])!=null&&r>=r)for(o=r;++n<e;)(r=i[n])!=null&&o>r&&(o=r)}else for(;++n<e;)if((r=t(i[n],n,i))!=null&&r>=r)for(o=r;++n<e;)(r=t(i[n],n,i))!=null&&o>r&&(o=r);return o}var d2=Array.prototype.slice;function lB(i){return i}var w4=1,S4=2,C4=3,Vd=4,cB=1e-6;function zpt(i){return"translate("+(i+.5)+",0)"}function Fpt(i){return"translate(0,"+(i+.5)+")"}function Opt(i){return function(t){return+i(t)}}function Bpt(i){var t=Math.max(0,i.bandwidth()-1)/2;return i.round()&&(t=Math.round(t)),function(e){return+i(e)+t}}function Vpt(){return!this.__axis}function uB(i,t){var e=[],n=null,r=null,o=6,s=6,a=3,l=i===w4||i===Vd?-1:1,c=i===Vd||i===S4?"x":"y",u=i===w4||i===C4?zpt:Fpt;function h(p){var f=n==null?t.ticks?t.ticks.apply(t,e):t.domain():n,d=r==null?t.tickFormat?t.tickFormat.apply(t,e):lB:r,m=Math.max(o,0)+a,x=t.range(),g=+x[0]+.5,y=+x[x.length-1]+.5,b=(t.bandwidth?Bpt:Opt)(t.copy()),v=p.selection?p.selection():p,_=v.selectAll(".domain").data([null]),S=v.selectAll(".tick").data(f,t).order(),E=S.exit(),M=S.enter().append("g").attr("class","tick"),N=S.select("line"),I=S.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),S=S.merge(M),N=N.merge(M.append("line").attr("stroke","currentColor").attr(c+"2",l*o)),I=I.merge(M.append("text").attr("fill","currentColor").attr(c,l*m).attr("dy",i===w4?"0em":i===C4?"0.71em":"0.32em")),p!==v&&(_=_.transition(p),S=S.transition(p),N=N.transition(p),I=I.transition(p),E=E.transition(p).attr("opacity",cB).attr("transform",function(w){return isFinite(w=b(w))?u(w):this.getAttribute("transform")}),M.attr("opacity",cB).attr("transform",function(w){var R=this.parentNode.__axis;return u(R&&isFinite(R=R(w))?R:b(w))})),E.remove(),_.attr("d",i===Vd||i==S4?s?"M"+l*s+","+g+"H0.5V"+y+"H"+l*s:"M0.5,"+g+"V"+y:s?"M"+g+","+l*s+"V0.5H"+y+"V"+l*s:"M"+g+",0.5H"+y),S.attr("opacity",1).attr("transform",function(w){return u(b(w))}),N.attr(c+"2",l*o),I.attr(c,l*m).text(d),v.filter(Vpt).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",i===S4?"start":i===Vd?"end":"middle"),v.each(function(){this.__axis=b})}return h.scale=function(p){return arguments.length?(t=p,h):t},h.ticks=function(){return e=d2.call(arguments),h},h.tickArguments=function(p){return arguments.length?(e=p==null?[]:d2.call(p),h):e.slice()},h.tickValues=function(p){return arguments.length?(n=p==null?null:d2.call(p),h):n&&n.slice()},h.tickFormat=function(p){return arguments.length?(r=p,h):r},h.tickSize=function(p){return arguments.length?(o=s=+p,h):o},h.tickSizeInner=function(p){return arguments.length?(o=+p,h):o},h.tickSizeOuter=function(p){return arguments.length?(s=+p,h):s},h.tickPadding=function(p){return arguments.length?(a=+p,h):a},h}function M4(i){return uB(C4,i)}function E4(i){return uB(Vd,i)}var Hpt={value:function(){}};function pB(){for(var i=0,t=arguments.length,e={},n;i<t;++i){if(!(n=arguments[i]+"")||n in e||/[\s.]/.test(n))throw new Error("illegal type: "+n);e[n]=[]}return new m2(e)}function m2(i){this._=i}function $pt(i,t){return i.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}m2.prototype=pB.prototype={constructor:m2,on:function(i,t){var e=this._,n=$pt(i+"",e),r,o=-1,s=n.length;if(arguments.length<2){for(;++o<s;)if((r=(i=n[o]).type)&&(r=Upt(e[r],i.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(r=(i=n[o]).type)e[r]=hB(e[r],i.name,t);else if(t==null)for(r in e)e[r]=hB(e[r],i.name,null);return this},copy:function(){var i={},t=this._;for(var e in t)i[e]=t[e].slice();return new m2(i)},call:function(i,t){if((r=arguments.length-2)>0)for(var e=new Array(r),n=0,r,o;n<r;++n)e[n]=arguments[n+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(o=this._[i],n=0,r=o.length;n<r;++n)o[n].value.apply(t,e)},apply:function(i,t,e){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var n=this._[i],r=0,o=n.length;r<o;++r)n[r].value.apply(t,e)}};function Upt(i,t){for(var e=0,n=i.length,r;e<n;++e)if((r=i[e]).name===t)return r.value}function hB(i,t,e){for(var n=0,r=i.length;n<r;++n)if(i[n].name===t){i[n]=Hpt,i=i.slice(0,n).concat(i.slice(n+1));break}return e!=null&&i.push({name:t,value:e}),i}var T4=pB;var g2="http://www.w3.org/1999/xhtml",I4={svg:"http://www.w3.org/2000/svg",xhtml:g2,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function jo(i){var t=i+="",e=t.indexOf(":");return e>=0&&(t=i.slice(0,e))!=="xmlns"&&(i=i.slice(e+1)),I4.hasOwnProperty(t)?{space:I4[t],local:i}:i}function Wpt(i){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===g2&&t.documentElement.namespaceURI===g2?t.createElement(i):t.createElementNS(e,i)}}function Gpt(i){return function(){return this.ownerDocument.createElementNS(i.space,i.local)}}function x2(i){var t=jo(i);return(t.local?Gpt:Wpt)(t)}function jpt(){}function Ml(i){return i==null?jpt:function(){return this.querySelector(i)}}function fB(i){typeof i!="function"&&(i=Ml(i));for(var t=this._groups,e=t.length,n=new Array(e),r=0;r<e;++r)for(var o=t[r],s=o.length,a=n[r]=new Array(s),l,c,u=0;u<s;++u)(l=o[u])&&(c=i.call(l,l.__data__,u,o))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new cn(n,this._parents)}function qpt(){return[]}function Hd(i){return i==null?qpt:function(){return this.querySelectorAll(i)}}function dB(i){typeof i!="function"&&(i=Hd(i));for(var t=this._groups,e=t.length,n=[],r=[],o=0;o<e;++o)for(var s=t[o],a=s.length,l,c=0;c<a;++c)(l=s[c])&&(n.push(i.call(l,l.__data__,c,s)),r.push(l));return new cn(n,r)}function $d(i){return function(){return this.matches(i)}}function mB(i){typeof i!="function"&&(i=$d(i));for(var t=this._groups,e=t.length,n=new Array(e),r=0;r<e;++r)for(var o=t[r],s=o.length,a=n[r]=[],l,c=0;c<s;++c)(l=o[c])&&i.call(l,l.__data__,c,o)&&a.push(l);return new cn(n,this._parents)}function y2(i){return new Array(i.length)}function gB(){return new cn(this._enter||this._groups.map(y2),this._parents)}function Ud(i,t){this.ownerDocument=i.ownerDocument,this.namespaceURI=i.namespaceURI,this._next=null,this._parent=i,this.__data__=t}Ud.prototype={constructor:Ud,appendChild:function(i){return this._parent.insertBefore(i,this._next)},insertBefore:function(i,t){return this._parent.insertBefore(i,t)},querySelector:function(i){return this._parent.querySelector(i)},querySelectorAll:function(i){return this._parent.querySelectorAll(i)}};function xB(i){return function(){return i}}var yB="$";function Xpt(i,t,e,n,r,o){for(var s=0,a,l=t.length,c=o.length;s<c;++s)(a=t[s])?(a.__data__=o[s],n[s]=a):e[s]=new Ud(i,o[s]);for(;s<l;++s)(a=t[s])&&(r[s]=a)}function Kpt(i,t,e,n,r,o,s){var a,l,c={},u=t.length,h=o.length,p=new Array(u),f;for(a=0;a<u;++a)(l=t[a])&&(p[a]=f=yB+s.call(l,l.__data__,a,t),f in c?r[a]=l:c[f]=l);for(a=0;a<h;++a)f=yB+s.call(i,o[a],a,o),(l=c[f])?(n[a]=l,l.__data__=o[a],c[f]=null):e[a]=new Ud(i,o[a]);for(a=0;a<u;++a)(l=t[a])&&c[p[a]]===l&&(r[a]=l)}function vB(i,t){if(!i)return f=new Array(this.size()),c=-1,this.each(function(S){f[++c]=S}),f;var e=t?Kpt:Xpt,n=this._parents,r=this._groups;typeof i!="function"&&(i=xB(i));for(var o=r.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=n[c],h=r[c],p=h.length,f=i.call(u,u&&u.__data__,c,n),d=f.length,m=a[c]=new Array(d),x=s[c]=new Array(d),g=l[c]=new Array(p);e(u,h,m,x,g,f,t);for(var y=0,b=0,v,_;y<d;++y)if(v=m[y]){for(y>=b&&(b=y+1);!(_=x[b])&&++b<d;);v._next=_||null}}return s=new cn(s,n),s._enter=a,s._exit=l,s}function bB(){return new cn(this._exit||this._groups.map(y2),this._parents)}function _B(i,t,e){var n=this.enter(),r=this,o=this.exit();return n=typeof i=="function"?i(n):n.append(i+""),t!=null&&(r=t(r)),e==null?o.remove():e(o),n&&r?n.merge(r).order():r}function wB(i){for(var t=this._groups,e=i._groups,n=t.length,r=e.length,o=Math.min(n,r),s=new Array(n),a=0;a<o;++a)for(var l=t[a],c=e[a],u=l.length,h=s[a]=new Array(u),p,f=0;f<u;++f)(p=l[f]||c[f])&&(h[f]=p);for(;a<n;++a)s[a]=t[a];return new cn(s,this._parents)}function SB(){for(var i=this._groups,t=-1,e=i.length;++t<e;)for(var n=i[t],r=n.length-1,o=n[r],s;--r>=0;)(s=n[r])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function CB(i){i||(i=Ypt);function t(h,p){return h&&p?i(h.__data__,p.__data__):!h-!p}for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o){for(var s=e[o],a=s.length,l=r[o]=new Array(a),c,u=0;u<a;++u)(c=s[u])&&(l[u]=c);l.sort(t)}return new cn(r,this._parents).order()}function Ypt(i,t){return i<t?-1:i>t?1:i>=t?0:NaN}function MB(){var i=arguments[0];return arguments[0]=this,i.apply(null,arguments),this}function EB(){var i=new Array(this.size()),t=-1;return this.each(function(){i[++t]=this}),i}function TB(){for(var i=this._groups,t=0,e=i.length;t<e;++t)for(var n=i[t],r=0,o=n.length;r<o;++r){var s=n[r];if(s)return s}return null}function IB(){var i=0;return this.each(function(){++i}),i}function AB(){return!this.node()}function kB(i){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,s=r.length,a;o<s;++o)(a=r[o])&&i.call(a,a.__data__,o,r);return this}function Zpt(i){return function(){this.removeAttribute(i)}}function Jpt(i){return function(){this.removeAttributeNS(i.space,i.local)}}function Qpt(i,t){return function(){this.setAttribute(i,t)}}function tft(i,t){return function(){this.setAttributeNS(i.space,i.local,t)}}function eft(i,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttribute(i):this.setAttribute(i,e)}}function nft(i,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttributeNS(i.space,i.local):this.setAttributeNS(i.space,i.local,e)}}function RB(i,t){var e=jo(i);if(arguments.length<2){var n=this.node();return e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}return this.each((t==null?e.local?Jpt:Zpt:typeof t=="function"?e.local?nft:eft:e.local?tft:Qpt)(e,t))}function v2(i){return i.ownerDocument&&i.ownerDocument.defaultView||i.document&&i||i.defaultView}function ift(i){return function(){this.style.removeProperty(i)}}function rft(i,t,e){return function(){this.style.setProperty(i,t,e)}}function oft(i,t,e){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(i):this.style.setProperty(i,n,e)}}function PB(i,t,e){return arguments.length>1?this.each((t==null?ift:typeof t=="function"?oft:rft)(i,t,e==null?"":e)):na(this.node(),i)}function na(i,t){return i.style.getPropertyValue(t)||v2(i).getComputedStyle(i,null).getPropertyValue(t)}function sft(i){return function(){delete this[i]}}function aft(i,t){return function(){this[i]=t}}function lft(i,t){return function(){var e=t.apply(this,arguments);e==null?delete this[i]:this[i]=e}}function NB(i,t){return arguments.length>1?this.each((t==null?sft:typeof t=="function"?lft:aft)(i,t)):this.node()[i]}function LB(i){return i.trim().split(/^|\s+/)}function A4(i){return i.classList||new DB(i)}function DB(i){this._node=i,this._names=LB(i.getAttribute("class")||"")}DB.prototype={add:function(i){var t=this._names.indexOf(i);t<0&&(this._names.push(i),this._node.setAttribute("class",this._names.join(" ")))},remove:function(i){var t=this._names.indexOf(i);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(i){return this._names.indexOf(i)>=0}};function zB(i,t){for(var e=A4(i),n=-1,r=t.length;++n<r;)e.add(t[n])}function FB(i,t){for(var e=A4(i),n=-1,r=t.length;++n<r;)e.remove(t[n])}function cft(i){return function(){zB(this,i)}}function uft(i){return function(){FB(this,i)}}function hft(i,t){return function(){(t.apply(this,arguments)?zB:FB)(this,i)}}function OB(i,t){var e=LB(i+"");if(arguments.length<2){for(var n=A4(this.node()),r=-1,o=e.length;++r<o;)if(!n.contains(e[r]))return!1;return!0}return this.each((typeof t=="function"?hft:t?cft:uft)(e,t))}function pft(){this.textContent=""}function fft(i){return function(){this.textContent=i}}function dft(i){return function(){var t=i.apply(this,arguments);this.textContent=t==null?"":t}}function BB(i){return arguments.length?this.each(i==null?pft:(typeof i=="function"?dft:fft)(i)):this.node().textContent}function mft(){this.innerHTML=""}function gft(i){return function(){this.innerHTML=i}}function xft(i){return function(){var t=i.apply(this,arguments);this.innerHTML=t==null?"":t}}function VB(i){return arguments.length?this.each(i==null?mft:(typeof i=="function"?xft:gft)(i)):this.node().innerHTML}function yft(){this.nextSibling&&this.parentNode.appendChild(this)}function HB(){return this.each(yft)}function vft(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function $B(){return this.each(vft)}function UB(i){var t=typeof i=="function"?i:x2(i);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function bft(){return null}function WB(i,t){var e=typeof i=="function"?i:x2(i),n=t==null?bft:typeof t=="function"?t:Ml(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),n.apply(this,arguments)||null)})}function _ft(){var i=this.parentNode;i&&i.removeChild(this)}function GB(){return this.each(_ft)}function wft(){var i=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(i,this.nextSibling):i}function Sft(){var i=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(i,this.nextSibling):i}function jB(i){return this.select(i?Sft:wft)}function qB(i){return arguments.length?this.property("__data__",i):this.node().__data__}var KB={},k4=null;typeof document!="undefined"&&(XB=document.documentElement,"onmouseenter"in XB||(KB={mouseenter:"mouseover",mouseleave:"mouseout"}));var XB;function Cft(i,t,e){return i=YB(i,t,e),function(n){var r=n.relatedTarget;(!r||r!==this&&!(r.compareDocumentPosition(this)&8))&&i.call(this,n)}}function YB(i,t,e){return function(n){var r=k4;k4=n;try{i.call(this,this.__data__,t,e)}finally{k4=r}}}function Mft(i){return i.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}function Eft(i){return function(){var t=this.__on;if(!!t){for(var e=0,n=-1,r=t.length,o;e<r;++e)o=t[e],(!i.type||o.type===i.type)&&o.name===i.name?this.removeEventListener(o.type,o.listener,o.capture):t[++n]=o;++n?t.length=n:delete this.__on}}}function Tft(i,t,e){var n=KB.hasOwnProperty(i.type)?Cft:YB;return function(r,o,s){var a=this.__on,l,c=n(t,o,s);if(a){for(var u=0,h=a.length;u<h;++u)if((l=a[u]).type===i.type&&l.name===i.name){this.removeEventListener(l.type,l.listener,l.capture),this.addEventListener(l.type,l.listener=c,l.capture=e),l.value=t;return}}this.addEventListener(i.type,c,e),l={type:i.type,name:i.name,value:t,listener:c,capture:e},a?a.push(l):this.__on=[l]}}function ZB(i,t,e){var n=Mft(i+""),r,o=n.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(r=0,u=a[l];r<o;++r)if((s=n[r]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?Tft:Eft,e==null&&(e=!1),r=0;r<o;++r)this.each(a(n[r],t,e));return this}function JB(i,t,e){var n=v2(i),r=n.CustomEvent;typeof r=="function"?r=new r(t,e):(r=n.document.createEvent("Event"),e?(r.initEvent(t,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(t,!1,!1)),i.dispatchEvent(r)}function Ift(i,t){return function(){return JB(this,i,t)}}function Aft(i,t){return function(){return JB(this,i,t.apply(this,arguments))}}function QB(i,t){return this.each((typeof t=="function"?Aft:Ift)(i,t))}var R4=[null];function cn(i,t){this._groups=i,this._parents=t}function tV(){return new cn([[document.documentElement]],R4)}cn.prototype=tV.prototype={constructor:cn,select:fB,selectAll:dB,filter:mB,data:vB,enter:gB,exit:bB,join:_B,merge:wB,order:SB,sort:CB,call:MB,nodes:EB,node:TB,size:IB,empty:AB,each:kB,attr:RB,style:PB,property:NB,classed:OB,text:BB,html:VB,raise:HB,lower:$B,append:UB,insert:WB,remove:GB,clone:jB,datum:qB,on:ZB,dispatch:QB};var qo=tV;function P4(i){return typeof i=="string"?new cn([[document.querySelector(i)]],[document.documentElement]):new cn([[i]],R4)}function b2(i,t,e){i.prototype=t.prototype=e,e.constructor=i}function N4(i,t){var e=Object.create(i.prototype);for(var n in t)e[n]=t[n];return e}function jd(){}var Wd=.7,w2=1/Wd,ch="\\s*([+-]?\\d+)\\s*",Gd="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ho="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",kft=/^#([0-9a-f]{3,8})$/,Rft=new RegExp("^rgb\\("+[ch,ch,ch]+"\\)$"),Pft=new RegExp("^rgb\\("+[ho,ho,ho]+"\\)$"),Nft=new RegExp("^rgba\\("+[ch,ch,ch,Gd]+"\\)$"),Lft=new RegExp("^rgba\\("+[ho,ho,ho,Gd]+"\\)$"),Dft=new RegExp("^hsl\\("+[Gd,ho,ho]+"\\)$"),zft=new RegExp("^hsla\\("+[Gd,ho,ho,Gd]+"\\)$"),eV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};b2(jd,Er,{copy:function(i){return Object.assign(new this.constructor,this,i)},displayable:function(){return this.rgb().displayable()},hex:nV,formatHex:nV,formatHsl:Fft,formatRgb:iV,toString:iV});function nV(){return this.rgb().formatHex()}function Fft(){return lV(this).formatHsl()}function iV(){return this.rgb().formatRgb()}function Er(i){var t,e;return i=(i+"").trim().toLowerCase(),(t=kft.exec(i))?(e=t[1].length,t=parseInt(t[1],16),e===6?rV(t):e===3?new zi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):e===8?_2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):e===4?_2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Rft.exec(i))?new zi(t[1],t[2],t[3],1):(t=Pft.exec(i))?new zi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Nft.exec(i))?_2(t[1],t[2],t[3],t[4]):(t=Lft.exec(i))?_2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Dft.exec(i))?aV(t[1],t[2]/100,t[3]/100,1):(t=zft.exec(i))?aV(t[1],t[2]/100,t[3]/100,t[4]):eV.hasOwnProperty(i)?rV(eV[i]):i==="transparent"?new zi(NaN,NaN,NaN,0):null}function rV(i){return new zi(i>>16&255,i>>8&255,i&255,1)}function _2(i,t,e,n){return n<=0&&(i=t=e=NaN),new zi(i,t,e,n)}function Oft(i){return i instanceof jd||(i=Er(i)),i?(i=i.rgb(),new zi(i.r,i.g,i.b,i.opacity)):new zi}function uh(i,t,e,n){return arguments.length===1?Oft(i):new zi(i,t,e,n==null?1:n)}function zi(i,t,e,n){this.r=+i,this.g=+t,this.b=+e,this.opacity=+n}b2(zi,uh,N4(jd,{brighter:function(i){return i=i==null?w2:Math.pow(w2,i),new zi(this.r*i,this.g*i,this.b*i,this.opacity)},darker:function(i){return i=i==null?Wd:Math.pow(Wd,i),new zi(this.r*i,this.g*i,this.b*i,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:oV,formatHex:oV,formatRgb:sV,toString:sV}));function oV(){return"#"+L4(this.r)+L4(this.g)+L4(this.b)}function sV(){var i=this.opacity;return i=isNaN(i)?1:Math.max(0,Math.min(1,i)),(i===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(i===1?")":", "+i+")")}function L4(i){return i=Math.max(0,Math.min(255,Math.round(i)||0)),(i<16?"0":"")+i.toString(16)}function aV(i,t,e,n){return n<=0?i=t=e=NaN:e<=0||e>=1?i=t=NaN:t<=0&&(i=NaN),new uo(i,t,e,n)}function lV(i){if(i instanceof uo)return new uo(i.h,i.s,i.l,i.opacity);if(i instanceof jd||(i=Er(i)),!i)return new uo;if(i instanceof uo)return i;i=i.rgb();var t=i.r/255,e=i.g/255,n=i.b/255,r=Math.min(t,e,n),o=Math.max(t,e,n),s=NaN,a=o-r,l=(o+r)/2;return a?(t===o?s=(e-n)/a+(e<n)*6:e===o?s=(n-t)/a+2:s=(t-e)/a+4,a/=l<.5?o+r:2-o-r,s*=60):a=l>0&&l<1?0:s,new uo(s,a,l,i.opacity)}function S2(i,t,e,n){return arguments.length===1?lV(i):new uo(i,t,e,n==null?1:n)}function uo(i,t,e,n){this.h=+i,this.s=+t,this.l=+e,this.opacity=+n}b2(uo,S2,N4(jd,{brighter:function(i){return i=i==null?w2:Math.pow(w2,i),new uo(this.h,this.s,this.l*i,this.opacity)},darker:function(i){return i=i==null?Wd:Math.pow(Wd,i),new uo(this.h,this.s,this.l*i,this.opacity)},rgb:function(){var i=this.h%360+(this.h<0)*360,t=isNaN(i)||isNaN(this.s)?0:this.s,e=this.l,n=e+(e<.5?e:1-e)*t,r=2*e-n;return new zi(D4(i>=240?i-240:i+120,r,n),D4(i,r,n),D4(i<120?i+240:i-120,r,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var i=this.opacity;return i=isNaN(i)?1:Math.max(0,Math.min(1,i)),(i===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(i===1?")":", "+i+")")}}));function D4(i,t,e){return(i<60?t+(e-t)*i/60:i<180?e:i<240?t+(e-t)*(240-i)/60:t)*255}function z4(i,t,e,n,r){var o=i*i,s=o*i;return((1-3*i+3*o-s)*t+(4-6*o+3*s)*e+(1+3*i+3*o-3*s)*n+s*r)/6}function cV(i){var t=i.length-1;return function(e){var n=e<=0?e=0:e>=1?(e=1,t-1):Math.floor(e*t),r=i[n],o=i[n+1],s=n>0?i[n-1]:2*r-o,a=n<t-1?i[n+2]:2*o-r;return z4((e-n/t)*t,s,r,o,a)}}function uV(i){var t=i.length;return function(e){var n=Math.floor(((e%=1)<0?++e:e)*t),r=i[(n+t-1)%t],o=i[n%t],s=i[(n+1)%t],a=i[(n+2)%t];return z4((e-n/t)*t,r,o,s,a)}}function qd(i){return function(){return i}}function Bft(i,t){return function(e){return i+e*t}}function Vft(i,t,e){return i=Math.pow(i,e),t=Math.pow(t,e)-i,e=1/e,function(n){return Math.pow(i+n*t,e)}}function hV(i){return(i=+i)==1?C2:function(t,e){return e-t?Vft(t,e,i):qd(isNaN(t)?e:t)}}function C2(i,t){var e=t-i;return e?Bft(i,e):qd(isNaN(i)?t:i)}var El=function i(t){var e=hV(t);function n(r,o){var s=e((r=uh(r)).r,(o=uh(o)).r),a=e(r.g,o.g),l=e(r.b,o.b),c=C2(r.opacity,o.opacity);return function(u){return r.r=s(u),r.g=a(u),r.b=l(u),r.opacity=c(u),r+""}}return n.gamma=i,n}(1);function pV(i){return function(t){var e=t.length,n=new Array(e),r=new Array(e),o=new Array(e),s,a;for(s=0;s<e;++s)a=uh(t[s]),n[s]=a.r||0,r[s]=a.g||0,o[s]=a.b||0;return n=i(n),r=i(r),o=i(o),a.opacity=1,function(l){return a.r=n(l),a.g=r(l),a.b=o(l),a+""}}}var Hft=pV(cV),$ft=pV(uV);function fV(i,t){t||(t=[]);var e=i?Math.min(t.length,i.length):0,n=t.slice(),r;return function(o){for(r=0;r<e;++r)n[r]=i[r]*(1-o)+t[r]*o;return n}}function dV(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function mV(i,t){var e=t?t.length:0,n=i?Math.min(e,i.length):0,r=new Array(n),o=new Array(e),s;for(s=0;s<n;++s)r[s]=Tl(i[s],t[s]);for(;s<e;++s)o[s]=t[s];return function(a){for(s=0;s<n;++s)o[s]=r[s](a);return o}}function gV(i,t){var e=new Date;return i=+i,t=+t,function(n){return e.setTime(i*(1-n)+t*n),e}}function Xn(i,t){return i=+i,t=+t,function(e){return i*(1-e)+t*e}}function xV(i,t){var e={},n={},r;(i===null||typeof i!="object")&&(i={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in i?e[r]=Tl(i[r],t[r]):n[r]=t[r];return function(o){for(r in e)n[r]=e[r](o);return n}}var O4=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,F4=new RegExp(O4.source,"g");function Uft(i){return function(){return i}}function Wft(i){return function(t){return i(t)+""}}function Xd(i,t){var e=O4.lastIndex=F4.lastIndex=0,n,r,o,s=-1,a=[],l=[];for(i=i+"",t=t+"";(n=O4.exec(i))&&(r=F4.exec(t));)(o=r.index)>e&&(o=t.slice(e,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:Xn(n,r)})),e=F4.lastIndex;return e<t.length&&(o=t.slice(e),a[s]?a[s]+=o:a[++s]=o),a.length<2?l[0]?Wft(l[0].x):Uft(t):(t=l.length,function(c){for(var u=0,h;u<t;++u)a[(h=l[u]).i]=h.x(c);return a.join("")})}function Tl(i,t){var e=typeof t,n;return t==null||e==="boolean"?qd(t):(e==="number"?Xn:e==="string"?(n=Er(t))?(t=n,El):Xd:t instanceof Er?El:t instanceof Date?gV:dV(t)?fV:Array.isArray(t)?mV:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?xV:Xn)(i,t)}function B4(i,t){return i=+i,t=+t,function(e){return Math.round(i*(1-e)+t*e)}}var yV=180/Math.PI,M2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function V4(i,t,e,n,r,o){var s,a,l;return(s=Math.sqrt(i*i+t*t))&&(i/=s,t/=s),(l=i*e+t*n)&&(e-=i*l,n-=t*l),(a=Math.sqrt(e*e+n*n))&&(e/=a,n/=a,l/=a),i*n<t*e&&(i=-i,t=-t,l=-l,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(t,i)*yV,skewX:Math.atan(l)*yV,scaleX:s,scaleY:a}}var Kd,H4,vV,E2;function bV(i){return i==="none"?M2:(Kd||(Kd=document.createElement("DIV"),H4=document.documentElement,vV=document.defaultView),Kd.style.transform=i,i=vV.getComputedStyle(H4.appendChild(Kd),null).getPropertyValue("transform"),H4.removeChild(Kd),i=i.slice(7,-1).split(","),V4(+i[0],+i[1],+i[2],+i[3],+i[4],+i[5]))}function _V(i){return i==null?M2:(E2||(E2=document.createElementNS("http://www.w3.org/2000/svg","g")),E2.setAttribute("transform",i),(i=E2.transform.baseVal.consolidate())?(i=i.matrix,V4(i.a,i.b,i.c,i.d,i.e,i.f)):M2)}function wV(i,t,e,n){function r(c){return c.length?c.pop()+" ":""}function o(c,u,h,p,f,d){if(c!==h||u!==p){var m=f.push("translate(",null,t,null,e);d.push({i:m-4,x:Xn(c,h)},{i:m-2,x:Xn(u,p)})}else(h||p)&&f.push("translate("+h+t+p+e)}function s(c,u,h,p){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),p.push({i:h.push(r(h)+"rotate(",null,n)-2,x:Xn(c,u)})):u&&h.push(r(h)+"rotate("+u+n)}function a(c,u,h,p){c!==u?p.push({i:h.push(r(h)+"skewX(",null,n)-2,x:Xn(c,u)}):u&&h.push(r(h)+"skewX("+u+n)}function l(c,u,h,p,f,d){if(c!==h||u!==p){var m=f.push(r(f)+"scale(",null,",",null,")");d.push({i:m-4,x:Xn(c,h)},{i:m-2,x:Xn(u,p)})}else(h!==1||p!==1)&&f.push(r(f)+"scale("+h+","+p+")")}return function(c,u){var h=[],p=[];return c=i(c),u=i(u),o(c.translateX,c.translateY,u.translateX,u.translateY,h,p),s(c.rotate,u.rotate,h,p),a(c.skewX,u.skewX,h,p),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,h,p),c=u=null,function(f){for(var d=-1,m=p.length,x;++d<m;)h[(x=p[d]).i]=x.x(f);return h.join("")}}}var $4=wV(bV,"px, ","px)","deg)"),U4=wV(_V,", ",")",")");var hh=0,Zd=0,Yd=0,CV=1e3,T2,Jd,I2=0,Il=0,A2=0,Qd=typeof performance=="object"&&performance.now?performance:Date,MV=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(i){setTimeout(i,17)};function ph(){return Il||(MV(Gft),Il=Qd.now()+A2)}function Gft(){Il=0}function tm(){this._call=this._time=this._next=null}tm.prototype=k2.prototype={constructor:tm,restart:function(i,t,e){if(typeof i!="function")throw new TypeError("callback is not a function");e=(e==null?ph():+e)+(t==null?0:+t),!this._next&&Jd!==this&&(Jd?Jd._next=this:T2=this,Jd=this),this._call=i,this._time=e,W4()},stop:function(){this._call&&(this._call=null,this._time=1/0,W4())}};function k2(i,t,e){var n=new tm;return n.restart(i,t,e),n}function EV(){ph(),++hh;for(var i=T2,t;i;)(t=Il-i._time)>=0&&i._call.call(null,t),i=i._next;--hh}function SV(){Il=(I2=Qd.now())+A2,hh=Zd=0;try{EV()}finally{hh=0,qft(),Il=0}}function jft(){var i=Qd.now(),t=i-I2;t>CV&&(A2-=t,I2=i)}function qft(){for(var i,t=T2,e,n=1/0;t;)t._call?(n>t._time&&(n=t._time),i=t,t=t._next):(e=t._next,t._next=null,t=i?i._next=e:T2=e);Jd=i,W4(n)}function W4(i){if(!hh){Zd&&(Zd=clearTimeout(Zd));var t=i-Il;t>24?(i<1/0&&(Zd=setTimeout(SV,i-Qd.now()-A2)),Yd&&(Yd=clearInterval(Yd))):(Yd||(I2=Qd.now(),Yd=setInterval(jft,CV)),hh=1,MV(SV))}}function R2(i,t,e){var n=new tm;return t=t==null?0:+t,n.restart(function(r){n.stop(),i(r+t)},t,e),n}var Xft=T4("start","end","cancel","interrupt"),Kft=[],IV=0,G4=1,N2=2,P2=3,TV=4,L2=5,em=6;function ia(i,t,e,n,r,o){var s=i.__transition;if(!s)i.__transition={};else if(e in s)return;Yft(i,e,{name:t,index:n,group:r,on:Xft,tween:Kft,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:IV})}function nm(i,t){var e=Rn(i,t);if(e.state>IV)throw new Error("too late; already scheduled");return e}function di(i,t){var e=Rn(i,t);if(e.state>P2)throw new Error("too late; already running");return e}function Rn(i,t){var e=i.__transition;if(!e||!(e=e[t]))throw new Error("transition not found");return e}function Yft(i,t,e){var n=i.__transition,r;n[t]=e,e.timer=k2(o,0,e.time);function o(c){e.state=G4,e.timer.restart(s,e.delay,e.time),e.delay<=c&&s(c-e.delay)}function s(c){var u,h,p,f;if(e.state!==G4)return l();for(u in n)if(f=n[u],f.name===e.name){if(f.state===P2)return R2(s);f.state===TV?(f.state=em,f.timer.stop(),f.on.call("interrupt",i,i.__data__,f.index,f.group),delete n[u]):+u<t&&(f.state=em,f.timer.stop(),f.on.call("cancel",i,i.__data__,f.index,f.group),delete n[u])}if(R2(function(){e.state===P2&&(e.state=TV,e.timer.restart(a,e.delay,e.time),a(c))}),e.state=N2,e.on.call("start",i,i.__data__,e.index,e.group),e.state===N2){for(e.state=P2,r=new Array(p=e.tween.length),u=0,h=-1;u<p;++u)(f=e.tween[u].value.call(i,i.__data__,e.index,e.group))&&(r[++h]=f);r.length=h+1}}function a(c){for(var u=c<e.duration?e.ease.call(null,c/e.duration):(e.timer.restart(l),e.state=L2,1),h=-1,p=r.length;++h<p;)r[h].call(i,u);e.state===L2&&(e.on.call("end",i,i.__data__,e.index,e.group),l())}function l(){e.state=em,e.timer.stop(),delete n[t];for(var c in n)return;delete i.__transition}}function im(i,t){var e=i.__transition,n,r,o=!0,s;if(!!e){t=t==null?null:t+"";for(s in e){if((n=e[s]).name!==t){o=!1;continue}r=n.state>N2&&n.state<L2,n.state=em,n.timer.stop(),n.on.call(r?"interrupt":"cancel",i,i.__data__,n.index,n.group),delete e[s]}o&&delete i.__transition}}function AV(i){return this.each(function(){im(this,i)})}function Zft(i,t){var e,n;return function(){var r=di(this,i),o=r.tween;if(o!==e){n=e=o;for(var s=0,a=n.length;s<a;++s)if(n[s].name===t){n=n.slice(),n.splice(s,1);break}}r.tween=n}}function Jft(i,t,e){var n,r;if(typeof e!="function")throw new Error;return function(){var o=di(this,i),s=o.tween;if(s!==n){r=(n=s).slice();for(var a={name:t,value:e},l=0,c=r.length;l<c;++l)if(r[l].name===t){r[l]=a;break}l===c&&r.push(a)}o.tween=r}}function kV(i,t){var e=this._id;if(i+="",arguments.length<2){for(var n=Rn(this.node(),e).tween,r=0,o=n.length,s;r<o;++r)if((s=n[r]).name===i)return s.value;return null}return this.each((t==null?Zft:Jft)(e,i,t))}function fh(i,t,e){var n=i._id;return i.each(function(){var r=di(this,n);(r.value||(r.value={}))[t]=e.apply(this,arguments)}),function(r){return Rn(r,n).value[t]}}function D2(i,t){var e;return(typeof t=="number"?Xn:t instanceof Er?El:(e=Er(t))?(t=e,El):Xd)(i,t)}function Qft(i){return function(){this.removeAttribute(i)}}function tdt(i){return function(){this.removeAttributeNS(i.space,i.local)}}function edt(i,t,e){var n,r=e+"",o;return function(){var s=this.getAttribute(i);return s===r?null:s===n?o:o=t(n=s,e)}}function ndt(i,t,e){var n,r=e+"",o;return function(){var s=this.getAttributeNS(i.space,i.local);return s===r?null:s===n?o:o=t(n=s,e)}}function idt(i,t,e){var n,r,o;return function(){var s,a=e(this),l;return a==null?void this.removeAttribute(i):(s=this.getAttribute(i),l=a+"",s===l?null:s===n&&l===r?o:(r=l,o=t(n=s,a)))}}function rdt(i,t,e){var n,r,o;return function(){var s,a=e(this),l;return a==null?void this.removeAttributeNS(i.space,i.local):(s=this.getAttributeNS(i.space,i.local),l=a+"",s===l?null:s===n&&l===r?o:(r=l,o=t(n=s,a)))}}function RV(i,t){var e=jo(i),n=e==="transform"?U4:D2;return this.attrTween(i,typeof t=="function"?(e.local?rdt:idt)(e,n,fh(this,"attr."+i,t)):t==null?(e.local?tdt:Qft)(e):(e.local?ndt:edt)(e,n,t))}function odt(i,t){return function(e){this.setAttribute(i,t.call(this,e))}}function sdt(i,t){return function(e){this.setAttributeNS(i.space,i.local,t.call(this,e))}}function adt(i,t){var e,n;function r(){var o=t.apply(this,arguments);return o!==n&&(e=(n=o)&&sdt(i,o)),e}return r._value=t,r}function ldt(i,t){var e,n;function r(){var o=t.apply(this,arguments);return o!==n&&(e=(n=o)&&odt(i,o)),e}return r._value=t,r}function PV(i,t){var e="attr."+i;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;var n=jo(i);return this.tween(e,(n.local?adt:ldt)(n,t))}function cdt(i,t){return function(){nm(this,i).delay=+t.apply(this,arguments)}}function udt(i,t){return t=+t,function(){nm(this,i).delay=t}}function NV(i){var t=this._id;return arguments.length?this.each((typeof i=="function"?cdt:udt)(t,i)):Rn(this.node(),t).delay}function hdt(i,t){return function(){di(this,i).duration=+t.apply(this,arguments)}}function pdt(i,t){return t=+t,function(){di(this,i).duration=t}}function LV(i){var t=this._id;return arguments.length?this.each((typeof i=="function"?hdt:pdt)(t,i)):Rn(this.node(),t).duration}function fdt(i,t){if(typeof t!="function")throw new Error;return function(){di(this,i).ease=t}}function DV(i){var t=this._id;return arguments.length?this.each(fdt(t,i)):Rn(this.node(),t).ease}function zV(i){typeof i!="function"&&(i=$d(i));for(var t=this._groups,e=t.length,n=new Array(e),r=0;r<e;++r)for(var o=t[r],s=o.length,a=n[r]=[],l,c=0;c<s;++c)(l=o[c])&&i.call(l,l.__data__,c,o)&&a.push(l);return new oi(n,this._parents,this._name,this._id)}function FV(i){if(i._id!==this._id)throw new Error;for(var t=this._groups,e=i._groups,n=t.length,r=e.length,o=Math.min(n,r),s=new Array(n),a=0;a<o;++a)for(var l=t[a],c=e[a],u=l.length,h=s[a]=new Array(u),p,f=0;f<u;++f)(p=l[f]||c[f])&&(h[f]=p);for(;a<n;++a)s[a]=t[a];return new oi(s,this._parents,this._name,this._id)}function ddt(i){return(i+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||t==="start"})}function mdt(i,t,e){var n,r,o=ddt(t)?nm:di;return function(){var s=o(this,i),a=s.on;a!==n&&(r=(n=a).copy()).on(t,e),s.on=r}}function OV(i,t){var e=this._id;return arguments.length<2?Rn(this.node(),e).on.on(i):this.each(mdt(e,i,t))}function gdt(i){return function(){var t=this.parentNode;for(var e in this.__transition)if(+e!==i)return;t&&t.removeChild(this)}}function BV(){return this.on("end.remove",gdt(this._id))}function VV(i){var t=this._name,e=this._id;typeof i!="function"&&(i=Ml(i));for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s)for(var a=n[s],l=a.length,c=o[s]=new Array(l),u,h,p=0;p<l;++p)(u=a[p])&&(h=i.call(u,u.__data__,p,a))&&("__data__"in u&&(h.__data__=u.__data__),c[p]=h,ia(c[p],t,e,p,c,Rn(u,e)));return new oi(o,this._parents,t,e)}function HV(i){var t=this._name,e=this._id;typeof i!="function"&&(i=Hd(i));for(var n=this._groups,r=n.length,o=[],s=[],a=0;a<r;++a)for(var l=n[a],c=l.length,u,h=0;h<c;++h)if(u=l[h]){for(var p=i.call(u,u.__data__,h,l),f,d=Rn(u,e),m=0,x=p.length;m<x;++m)(f=p[m])&&ia(f,t,e,m,p,d);o.push(p),s.push(u)}return new oi(o,s,t,e)}var xdt=qo.prototype.constructor;function $V(){return new xdt(this._groups,this._parents)}function ydt(i,t){var e,n,r;return function(){var o=na(this,i),s=(this.style.removeProperty(i),na(this,i));return o===s?null:o===e&&s===n?r:r=t(e=o,n=s)}}function UV(i){return function(){this.style.removeProperty(i)}}function vdt(i,t,e){var n,r=e+"",o;return function(){var s=na(this,i);return s===r?null:s===n?o:o=t(n=s,e)}}function bdt(i,t,e){var n,r,o;return function(){var s=na(this,i),a=e(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(i),na(this,i))),s===l?null:s===n&&l===r?o:(r=l,o=t(n=s,a))}}function _dt(i,t){var e,n,r,o="style."+t,s="end."+o,a;return function(){var l=di(this,i),c=l.on,u=l.value[o]==null?a||(a=UV(t)):void 0;(c!==e||r!==u)&&(n=(e=c).copy()).on(s,r=u),l.on=n}}function WV(i,t,e){var n=(i+="")=="transform"?$4:D2;return t==null?this.styleTween(i,ydt(i,n)).on("end.style."+i,UV(i)):typeof t=="function"?this.styleTween(i,bdt(i,n,fh(this,"style."+i,t))).each(_dt(this._id,i)):this.styleTween(i,vdt(i,n,t),e).on("end.style."+i,null)}function wdt(i,t,e){return function(n){this.style.setProperty(i,t.call(this,n),e)}}function Sdt(i,t,e){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&wdt(i,s,e)),n}return o._value=t,o}function GV(i,t,e){var n="style."+(i+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,Sdt(i,t,e==null?"":e))}function Cdt(i){return function(){this.textContent=i}}function Mdt(i){return function(){var t=i(this);this.textContent=t==null?"":t}}function jV(i){return this.tween("text",typeof i=="function"?Mdt(fh(this,"text",i)):Cdt(i==null?"":i+""))}function Edt(i){return function(t){this.textContent=i.call(this,t)}}function Tdt(i){var t,e;function n(){var r=i.apply(this,arguments);return r!==e&&(t=(e=r)&&Edt(r)),t}return n._value=i,n}function qV(i){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(i==null)return this.tween(t,null);if(typeof i!="function")throw new Error;return this.tween(t,Tdt(i))}function XV(){for(var i=this._name,t=this._id,e=z2(),n=this._groups,r=n.length,o=0;o<r;++o)for(var s=n[o],a=s.length,l,c=0;c<a;++c)if(l=s[c]){var u=Rn(l,t);ia(l,i,e,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new oi(n,this._parents,i,e)}function KV(){var i,t,e=this,n=e._id,r=e.size();return new Promise(function(o,s){var a={value:s},l={value:function(){--r===0&&o()}};e.each(function(){var c=di(this,n),u=c.on;u!==i&&(t=(i=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),c.on=t})})}var Idt=0;function oi(i,t,e,n){this._groups=i,this._parents=t,this._name=e,this._id=n}function j4(i){return qo().transition(i)}function z2(){return++Idt}var dh=qo.prototype;oi.prototype=j4.prototype={constructor:oi,select:VV,selectAll:HV,filter:zV,merge:FV,selection:$V,transition:XV,call:dh.call,nodes:dh.nodes,node:dh.node,size:dh.size,empty:dh.empty,each:dh.each,on:OV,attr:RV,attrTween:PV,style:WV,styleTween:GV,text:jV,textTween:qV,remove:BV,tween:kV,delay:NV,duration:LV,ease:DV,end:KV};function F2(i){return((i*=2)<=1?i*i*i:(i-=2)*i*i+2)/2}var q4={time:null,delay:0,duration:250,ease:F2};function Adt(i,t){for(var e;!(e=i.__transition)||!(e=e[t]);)if(!(i=i.parentNode))return q4.time=ph(),q4;return e}function YV(i){var t,e;i instanceof oi?(t=i._id,i=i._name):(t=z2(),(e=q4).time=ph(),i=i==null?null:i+"");for(var n=this._groups,r=n.length,o=0;o<r;++o)for(var s=n[o],a=s.length,l,c=0;c<a;++c)(l=s[c])&&ia(l,i,t,c,s,e||Adt(l,t));return new oi(n,this._parents,i,t)}qo.prototype.interrupt=AV;qo.prototype.transition=YV;function ZV(i){return[+i[0],+i[1]]}function kdt(i){return[ZV(i[0]),ZV(i[1])]}var uge={name:"x",handles:["w","e"].map(X4),input:function(i,t){return i==null?null:[[+i[0],t[0][1]],[+i[1],t[1][1]]]},output:function(i){return i&&[i[0][0],i[1][0]]}},hge={name:"y",handles:["n","s"].map(X4),input:function(i,t){return i==null?null:[[t[0][0],+i[0]],[t[1][0],+i[1]]]},output:function(i){return i&&[i[0][1],i[1][1]]}},pge={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(X4),input:function(i){return i==null?null:kdt(i)},output:function(i){return i}};function X4(i){return{type:i}}var JV=Math.PI,Rdt=JV/2,Pdt=JV*2;var Ndt=Array.prototype.slice;var K4=Math.PI,Y4=2*K4,Al=1e-6,Ldt=Y4-Al;function Z4(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function QV(){return new Z4}Z4.prototype=QV.prototype={constructor:Z4,moveTo:function(i,t){this._+="M"+(this._x0=this._x1=+i)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(i,t){this._+="L"+(this._x1=+i)+","+(this._y1=+t)},quadraticCurveTo:function(i,t,e,n){this._+="Q"+ +i+","+ +t+","+(this._x1=+e)+","+(this._y1=+n)},bezierCurveTo:function(i,t,e,n,r,o){this._+="C"+ +i+","+ +t+","+ +e+","+ +n+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(i,t,e,n,r){i=+i,t=+t,e=+e,n=+n,r=+r;var o=this._x1,s=this._y1,a=e-i,l=n-t,c=o-i,u=s-t,h=c*c+u*u;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=i)+","+(this._y1=t);else if(h>Al)if(!(Math.abs(u*a-l*c)>Al)||!r)this._+="L"+(this._x1=i)+","+(this._y1=t);else{var p=e-o,f=n-s,d=a*a+l*l,m=p*p+f*f,x=Math.sqrt(d),g=Math.sqrt(h),y=r*Math.tan((K4-Math.acos((d+h-m)/(2*x*g)))/2),b=y/g,v=y/x;Math.abs(b-1)>Al&&(this._+="L"+(i+b*c)+","+(t+b*u)),this._+="A"+r+","+r+",0,0,"+ +(u*p>c*f)+","+(this._x1=i+v*a)+","+(this._y1=t+v*l)}},arc:function(i,t,e,n,r,o){i=+i,t=+t,e=+e,o=!!o;var s=e*Math.cos(n),a=e*Math.sin(n),l=i+s,c=t+a,u=1^o,h=o?n-r:r-n;if(e<0)throw new Error("negative radius: "+e);this._x1===null?this._+="M"+l+","+c:(Math.abs(this._x1-l)>Al||Math.abs(this._y1-c)>Al)&&(this._+="L"+l+","+c),e&&(h<0&&(h=h%Y4+Y4),h>Ldt?this._+="A"+e+","+e+",0,1,"+u+","+(i-s)+","+(t-a)+"A"+e+","+e+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):h>Al&&(this._+="A"+e+","+e+",0,"+ +(h>=K4)+","+u+","+(this._x1=i+e*Math.cos(r))+","+(this._y1=t+e*Math.sin(r))))},rect:function(i,t,e,n){this._+="M"+(this._x0=this._x1=+i)+","+(this._y0=this._y1=+t)+"h"+ +e+"v"+ +n+"h"+-e+"Z"},toString:function(){return this._}};var J4=QV;var Fi="$";function O2(){}O2.prototype=tH.prototype={constructor:O2,has:function(i){return Fi+i in this},get:function(i){return this[Fi+i]},set:function(i,t){return this[Fi+i]=t,this},remove:function(i){var t=Fi+i;return t in this&&delete this[t]},clear:function(){for(var i in this)i[0]===Fi&&delete this[i]},keys:function(){var i=[];for(var t in this)t[0]===Fi&&i.push(t.slice(1));return i},values:function(){var i=[];for(var t in this)t[0]===Fi&&i.push(this[t]);return i},entries:function(){var i=[];for(var t in this)t[0]===Fi&&i.push({key:t.slice(1),value:this[t]});return i},size:function(){var i=0;for(var t in this)t[0]===Fi&&++i;return i},empty:function(){for(var i in this)if(i[0]===Fi)return!1;return!0},each:function(i){for(var t in this)t[0]===Fi&&i(this[t],t.slice(1),this)}};function tH(i,t){var e=new O2;if(i instanceof O2)i.each(function(a,l){e.set(l,a)});else if(Array.isArray(i)){var n=-1,r=i.length,o;if(t==null)for(;++n<r;)e.set(n,i[n]);else for(;++n<r;)e.set(t(o=i[n],n,i),o)}else if(i)for(var s in i)e.set(s,i[s]);return e}var Xo=tH;function B2(){}var kl=Xo.prototype;B2.prototype=Ddt.prototype={constructor:B2,has:kl.has,add:function(i){return i+="",this[Fi+i]=i,this},remove:kl.remove,clear:kl.clear,values:kl.keys,size:kl.size,empty:kl.empty,each:kl.each};function Ddt(i,t){var e=new B2;if(i instanceof B2)i.each(function(o){e.add(o)});else if(i){var n=-1,r=i.length;if(t==null)for(;++n<r;)e.add(i[n]);else for(;++n<r;)e.add(t(i[n],n,i))}return e}var zdt=Array.prototype,eH=zdt.slice;var Y1e=Math.PI*(3-Math.sqrt(5));function iH(i){return Math.abs(i=Math.round(i))>=1e21?i.toLocaleString("en").replace(/,/g,""):i.toString(10)}function Rl(i,t){if((e=(i=t?i.toExponential(t-1):i.toExponential()).indexOf("e"))<0)return null;var e,n=i.slice(0,e);return[n.length>1?n[0]+n.slice(2):n,+i.slice(e+1)]}function po(i){return i=Rl(Math.abs(i)),i?i[1]:NaN}function rH(i,t){return function(e,n){for(var r=e.length,o=[],s=0,a=i[0],l=0;r>0&&a>0&&(l+a+1>n&&(a=Math.max(1,n-l)),o.push(e.substring(r-=a,r+a)),!((l+=a+1)>n));)a=i[s=(s+1)%i.length];return o.reverse().join(t)}}function oH(i){return function(t){return t.replace(/[0-9]/g,function(e){return i[+e]})}}var Bdt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ra(i){if(!(t=Bdt.exec(i)))throw new Error("invalid format: "+i);var t;return new V2({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ra.prototype=V2.prototype;function V2(i){this.fill=i.fill===void 0?" ":i.fill+"",this.align=i.align===void 0?">":i.align+"",this.sign=i.sign===void 0?"-":i.sign+"",this.symbol=i.symbol===void 0?"":i.symbol+"",this.zero=!!i.zero,this.width=i.width===void 0?void 0:+i.width,this.comma=!!i.comma,this.precision=i.precision===void 0?void 0:+i.precision,this.trim=!!i.trim,this.type=i.type===void 0?"":i.type+""}V2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function sH(i){t:for(var t=i.length,e=1,n=-1,r;e<t;++e)switch(i[e]){case".":n=r=e;break;case"0":n===0&&(n=e),r=e;break;default:if(!+i[e])break t;n>0&&(n=0);break}return n>0?i.slice(0,n)+i.slice(r+1):i}var Q4;function aH(i,t){var e=Rl(i,t);if(!e)return i+"";var n=e[0],r=e[1],o=r-(Q4=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,s=n.length;return o===s?n:o>s?n+new Array(o-s+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+Rl(i,Math.max(0,t+o-1))[0]}function tE(i,t){var e=Rl(i,t);if(!e)return i+"";var n=e[0],r=e[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")}var eE={"%":function(i,t){return(i*100).toFixed(t)},b:function(i){return Math.round(i).toString(2)},c:function(i){return i+""},d:iH,e:function(i,t){return i.toExponential(t)},f:function(i,t){return i.toFixed(t)},g:function(i,t){return i.toPrecision(t)},o:function(i){return Math.round(i).toString(8)},p:function(i,t){return tE(i*100,t)},r:tE,s:aH,X:function(i){return Math.round(i).toString(16).toUpperCase()},x:function(i){return Math.round(i).toString(16)}};function nE(i){return i}var lH=Array.prototype.map,cH=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function uH(i){var t=i.grouping===void 0||i.thousands===void 0?nE:rH(lH.call(i.grouping,Number),i.thousands+""),e=i.currency===void 0?"":i.currency[0]+"",n=i.currency===void 0?"":i.currency[1]+"",r=i.decimal===void 0?".":i.decimal+"",o=i.numerals===void 0?nE:oH(lH.call(i.numerals,String)),s=i.percent===void 0?"%":i.percent+"",a=i.minus===void 0?"-":i.minus+"",l=i.nan===void 0?"NaN":i.nan+"";function c(h){h=ra(h);var p=h.fill,f=h.align,d=h.sign,m=h.symbol,x=h.zero,g=h.width,y=h.comma,b=h.precision,v=h.trim,_=h.type;_==="n"?(y=!0,_="g"):eE[_]||(b===void 0&&(b=12),v=!0,_="g"),(x||p==="0"&&f==="=")&&(x=!0,p="0",f="=");var S=m==="$"?e:m==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",E=m==="$"?n:/[%p]/.test(_)?s:"",M=eE[_],N=/[defgprs%]/.test(_);b=b===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function I(w){var R=S,P=E,D,F,z;if(_==="c")P=M(w)+P,w="";else{w=+w;var V=w<0||1/w<0;if(w=isNaN(w)?l:M(Math.abs(w),b),v&&(w=sH(w)),V&&+w==0&&d!=="+"&&(V=!1),R=(V?d==="("?d:a:d==="-"||d==="("?"":d)+R,P=(_==="s"?cH[8+Q4/3]:"")+P+(V&&d==="("?")":""),N){for(D=-1,F=w.length;++D<F;)if(z=w.charCodeAt(D),48>z||z>57){P=(z===46?r+w.slice(D+1):w.slice(D))+P,w=w.slice(0,D);break}}}y&&!x&&(w=t(w,1/0));var H=R.length+w.length+P.length,X=H<g?new Array(g-H+1).join(p):"";switch(y&&x&&(w=t(X+w,X.length?g-P.length:1/0),X=""),f){case"<":w=R+w+P+X;break;case"=":w=R+X+w+P;break;case"^":w=X.slice(0,H=X.length>>1)+R+w+P+X.slice(H);break;default:w=X+R+w+P;break}return o(w)}return I.toString=function(){return h+""},I}function u(h,p){var f=c((h=ra(h),h.type="f",h)),d=Math.max(-8,Math.min(8,Math.floor(po(p)/3)))*3,m=Math.pow(10,-d),x=cH[8+d/3];return function(g){return f(m*g)+x}}return{format:c,formatPrefix:u}}var H2,$2,U2;iE({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function iE(i){return H2=uH(i),$2=H2.format,U2=H2.formatPrefix,H2}function rE(i){return Math.max(0,-po(Math.abs(i)))}function oE(i,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(po(t)/3)))*3-po(Math.abs(i)))}function sE(i,t){return i=Math.abs(i),t=Math.abs(t)-i,Math.max(0,po(t)-po(i))+1}function or(){return Math.random()}var Vdt=function i(t){function e(n,r){return n=n==null?0:+n,r=r==null?1:+r,arguments.length===1?(r=n,n=0):r-=n,function(){return t()*r+n}}return e.source=i,e}(or);var om=function i(t){function e(n,r){var o,s;return n=n==null?0:+n,r=r==null?1:+r,function(){var a;if(o!=null)a=o,o=null;else do o=t()*2-1,a=t()*2-1,s=o*o+a*a;while(!s||s>1);return n+r*a*Math.sqrt(-2*Math.log(s)/s)}}return e.source=i,e}(or);var Hdt=function i(t){function e(){var n=om.source(t).apply(this,arguments);return function(){return Math.exp(n())}}return e.source=i,e}(or);var aE=function i(t){function e(n){return function(){for(var r=0,o=0;o<n;++o)r+=t();return r}}return e.source=i,e}(or);var $dt=function i(t){function e(n){var r=aE.source(t)(n);return function(){return r()/n}}return e.source=i,e}(or);var Udt=function i(t){function e(n){return function(){return-Math.log(1-t())/n}}return e.source=i,e}(or);function wi(i,t){switch(arguments.length){case 0:break;case 1:this.range(i);break;default:this.range(t).domain(i);break}return this}var hH=Array.prototype,W2=hH.map,oa=hH.slice;var lE={name:"implicit"};function mh(){var i=Xo(),t=[],e=[],n=lE;function r(o){var s=o+"",a=i.get(s);if(!a){if(n!==lE)return n;i.set(s,a=t.push(o))}return e[(a-1)%e.length]}return r.domain=function(o){if(!arguments.length)return t.slice();t=[],i=Xo();for(var s=-1,a=o.length,l,c;++s<a;)i.has(c=(l=o[s])+"")||i.set(c,t.push(l));return r},r.range=function(o){return arguments.length?(e=oa.call(o),r):e.slice()},r.unknown=function(o){return arguments.length?(n=o,r):n},r.copy=function(){return mh(t,e).unknown(n)},wi.apply(r,arguments),r}function pH(i){return function(){return i}}function cE(i){return+i}var fH=[0,1];function si(i){return i}function uE(i,t){return(t-=i=+i)?function(e){return(e-i)/t}:pH(isNaN(t)?NaN:.5)}function dH(i){var t=i[0],e=i[i.length-1],n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function Wdt(i,t,e){var n=i[0],r=i[1],o=t[0],s=t[1];return r<n?(n=uE(r,n),o=e(s,o)):(n=uE(n,r),o=e(o,s)),function(a){return o(n(a))}}function Gdt(i,t,e){var n=Math.min(i.length,t.length)-1,r=new Array(n),o=new Array(n),s=-1;for(i[n]<i[0]&&(i=i.slice().reverse(),t=t.slice().reverse());++s<n;)r[s]=uE(i[s],i[s+1]),o[s]=e(t[s],t[s+1]);return function(a){var l=Qs(i,a,1,n)-1;return o[l](r[l](a))}}function Pl(i,t){return t.domain(i.domain()).range(i.range()).interpolate(i.interpolate()).clamp(i.clamp()).unknown(i.unknown())}function sm(){var i=fH,t=fH,e=Tl,n,r,o,s=si,a,l,c;function u(){return a=Math.min(i.length,t.length)>2?Gdt:Wdt,l=c=null,h}function h(p){return isNaN(p=+p)?o:(l||(l=a(i.map(n),t,e)))(n(s(p)))}return h.invert=function(p){return s(r((c||(c=a(t,i.map(n),Xn)))(p)))},h.domain=function(p){return arguments.length?(i=W2.call(p,cE),s===si||(s=dH(i)),u()):i.slice()},h.range=function(p){return arguments.length?(t=oa.call(p),u()):t.slice()},h.rangeRound=function(p){return t=oa.call(p),e=B4,u()},h.clamp=function(p){return arguments.length?(s=p?dH(i):si,h):s!==si},h.interpolate=function(p){return arguments.length?(e=p,u()):e},h.unknown=function(p){return arguments.length?(o=p,h):o},function(p,f){return n=p,r=f,u()}}function G2(i,t){return sm()(i,t)}function hE(i,t,e,n){var r=Cl(i,t,e),o;switch(n=ra(n==null?",f":n),n.type){case"s":{var s=Math.max(Math.abs(i),Math.abs(t));return n.precision==null&&!isNaN(o=oE(r,s))&&(n.precision=o),U2(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=sE(r,Math.max(Math.abs(i),Math.abs(t))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=rE(r))&&(n.precision=o-(n.type==="%")*2);break}}return $2(n)}function sa(i){var t=i.domain;return i.ticks=function(e){var n=t();return f2(n[0],n[n.length-1],e==null?10:e)},i.tickFormat=function(e,n){var r=t();return hE(r[0],r[r.length-1],e==null?10:e,n)},i.nice=function(e){e==null&&(e=10);var n=t(),r=0,o=n.length-1,s=n[r],a=n[o],l;return a<s&&(l=s,s=a,a=l,l=r,r=o,o=l),l=lh(s,a,e),l>0?(s=Math.floor(s/l)*l,a=Math.ceil(a/l)*l,l=lh(s,a,e)):l<0&&(s=Math.ceil(s*l)/l,a=Math.floor(a*l)/l,l=lh(s,a,e)),l>0?(n[r]=Math.floor(s/l)*l,n[o]=Math.ceil(a/l)*l,t(n)):l<0&&(n[r]=Math.ceil(s*l)/l,n[o]=Math.floor(a*l)/l,t(n)),i},i}function mi(){var i=G2(si,si);return i.copy=function(){return Pl(i,mi())},wi.apply(i,arguments),sa(i)}function mH(i){return function(t){return t<0?-Math.pow(-t,i):Math.pow(t,i)}}function qdt(i){return i<0?-Math.sqrt(-i):Math.sqrt(i)}function Xdt(i){return i<0?-i*i:i*i}function pE(i){var t=i(si,si),e=1;function n(){return e===1?i(si,si):e===.5?i(qdt,Xdt):i(mH(e),mH(1/e))}return t.exponent=function(r){return arguments.length?(e=+r,n()):e},sa(t)}function am(){var i=pE(sm());return i.copy=function(){return Pl(i,am()).exponent(i.exponent())},wi.apply(i,arguments),i}var Kdt=1e3,Ydt=Kdt*60,Zdt=Ydt*60,fE=Zdt*24,$ye=fE*7,Uye=fE*30,Wye=fE*365;function xH(i){for(var t=i.length/6|0,e=new Array(t),n=0;n<t;)e[n]="#"+i.slice(n*6,++n*6);return e}var dE=xH("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function lm(i){return function(){return i}}function yH(i){this._context=i}yH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(i,t){switch(i=+i,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,t):this._context.moveTo(i,t);break;case 1:this._point=2;default:this._context.lineTo(i,t);break}}};function vH(i){return new yH(i)}function bH(i){return i[0]}function _H(i){return i[1]}function j2(){var i=bH,t=_H,e=lm(!0),n=null,r=vH,o=null;function s(a){var l,c=a.length,u,h=!1,p;for(n==null&&(o=r(p=J4())),l=0;l<=c;++l)!(l<c&&e(u=a[l],l,a))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+i(u,l,a),+t(u,l,a));if(p)return o=null,p+""||null}return s.x=function(a){return arguments.length?(i=typeof a=="function"?a:lm(+a),s):i},s.y=function(a){return arguments.length?(t=typeof a=="function"?a:lm(+a),s):t},s.defined=function(a){return arguments.length?(e=typeof a=="function"?a:lm(!!a),s):e},s.curve=function(a){return arguments.length?(r=a,n!=null&&(o=r(n)),s):r},s.context=function(a){return arguments.length?(a==null?n=o=null:o=r(n=a),s):n},s}function mE(){this._=null}function gh(i){i.U=i.C=i.L=i.R=i.P=i.N=null}mE.prototype={constructor:mE,insert:function(i,t){var e,n,r;if(i){if(t.P=i,t.N=i.N,i.N&&(i.N.P=t),i.N=t,i.R){for(i=i.R;i.L;)i=i.L;i.L=t}else i.R=t;e=i}else this._?(i=wH(this._),t.P=null,t.N=i,i.P=i.L=t,e=i):(t.P=t.N=null,this._=t,e=null);for(t.L=t.R=null,t.U=e,t.C=!0,i=t;e&&e.C;)n=e.U,e===n.L?(r=n.R,r&&r.C?(e.C=r.C=!1,n.C=!0,i=n):(i===e.R&&(cm(this,e),i=e,e=i.U),e.C=!1,n.C=!0,um(this,n))):(r=n.L,r&&r.C?(e.C=r.C=!1,n.C=!0,i=n):(i===e.L&&(um(this,e),i=e,e=i.U),e.C=!1,n.C=!0,cm(this,n))),e=i.U;this._.C=!1},remove:function(i){i.N&&(i.N.P=i.P),i.P&&(i.P.N=i.N),i.N=i.P=null;var t=i.U,e,n=i.L,r=i.R,o,s;if(n?r?o=wH(r):o=n:o=r,t?t.L===i?t.L=o:t.R=o:this._=o,n&&r?(s=o.C,o.C=i.C,o.L=n,n.U=o,o!==r?(t=o.U,o.U=i.U,i=o.R,t.L=i,o.R=r,r.U=o):(o.U=t,t=o,i=o.R)):(s=i.C,i=o),i&&(i.U=t),!s){if(i&&i.C){i.C=!1;return}do{if(i===this._)break;if(i===t.L){if(e=t.R,e.C&&(e.C=!1,t.C=!0,cm(this,t),e=t.R),e.L&&e.L.C||e.R&&e.R.C){(!e.R||!e.R.C)&&(e.L.C=!1,e.C=!0,um(this,e),e=t.R),e.C=t.C,t.C=e.R.C=!1,cm(this,t),i=this._;break}}else if(e=t.L,e.C&&(e.C=!1,t.C=!0,um(this,t),e=t.L),e.L&&e.L.C||e.R&&e.R.C){(!e.L||!e.L.C)&&(e.R.C=!1,e.C=!0,cm(this,e),e=t.L),e.C=t.C,t.C=e.L.C=!1,um(this,t),i=this._;break}e.C=!0,i=t,t=t.U}while(!i.C);i&&(i.C=!1)}}};function cm(i,t){var e=t,n=t.R,r=e.U;r?r.L===e?r.L=n:r.R=n:i._=n,n.U=r,e.U=n,e.R=n.L,e.R&&(e.R.U=e),n.L=e}function um(i,t){var e=t,n=t.L,r=e.U;r?r.L===e?r.L=n:r.R=n:i._=n,n.U=r,e.U=n,e.L=n.R,e.L&&(e.L.U=e),n.R=e}function wH(i){for(;i.L;)i=i.L;return i}var gE=mE;function xh(i,t,e,n){var r=[null,null],o=$n.push(r)-1;return r.left=i,r.right=t,e&&hm(r,i,t,e),n&&hm(r,t,i,n),gi[i.index].halfedges.push(o),gi[t.index].halfedges.push(o),r}function yh(i,t,e){var n=[t,e];return n.left=i,n}function hm(i,t,e,n){!i[0]&&!i[1]?(i[0]=n,i.left=t,i.right=e):i.left===e?i[1]=n:i[0]=n}function tmt(i,t,e,n,r){var o=i[0],s=i[1],a=o[0],l=o[1],c=s[0],u=s[1],h=0,p=1,f=c-a,d=u-l,m;if(m=t-a,!(!f&&m>0)){if(m/=f,f<0){if(m<h)return;m<p&&(p=m)}else if(f>0){if(m>p)return;m>h&&(h=m)}if(m=n-a,!(!f&&m<0)){if(m/=f,f<0){if(m>p)return;m>h&&(h=m)}else if(f>0){if(m<h)return;m<p&&(p=m)}if(m=e-l,!(!d&&m>0)){if(m/=d,d<0){if(m<h)return;m<p&&(p=m)}else if(d>0){if(m>p)return;m>h&&(h=m)}if(m=r-l,!(!d&&m<0)){if(m/=d,d<0){if(m>p)return;m>h&&(h=m)}else if(d>0){if(m<h)return;m<p&&(p=m)}return!(h>0)&&!(p<1)||(h>0&&(i[0]=[a+h*f,l+h*d]),p<1&&(i[1]=[a+p*f,l+p*d])),!0}}}}}function emt(i,t,e,n,r){var o=i[1];if(o)return!0;var s=i[0],a=i.left,l=i.right,c=a[0],u=a[1],h=l[0],p=l[1],f=(c+h)/2,d=(u+p)/2,m,x;if(p===u){if(f<t||f>=n)return;if(c>h){if(!s)s=[f,e];else if(s[1]>=r)return;o=[f,r]}else{if(!s)s=[f,r];else if(s[1]<e)return;o=[f,e]}}else if(m=(c-h)/(p-u),x=d-m*f,m<-1||m>1)if(c>h){if(!s)s=[(e-x)/m,e];else if(s[1]>=r)return;o=[(r-x)/m,r]}else{if(!s)s=[(r-x)/m,r];else if(s[1]<e)return;o=[(e-x)/m,e]}else if(u<p){if(!s)s=[t,m*t+x];else if(s[0]>=n)return;o=[n,m*n+x]}else{if(!s)s=[n,m*n+x];else if(s[0]<t)return;o=[t,m*t+x]}return i[0]=s,i[1]=o,!0}function SH(i,t,e,n){for(var r=$n.length,o;r--;)(!emt(o=$n[r],i,t,e,n)||!tmt(o,i,t,e,n)||!(Math.abs(o[0][0]-o[1][0])>Ve||Math.abs(o[0][1]-o[1][1])>Ve))&&delete $n[r]}function CH(i){return gi[i.index]={site:i,halfedges:[]}}function nmt(i,t){var e=i.site,n=t.left,r=t.right;return e===r&&(r=n,n=e),r?Math.atan2(r[1]-n[1],r[0]-n[0]):(e===n?(n=t[1],r=t[0]):(n=t[0],r=t[1]),Math.atan2(n[0]-r[0],r[1]-n[1]))}function xE(i,t){return t[+(t.left!==i.site)]}function imt(i,t){return t[+(t.left===i.site)]}function MH(){for(var i=0,t=gi.length,e,n,r,o;i<t;++i)if((e=gi[i])&&(o=(n=e.halfedges).length)){var s=new Array(o),a=new Array(o);for(r=0;r<o;++r)s[r]=r,a[r]=nmt(e,$n[n[r]]);for(s.sort(function(l,c){return a[c]-a[l]}),r=0;r<o;++r)a[r]=n[s[r]];for(r=0;r<o;++r)n[r]=a[r]}}function EH(i,t,e,n){var r=gi.length,o,s,a,l,c,u,h,p,f,d,m,x,g=!0;for(o=0;o<r;++o)if(s=gi[o]){for(a=s.site,c=s.halfedges,l=c.length;l--;)$n[c[l]]||c.splice(l,1);for(l=0,u=c.length;l<u;)d=imt(s,$n[c[l]]),m=d[0],x=d[1],h=xE(s,$n[c[++l%u]]),p=h[0],f=h[1],(Math.abs(m-p)>Ve||Math.abs(x-f)>Ve)&&(c.splice(l,0,$n.push(yh(a,d,Math.abs(m-i)<Ve&&n-x>Ve?[i,Math.abs(p-i)<Ve?f:n]:Math.abs(x-n)<Ve&&e-m>Ve?[Math.abs(f-n)<Ve?p:e,n]:Math.abs(m-e)<Ve&&x-t>Ve?[e,Math.abs(p-e)<Ve?f:t]:Math.abs(x-t)<Ve&&m-i>Ve?[Math.abs(f-t)<Ve?p:i,t]:null))-1),++u);u&&(g=!1)}if(g){var y,b,v,_=1/0;for(o=0,g=null;o<r;++o)(s=gi[o])&&(a=s.site,y=a[0]-i,b=a[1]-t,v=y*y+b*b,v<_&&(_=v,g=s));if(g){var S=[i,t],E=[i,n],M=[e,n],N=[e,t];g.halfedges.push($n.push(yh(a=g.site,S,E))-1,$n.push(yh(a,E,M))-1,$n.push(yh(a,M,N))-1,$n.push(yh(a,N,S))-1)}}for(o=0;o<r;++o)(s=gi[o])&&(s.halfedges.length||delete gi[o])}var TH=[],q2;function rmt(){gh(this),this.x=this.y=this.arc=this.site=this.cy=null}function Nl(i){var t=i.P,e=i.N;if(!(!t||!e)){var n=t.site,r=i.site,o=e.site;if(n!==o){var s=r[0],a=r[1],l=n[0]-s,c=n[1]-a,u=o[0]-s,h=o[1]-a,p=2*(l*h-c*u);if(!(p>=-IH)){var f=l*l+c*c,d=u*u+h*h,m=(h*f-c*d)/p,x=(l*d-u*f)/p,g=TH.pop()||new rmt;g.arc=i,g.site=r,g.x=m+s,g.y=(g.cy=x+a)+Math.sqrt(m*m+x*x),i.circle=g;for(var y=null,b=vh._;b;)if(g.y<b.y||g.y===b.y&&g.x<=b.x)if(b.L)b=b.L;else{y=b.P;break}else if(b.R)b=b.R;else{y=b;break}vh.insert(y,g),y||(q2=g)}}}}function Ll(i){var t=i.circle;t&&(t.P||(q2=t.N),vh.remove(t),TH.push(t),gh(t),i.circle=null)}var kH=[];function omt(){gh(this),this.edge=this.site=this.circle=null}function AH(i){var t=kH.pop()||new omt;return t.site=i,t}function yE(i){Ll(i),Dl.remove(i),kH.push(i),gh(i)}function RH(i){var t=i.circle,e=t.x,n=t.cy,r=[e,n],o=i.P,s=i.N,a=[i];yE(i);for(var l=o;l.circle&&Math.abs(e-l.circle.x)<Ve&&Math.abs(n-l.circle.cy)<Ve;)o=l.P,a.unshift(l),yE(l),l=o;a.unshift(l),Ll(l);for(var c=s;c.circle&&Math.abs(e-c.circle.x)<Ve&&Math.abs(n-c.circle.cy)<Ve;)s=c.N,a.push(c),yE(c),c=s;a.push(c),Ll(c);var u=a.length,h;for(h=1;h<u;++h)c=a[h],l=a[h-1],hm(c.edge,l.site,c.site,r);l=a[0],c=a[u-1],c.edge=xh(l.site,c.site,null,r),Nl(l),Nl(c)}function PH(i){for(var t=i[0],e=i[1],n,r,o,s,a=Dl._;a;)if(o=NH(a,e)-t,o>Ve)a=a.L;else if(s=t-smt(a,e),s>Ve){if(!a.R){n=a;break}a=a.R}else{o>-Ve?(n=a.P,r=a):s>-Ve?(n=a,r=a.N):n=r=a;break}CH(i);var l=AH(i);if(Dl.insert(n,l),!(!n&&!r)){if(n===r){Ll(n),r=AH(n.site),Dl.insert(l,r),l.edge=r.edge=xh(n.site,l.site),Nl(n),Nl(r);return}if(!r){l.edge=xh(n.site,l.site);return}Ll(n),Ll(r);var c=n.site,u=c[0],h=c[1],p=i[0]-u,f=i[1]-h,d=r.site,m=d[0]-u,x=d[1]-h,g=2*(p*x-f*m),y=p*p+f*f,b=m*m+x*x,v=[(x*y-f*b)/g+u,(p*b-m*y)/g+h];hm(r.edge,c,d,v),l.edge=xh(c,i,null,v),r.edge=xh(i,d,null,v),Nl(n),Nl(r)}}function NH(i,t){var e=i.site,n=e[0],r=e[1],o=r-t;if(!o)return n;var s=i.P;if(!s)return-1/0;e=s.site;var a=e[0],l=e[1],c=l-t;if(!c)return a;var u=a-n,h=1/o-1/c,p=u/c;return h?(-p+Math.sqrt(p*p-2*h*(u*u/(-2*c)-l+c/2+r-o/2)))/h+n:(n+a)/2}function smt(i,t){var e=i.N;if(e)return NH(e,t);var n=i.site;return n[1]===t?n[0]:1/0}var Ve=1e-6,IH=1e-12,Dl,gi,vh,$n;function amt(i,t,e){return(i[0]-e[0])*(t[1]-i[1])-(i[0]-t[0])*(e[1]-i[1])}function lmt(i,t){return t[1]-i[1]||t[0]-i[0]}function X2(i,t){var e=i.sort(lmt).pop(),n,r,o;for($n=[],gi=new Array(i.length),Dl=new gE,vh=new gE;;)if(o=q2,e&&(!o||e[1]<o.y||e[1]===o.y&&e[0]<o.x))(e[0]!==n||e[1]!==r)&&(PH(e),n=e[0],r=e[1]),e=i.pop();else if(o)RH(o.arc);else break;if(MH(),t){var s=+t[0][0],a=+t[0][1],l=+t[1][0],c=+t[1][1];SH(s,a,l,c),EH(s,a,l,c)}this.edges=$n,this.cells=gi,Dl=vh=$n=gi=null}X2.prototype={constructor:X2,polygons:function(){var i=this.edges;return this.cells.map(function(t){var e=t.halfedges.map(function(n){return xE(t,i[n])});return e.data=t.site.data,e})},triangles:function(){var i=[],t=this.edges;return this.cells.forEach(function(e,n){if(!!(a=(o=e.halfedges).length))for(var r=e.site,o,s=-1,a,l,c=t[o[a-1]],u=c.left===r?c.right:c.left;++s<a;)l=u,c=t[o[s]],u=c.left===r?c.right:c.left,l&&u&&n<l.index&&n<u.index&&amt(r,l,u)<0&&i.push([r.data,l.data,u.data])}),i},links:function(){return this.edges.filter(function(i){return i.right}).map(function(i){return{source:i.left.data,target:i.right.data}})},find:function(i,t,e){for(var n=this,r,o=n._found||0,s=n.cells.length,a;!(a=n.cells[o]);)if(++o>=s)return null;var l=i-a.site[0],c=t-a.site[1],u=l*l+c*c;do a=n.cells[r=o],o=null,a.halfedges.forEach(function(h){var p=n.edges[h],f=p.left;if(!((f===a.site||!f)&&!(f=p.right))){var d=i-f[0],m=t-f[1],x=d*d+m*m;x<u&&(u=x,o=f.index)}});while(o!==null);return n._found=r,e==null||u<=e*e?a.site:null}};function zl(i,t,e){this.k=i,this.x=t,this.y=e}zl.prototype={constructor:zl,scale:function(i){return i===1?this:new zl(this.k*i,this.x,this.y)},translate:function(i,t){return i===0&t===0?this:new zl(this.k,this.x+this.k*i,this.y+this.k*t)},apply:function(i){return[i[0]*this.k+this.x,i[1]*this.k+this.y]},applyX:function(i){return i*this.k+this.x},applyY:function(i){return i*this.k+this.y},invert:function(i){return[(i[0]-this.x)/this.k,(i[1]-this.y)/this.k]},invertX:function(i){return(i-this.x)/this.k},invertY:function(i){return(i-this.y)/this.k},rescaleX:function(i){return i.copy().domain(i.range().map(this.invertX,this).map(i.invert,i))},rescaleY:function(i){return i.copy().domain(i.range().map(this.invertY,this).map(i.invert,i))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var vE=new zl(1,0,0);bE.prototype=zl.prototype;function bE(i){for(;!i.__zoom;)if(!(i=i.parentNode))return vE;return i.__zoom}function K2(i,t){ah(i.length===t.length,"Vectors a and b must be of same length");let e=0;for(let n=0;n<i.length;++n)e+=i[n]*t[n];return e}function dm(i,t){ah(i.length===t.length,"Vectors a and b must be of same length");let e=new Float32Array(i.length);for(let n=0;n<i.length;++n)e[n]=i[n]-t[n];return e}function fm(i){let t=0;for(let e=0;e<i.length;++e)t+=i[e]*i[e];return t}function bh(i,t){return Math.sqrt(cmt(i,t))}function cmt(i,t){ah(i.length===t.length,"Vectors a and b must be of same length");let e=0;for(let n=0;n<i.length;++n){let r=i[n]-t[n];e+=r*r}return e}function LH(i){let t=Math.sqrt(fm(i));ah(t>=0,"Norm of the vector must be > 0");for(let e=0;e<i.length;++e)i[e]/=t}function DH(i,t){let e=i[0].length,n=i.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=new Float32Array(t);for(let o=0;o<t;++o){let s=_E(e);for(let a=0;a<n;++a)r[a][o]=K2(i[a],s)}return r}function Y2(i,t){if(i.length===0)return null;t==null&&(t=n=>n),ah(i.length>=0,"`vectors` must be of length >= 1");let e=new Float32Array(t(i[0]).length);for(let n=0;n<i.length;++n){let r=i[n],o=t(r);for(let s=0;s<e.length;++s)e[s]+=o[s]}for(let n=0;n<e.length;++n)e[n]/=i.length;return e}function _E(i){let t=om(),e=new Float32Array(i);for(let n=0;n<i;++n)e[n]=t();return e}function Z2(i,t){return J2(i,t)}function J2(i,t){return 1-umt(i,t)}function umt(i,t){return K2(i,t)/Math.sqrt(fm(i)*fm(t))}function zH(i,t){let e=i.length,n=t(i[0]).length,r=new Float32Array(e*n);for(let o=0;o<e;++o){let s=t(i[o]);for(let a=0;a<n;++a)r[o*n+a]=s[a]}return r}var hmt=256,wE="knn-gpu";function FH(i,t,e){let n=i.length,r=e(i[0]).length,o=new Array(n),s=Math.ceil(n/hmt),a=Math.floor(n/s);s+=n%a?1:0;let c=0,u=0,h=1/(2*s),p=0,f=zH(i,e),d=wS(f,[n,r]),m=eP(d),x=PS(d,m),g=OS(1,x),y=g;if(a*s>n){let _=[[0,a*s-n],[0,0]];y=VS(g,_)}let b=XS(y,new Array(s).fill(a),0);function v(_){let S="Finding nearest neighbors: "+(u*100).toFixed()+"%";lo(S,()=>$t(this,null,function*(){let E=yield b[p].data();u+=h;for(let M=0;M<a;M++){let N=new gu(t),I=c+M;if(I>=n)break;for(let w=0;w<n;w++){if(w===I)continue;let R=E[M*n+w];R>=0&&N.add(R,{index:w,dist:R})}o[I]=N.getMinKItems()}u+=h,c+=a,p++}),wE).then(()=>{p<s?v(_):(he(null,wE),d.dispose(),m.dispose(),x.dispose(),g.dispose(),b.forEach(E=>E.dispose()),_(o))},E=>{he(null,wE),SE(i,t,e,(N,I,w)=>Z2(N,I)).then(N=>{_(N)})})}return new Promise(_=>v(_))}function SE(i,t,e,n){return lo("Finding nearest neighbors...",()=>{let r=i.length,o=new Array(r),s=new Array(r);for(let a=0;a<r;a++)s[a]=new gu(t);for(let a=0;a<r;a++){let l=e(i[a]),c=s[a];for(let u=a+1;u<r;u++){let h=s[u],p=c.getSize()===t&&c.getLargestKey()||Number.MAX_VALUE,f=h.getSize()===t&&h.getLargestKey()||Number.MAX_VALUE,d=Math.max(p,f),m=n(l,e(i[u]),d);m>=0&&(c.add(m,{index:u,dist:m}),h.add(m,{index:a,dist:m}))}}for(let a=0;a<r;a++)o[a]=s[a].getMinKItems();return o})}function OH(i,t,e,n,r){let o=new gu(e),s=n(i[t]);for(let a=0;a<i.length;++a){if(a===t)continue;let l=n(i[a]),c=r(s,l);o.add(c,{index:a,dist:c})}return o.getMinKItems()}var fe=zh(JH(),1);var ym=fe.Matrix;var QH=fe.SingularValueDecomposition;var s_e=fe.default.Matrix?fe.default.Matrix:fe.Matrix;var Ymt=navigator.userAgent.toLowerCase().indexOf("firefox")>=0,Ol=1e4,pb=1e4,Zmt=1e4,fb=5e4,vm=200,zE=10,ub="umap-optimization",Jmt=300,Qmt=["__next__","__seq_next__"];function t$(i){let t=null;for(let e of Qmt)if(e in i&&i[e]!==""){t=i[e];break}return t==null?null:+t}var Ir=class{constructor(t,e){this.shuffledDataIndices=[],this.projections={},this.tSNEIteration=0,this.tSNEShouldPause=!1,this.tSNEShouldStop=!0,this.superviseInput="",this.dim=[0,0],this.hasTSNERun=!1,this.hasUmapRun=!1,this.points=t,this.shuffledDataIndices=Q7(c2(this.points.length)),this.sequences=this.computeSequences(t),this.dim=[this.points.length,this.points[0].vector.length],e&&(this.spriteAndMetadataInfo=e)}computeSequences(t){let e=new Int8Array(t.length),n={},r=[];for(let o=0;o<t.length;o++){if(e[o])continue;e[o]=1;let s=t$(t[o].metadata);if(s==null)continue;if(s in n){let c=n[s];c.pointIndices.unshift(o),n[o]=c;continue}let a={pointIndices:[]};n[o]=a,r.push(a);let l=o;for(;t[l];){a.pointIndices.push(l);let c=t$(t[l].metadata);c!=null?(e[c]=1,l=c):l=-1}}return r}projectionCanBeRendered(t){return t!=="tsne"?!0:this.tSNEIteration>0}getSubset(t){let n=(t!=null&&t.length>0?t.map(r=>this.points[r]):this.points).map(r=>({metadata:r.metadata,index:r.index,vector:r.vector.slice(),projections:{}}));return new Ir(n,this.spriteAndMetadataInfo)}normalize(){for(let e=0;e<this.points.length;++e){let n=this.points[e];fm(n.vector)>0&&LH(n.vector)}let t=Y2(this.points,e=>e.vector);if(t==null)throw Error("centroid should not be null");for(let e=0;e<this.points.length;++e){let n=this.points[e];n.vector=dm(n.vector,t)}}projectMatrix(t){this.points.forEach(e=>{let r=new ym([e.vector]).mmul(t);e.vector=new Float32Array(r.getRow(0))})}projectLinear(t,e){this.projections[e]=!0,this.points.forEach(n=>{n.projections[e]=K2(n.vector,t)})}projectPCA(){return this.projections["pca-0"]!=null?Promise.resolve(null):lo("Computing PCA...",()=>{let t=this.points[0].vector.length,e=this.shuffledDataIndices.map(m=>this.points[m].vector);t>vm&&(e=DH(e,vm));let n=e.slice(0,fb),{dot:r,transpose:o,svd:s}=Cp.default,a=Cp.default.div,l=r(o(n),n),c=a(l,n.length),u=s(c),h=u.S,p=0;for(let m=0;m<h.length;++m)p+=h[m];for(let m=0;m<h.length;++m)h[m]/=p;this.fracVariancesExplained=h;let f=u.U,d=e.map(m=>{let x=new Float32Array(zE);for(let g=0;g<zE;g++){let y=0;for(let b=0;b<m.length;b++)y+=m[b]*f[b][g];x[g]=y}return x});for(let m=0;m<zE;m++){let x="pca-"+m;this.projections[x]=!0;for(let g=0;g<d.length;g++){let y=this.shuffledDataIndices[g];this.points[y].projections[x]=d[g][m]}}})}projectTSNE(t,e,n,r){this.hasTSNERun=!0;let o=Math.floor(3*t),s={epsilon:e,perplexity:t,dim:n};this.tsne=new e1(s),this.tsne.setSupervision(this.superviseLabels,this.superviseInput),this.tsne.setSuperviseFactor(this.superviseFactor),this.tSNEShouldPause=!1,this.tSNEShouldStop=!1,this.tSNEIteration=0;let a=this.shuffledDataIndices.slice(0,Ol),l=()=>{if(!this.tsne.getSolution()){this.initTsneSolutionFromCurrentProjection();return}if(this.tSNEShouldStop){this.projections.tsne=!1,r(null),this.tsne=null,this.hasTSNERun=!1;return}if(!this.tSNEShouldPause){this.tsne.step();let h=this.tsne.getSolution(),p=this.tsne.getDim();a.forEach((f,d)=>{let m=this.points[f];for(let x=0;x<p;x++)m.projections[`tsne-${x}`]=h[d*p+x]}),this.projections.tsne=!0,this.tSNEIteration++,r(this.tSNEIteration)}requestAnimationFrame(l)},c=a.map(h=>this.points[h]);this.computeKnn(c,o).then(h=>{lo("Initializing T-SNE...",()=>{this.tsne.initDataDist(h)}).then(l)})}projectUmap(t,e,n,r){return $t(this,null,function*(){this.hasUmapRun=!0,this.umap=new e$.UMAP({nComponents:t,nNeighbors:e,minDist:n});let o=0,s=10,a=this.shuffledDataIndices.slice(0,pb),l=a.map(p=>this.points[p]),c=l.map(p=>Array.from(p.vector)),u=yield this.computeKnn(l,e),h=yield lo("Initializing UMAP...",()=>{let p=u.map(d=>d.map(m=>m.index)),f=u.map(d=>d.map(m=>m.dist));return this.umap.setPrecomputedKNN(p,f),this.umap.initializeFit(c)},ub);return new Promise((p,f)=>{let d=()=>{let m=Math.min(s,h-o);for(let g=0;g<m;g++)o=this.umap.step();let x=`Optimizing UMAP (epoch ${o} of ${h})`;lo(x,()=>{if(o<h)requestAnimationFrame(d);else{let g=this.umap.getEmbedding();a.forEach((y,b)=>{let v=this.points[y];v.projections["umap-0"]=g[b][0],v.projections["umap-1"]=g[b][1],t===3&&(v.projections["umap-2"]=g[b][2])}),this.projections.umap=!0,he(null,ub),this.hasUmapRun=!0,r(o),p()}},ub,0).catch(g=>{he(null,ub),f(g)})};requestAnimationFrame(d)})})}computeSelfConsistency(t,e){return $t(this,null,function*(){let r=this.shuffledDataIndices.slice(0,Zmt).map(c=>this.points[c]),o=yield this.computeKnn(r,t),s=new Map;o.forEach((c,u)=>{let p=r[u].metadata[e],f=s.get(p);f||(f={consistentNN:0,totalNN:0},s.set(p,f)),c.forEach(d=>{f.totalNN+=1;let m=r[d.index];p===m.metadata[e]&&(f.consistentNN+=1)})});let a=Array.from(s.entries()).sort((c,u)=>c[0]<=u[0]?-1:1),l=new Map(a);return Promise.resolve(l)})}computeKnn(t,e){return $t(this,null,function*(){let n=this.nearest&&this.nearest.length?this.nearest[0].length:0;if(this.nearest!=null&&this.nearest.length===t.length&&n>=e)return Promise.resolve(this.nearest.map(r=>r.slice(0,e)));{let r=(yield u2())&&!Ymt,o=Math.max(e,Jmt),s=yield r?FH(t,o,a=>a.vector):SE(t,o,a=>a.vector,(a,l)=>Z2(a,l));return this.nearest=s,Promise.resolve(s.map(a=>a.slice(0,e)))}})}initTsneSolutionFromCurrentProjection(){let t=this.shuffledDataIndices.slice(0,Ol),e=this.tsne.getRng(),n=this.tsne.getDim(),r=new Float64Array(t.length*n);t.forEach((o,s)=>{var l;let a=this.points[o];for(let c=0;c<n;c++)r[s*n+c]=(l=a.projections[`tsne-${c}`])!=null?l:e()}),this.tsne.setSolution(r)}perturbTsne(){if(this.hasTSNERun&&this.tsne){this.tsne.perturb();let t=this.tsne.getDim(),e=this.tsne.getSolution();this.shuffledDataIndices.slice(0,Ol).forEach((r,o)=>{let s=this.points[r];s.projections["tsne-0"]=e[o*t+0],s.projections["tsne-1"]=e[o*t+1],t===3&&(s.projections["tsne-2"]=e[o*t+2])})}}setTsneLearningRate(t){this.tsne&&this.tsne.setEpsilon(t)}setSupervision(t,e){t!=null&&(this.superviseLabels=this.shuffledDataIndices.slice(0,Ol).map(n=>this.points[n].metadata[t]!==void 0?String(this.points[n].metadata[t]):`Unknown #${n}`)),e!=null&&(this.superviseInput=e),this.tsne&&this.tsne.setSupervision(this.superviseLabels,this.superviseInput)}setSuperviseFactor(t){t!=null&&(this.superviseFactor=t,this.tsne&&this.tsne.setSuperviseFactor(t))}mergeMetadata(t){var e,n,r,o,s,a,l;if(((e=t.pointsInfo)==null?void 0:e.length)!==this.points.length){let c=`Number of tensors (${this.points.length}) do not match the number of lines in metadata (${(n=t.pointsInfo)==null?void 0:n.length}).`;if(((r=t.stats)==null?void 0:r.length)===1&&this.points.length+1===((o=t.pointsInfo)==null?void 0:o.length))return Ye(c+" Single column metadata should not have a header row.","merging metadata"),!1;if(((s=t.stats)==null?void 0:s.length)>1&&this.points.length-1===((a=t.pointsInfo)==null?void 0:a.length))return Ye(c+" Multi-column metadata should have a header row with column labels.","merging metadata"),!1;yu(c)}return this.spriteAndMetadataInfo=t,(l=t.pointsInfo)==null||l.slice(0,this.points.length).forEach((c,u)=>this.points[u].metadata=c),!0}stopTSNE(){this.tSNEShouldStop=!0}findNeighbors(t,e,n){return OH(this.points,t,n,s=>s.vector,e).slice(0,n)}query(t,e,n){let r=nB(t,e,n),o=[];return this.points.forEach((s,a)=>{r(s)&&o.push(a)}),o}},Yo=class{constructor(t,e,n,r){this.projectionType=t,this.projectionComponents=e,this.dimensionality=n,this.dataSet=r}},hb=class{constructor(){this.label="",this.isSelected=!1,this.tSNEIteration=0,this.tSNEPerplexity=0,this.tSNELearningRate=0,this.tSNEis3d=!0,this.umapIs3d=!0,this.umapNeighbors=15,this.umapMinDist=.1,this.pcaComponentDimensions=[],this.projections=[],this.selectedPoints=[],this.shuffledDataIndices=[]}};function Bl(i,t){if(t.length>3)throw new RangeError("components length must be <= 3");let e=[null,null,null],n=i==="custom"?"linear":i;for(let r=0;r<t.length;++r)t[r]!=null&&(e[r]=n+"-"+t[r]);return e}function n$(i){let t;switch(i.selectedProjection){case"pca":t=i.pcaComponentDimensions.slice();break;case"tsne":t=[0,1],i.tSNEis3d&&t.push(2);break;case"umap":t=[0,1],i.umapIs3d&&t.push(2);break;case"custom":t=["x","y"];break;default:throw new Error("Unexpected fallthrough")}return t}var tgt=50,db=81920,FE="metadata",ca="tensors",bm="BINARY_LABEL",mb="N/A",Ih="TEXT_LABEL",gb="N/A";function xb(i,t,e,n,r,o){he("Fetching tensor values...",ca);let s=new XMLHttpRequest;s.open("GET",r),s.responseType="arraybuffer",s.onprogress=a=>{if(a.lengthComputable){let l=(a.loaded*100/a.total).toFixed(1);he("Fetching tensor values: "+l+"%",ca)}},s.onload=()=>{if(s.status!==200){let u=String.fromCharCode.apply(null,new Uint8Array(s.response));Ye(u,"fetching tensors");return}let a;try{a=new Float32Array(s.response)}catch(u){Ye(u.message,"parsing tensor bytes");return}let l=t.tensorShape[1],c=a.length/l;t.tensorShape[0]>c&&t.tensorShape[0]!=-1&&yu(`Showing the first ${c.toLocaleString()} of ${t.tensorShape[0].toLocaleString()} data points`),egt(a,l).then(u=>{o(new Ir(u))})},s.send()}function i$(i,t){OE(i).then(e=>{t(new Ir(e))})}function r$(i,t){s$(i).then(e=>t(e))}function o$(i,t,e=1e6,n=`
`){return new Promise((r,o)=>{let s=0,a=i.byteLength-1,l="";function c(h){s+=e;let p=h.split(n),f=l+p[0];if(p.length===1){l=f,u(s,e);return}l=p[p.length-1],t(f);for(let d=1;d<p.length-1;d++)t(p[d]);if(s>=a){l&&t(l),r();return}u(s,e)}function u(h,p){let f=i.slice(h,h+p),d=new Blob([f]),m=new FileReader;m.onload=x=>c(x.target.result),m.readAsText(d)}u(s,e)})}function OE(i,t="	"){return he("Parsing tensors...",ca),new Promise((e,n)=>{let r=[],o;o$(i,s=>{if(s=s.trim(),s==="")return;let a=s.split(t),l={metadata:{},vector:null,index:r.length,projections:null};if(isNaN(a[0])||o===a.length-1?(l.metadata.label=a[0],l.vector=new Float32Array(a.slice(1).map(Number))):l.vector=new Float32Array(a.map(Number)),r.push(l),o==null&&(o=l.vector.length),o!==l.vector.length)throw Ye("Vector dimensions do not match","parsing tensors"),Error("Parsing failed");if(o<=1)throw Ye("Found a vector with only one dimension?","parsing tensors"),Error("Parsing failed")}).then(()=>{he(null,ca),e(r)})})}function egt(i,t){return lo("Parsing tensors...",()=>{let e=i.length/t,n=[],r=0;for(let o=0;o<e;++o)n.push({metadata:{},vector:i.subarray(r,r+t),index:o,projections:null}),r+=t;return n},ca).then(e=>(he(null,ca),e))}function Zo(i,t){let e=i.map(r=>({name:r,isNumeric:!0,tooManyUniqueValues:!1,min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY})),n=i.map(()=>new Object);return t.forEach(r=>{i.forEach((o,s)=>{let a=e[s],l=n[s],c=r[o];c!=null&&(a.tooManyUniqueValues||(c in l?l[c]++:l[c]=1,Object.keys(l).length>tgt&&(a.tooManyUniqueValues=!0)),isNaN(c)?a.isNumeric=!1:(r[o]=+c,a.min=Math.min(a.min,+c),a.max=Math.max(a.max,+c)))})}),e.forEach((r,o)=>{r.uniqueEntries=Object.keys(n[o]).map(s=>({label:s,count:n[o][s]}))}),e}function s$(i){return he("Parsing metadata...",FE),new Promise((t,e)=>{let n=[],r=!1,o=0,s=["label"],a=bm,l=Ih;o$(i,c=>{if(c.trim().length===0)return;if(o===0&&(r=c.indexOf("	")>=0,r)){s=c.split("	"),s.includes(a)||(s=s.concat([a])),s.includes(l)||(s=s.concat([l])),o++;return}o++;let u=c.split("	"),h={};n.push(h),s.forEach((p,f)=>{let d=u[f];d=d===""?null:d,h[p]=d,(p=="donor"||p=="acceptor")&&(h[p]=JSON.parse(d))}),h[a]==null&&(h[a]=mb),h[l]==null&&(h[l]=gb)}).then(()=>{he(null,FE),s=s.filter(c=>c!=="donor"&&c!=="acceptor"),t({stats:Zo(s,n),pointsInfo:n})})})}function ngt(i){return new Promise((t,e)=>{let n=new Image;n.onload=()=>t(n),n.onerror=r=>e(r),n.crossOrigin="",n.src=i})}function yb(i,t,e,n){let r=Promise.resolve({});i&&(r=new Promise((a,l)=>{he("Fetching metadata...",FE);let c=new XMLHttpRequest;c.open("GET",i),c.responseType="arraybuffer",c.onreadystatechange=()=>{if(c.readyState===4)if(c.status===200)a(s$(c.response));else{let u=new FileReader;u.onload=()=>{Ye(u.result,"fetching metadata"),l()},u.readAsText(new Blob([c.response]))}},c.send(null)}));let o=null,s=null;t&&(o=he("Fetching sprite image..."),s=ngt(t)),Promise.all([r,s]).then(a=>{o&&he(null,o);let[l,c]=a;if(c&&(c.height>db||c.width>db))Ye(`Error: Sprite image of dimensions ${c.width}px x ${c.height}px exceeds maximum dimensions ${db}px x ${db}px`,"parsing sprite images");else{l.spriteImage=c,l.spriteMetadata=e;try{n(l)}catch(u){Ye(u.message,"parsing sprite metadata")}}})}var a$=".bytes",vb=class{constructor(t,e){this.projectorConfigPath=t,e&&(this.principleMatricesPath=e)}getEmbeddingInfo(t){let e=this.projectorConfig.embeddings;for(let n=0;n<e.length;n++){let r=e[n];if(r.tensorName===t)return r}return null}retrieveRuns(t){t(["Demo"])}retrieveProjectorConfig(t,e){let n=he("Fetching projector config..."),r=new XMLHttpRequest;r.open("GET",this.projectorConfigPath),r.onerror=o=>{let s=o.message;r.responseText!=null&&(s="Cannot fetch projector config, possibly a Cross-Origin request error."),Ye(s,"fetching projector config")},r.onload=()=>{let o=JSON.parse(r.responseText);he(null,n),this.projectorConfig=o,e(o)},r.send()}retrieveTensor(t,e,n){var s;let r=this.getEmbeddingInfo(e),o=`${r.tensorPath}`;if(((s=r.tensorPath)==null?void 0:s.substr(-1*a$.length))===a$)xb(this,this.getEmbeddingInfo(e),t,e,o,n);else{he("Fetching dataset...",ca);let a=new XMLHttpRequest;a.open("GET",o),a.responseType="arraybuffer",a.onerror=()=>{Ye(a.responseText,"fetching dataset")},a.onload=()=>{OE(a.response).then(l=>{n(new Ir(l))})},a.send()}}retrieveSpriteAndMetadata(t,e,n){let r=this.getEmbeddingInfo(e),o=null;r.sprite&&r.sprite.imagePath&&(o=r.sprite.imagePath),yb(r.metadataPath,o,r.sprite,n)}getBookmarks(t,e,n){let r=this.getEmbeddingInfo(e),o=he("Fetching bookmarks..."),s=new XMLHttpRequest;s.open("GET",r.bookmarksPath),s.onerror=a=>{Ye(s.responseText,"fetching bookmarks")},s.onload=()=>{let a=JSON.parse(s.responseText);he(null,o),n(a)},s.send()}retrievePrincipleMatrices(t){let e=he("Fetching principle matrices..."),n=new XMLHttpRequest;n.open("GET",this.principleMatricesPath),n.onerror=r=>{let o=r.message;n.responseText!=null&&(o="Cannot fetch principle matrices, possibly a Cross-Origin request error."),Ye(o,"fetching principle matrices")},n.onload=()=>{let r=JSON.parse(n.responseText);he(null,e),this.principleMatrices=r,t(r)},n.send()}};var bb=class{constructor(t){this.dataProto=t}retrieveRuns(t){t(["proto"])}retrieveProjectorConfig(t,e){e({modelCheckpointPath:"proto",embeddings:[{tensorName:"proto",tensorShape:this.dataProto.shape,metadataPath:"proto"}]})}retrieveTensor(t,e,n){n(this.flatArrayToDataset(this.dataProto.tensor))}retrieveSpriteAndMetadata(t,e,n){let r=this.dataProto.metadata.columns.map(l=>l.name),o=this.dataProto.shape[0],s=new Array(o);this.dataProto.metadata.columns.forEach(l=>{let c=l.numericValues||l.stringValues;for(let u=0;u<o;u++)s[u]=s[u]||{},s[u][l.name]=c[u]});let a=Promise.resolve(null);this.dataProto.metadata.sprite!=null&&(a=new Promise((l,c)=>{let u=new Image;u.onload=()=>l(u),u.onerror=()=>c("Failed converting base64 to an image"),u.src=this.dataProto.metadata.sprite.imageBase64})),a.then(l=>{let c={stats:Zo(r,s),pointsInfo:s};l!=null&&(c.spriteImage=l,c.spriteMetadata={singleImageDim:this.dataProto.metadata.sprite.singleImageDim,imagePath:"proto"}),n(c)})}getBookmarks(t,e,n){return n([])}flatArrayToDataset(t){let e=[],n=this.dataProto.shape[0],r=this.dataProto.shape[1];if(n*r!==t.length)throw"The shape doesn't match the length of the flattened array";for(let o=0;o<n;o++){let s=o*r;e.push({vector:new Float32Array(t.slice(s,s+r)),metadata:{},projections:null,index:o})}return new Ir(e)}retrievePrincipleMatrices(t){console.log("not implemented")}};var l$=1e5,_b=class{constructor(t){this.runProjectorConfigCache={},this.routePrefix=t}getEmbeddingInfo(t,e,n){this.retrieveProjectorConfig(t,r=>{let o=r.embeddings;for(let s=0;s<o.length;s++){let a=o[s];if(a.tensorName===e){n(a);return}}n(null)})}retrieveRuns(t){let e=he("Fetching runs..."),n=new XMLHttpRequest;n.open("GET",`${this.routePrefix}/runs`),n.onerror=r=>{Ye(n.responseText,"fetching runs")},n.onload=()=>{let r=JSON.parse(n.responseText);he(null,e),t(r)},n.send()}retrieveProjectorConfig(t,e){if(t in this.runProjectorConfigCache){e(this.runProjectorConfigCache[t]);return}let n=he("Fetching projector config..."),r=new XMLHttpRequest;r.open("GET",`${this.routePrefix}/info?run=${t}`),r.onerror=o=>{Ye(r.responseText,"fetching projector config")},r.onload=()=>{let o=JSON.parse(r.responseText);he(null,n),this.runProjectorConfigCache[t]=o,e(o)},r.send()}retrieveTensor(t,e,n){this.getEmbeddingInfo(t,e,r=>{xb(this,r,t,e,`${this.routePrefix}/tensor?run=${t}&name=${e}&num_rows=${l$}`,n)})}retrieveSpriteAndMetadata(t,e,n){this.getEmbeddingInfo(t,e,r=>{let o=null;r.metadataPath&&(o=`${this.routePrefix}/metadata?run=${t}&name=${e}&num_rows=${l$}`);let s=null;r.sprite&&r.sprite.imagePath&&(s=`${this.routePrefix}/sprite_image?run=${t}&name=${e}`),yb(o,s,r.sprite,n)})}retrievePrincipleMatrices(t){console.log("not implemented")}getBookmarks(t,e,n){let r=he("Fetching bookmarks..."),o=new XMLHttpRequest;o.open("GET",`${this.routePrefix}/bookmarks?run=${t}&name=${e}`),o.onerror=s=>{Ye(o.responseText,"fetching bookmarks")},o.onload=()=>{he(null,r);let s=JSON.parse(o.responseText);n(s)},o.send()}};var wb=class{constructor(t,e,n,r,o,s,a,l){this.pointIndices=t,this.labelStrings=e,this.scaleFactors=n,this.useSceneOpacityFlags=r,this.defaultFontSize=o,this.fillColors=s,this.strokeColors=a,this.traceVectors=l}},Jo;(function(i){i[i.Perspective=0]="Perspective",i[i.Orthographic=1]="Orthographic"})(Jo||(Jo={}));var Sb=class{constructor(t,e,n,r,o,s,a,l,c,u,h,p,f,d){this.camera=t,this.cameraType=e,this.cameraTarget=n,this.screenWidth=r,this.screenHeight=o,this.nearestCameraSpacePointZ=s,this.farthestCameraSpacePointZ=a,this.backgroundColor=l,this.pointColors=c,this.pointScaleFactors=u,this.labels=h,this.polylineColors=p,this.polylineOpacities=f,this.polylineWidths=d}};var c$={type:"change"},BE={type:"start"},u$={type:"end"},Cb=class extends Mr{constructor(t,e){super(),e===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new q,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:yn.ROTATE,MIDDLE:yn.DOLLY,RIGHT:yn.PAN},this.touches={ONE:wl.ROTATE,TWO:wl.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Q){Q.addEventListener("keydown",re),this._domElementKeyEvents=Q},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(c$),n.update(),o=r.NONE},this.update=function(){let Q=new q,xt=new kn().setFromUnitVectors(t.up,new q(0,1,0)),At=xt.clone().invert(),jt=new q,tt=new kn,Ht=2*Math.PI;return function(){let ne=n.object.position;Q.copy(ne).sub(n.target),Q.applyQuaternion(xt),a.setFromVector3(Q),n.autoRotate&&o===r.NONE&&N(E()),n.enableDamping?(a.theta+=l.theta*n.dampingFactor,a.phi+=l.phi*n.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let bt=n.minAzimuthAngle,Xt=n.maxAzimuthAngle;return isFinite(bt)&&isFinite(Xt)&&(bt<-Math.PI?bt+=Ht:bt>Math.PI&&(bt-=Ht),Xt<-Math.PI?Xt+=Ht:Xt>Math.PI&&(Xt-=Ht),bt<=Xt?a.theta=Math.max(bt,Math.min(Xt,a.theta)):a.theta=a.theta>(bt+Xt)/2?Math.max(bt,a.theta):Math.min(Xt,a.theta)),a.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(n.minDistance,Math.min(n.maxDistance,a.radius)),n.enableDamping===!0?n.target.addScaledVector(u,n.dampingFactor):n.target.add(u),Q.setFromSpherical(a),Q.applyQuaternion(At),ne.copy(n.target).add(Q),n.object.lookAt(n.target),n.enableDamping===!0?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,u.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),c=1,h||jt.distanceToSquared(n.object.position)>s||8*(1-tt.dot(n.object.quaternion))>s?(n.dispatchEvent(c$),jt.copy(n.object.position),tt.copy(n.object.quaternion),h=!1,!0):!1}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",ft),n.domElement.removeEventListener("pointerdown",ct),n.domElement.removeEventListener("pointercancel",Pt),n.domElement.removeEventListener("wheel",Qt),n.domElement.removeEventListener("pointermove",_t),n.domElement.removeEventListener("pointerup",gt),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",re)};let n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},o=r.NONE,s=1e-6,a=new Dd,l=new Dd,c=1,u=new q,h=!1,p=new Et,f=new Et,d=new Et,m=new Et,x=new Et,g=new Et,y=new Et,b=new Et,v=new Et,_=[],S={};function E(){return 2*Math.PI/60/60*n.autoRotateSpeed}function M(){return Math.pow(.95,n.zoomSpeed)}function N(Q){l.theta-=Q}function I(Q){l.phi-=Q}let w=function(){let Q=new q;return function(At,jt){Q.setFromMatrixColumn(jt,0),Q.multiplyScalar(-At),u.add(Q)}}(),R=function(){let Q=new q;return function(At,jt){n.screenSpacePanning===!0?Q.setFromMatrixColumn(jt,1):(Q.setFromMatrixColumn(jt,0),Q.crossVectors(n.object.up,Q)),Q.multiplyScalar(At),u.add(Q)}}(),P=function(){let Q=new q;return function(At,jt){let tt=n.domElement;if(n.object.isPerspectiveCamera){let Ht=n.object.position;Q.copy(Ht).sub(n.target);let Ft=Q.length();Ft*=Math.tan(n.object.fov/2*Math.PI/180),w(2*At*Ft/tt.clientHeight,n.object.matrix),R(2*jt*Ft/tt.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(w(At*(n.object.right-n.object.left)/n.object.zoom/tt.clientWidth,n.object.matrix),R(jt*(n.object.top-n.object.bottom)/n.object.zoom/tt.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function D(Q){n.object.isPerspectiveCamera?c/=Q:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*Q)),n.object.updateProjectionMatrix(),h=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function F(Q){n.object.isPerspectiveCamera?c*=Q:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/Q)),n.object.updateProjectionMatrix(),h=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function z(Q){p.set(Q.clientX,Q.clientY)}function V(Q){y.set(Q.clientX,Q.clientY)}function H(Q){m.set(Q.clientX,Q.clientY)}function X(Q){f.set(Q.clientX,Q.clientY),d.subVectors(f,p).multiplyScalar(n.rotateSpeed);let xt=n.domElement;N(2*Math.PI*d.x/xt.clientHeight),I(2*Math.PI*d.y/xt.clientHeight),p.copy(f),n.update()}function U(Q){b.set(Q.clientX,Q.clientY),v.subVectors(b,y),v.y>0?D(M()):v.y<0&&F(M()),y.copy(b),n.update()}function Y(Q){x.set(Q.clientX,Q.clientY),g.subVectors(x,m).multiplyScalar(n.panSpeed),P(g.x,g.y),m.copy(x),n.update()}function Z(Q){Q.deltaY<0?F(M()):Q.deltaY>0&&D(M()),n.update()}function K(Q){let xt=!1;switch(Q.code){case n.keys.UP:P(0,n.keyPanSpeed),xt=!0;break;case n.keys.BOTTOM:P(0,-n.keyPanSpeed),xt=!0;break;case n.keys.LEFT:P(n.keyPanSpeed,0),xt=!0;break;case n.keys.RIGHT:P(-n.keyPanSpeed,0),xt=!0;break}xt&&(Q.preventDefault(),n.update())}function J(){if(_.length===1)p.set(_[0].pageX,_[0].pageY);else{let Q=.5*(_[0].pageX+_[1].pageX),xt=.5*(_[0].pageY+_[1].pageY);p.set(Q,xt)}}function G(){if(_.length===1)m.set(_[0].pageX,_[0].pageY);else{let Q=.5*(_[0].pageX+_[1].pageX),xt=.5*(_[0].pageY+_[1].pageY);m.set(Q,xt)}}function nt(){let Q=_[0].pageX-_[1].pageX,xt=_[0].pageY-_[1].pageY,At=Math.sqrt(Q*Q+xt*xt);y.set(0,At)}function et(){n.enableZoom&&nt(),n.enablePan&&G()}function at(){n.enableZoom&&nt(),n.enableRotate&&J()}function it(Q){if(_.length==1)f.set(Q.pageX,Q.pageY);else{let At=Ut(Q),jt=.5*(Q.pageX+At.x),tt=.5*(Q.pageY+At.y);f.set(jt,tt)}d.subVectors(f,p).multiplyScalar(n.rotateSpeed);let xt=n.domElement;N(2*Math.PI*d.x/xt.clientHeight),I(2*Math.PI*d.y/xt.clientHeight),p.copy(f)}function St(Q){if(_.length===1)x.set(Q.pageX,Q.pageY);else{let xt=Ut(Q),At=.5*(Q.pageX+xt.x),jt=.5*(Q.pageY+xt.y);x.set(At,jt)}g.subVectors(x,m).multiplyScalar(n.panSpeed),P(g.x,g.y),m.copy(x)}function yt(Q){let xt=Ut(Q),At=Q.pageX-xt.x,jt=Q.pageY-xt.y,tt=Math.sqrt(At*At+jt*jt);b.set(0,tt),v.set(0,Math.pow(b.y/y.y,n.zoomSpeed)),D(v.y),y.copy(b)}function rt(Q){n.enableZoom&&yt(Q),n.enablePan&&St(Q)}function vt(Q){n.enableZoom&&yt(Q),n.enableRotate&&it(Q)}function ct(Q){n.enabled!==!1&&(_.length===0&&(n.domElement.setPointerCapture(Q.pointerId),n.domElement.addEventListener("pointermove",_t),n.domElement.addEventListener("pointerup",gt)),kt(Q),Q.pointerType==="touch"?j(Q):Dt(Q))}function _t(Q){n.enabled!==!1&&(Q.pointerType==="touch"?$(Q):Jt(Q))}function gt(Q){Vt(Q),_.length===0&&(n.domElement.releasePointerCapture(Q.pointerId),n.domElement.removeEventListener("pointermove",_t),n.domElement.removeEventListener("pointerup",gt)),n.dispatchEvent(u$),o=r.NONE}function Pt(Q){Vt(Q)}function Dt(Q){let xt;switch(Q.button){case 0:xt=n.mouseButtons.LEFT;break;case 1:xt=n.mouseButtons.MIDDLE;break;case 2:xt=n.mouseButtons.RIGHT;break;default:xt=-1}switch(xt){case yn.DOLLY:if(n.enableZoom===!1)return;V(Q),o=r.DOLLY;break;case yn.ROTATE:if(Q.ctrlKey||Q.metaKey||Q.shiftKey){if(n.enablePan===!1)return;H(Q),o=r.PAN}else{if(n.enableRotate===!1)return;z(Q),o=r.ROTATE}break;case yn.PAN:if(Q.ctrlKey||Q.metaKey||Q.shiftKey){if(n.enableRotate===!1)return;z(Q),o=r.ROTATE}else{if(n.enablePan===!1)return;H(Q),o=r.PAN}break;default:o=r.NONE}o!==r.NONE&&n.dispatchEvent(BE)}function Jt(Q){if(n.enabled!==!1)switch(o){case r.ROTATE:if(n.enableRotate===!1)return;X(Q);break;case r.DOLLY:if(n.enableZoom===!1)return;U(Q);break;case r.PAN:if(n.enablePan===!1)return;Y(Q);break}}function Qt(Q){n.enabled===!1||n.enableZoom===!1||o!==r.NONE||(Q.preventDefault(),n.dispatchEvent(BE),Z(Q),n.dispatchEvent(u$))}function re(Q){n.enabled===!1||n.enablePan===!1||K(Q)}function j(Q){switch(mt(Q),_.length){case 1:switch(n.touches.ONE){case wl.ROTATE:if(n.enableRotate===!1)return;J(),o=r.TOUCH_ROTATE;break;case wl.PAN:if(n.enablePan===!1)return;G(),o=r.TOUCH_PAN;break;default:o=r.NONE}break;case 2:switch(n.touches.TWO){case wl.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;et(),o=r.TOUCH_DOLLY_PAN;break;case wl.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;at(),o=r.TOUCH_DOLLY_ROTATE;break;default:o=r.NONE}break;default:o=r.NONE}o!==r.NONE&&n.dispatchEvent(BE)}function $(Q){switch(mt(Q),o){case r.TOUCH_ROTATE:if(n.enableRotate===!1)return;it(Q),n.update();break;case r.TOUCH_PAN:if(n.enablePan===!1)return;St(Q),n.update();break;case r.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;rt(Q),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;vt(Q),n.update();break;default:o=r.NONE}}function ft(Q){n.enabled!==!1&&Q.preventDefault()}function kt(Q){_.push(Q)}function Vt(Q){delete S[Q.pointerId];for(let xt=0;xt<_.length;xt++)if(_[xt].pointerId==Q.pointerId){_.splice(xt,1);return}}function mt(Q){let xt=S[Q.pointerId];xt===void 0&&(xt=new Et,S[Q.pointerId]=xt),xt.set(Q.pageX,Q.pageY)}function Ut(Q){let xt=Q.pointerId===_[0].pointerId?_[1]:_[0];return S[xt.pointerId]}n.domElement.addEventListener("contextmenu",ft),n.domElement.addEventListener("pointerdown",ct),n.domElement.addEventListener("pointercancel",Pt),n.domElement.addEventListener("wheel",Qt,{passive:!1}),this.update()}};var igt="#dddddd";var rgt="#aaaaaa";var ogt="10 5",Mb=class{constructor(t,e){this.svgElement=t.querySelector("#selector"),this.rectElement=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.rectElement.style.stroke=rgt,this.rectElement.style.strokeDasharray=ogt,this.rectElement.style.strokeWidth=""+2,this.rectElement.style.fill=igt,this.rectElement.style.fillOpacity=""+.2,this.svgElement.appendChild(this.rectElement),this.selectionCallback=e,this.isMouseDown=!1}onMouseDown(t,e){this.isMouseDown=!0,this.svgElement.style.display="block",this.startCoordinates=[t,e],this.lastBoundingBox={x:this.startCoordinates[0],y:this.startCoordinates[1],width:1,height:1}}onMouseMove(t,e){!this.isMouseDown||(this.lastBoundingBox.x=Math.min(t,this.startCoordinates[0]),this.lastBoundingBox.y=Math.max(e,this.startCoordinates[1]),this.lastBoundingBox.width=Math.max(t,this.startCoordinates[0])-this.lastBoundingBox.x,this.lastBoundingBox.height=this.lastBoundingBox.y-Math.min(e,this.startCoordinates[1]),this.rectElement.setAttribute("x",""+this.lastBoundingBox.x),this.rectElement.setAttribute("y",""+(this.lastBoundingBox.y-this.lastBoundingBox.height)),this.rectElement.setAttribute("width",""+this.lastBoundingBox.width),this.rectElement.setAttribute("height",""+this.lastBoundingBox.height))}onMouseUp(){this.isMouseDown=!1,this.svgElement.style.display="none",this.rectElement.setAttribute("width","0"),this.rectElement.setAttribute("height","0"),this.selectionCallback(this.lastBoundingBox)}};var h$=16777215,m$=2,sgt=5*m$,agt=.025*m$,lgt=70,cgt=.01,ugt=100,Eb=1.2,p$=16,f$=17,d$=1,hgt=7,Qo;(function(i){i[i.AREA_SELECT=0]="AREA_SELECT",i[i.CAMERA_AND_CLICK_SELECT=1]="CAMERA_AND_CLICK_SELECT"})(Qo||(Qo={}));var Tb=class{constructor(){this.orthographic=!1}},Ib=class{constructor(t,e){this.container=t,this.projectorEventContext=e,this.START_CAMERA_POS_3D=new q(.45,.9,1.6),this.START_CAMERA_TARGET_3D=new q(0,0,0),this.START_CAMERA_POS_2D=new q(0,0,4),this.START_CAMERA_TARGET_2D=new q(0,0,0),this.visualizers=[],this.onCameraMoveListeners=[],this.backgroundColor=h$,this.dimensionality=3,this.cameraDef=null,this.orbitAnimationOnNextCameraCreation=!1,this.selecting=!1,this.mouseIsDown=!1,this.isDragSequence=!1,this.getLayoutValues(),this.scene=new Ju,this.renderer=new Ne({alpha:!0,premultipliedAlpha:!1,antialias:!1}),this.renderer.setClearColor(h$,1),this.container.appendChild(this.renderer.domElement),this.light=new Pd(16772287,1,0),this.scene.add(this.light),this.setDimensions(3),this.recreateCamera(this.makeDefaultCameraDef(this.dimensionality)),this.renderer.render(this.scene,this.camera),this.rectangleSelector=new Mb(this.container,n=>this.selectBoundingBox(n)),this.addInteractionListeners()}addInteractionListeners(){this.container.addEventListener("mousemove",this.onMouseMove.bind(this)),this.container.addEventListener("mousedown",this.onMouseDown.bind(this)),this.container.addEventListener("mouseup",this.onMouseUp.bind(this)),this.container.addEventListener("click",this.onClick.bind(this)),window.addEventListener("keydown",this.onKeyDown.bind(this),!1),window.addEventListener("keyup",this.onKeyUp.bind(this),!1)}addCameraControlsEventListeners(t){t.addEventListener("start",()=>{this.stopOrbitAnimation(),this.onCameraMoveListeners.forEach(e=>e(this.camera.position,t.target))}),t.addEventListener("change",()=>{this.render()}),t.addEventListener("end",()=>{})}makeOrbitControls(t,e,n){this.orbitCameraControls!=null&&this.orbitCameraControls.dispose();let r=new Cb(t,this.renderer.domElement);r.target0=new q(e.target[0],e.target[1],e.target[2]),r.position0=new q().copy(t.position),r.zoom0=e.zoom,r.enableRotate=n,r.autoRotate=!1,r.rotateSpeed=d$,n?(r.mouseButtons.ORBIT=yn.LEFT,r.mouseButtons.PAN=yn.RIGHT):(r.mouseButtons.ORBIT=null,r.mouseButtons.PAN=yn.LEFT),r.reset(),this.camera=t,this.orbitCameraControls=r,this.addCameraControlsEventListeners(this.orbitCameraControls)}makeCamera3D(t,e,n){let r;{let o=e/n;r=new xn(lgt,o,cgt,ugt),r.position.set(t.position[0],t.position[1],t.position[2]);let s=new q(t.target[0],t.target[1],t.target[2]);r.lookAt(s),r.zoom=t.zoom,r.updateProjectionMatrix()}this.camera=r,this.makeOrbitControls(r,t,!0)}makeCamera2D(t,e,n){let r,o=new q(t.target[0],t.target[1],t.target[2]);{let s=e/n,a=-Eb,l=Eb,c=-Eb,u=Eb;s>1?(a*=s,l*=s):(u/=s,c/=s),r=new ml(a,l,u,c,-1e3,1e3),r.position.set(t.position[0],t.position[1],t.position[2]),r.up=new q(0,1,0),r.lookAt(o),r.zoom=t.zoom,r.updateProjectionMatrix()}this.camera=r,this.makeOrbitControls(r,t,!1)}makeDefaultCameraDef(t){let e=new Tb;return e.orthographic=t===2,e.zoom=1,e.orthographic?(e.position=[this.START_CAMERA_POS_2D.x,this.START_CAMERA_POS_2D.y,this.START_CAMERA_POS_2D.z],e.target=[this.START_CAMERA_TARGET_2D.x,this.START_CAMERA_TARGET_2D.y,this.START_CAMERA_TARGET_2D.z]):(e.position=[this.START_CAMERA_POS_3D.x,this.START_CAMERA_POS_3D.y,this.START_CAMERA_POS_3D.z],e.target=[this.START_CAMERA_TARGET_3D.x,this.START_CAMERA_TARGET_3D.y,this.START_CAMERA_TARGET_3D.z]),e}recreateCamera(t){t.orthographic?this.makeCamera2D(t,this.width,this.height):this.makeCamera3D(t,this.width,this.height),this.orbitCameraControls.minDistance=agt,this.orbitCameraControls.maxDistance=sgt,this.orbitCameraControls.update(),this.orbitAnimationOnNextCameraCreation&&this.startOrbitAnimation()}onClick(t,e=!0){if(!(t&&this.selecting)){if(!this.isDragSequence&&e){let n=this.nearestPoint!=null?[this.nearestPoint]:[];this.projectorEventContext.notifySelectionChanged(n)}this.isDragSequence=!1,this.render()}}onMouseDown(t){this.isDragSequence=!1,this.mouseIsDown=!0,this.selecting?(this.orbitCameraControls.enabled=!1,this.rectangleSelector.onMouseDown(t.offsetX,t.offsetY),this.setNearestPointToMouse(t)):!t.ctrlKey&&this.sceneIs3D()&&this.orbitCameraControls.mouseButtons.ORBIT===yn.RIGHT?(this.orbitCameraControls.mouseButtons.ORBIT=yn.LEFT,this.orbitCameraControls.mouseButtons.PAN=yn.RIGHT):t.ctrlKey&&this.sceneIs3D()&&this.orbitCameraControls.mouseButtons.ORBIT===yn.LEFT&&(this.orbitCameraControls.mouseButtons.ORBIT=yn.RIGHT,this.orbitCameraControls.mouseButtons.PAN=yn.LEFT)}onMouseUp(t){(this.selecting||!this.orbitCameraControls.enabled)&&(this.orbitCameraControls.enabled=!0,this.rectangleSelector.onMouseUp(),this.render()),this.mouseIsDown=!1}onMouseMove(t){this.isDragSequence=this.mouseIsDown,this.selecting&&this.mouseIsDown?(this.rectangleSelector.onMouseMove(t.offsetX,t.offsetY),this.render()):this.mouseIsDown||(this.setNearestPointToMouse(t),this.projectorEventContext.notifyHoverOverPoint(this.nearestPoint))}onKeyDown(t){t.keyCode===f$&&this.sceneIs3D()&&(this.orbitCameraControls.mouseButtons.ORBIT=yn.RIGHT,this.orbitCameraControls.mouseButtons.PAN=yn.LEFT),t.keyCode===p$&&(this.selecting=!0,this.container.style.cursor="crosshair")}onKeyUp(t){t.keyCode===f$&&this.sceneIs3D()&&(this.orbitCameraControls.mouseButtons.ORBIT=yn.LEFT,this.orbitCameraControls.mouseButtons.PAN=yn.RIGHT),t.keyCode===p$&&(this.selecting=this.getMouseMode()===Qo.AREA_SELECT,this.selecting||(this.container.style.cursor="default"),this.render())}getPointIndicesFromPickingTexture(t){if(this.worldSpacePointPositions==null)return null;let e=this.worldSpacePointPositions.length/3,n=window.devicePixelRatio||1,r=Math.floor(t.x*n),o=Math.floor(t.y*n),s=Math.floor(t.width*n),a=Math.floor(t.height*n),l=new Uint8Array(s*a*4);this.renderer.readRenderTargetPixels(this.pickingTexture,r,this.pickingTexture.height-o,s,a,l);let c=new Uint8Array(this.worldSpacePointPositions.length);for(let h=0;h<s*a;h++){let p=l[h*4]<<16|l[h*4+1]<<8|l[h*4+2];p!==16777215&&p<e&&(c[p]=1)}let u=[];for(let h=0;h<c.length;h++)c[h]===1&&u.push(h);return u}selectBoundingBox(t){let e=this.getPointIndicesFromPickingTexture(t);this.projectorEventContext.notifySelectionChanged(e)}setNearestPointToMouse(t){if(this.pickingTexture==null){this.nearestPoint=null;return}let e={x:t.offsetX,y:t.offsetY,width:1,height:1},n=this.getPointIndicesFromPickingTexture(e);this.nearestPoint=n!=null?n[0]:null}getLayoutValues(){return this.width=this.container.offsetWidth,this.height=Math.max(1,this.container.offsetHeight),[this.width,this.height]}sceneIs3D(){return this.dimensionality===3}remove3dAxisFromScene(){let t=this.scene.getObjectByName("axes");return t!=null&&this.scene.remove(t),t}add3dAxis(){let t=new i2;t.name="axes",this.scene.add(t)}setDimensions(t){if(t!==2&&t!==3)throw new RangeError("dimensionality must be 2 or 3");this.dimensionality=t;let e=this.cameraDef||this.makeDefaultCameraDef(t);this.recreateCamera(e),this.remove3dAxisFromScene(),t===3&&this.add3dAxis()}getCameraDef(){let t=new Tb,e=this.camera.position,n=this.orbitCameraControls.target;return t.orthographic=!this.sceneIs3D(),t.position=[e.x,e.y,e.z],t.target=[n.x,n.y,n.z],t.zoom=this.camera.zoom,t}setCameraParametersForNextCameraCreation(t,e){this.cameraDef=t,this.orbitAnimationOnNextCameraCreation=e}getCameraPosition(){let t=this.camera.position;return[t.x,t.y,t.z]}getCameraTarget(){let t=this.orbitCameraControls.target;return[t.x,t.y,t.z]}setCameraPositionAndTarget(t,e){this.stopOrbitAnimation(),this.camera.position.set(t[0],t[1],t[2]),this.orbitCameraControls.target.set(e[0],e[1],e[2]),this.orbitCameraControls.update(),this.render()}startOrbitAnimation(){!this.sceneIs3D()||(this.orbitAnimationId!=null&&this.stopOrbitAnimation(),this.orbitCameraControls.autoRotate=!0,this.orbitCameraControls.rotateSpeed=hgt,this.updateOrbitAnimation())}updateOrbitAnimation(){this.orbitCameraControls.update(),this.orbitAnimationId=requestAnimationFrame(()=>this.updateOrbitAnimation())}stopOrbitAnimation(){this.orbitCameraControls.autoRotate=!1,this.orbitCameraControls.rotateSpeed=d$,this.orbitAnimationId!=null&&(cancelAnimationFrame(this.orbitAnimationId),this.orbitAnimationId=null)}addVisualizer(t){this.scene&&t.setScene(this.scene),t.onResize(this.width,this.height),t.onPointPositionsChanged(this.worldSpacePointPositions),this.visualizers.push(t)}removeAllVisualizers(){this.visualizers.forEach(t=>t.dispose()),this.visualizers=[]}setPointPositions(t){this.worldSpacePointPositions=t,this.visualizers.forEach(e=>e.onPointPositionsChanged(t))}render(){{let r=this.camera.position.clone();r.x+=1,r.y+=1,this.light.position.set(r.x,r.y,r.z)}let t=this.camera instanceof xn?Jo.Perspective:Jo.Orthographic,e=[0,0];this.worldSpacePointPositions!=null&&(e=eB(this.worldSpacePointPositions,this.camera.position,this.orbitCameraControls.target));let n=new Sb(this.camera,t,this.orbitCameraControls.target,this.width,this.height,e[0],e[1],this.backgroundColor,this.pointColors,this.pointScaleFactors,this.labels,this.polylineColors,this.polylineOpacities,this.polylineWidths);this.visualizers.forEach(r=>r.onPickingRender(n));{let r=this.remove3dAxisFromScene();this.pickingTexture?this.renderer.setRenderTarget(this.pickingTexture):this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null),r!=null&&this.scene.add(r)}this.visualizers.forEach(r=>r.onRender(n)),this.renderer.render(this.scene,this.camera)}setMouseMode(t){this.mouseMode=t,t===Qo.AREA_SELECT?(this.selecting=!0,this.container.style.cursor="crosshair"):(this.selecting=!1,this.container.style.cursor="default")}setPointColors(t){this.pointColors=t}setPointScaleFactors(t){this.pointScaleFactors=t}setLabels(t){this.labels=t}setPolylineColors(t){this.polylineColors=t}setPolylineOpacities(t){this.polylineOpacities=t}setPolylineWidths(t){this.polylineWidths=t}getMouseMode(){return this.mouseMode}resetZoom(){this.recreateCamera(this.makeDefaultCameraDef(this.dimensionality)),this.render()}setDayNightMode(t){let e=this.container.querySelectorAll("canvas"),n=t?"invert(100%)":null;for(let r=0;r<e.length;r++)e[r].style.filter=n}resize(t=!0){let[e,n]=[this.width,this.height],[r,o]=this.getLayoutValues();if(this.dimensionality===3){let a=this.camera;a.aspect=r/o,a.updateProjectionMatrix()}else{let a=this.camera,l=r/e,c=o/n,u=(a.right-a.left)*l/2,h=(a.top-a.bottom)*c/2;a.top=h,a.bottom=-h,a.left=-u,a.right=u,a.updateProjectionMatrix()}let s=window.devicePixelRatio||1;this.renderer.setPixelRatio(s),this.renderer.setSize(r,o);{let a=new Et;this.renderer.getSize(a);let l=this.renderer.getPixelRatio();this.pickingTexture=new ii(a.width*l,a.height*l),this.pickingTexture.texture.minFilter=_n}this.visualizers.forEach(a=>a.onResize(r,o)),t&&this.render()}onCameraMove(t){this.onCameraMoveListeners.push(t)}clickOnPoint(t){this.nearestPoint=t,this.onClick(void 0,!1)}};var Ab=class{constructor(t,e,n){this.bound=t,this.cellWidth=e,this.cellHeight=n,this.numHorizCells=Math.ceil(this.boundWidth(t)/e),this.numVertCells=Math.ceil(this.boundHeight(t)/n),this.grid=new Array(this.numHorizCells*this.numVertCells)}boundWidth(t){return t.hiX-t.loX}boundHeight(t){return t.hiY-t.loY}boundsIntersect(t,e){return!(t.loX>e.hiX||t.loY>e.hiY||t.hiX<e.loX||t.hiY<e.loY)}insert(t,e=!1){if(t.hiX<this.bound.loX||t.loX>this.bound.hiX||t.hiY<this.bound.loY||t.loY>this.bound.hiY)return!1;let n=this.getCellX(t.loX),r=this.getCellX(t.hiX),o=this.getCellY(t.loY),s=this.getCellY(t.hiY),a=o*this.numHorizCells+n,l=a;for(let c=o;c<=s;c++){for(let u=n;u<=r;u++){let h=this.grid[l++];if(h){for(let p=0;p<h.length;p++)if(this.boundsIntersect(t,h[p]))return!1}}l+=this.numHorizCells-(r-n+1)}if(e)return!0;l=a;for(let c=o;c<=s;c++){for(let u=n;u<=r;u++)this.grid[l]?this.grid[l].push(t):this.grid[l]=[t],l++;l+=this.numHorizCells-(r-n+1)}return!0}getCellX(t){return Math.floor((t-this.bound.loX)/this.cellWidth)}getCellY(t){return Math.floor((t-this.bound.loY)/this.cellHeight)}};var pgt=1e4,fgt=3,dgt=6;function mgt(i,t,e,n,r){if(t.length==0)return;let o={top:10,right:10,bottom:20,left:40},s=400,a=160,l=s-o.left-o.right,c=a-o.top-o.bottom,u=i,h=g$(ea(t,f=>f.time),ta(t,f=>f.time*1.01),0,l),p=g$(ea(t,f=>Math.min(f.donor,f.acceptor)),ta(t,f=>Math.max(f.donor,f.acceptor)),c,0);x$(u,t,e,n,h,p,"#4DBBD5",f=>f.donor),x$(u,t,e,n,h,p,"#E64B35",f=>f.acceptor)}function g$(i,t,e,n){return mi().domain([i,t]).range([e,n])}function x$(i,t,e,n,r,o,s,a){i.beginPath(),i.moveTo(e+r(t[0].time),n+o(a(t[0])));for(let l=1;l<t.length;l++){let c=e+r(t[l].time),u=n+o(a(t[l]));i.lineTo(c,u)}i.strokeStyle=s,i.lineWidth=.5,i.stroke()}var kb=class{constructor(t){this.labelsActive=!0,this.canvas=document.createElement("canvas"),t.appendChild(this.canvas),this.gc=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.left="0",this.canvas.style.top="0",this.canvas.style.pointerEvents="none"}removeAllLabels(){let t=this.canvas.width*window.devicePixelRatio,e=this.canvas.height*window.devicePixelRatio;this.gc.clearRect(0,0,t,e)}makeLabels(t){if(t.labels==null||t.labels.pointIndices.length===0||this.worldSpacePointPositions==null)return;let e=t.labels,n=t.cameraType===Jo.Perspective,r=parseInt(this.gc.font,10),o=window.devicePixelRatio,s;{let d=this.canvas.width*o,m=this.canvas.height*o,x={loX:0,hiX:d,loY:0,hiY:m};s=new Ab(x,d/25,m/50)}let a=am().exponent(Math.E).domain([t.farthestCameraSpacePointZ,t.nearestCameraSpacePointZ]).range([.1,1]),l=t.camera.position,c=l.clone().sub(t.cameraTarget),u=new q;this.gc.textBaseline="middle",this.gc.miterLimit=2;let h=2,p=4,f=Math.min(pgt,e.pointIndices.length);for(let d=0;d<f;++d){let m;{let b=e.pointIndices[d];m=Od(this.worldSpacePointPositions,b)}if(u.copy(l).sub(m),c.dot(u)<0)continue;let[x,g]=tB(t.camera,t.screenWidth,t.screenHeight,m);x+=p;let y={loX:x-h,hiX:x+1+h,loY:g-r/2-h,hiY:g+r/2+h};if(s.insert(y,!0)){let b=e.labelStrings[d],v=e.traceVectors[d],_=e.defaultFontSize*e.scaleFactors[d]*o;if(this.gc.font=_+"px roboto",y.hiX+=this.gc.measureText(b).width-1,s.insert(y)){let S=1;n&&e.useSceneOpacityFlags[d]===1&&(S=a(u.length())),this.gc.fillStyle=this.styleStringFromPackedRgba(e.fillColors,d,S),this.gc.strokeStyle=this.styleStringFromPackedRgba(e.strokeColors,d,S),this.gc.lineWidth=fgt,this.gc.strokeText(b,x,g),this.gc.lineWidth=dgt,this.gc.fillText(b,x,g),mgt(this.gc,v,x,g)}}}}styleStringFromPackedRgba(t,e,n){let r=e*3,o=t[r],s=t[r+1],a=t[r+2];return"rgba("+o+","+s+","+a+","+n+")"}onResize(t,e){let n=window.devicePixelRatio;this.canvas.width=t*n,this.canvas.height=e*n,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"}dispose(){this.removeAllLabels(),this.canvas=null,this.gc=null}onPointPositionsChanged(t){this.worldSpacePointPositions=t,this.removeAllLabels()}onRender(t){!this.labelsActive||(this.removeAllLabels(),this.makeLabels(t))}setScene(t){}onPickingRender(t){}};var y$=3,v$=3,Rb=class{constructor(){this.polylinePositionBuffer={},this.polylineColorBuffer={}}updateSequenceIndicesInDataSet(t){for(let e=0;e<t.sequences.length;e++){let n=t.sequences[e];for(let r=0;r<n.pointIndices.length-1;r++)t.points[n.pointIndices[r]].sequenceIndex=e,t.points[n.pointIndices[r+1]].sequenceIndex=e}}createPolylines(t){if(!(!this.dataSet||!this.dataSet.sequences)){this.updateSequenceIndicesInDataSet(this.dataSet),this.polylines=[];for(let e=0;e<this.dataSet.sequences.length;e++){let n=new Pe;n.setAttribute("position",this.polylinePositionBuffer[e]),n.setAttribute("color",this.polylineColorBuffer[e]);let r=new ro({linewidth:1,opacity:1,transparent:!0,vertexColors:!0}),o=new Xs(n,r);o.frustumCulled=!1,this.polylines.push(o),t.add(o)}}}dispose(){if(this.polylines!=null){for(let t=0;t<this.polylines.length;t++)this.scene.remove(this.polylines[t]),this.polylines[t].geometry.dispose();this.polylines=null,this.polylinePositionBuffer={},this.polylineColorBuffer={}}}setScene(t){this.scene=t}setDataSet(t){this.dataSet=t}onPointPositionsChanged(t){if((t==null||this.polylines!=null)&&this.dispose(),!(t==null||this.dataSet==null)){for(let e=0;e<this.dataSet.sequences.length;e++){let n=this.dataSet.sequences[e],r=2*(n.pointIndices.length-1),o=new Float32Array(r*v$);this.polylinePositionBuffer[e]=new we(o,v$);let s=new Float32Array(r*y$);this.polylineColorBuffer[e]=new we(s,y$)}for(let e=0;e<this.dataSet.sequences.length;e++){let n=this.dataSet.sequences[e],r=0;for(let o=0;o<n.pointIndices.length-1;o++){let s=n.pointIndices[o],a=n.pointIndices[o+1],l=Od(t,s),c=Od(t,a);this.polylinePositionBuffer[e].setXYZ(r,l.x,l.y,l.z),this.polylinePositionBuffer[e].setXYZ(r+1,c.x,c.y,c.z),r+=2}this.polylinePositionBuffer[e].needsUpdate=!0}this.polylines==null&&this.createPolylines(this.scene)}}onRender(t){if(this.polylines!=null)for(let e=0;e<this.polylines.length;e++){let n=this.polylines[e].material;n.opacity=t.polylineOpacities[e],n.linewidth=t.polylineWidths[e];let r=new we(t.polylineColors[e],3);this.polylineColorBuffer[e]=r,r.needsUpdate=!0,this.polylines[e].geometry.setAttribute("color",r)}}onPickingRender(t){}onResize(t,e){}};var b$=5e3,ggt=5,xgt=40,_$=3,w$=1,Pb=3;function ygt(){return`
  // Index of the specific vertex (passed in as bufferAttribute), and the
  // variable that will be used to pass it to the fragment shader.
  attribute float spriteIndex;
  attribute vec3 color;
  attribute float scaleFactor;

  varying vec2 xyIndex;
  varying vec3 vColor;

  uniform bool sizeAttenuation;
  uniform float pointSize;
  uniform float spritesPerRow;
  uniform float spritesPerColumn;

  ${pe.fog_pars_vertex}

  void main() {
    // Pass index and color values to fragment shader.
    vColor = color;
    xyIndex = vec2(mod(spriteIndex, spritesPerRow),
              floor(spriteIndex / spritesPerColumn));

    // Transform current vertex by modelViewMatrix (model world position and
    // camera world position matrix).
    vec4 cameraSpacePos = modelViewMatrix * vec4(position, 1.0);

    // Project vertex in camera-space to screen coordinates using the camera's
    // projection matrix.
    gl_Position = projectionMatrix * cameraSpacePos;

    // Create size attenuation (if we're in 3D mode) by making the size of
    // each point inversly proportional to its distance to the camera.
    float outputPointSize = pointSize;
    if (sizeAttenuation) {
      outputPointSize = -pointSize / cameraSpacePos.z;
    } else {  // Create size attenuation (if we're in 2D mode)
      const float PI = 3.1415926535897932384626433832795;
      const float minScale = 0.1;  // minimum scaling factor
      const float outSpeed = 2.0;  // shrink speed when zooming out
      const float outNorm = (1. - minScale) / atan(outSpeed);
      const float maxScale = 15.0;  // maximum scaling factor
      const float inSpeed = 0.02;  // enlarge speed when zooming in
      const float zoomOffset = 0.3;  // offset zoom pivot
      float zoom = projectionMatrix[0][0] + zoomOffset;  // zoom pivot
      float scale = zoom < 1. ? 1. + outNorm * atan(outSpeed * (zoom - 1.)) :
                    1. + 2. / PI * (maxScale - 1.) * atan(inSpeed * (zoom - 1.));
      outputPointSize = pointSize * scale;
    }

    gl_PointSize =
      max(outputPointSize * scaleFactor, ${ggt.toFixed(1)});
  }`}var S$=`
  bool point_in_unit_circle(vec2 spriteCoord) {
    vec2 centerToP = spriteCoord - vec2(0.5, 0.5);
    return dot(centerToP, centerToP) < (0.5 * 0.5);
  }

  bool point_in_unit_equilateral_triangle(vec2 spriteCoord) {
    vec3 v0 = vec3(0, 1, 0);
    vec3 v1 = vec3(0.5, 0, 0);
    vec3 v2 = vec3(1, 1, 0);
    vec3 p = vec3(spriteCoord, 0);
    float p_in_v0_v1 = cross(v1 - v0, p - v0).z;
    float p_in_v1_v2 = cross(v2 - v1, p - v1).z;
    return (p_in_v0_v1 > 0.0) && (p_in_v1_v2 > 0.0);
  }

  bool point_in_unit_square(vec2 spriteCoord) {
    return true;
  }
`;function vgt(){return`
  varying vec2 xyIndex;
  varying vec3 vColor;

  uniform sampler2D spriteTexture;
  uniform float spritesPerRow;
  uniform float spritesPerColumn;
  uniform bool isImage;

  ${pe.common}
  ${pe.fog_pars_fragment}
  ${S$}

  void main() {
    if (isImage) {
      // Coordinates of the vertex within the entire sprite image.
      vec2 coords = 
        (gl_PointCoord + xyIndex) / vec2(spritesPerRow, spritesPerColumn);
      if (texture2D(spriteTexture, coords).a==0.0) {
        discard;
      }
      gl_FragColor = vec4(vColor, 1.0) * texture2D(spriteTexture, coords);
    } else {
      bool inside = point_in_unit_circle(gl_PointCoord);
      if (!inside) {
        discard;
      }
      gl_FragColor = vec4(vColor, 1);
    }
    ${pe.fog_fragment}
  }`}var bgt=`
  varying vec2 xyIndex;
  varying vec3 vColor;
  uniform bool isImage;

  ${S$}

  void main() {
    xyIndex; // Silence 'unused variable' warning.
    if (isImage) {
      gl_FragColor = vec4(vColor, 1);
    } else {
      bool inside = point_in_unit_circle(gl_PointCoord);
      if (!inside) {
        discard;
      }
      gl_FragColor = vec4(vColor, 1);
    }
  }`,Nb=class{constructor(){this.VERTEX_SHADER=ygt(),this.FRAGMENT_SHADER=vgt(),this.texture=null,this.standinTextureForPoints=m4(document.createElement("canvas")),this.renderMaterial=this.createRenderMaterial(!1),this.pickingMaterial=this.createPickingMaterial(!1)}createTextureFromSpriteAtlas(t,e,n){this.texture=m4(t),this.spritesPerRow=t.width/e[0],this.spritesPerColumn=t.height/e[1],this.spriteDimensions=e,this.spriteIndexBufferAttribute=new we(n,w$),this.points!=null&&this.points.geometry.setAttribute("spriteIndex",this.spriteIndexBufferAttribute)}createUniforms(){return{spriteTexture:{type:"t"},spritesPerRow:{type:"f"},spritesPerColumn:{type:"f"},fogColor:{type:"c"},fogNear:{type:"f"},fogFar:{type:"f"},isImage:{type:"bool"},sizeAttenuation:{type:"bool"},pointSize:{type:"f"}}}createRenderMaterial(t){let e=this.createUniforms();return new er({uniforms:e,vertexShader:this.VERTEX_SHADER,fragmentShader:this.FRAGMENT_SHADER,transparent:!t,depthTest:t,depthWrite:t,fog:!0,blending:Bs})}createPickingMaterial(t){let e=this.createUniforms();return new er({uniforms:e,vertexShader:this.VERTEX_SHADER,fragmentShader:bgt,transparent:!0,depthTest:!0,depthWrite:!0,fog:!1,blending:Bs})}createPointSprites(t,e){let n=e!=null?e.length/Pb:0,r=this.createGeometry(n);this.fog=new gl(16777215),this.points=new wd(r,this.renderMaterial),this.points.frustumCulled=!1,this.spriteIndexBufferAttribute!=null&&this.points.geometry.setAttribute("spriteIndex",this.spriteIndexBufferAttribute),t.add(this.points)}calculatePointSize(t){if(this.texture!=null)return t?xgt:this.spriteDimensions[0];let e=this.worldSpacePointPositions!=null?this.worldSpacePointPositions.length/Pb:1,n=200,r=8,o=1.5,s=n/Math.log(e)/Math.log(r);return t?s:s/o}createGeometry(t){let e=t;this.pickingColors=new Float32Array(e*_$);{let r=0;for(let o=0;o<e;o++){let s=new zt(o);this.pickingColors[r++]=s.r,this.pickingColors[r++]=s.g,this.pickingColors[r++]=s.b}}let n=new Pe;return n.setAttribute("position",new we(void 0,Pb)),n.setAttribute("color",new we(void 0,_$)),n.setAttribute("scaleFactor",new we(void 0,w$)),n}setFogDistances(t,e,n){if(t){let r=this.worldSpacePointPositions.length/Pb;this.fog.near=e;let o=2-Math.min(r,b$)/b$;this.fog.far=n*o}else this.fog.near=1/0,this.fog.far=1/0}dispose(){this.disposeGeometry(),this.disposeTextureAtlas()}disposeGeometry(){this.points!=null&&(this.scene.remove(this.points),this.points.geometry.dispose(),this.points=null,this.worldSpacePointPositions=null)}disposeTextureAtlas(){this.texture!=null&&this.texture.dispose(),this.texture=null,this.renderMaterial=null,this.pickingMaterial=null}setScene(t){this.scene=t}setSpriteAtlas(t,e,n){this.disposeTextureAtlas(),this.createTextureFromSpriteAtlas(t,e,n),this.renderMaterial=this.createRenderMaterial(!0),this.pickingMaterial=this.createPickingMaterial(!0)}clearSpriteAtlas(){this.disposeTextureAtlas(),this.renderMaterial=this.createRenderMaterial(!1),this.pickingMaterial=this.createPickingMaterial(!1)}onPointPositionsChanged(t){if(t==null||t.length===0){this.dispose();return}this.points!=null&&this.worldSpacePointPositions.length!==t.length&&this.disposeGeometry(),this.worldSpacePointPositions=t,this.points==null&&this.createPointSprites(this.scene,t);let e=new we(t,3);this.points.geometry.setAttribute("position",e),e.needsUpdate=!0}onPickingRender(t){if(this.points==null)return;let e=t.cameraType===Jo.Perspective;this.pickingMaterial.uniforms.spritesPerRow.value=this.spritesPerRow,this.pickingMaterial.uniforms.spritesPerRow.value=this.spritesPerColumn,this.pickingMaterial.uniforms.sizeAttenuation.value=e,this.pickingMaterial.uniforms.pointSize.value=this.calculatePointSize(e),this.points.material=this.pickingMaterial;let n=new we(this.pickingColors,3);this.points.geometry.setAttribute("color",n),n.needsUpdate=!0;let r=new we(t.pointScaleFactors,1);this.points.geometry.setAttribute("scaleFactor",r),r.needsUpdate=!0}onRender(t){if(!this.points)return;let e=t.camera instanceof xn;this.setFogDistances(e,t.nearestCameraSpacePointZ,t.farthestCameraSpacePointZ),this.scene.fog=this.fog,this.scene.fog.color=new zt(t.backgroundColor),this.renderMaterial.uniforms.fogColor.value=this.scene.fog.color,this.renderMaterial.uniforms.fogNear.value=this.fog.near,this.renderMaterial.uniforms.fogFar.value=this.fog.far,this.renderMaterial.uniforms.spritesPerRow.value=this.spritesPerRow,this.renderMaterial.uniforms.spritesPerColumn.value=this.spritesPerColumn,this.renderMaterial.uniforms.isImage.value=this.texture!=null,this.renderMaterial.uniforms.spriteTexture.value=this.texture!=null?this.texture:this.standinTextureForPoints,this.renderMaterial.uniforms.sizeAttenuation.value=e,this.renderMaterial.uniforms.pointSize.value=this.calculatePointSize(e),this.points.material=this.renderMaterial,this.renderColors=t.pointColors;let n=new we(this.renderColors,3);this.points.geometry.setAttribute("color",n),n.needsUpdate=!0;let r=new we(t.pointScaleFactors,1);this.points.geometry.setAttribute("scaleFactor",r),r.needsUpdate=!0}onResize(t,e){}};var _m=class extends Oe(ve){registerInputChangedListener(t){this.textChangedListeners.push(t)}ready(){super.ready(),this.inRegexMode=!1,this.textChangedListeners=[],this.paperInput=this.$$("paper-input"),this.inRegexModeButton=this.$$("paper-button"),this.paperInput.setAttribute("error-message","Invalid regex"),this.paperInput.addEventListener("input",()=>{this.onTextChanged()}),this.paperInput.addEventListener("keydown",t=>{t.stopPropagation()}),this.inRegexModeButton.addEventListener("click",()=>this.onClickRegexModeButton()),this.updateRegexModeDisplaySlashes(),this.onTextChanged()}onClickRegexModeButton(){this.inRegexMode=this.inRegexModeButton.active,this.updateRegexModeDisplaySlashes(),this.onTextChanged()}notifyInputChanged(t,e){this.textChangedListeners.forEach(n=>n(t,e))}onTextChanged(){try{this.inRegexMode&&new RegExp(this.paperInput.value)}catch(t){this.paperInput.setAttribute("invalid","true"),this.message="",this.notifyInputChanged(null,!0);return}this.paperInput.removeAttribute("invalid"),this.notifyInputChanged(this.paperInput.value,this.inRegexMode)}updateRegexModeDisplaySlashes(){let t=this.paperInput.querySelectorAll(".slash"),e=this.inRegexMode?"":"none";for(let n=0;n<t.length;n++)t[n].style.display=e}getValue(){return this.paperInput.value}getInRegexMode(){return this.inRegexMode}setValue(t,e){this.inRegexModeButton.active=e,this.paperInput.value=t,this.onClickRegexModeButton()}};_m.template=ut`
    <style include="vz-projector-styles"></style>
    <style>
      .info {
        color: rgba(0, 0, 0, 0.5);
        display: block;
        font-size: 11px;
      }

      .toggle {
        font-size: 12px;
        height: 21px;
        margin: 0px;
        min-width: 0px;
        min-height: 0px;
        padding: 0;
        width: 17px;
      }

      .toggle[active] {
        background-color: #880e4f;
        color: white;
      }

      .suffix {
        display: flex;
        flex-direction: row;
      }
    </style>

    <paper-input label="[[label]]">
      <div class="slash" prefix slot="prefix">/</div>
      <div class="suffix" suffix slot="suffix">
        <div class="slash">/</div>
        <paper-button id="regex" toggles class="toggle">.*</paper-button>
      </div>
    </paper-input>
    <paper-tooltip
      for="regex"
      position="bottom"
      animation-delay="0"
      fit-to-visible-bounds
    >
      Enable/disable regex mode.
    </paper-tooltip>
    <span class="info">[[message]]</span>
  `;wt([Rt({type:String}),ht("design:type",String)],_m.prototype,"label",void 0);wt([Rt({type:String}),ht("design:type",String)],_m.prototype,"message",void 0);_m=wt([Fe("vz-projector-input")],_m);var Vl=class extends Oe(ve){constructor(){super(...arguments),this.isCollapsed=!1,this.syncMode=!1}ready(){super.ready();for(let e of this.choices)e.value==this.projector.dataSet.points[this.pointIndex].metadata[bm]&&(e.checked=!0);let t=this.projector.dataSet.points[this.pointIndex].metadata[Ih];t!==gb&&(this.textLabel=t)}initialize(t,e){this.projector=t,this.pointIndex=e,this.choices=[{value:"True",checked:!1},{value:mb,checked:!1},{value:"False",checked:!1}],this.textLabel=""}_binaryLabelUpdated(t){this.choices.forEach(e=>e.checked=!1),this.choices[t.model.index].checked=!0,this.binaryChoiceChanged()}_textLabelUpdated(t){var e;this.textLabel=(e=t.target)==null?void 0:e.value,this.textLabelChanged()}binaryChoiceChanged(){for(let t of this.choices)t.checked&&(t.value!=mb?(this.$$("#binary-button").classList.remove("normal"),this.$$("#binary-button").classList.add("highlight")):(this.$$("#binary-button").classList.remove("highlight"),this.$$("#binary-button").classList.add("normal")),this.projector.dataSet.points[this.pointIndex].metadata[bm]=t.value);this.syncStats(),this.projector.dataPanel.selectedColorOptionName=bm}textLabelChanged(){this.textLabel?this.projector.dataSet.points[this.pointIndex].metadata[Ih]=this.textLabel:this.projector.dataSet.points[this.pointIndex].metadata[Ih]=gb,this.syncStats(),this.projector.dataPanel.selectedColorOptionName=Ih}syncStats(){var t;this.projector.dataSet.spriteAndMetadataInfo.stats=Zo((t=this.projector.dataSet.spriteAndMetadataInfo.stats)==null?void 0:t.map(e=>e.name),this.projector.dataSet.points.map(e=>e.metadata)),this.projector.dataPanel.metadataChanged(this.projector.dataSet.spriteAndMetadataInfo,this.projector.metadataFile),this.projector.dataPanel._selectedColorOptionNameChanged()}metadataChanged(){this.ready()}};Vl.template=ut`
    <style>
      .download-button {
        position: absolute;
        right: 20px;
        top: 120px;
      }

      .button-container {
        display: flex;
        flex-direction: row;
        gap: 2px; /* Add spacing between sections */
        width: calc(100% - 5px);
      }
      
      .button-group {
        display: flex;
        gap: 2px; /* Add spacing between buttons */
      }

      .text-label {
        border-radius: 7px;
        padding: 5px;
        box-sizing: border-box;
        width: 100%;
        border: none;
      }

      .highlight, .button-container input:not(:placeholder-shown) {
        background: #ADD8E6;
      }

      .normal {
        background: #e3e3e3;
      }

      .binary-button {
        display: flex;
        flex-direction: row;
        gap: 20px;
        margin-right: 6px;
        border: none;
        border-radius: 7px;
        padding: 5px;
      }
      
      
    </style>

    <div id="labeler-container" class="label-control">
      <div class="button-container">
        <radio-group id="binary-button" class="binary-button normal">
          <template is="dom-repeat" items="[[choices]]">
          <label>
            <input type="radio" name="labeler" value="[[item.value]]" checked="[[item.checked]]" on-change="_binaryLabelUpdated"></input>
            <span class="input-text">[[item.value]]</span>
          </label>
          </template>
        </radio-group>
        <input class="text-label normal" placeholder="Text Label" on-input="_textLabelUpdated" value="[[textLabel]]"></input>
      </div>
    </div>
  `;wt([Rt({type:Object}),ht("design:type",Array)],Vl.prototype,"choices",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],Vl.prototype,"isCollapsed",void 0);wt([Rt({type:String}),ht("design:type",String)],Vl.prototype,"textLabel",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],Vl.prototype,"syncMode",void 0);Vl=wt([Fe("vz-projector-trace-labeler")],Vl);var C$=ut`
  <style include="vz-projector-styles"></style>
  <style>
    :host {
      display: flex;
      flex-direction: column;
      /* Account for the bookmark pane at the bottom */
      height: calc(100% - 55px);
    }

    .container {
      display: block;
      padding: 10px 20px 0 20px;
    }

    .buttons {
      display: flex;
      height: 60px;
    }

    .button {
      margin-right: 5px;
      border: none;
      border-radius: 7px;
      font-size: 13px;
      padding: 5;
      background: #e3e3e3;
    }

    .radio-group {
      display: flex;
      flex-direction: row;
    }

    .button:last-child {
      margin-right: 0;
    }

    .nn,
    .metadata-info {
      display: flex;
      flex-direction: column;
    }

    .nn > *,
    .metadata-info > * {
      padding: 0 20px;
    }

    .nn-list,
    .metadata-list {
      overflow-y: auto;
    }

    .nn-list .neighbor,
    .metadata-list .metadata {
      font-size: 12px;
      margin-bottom: 8px;
    }

    .nn-list .label-and-value,
    .metadata-list .label-and-value {
      display: flex;
      justify-content: space-between;
    }

    .label {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .nn-list .value,
    .metadata-list .value {
      color: #666;
      float: right;
      font-weight: 300;
      margin-left: 8px;
    }

    .nn-list .bar,
    .metadata-list .bar {
      position: relative;
      border-top: 1px solid rgba(0, 0, 0, 0.15);
      margin: 2px 0;
    }

    .nn-list .bar .fill,
    .metadata-list .bar .fill {
      position: absolute;
      top: -1px;
      border-top: 1px solid white;
    }

    .nn-list .tick,
    .metadata-list .tick {
      position: absolute;
      top: 0px;
      height: 3px;
      border-left: 1px solid rgba(0, 0, 0, 0.15);
    }

    .nn-list .sprite-image,
    .metadata-list .sprite-image {
      width: 100%;
    }

    .nn-list.nn-img-show .sprite-image,
    .metadata-list.nn-img-show .sprite-image {
      display: block;
    }

    .nn-list .neighbor-link:hover,
    .metadata-list .metadata-link:hover {
      cursor: pointer;
    }

    .search-by {
      display: flex;
    }

    .search-by vz-projector-input {
      width: 100%;
    }

    .search-by paper-dropdown-menu {
      margin-left: 10px;
      width: 100px;
    }

    .distance .options {
      float: right;
    }

    .neighbor-image-controls {
      display: flex;
      padding: 0.8em 0.1em;
    }

    .options a {
      color: #727272;
      font-size: 13px;
      margin-left: 12px;
      text-decoration: none;
    }

    .options a.selected {
      color: #009efe;
    }

    .neighbors {
      margin-bottom: 15px;
    }

    .neighbors-options {
      margin-top: 6px;
    }

    .neighbors-options .option-label,
    .distance .option-label {
      color: #727272;
      margin-right: 2px;
      width: auto;
    }

    .num-neighbors-container {
      display: inline-block;
    }

    .nn-slider {
      --paper-slider-input: {
        width: 72px;
      }
      --paper-input-container-input: {
        font-size: 14px;
      }
    }

    .euclidean {
      margin-right: 10px;
    }

    .matches-list {
      padding: 0 20px;
    }

    .matches-list .row {
      border-bottom: 1px solid #ddd;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      font-size: 12px;
      margin: 5px 0;
      padding: 4px 0;
    }

    .results {
      display: flex;
      flex-direction: column;
    }

    .results,
    .nn,
    .nn-list {
      flex: 1 0 100px;
    }

    .label-control {
      width: 100%;
      padding: 2px;
      display: flex;
      flex-directon: row;
      margin-right: 5px;
    }

    .sync-labeler-checkbox {
      display: none;
    }
    
    .binary-selected, .label-control input:not(:placeholder-shown) {
      background: #ADD8E6;
    }

    .horizontal-line {
      border-top: 1px solid #ccc; /* Change these values to customize the line */
      width: 100%; /* Adjust the width as needed */
      margin: 10px 0; /* Add spacing above and below the line (optional) */
    }
    
  </style>
  <div class="container">
    <div class="buttons">
      <button class="button plot-all-traces">List traces</button>
      <button class="button set-filter">Isolate selection</button>
      <button class="button set-reverse-filter">Remove selection</button>
      <button class="button reset-filter">Clear Isolation</button>
      <button class="button clear-selection" style="display: none">Clear selection</button>
    </div>
    <div class="search-by" style="display: none">
      <vz-projector-input id="search-box" label="Search"></vz-projector-input>
      <paper-dropdown-menu no-animations label="By">
        <paper-listbox
          attr-for-selected="value"
          class="dropdown-content"
          selected="{{selectedMetadataField}}"
          slot="dropdown-content"
        >
          <template is="dom-repeat" items="[[metadataFields]]">
            <paper-item value="[[item]]" label="[[item]]">
              [[item]]
            </paper-item>
          </template>
        </paper-listbox>
      </paper-dropdown-menu>
    </div>
  </div>
  <div class="results">
    <div class="nn" style="display: none">
      <div>
        <hr class="horizontal-line">
        <p>Selected trace:</p>
        <div class="trace-container"></div>
        <paper-checkbox class="sync-labeler-checkbox" checked="{{syncLabelers}}"> Sync Labeling </paper-checkbox>
      </div>
      <div class="neighbors">
        <div class="neighbors-options">
          <div class="slider num-nn">
            <span class="option-label">Neighbors</span>
            <paper-icon-button
              icon="help"
              class="help-icon"
            ></paper-icon-button>
            <paper-tooltip
              position="bottom"
              animation-delay="0"
              fit-to-visible-bounds
            >
              The number of neighbors (in the original space) to show when
              clicking on a point.
            </paper-tooltip>
            <paper-slider
              class="nn-slider"
              pin
              min="5"
              max="100"
              editable
              value="{{numNN}}"
              on-change="updateNumNN"
            ></paper-slider>
          </div>
        </div>
        <div class="distance">
          <span class="option-label">Distance</span>
          <div class="options">
            <a class="selected cosine" href="javascript:void(0);">COSINE</a>
            <a class="euclidean" href="javascript:void(0);">EUCLIDEAN</a>
          </div>
        </div>
        <div class="neighbor-image-controls">
          <template is="dom-if" if="[[spriteImagesAvailable]]">
            <paper-checkbox checked="{{showNeighborImages}}">
              show images
              <paper-icon-button
                icon="help"
                class="help-icon"
              ></paper-icon-button>
              <paper-tooltip
                position="bottom"
                animation-delay="0"
                fit-to-visible-bounds
              >
                Show the images of the nearest neighbors.
              </paper-tooltip>
            </paper-checkbox>
          </template>
        </div>
      </div>
      <p>Similar traces by distance:</p>
      <div class="nn-list"></div>
    </div>
    <div class="metadata-info" style="display: none">
      <div class="neighbors-options">
        <div class="slider num-nn">
          <span class="option-label">neighbors</span>
          <paper-icon-button icon="help" class="help-icon"></paper-icon-button>
          <paper-tooltip
            position="bottom"
            animation-delay="0"
            fit-to-visible-bounds
          >
            The number of neighbors (in the selected space) to show when
            clicking on a point.
          </paper-tooltip>
          <paper-slider
            class="nn-slider"
            pin
            min="5"
            max="100"
            editable
            value="{{numNN}}"
            on-change="updateNumNN"
          ></paper-slider>
        </div>

      </div>
      <p>{{metadataColumn}} labels (click to apply):</p>
      <div class="metadata-list"></div>
    </div>
    <div class="matches-list" style="display: none">
      <paper-checkbox class="sync-labeler-checkbox" checked="{{syncLabelers}}"> Sync Labeling </paper-checkbox>
      <div class="list"></div>
      <div class="limit-msg">Showing only the first 100 results...</div>
    </div>
  </div>
`;var Lb=100,_gt=20;function M$(i,t="trace"){if(i){let e=new XMLSerializer().serializeToString(i.parentNode),n=new Blob([e],{type:"image/svg+xml"}),r=document.createElement("a");r.href=URL.createObjectURL(n),r.download=`${t}.svg`,r.click(),URL.revokeObjectURL(r.href)}}function Hl(i,t){let e=i.points[t].metadata.donor,n=e!==void 0?e:[],r=i.points[t].metadata.acceptor,o=r!==void 0?r:[];return n.map((a,l)=>({time:l,donor:n[l],acceptor:o[l]}))}function es(i,t,e){let n={top:10,right:10,bottom:20,left:40},r=250,o=100;e!=null&&e.hasOwnProperty("width")&&(r=e.width),e!=null&&e.hasOwnProperty("height")&&(o=e.height);let s=r-n.left-n.right,a=o-n.top-n.bottom,l=P4(i).append("svg").attr("height",o).attr("width",r+10).append("g").attr("transform",`translate(${n.left},${n.top})`),c=mi().domain([ea(t,d=>d.time)||0,ta(t,d=>d.time*1.01)||1]).range([0,s]),u=mi().domain([ea(t,d=>Math.min(d.donor,d.acceptor))||0,ta(t,d=>Math.max(d.donor,d.acceptor))||1]).range([a,0]),h=j2().x(d=>c(d.time)).y(d=>u(d.donor));l.append("path").datum(t).attr("fill","none").attr("stroke","#4DBBD5").attr("stroke-width",.5).attr("d",h);let p=j2().x(d=>c(d.time)).y(d=>u(d.acceptor));l.append("path").datum(t).attr("fill","none").attr("stroke","#E64B35").attr("stroke-width",.5).attr("d",p);let f=5;return l.append("g").attr("transform",`translate(0, ${a})`).call(M4(c).ticks(f)),l.append("g").call(E4(u).ticks(f)),l.node()}function $l(i,t){let e=document.createElement("div"),n=document.createElement("vz-projector-trace-labeler");return n.initialize(i,t),e.appendChild(n),e}var Oi=class extends Oe(ve){constructor(){super(...arguments),this.numNN=_gt,this.showNeighborImages=!0,this.spriteImagesAvailable=!0,this.syncLabelers=!1}ready(){super.ready(),this.resetFilterButton=this.$$(".reset-filter"),this.setReverseFilterButton=this.$$(".set-reverse-filter"),this.setFilterButton=this.$$(".set-filter"),this.clearSelectionButton=this.$$(".clear-selection"),this.plotAllTracesButton=this.$$(".plot-all-traces"),this.plotSelectedTracesButton=this.$$(".plot-selected-traces"),this.limitMessage=this.$$(".limit-msg"),this.searchBox=this.$$("#search-box"),this.displayContexts=[]}initialize(t,e){this.projector=t,this.projectorEventContext=e,this.setupUI(t),e.registerSelectionChangedListener((n,r)=>this.updateInspectorPane(n,r))}updateInspectorPane(t,e){this.neighborsOfFirstPoint=e,this.selectedPointIndices=t,this.updateFilterButtons(t.length+e.length),this.updateNeighborsList(e),this.updateTraceContainer(t),e.length===0?this.updateSearchResults(t):this.updateSearchResults([]),this.searchBox.message=""}enableResetFilterButton(t){this.resetFilterButton.disabled=!t}restoreUIFromBookmark(t){this.enableResetFilterButton(t.filteredPoints!=null)}metadataChanged(t){var n,r;let e=-1;if(t.stats&&(this.metadataFields=t.stats.map((o,s)=>(!o.isNumeric&&e===-1&&(e=s),o.name))),t.spriteMetadata&&t.spriteMetadata.imagePath){let[o,s]=t.spriteMetadata.singleImageDim;this.spriteMeta={imagePath:(n=t.spriteImage)==null?void 0:n.src,aspectRatio:o/s,nCols:Math.floor(((r=t.spriteImage)==null?void 0:r.width)/o),singleImageDim:[o,s]}}else this.spriteMeta={};this.spriteImagesAvailable=!!this.spriteMeta.imagePath,(this.selectedMetadataField==null||this.metadataFields.filter(o=>o===this.selectedMetadataField).length===0)&&(this.selectedMetadataField=this.metadataFields[Math.max(0,e)]),this.updateInspectorPane(this.selectedPointIndices,this.neighborsOfFirstPoint),this.searchBox.setValue("",!1)}datasetChanged(){this.enableResetFilterButton(!1)}_refreshNeighborsList(){this.updateNeighborsList()}_selectedMetadataFieldChanged(){this.searchBox.setValue("",!1)}metadataEditorContext(t,e){if(!this.projector||!this.projector.dataSet)return;let n=this.projector.dataSet.spriteAndMetadataInfo.stats.filter(a=>a.name===e);if(!t||n.length===0||n[0].tooManyUniqueValues){this.removeContext(".metadata-info");return}this.metadataColumn=e,this.addContext(".metadata-info");let r=this.$$(".metadata-list");r.textContent="";let o=n[0].uniqueEntries.sort((a,l)=>a.count-l.count),s=o[o.length-1].count;o.forEach(a=>{let l=document.createElement("div");l.className="metadata";let c=document.createElement("a");c.className="metadata-link",c.title=a.label;let u=document.createElement("div");u.className="label-and-value";let h=document.createElement("div");h.className="label",h.style.color=ts(this.distFunc,s,a.count),h.innerText=a.label;let p=document.createElement("div");p.className="value",p.innerText=a.count.toString(),u.appendChild(h),u.appendChild(p);let f=document.createElement("div");f.className="bar";let d=document.createElement("div");d.className="fill",d.style.borderTopColor=ts(this.distFunc,s,a.count),d.style.width=Db(this.distFunc,s,a.count)*100+"%",f.appendChild(d);for(let m=1;m<4;m++){let x=document.createElement("div");x.className="tick",x.style.left=m*100/4+"%",f.appendChild(x)}c.appendChild(u),c.appendChild(f),l.appendChild(c),r.appendChild(l),c.onclick=()=>{this.projector.metadataEdit(e,a.label)}})}addContext(t){this.displayContexts.indexOf(t)===-1&&this.displayContexts.push(t),this.displayContexts.forEach(e=>{this.$$(e).style.display="none"}),this.$$(t).style.display=null}removeContext(t){if(this.displayContexts=this.displayContexts.filter(e=>e!==t),this.$$(t).style.display="none",this.displayContexts.length>0){let e=this.displayContexts[this.displayContexts.length-1];this.$$(e).style.display=null}}updateSearchResults(t){let n=this.$$(".matches-list").querySelector(".list");if(n.textContent="",t.length===0){this.removeContext(".matches-list");return}this.addContext(".matches-list"),this.limitMessage.style.display=t.length<=Lb?"none":null,t=t.slice(0,Lb);for(let r=0;r<t.length;r++){let o=t[r],s=document.createElement("div");s.className="row";let a=this.getLabelFromIndex(o),l=document.createElement("a");l.className="label",l.title=a,l.innerText=a,l.onmouseenter=()=>{this.projectorEventContext.notifyHoverOverPoint(o)},l.onmouseleave=()=>{this.projectorEventContext.notifyHoverOverPoint(null)},l.onclick=()=>{this.projectorEventContext.notifySelectionChanged([o])},s.appendChild(l),n.appendChild(s);let c=Hl(this.projector.dataSet,o),u=$l(this.projector,o);es(s,c),s.appendChild(u)}}getLabelFromIndex(t){let e=this.projector.dataSet.points[t].metadata[this.selectedMetadataField];return e!==void 0?String(e):`Unknown #${t}`}spriteImageRenderer(){let t=this.spriteMeta.imagePath,{aspectRatio:e,nCols:n}=this.spriteMeta,r=100/e+"%",o=`${n*100}% ${n*100}%`,s=`url(${CSS.escape(t)})`;return a=>{let l=document.createElement("div"),c=Hl(this.projector.dataSet,a.index);return es(l,c),l}}updateTraceContainer(t){if(t[0]==null)return;let e=this.$$(".trace-container");if(e.textContent="",t.length===0){this.removeContext(".matches-list");return}this.addContext(".matches-list"),this.limitMessage.style.display=t.length<=Lb?"none":null,t=t.slice(0,Lb);for(let n=0;n<t.length;n++){let r=t[n],o=document.createElement("div");o.className="row";let s=this.getLabelFromIndex(r),a=document.createElement("a");a.className="label",a.title=s,a.innerText=s,a.onmouseenter=()=>{this.projectorEventContext.notifyHoverOverPoint(r)},a.onmouseleave=()=>{this.projectorEventContext.notifyHoverOverPoint(null)},a.onclick=()=>{this.projectorEventContext.notifySelectionChanged([r])},o.appendChild(a),e.appendChild(o);let l=Hl(this.projector.dataSet,r),c=$l(this.projector,r);es(o,l),o.appendChild(c)}}updateNeighborsList(t){if(t=t||this._currentNeighbors,this._currentNeighbors=t,t==null)return;let e=this.$$(".nn-list");if(e.scrollTo({top:0,behavior:"smooth"}),e.textContent="",t.length===0){this.removeContext(".nn");return}this.addContext(".nn"),this.searchBox.message="";let n=t.length>0?t[0].dist:0;for(let r=0;r<t.length;r++){let o=t[r],s=document.createElement("div");s.className="neighbor";let a=document.createElement("a");a.className="neighbor-link",a.title=this.getLabelFromIndex(o.index);let l=document.createElement("div");l.className="label-and-value";let c=document.createElement("div");c.className="label",c.style.color=ts(this.distFunc,o.dist,n),c.innerText=this.getLabelFromIndex(o.index);let u=document.createElement("div");u.className="value",u.innerText=o.dist.toFixed(3),l.appendChild(c),l.appendChild(u);let h=document.createElement("div");h.className="bar";let p=document.createElement("div");p.className="fill",p.style.borderTopColor=ts(this.distFunc,o.dist,n),p.style.width=Db(this.distFunc,o.dist,n)*100+"%",h.appendChild(p);for(let d=1;d<4;d++){let m=document.createElement("div");m.className="tick",m.style.left=d*100/4+"%",h.appendChild(m)}if(a.appendChild(l),s.appendChild(a),this.showNeighborImages){let d=this.spriteImageRenderer()(o);a.appendChild(d)}let f=$l(this.projector,o.index);s.appendChild(f),s.appendChild(h),e.appendChild(s),a.onmouseenter=()=>{this.projectorEventContext.notifyHoverOverPoint(o.index)},a.onmouseleave=()=>{this.projectorEventContext.notifyHoverOverPoint(null)},a.onclick=()=>{this.projectorEventContext.notifySelectionChanged([o.index])}}}updateFilterButtons(t){t>1?(this.setFilterButton.innerText=`Isolate ${t} points`,this.setReverseFilterButton.innerText=`Remove ${t} points`,this.setFilterButton.disabled=null,this.setReverseFilterButton.disabled=null,this.clearSelectionButton.disabled=null):(this.setFilterButton.innerText="Isolate selection",this.setReverseFilterButton.innerText="Remove selection",this.setFilterButton.disabled=!0,this.setReverseFilterButton.disabled=!0,this.clearSelectionButton.disabled=!0)}setupUI(t){this.distFunc=J2;let e=this.$$(".distance a.euclidean");e.onclick=()=>{var a;let o=(a=this.root)==null?void 0:a.querySelectorAll(".distance a");if(o)for(let l=0;l<o.length;l++)ao(o[l],"selected",!1);ao(e,"selected",!0),this.distFunc=bh,this.projectorEventContext.notifyDistanceMetricChanged(this.distFunc);let s=t.dataSet.findNeighbors(this.selectedPointIndices[0],this.distFunc,this.numNN);this.updateNeighborsList(s)};let n=this.$$(".distance a.cosine");n.onclick=()=>{var a;let o=(a=this.root)==null?void 0:a.querySelectorAll(".distance a");if(o)for(let l=0;l<o.length;l++)ao(o[l],"selected",!1);ao(n,"selected",!0),this.distFunc=J2,this.projectorEventContext.notifyDistanceMetricChanged(this.distFunc);let s=t.dataSet.findNeighbors(this.selectedPointIndices[0],this.distFunc,this.numNN);this.updateNeighborsList(s)};let r=(o,s)=>{if(o==null||o.trim()===""){this.searchBox.message="",this.projectorEventContext.notifySelectionChanged([]);return}let a=t.dataSet.query(o,s,this.selectedMetadataField);this.projectorEventContext.notifySelectionChanged(a),a.length===0?this.searchBox.message="0 matches.":this.searchBox.message=`${a.length} matches.`};this.searchBox.registerInputChangedListener((o,s)=>{r(o,s)}),this.setFilterButton.onclick=()=>{let o=this.selectedPointIndices.concat(this.neighborsOfFirstPoint.map(s=>s.index));t.filterDataset(o),this.enableResetFilterButton(!0),this.updateFilterButtons(0)},this.setReverseFilterButton.onclick=()=>{let o=this.selectedPointIndices.concat(this.neighborsOfFirstPoint.map(l=>l.index)),s=t.dataSet.points.length,a=Array.from({length:s},(l,c)=>c).filter(l=>!o.includes(l));t.filterDataset(a),this.enableResetFilterButton(!0),this.updateFilterButtons(0)},this.resetFilterButton.onclick=()=>{t.resetFilterDataset(),this.enableResetFilterButton(!1)},this.clearSelectionButton.onclick=()=>{t.adjustSelectionAndHover([])},this.plotAllTracesButton.onclick=()=>{t.tracePanel.open()},this.enableResetFilterButton(!1)}updateNumNN(){this.selectedPointIndices!=null&&this.projectorEventContext.notifySelectionChanged([this.selectedPointIndices[0]])}};Oi.template=C$;wt([Rt({type:String}),ht("design:type",String)],Oi.prototype,"selectedMetadataField",void 0);wt([Rt({type:Array}),ht("design:type",Array)],Oi.prototype,"metadataFields",void 0);wt([Rt({type:String}),ht("design:type",String)],Oi.prototype,"metadataColumn",void 0);wt([Rt({type:Number}),ht("design:type",Number)],Oi.prototype,"numNN",void 0);wt([Rt({type:Object}),ht("design:type",Object)],Oi.prototype,"spriteMeta",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],Oi.prototype,"showNeighborImages",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],Oi.prototype,"spriteImagesAvailable",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],Oi.prototype,"syncLabelers",void 0);wt([Nn("showNeighborImages","spriteImagesAvailable"),ht("design:type",Function),ht("design:paramtypes",[]),ht("design:returntype",void 0)],Oi.prototype,"_refreshNeighborsList",null);wt([Nn("selectedMetadataField"),ht("design:type",Function),ht("design:paramtypes",[]),ht("design:returntype",void 0)],Oi.prototype,"_selectedMetadataFieldChanged",null);Oi=wt([Fe("vz-projector-inspector-panel")],Oi);var wgt=10,Sgt=1,E$=2,Cgt=0,Mgt=0,Egt=0,Tgt=16777215,Igt=16777215,Agt=16777215,T$=7697781,I$=7697881,kgt=16410214,Rgt=7736143,Pgt=1,Ngt=1.2,Lgt=1.2,Dgt=1.2;var zgt=16777215,Fgt=16777215,A$=60,Ogt=360,Bgt=1,Vgt=.3,Hgt=.2,$gt=2,Ugt=.9,Wgt=3,Ggt=.05,k$=2,jgt=mi().domain([1,.7,.4]).range(["hsl(285, 80%, 40%)","hsl(0, 80%, 65%)","hsl(40, 70%, 60%)"]).clamp(!0),zb=class{constructor(t,e){this.scatterPlotContainer=t,this.renderLabelsIn3D=!1,this.scatterPlot=new Ib(t,e),e.registerProjectionChangedListener(n=>{this.projection=n,this.updateScatterPlotWithNewProjection(n)}),e.registerSelectionChangedListener((n,r)=>{this.selectedPointIndices=n,this.neighborsOfFirstSelectedPoint=r,this.updateScatterPlotPositions(),this.updateScatterPlotAttributes(),this.scatterPlot.render()}),e.registerHoverListener(n=>{this.hoverPointIndex=n,this.updateScatterPlotAttributes(),this.scatterPlot.render()}),e.registerDistanceMetricChangedListener(n=>{this.distanceMetric=n,this.updateScatterPlotAttributes(),this.scatterPlot.render()}),this.createVisualizers(!1)}notifyProjectionPositionsUpdated(){this.updateScatterPlotPositions(),this.scatterPlot.render(),this.spriteVisualizer&&!this.renderLabelsIn3D&&this.spriteVisualizer.clearSpriteAtlas()}setDataSet(t){if(this.projection!=null&&(this.projection.dataSet=t),this.polylineVisualizer!=null&&this.polylineVisualizer.setDataSet(t),this.labels3DVisualizer!=null&&this.labels3DVisualizer.setLabelStrings(this.generate3DLabelsArray(t,this.labelPointAccessor)),this.spriteVisualizer==null||(this.spriteVisualizer.clearSpriteAtlas(),t==null||t.spriteAndMetadataInfo==null))return;let e=t.spriteAndMetadataInfo;if(e.spriteImage==null||e.spriteMetadata==null)return;let n=t.points.length,r=new Float32Array(n);for(let o=0;o<n;++o)r[o]=t.points[o].index;this.spriteVisualizer.setSpriteAtlas(e.spriteImage,e.spriteMetadata.singleImageDim,r)}set3DLabelMode(t){this.renderLabelsIn3D=t,this.createVisualizers(t),this.updateScatterPlotAttributes(),this.scatterPlot.render()}setLegendPointColorer(t){this.legendPointColorer=t}setLabelPointAccessor(t){if(this.labelPointAccessor=t,this.labels3DVisualizer!=null){let e=this.projection==null?null:this.projection.dataSet;this.labels3DVisualizer.setLabelStrings(this.generate3DLabelsArray(e,t))}}resize(){this.scatterPlot.resize()}populateBookmarkFromUI(t){t.cameraDef=this.scatterPlot.getCameraDef()}restoreUIFromBookmark(t){this.scatterPlot.setCameraParametersForNextCameraCreation(t.cameraDef,!1)}updateScatterPlotPositions(){let t=this.projection==null?null:this.projection.dataSet,e=this.projection==null?null:this.projection.projectionComponents,n=this.generatePointPositionArray(t,e);this.scatterPlot.setPointPositions(n)}updateScatterPlotAttributes(){if(this.projection==null)return;let t=this.projection.dataSet,e=this.selectedPointIndices,n=this.hoverPointIndex,r=this.neighborsOfFirstSelectedPoint,o=this.legendPointColorer,s=this.generatePointColorArray(t,o,this.distanceMetric,e,r,n,this.renderLabelsIn3D,this.getSpriteImageMode()),a=this.generatePointScaleFactorArray(t,e,r,n),l=this.generateVisibleLabelRenderParams(t,e,r,n),c=this.generateLineSegmentColorMap(t,o),u=this.generateLineSegmentOpacityArray(t,e),h=this.generateLineSegmentWidthArray(t,e);this.scatterPlot.setPointColors(s),this.scatterPlot.setPointScaleFactors(a),this.scatterPlot.setLabels(l),this.scatterPlot.setPolylineColors(c),this.scatterPlot.setPolylineOpacities(u),this.scatterPlot.setPolylineWidths(h)}render(){this.scatterPlot.render()}generatePointPositionArray(t,e){if(t==null)return null;let n=mi(),r=mi(),o=null;{let l=Sl(t.points,(h,p)=>t.points[p].projections[e[0]]),c=Sl(t.points,(h,p)=>t.points[p].projections[e[1]]),u=[-k$/2,k$/2];if(n.domain(l).range(u),r.domain(c).range(u),e[2]!=null){let h=Sl(t.points,(p,f)=>t.points[f].projections[e[2]]);o=mi(),o.domain(h).range(u)}}let s=new Float32Array(t.points.length*3),a=0;return t.points.forEach((l,c)=>{s[a++]=n(t.points[c].projections[e[0]]),s[a++]=r(t.points[c].projections[e[1]]),s[a++]=0}),o&&(a=2,t.points.forEach((l,c)=>{s[a]=o(t.points[c].projections[e[2]]),a+=3})),s}generateVisibleLabelRenderParams(t,e,n,r){if(t==null)return null;let o=e==null?0:e.length,s=n==null?0:n.length,a=o+s+(r!=null?1:0),l=new Uint32Array(a),c=new Float32Array(a),u=new Int8Array(a),h=new Uint8Array(a*3),p=new Uint8Array(a*3),f=[],d=[];c.fill(Sgt),u.fill(1);let m=0;if(r!=null){f.push(this.getLabelText(t,r,this.labelPointAccessor)),d.push(Hl(t,r)),l[m]=r,c[m]=E$,u[m]=0;let x=kh(Mgt);Ah(h,m,x[0],x[1],x[2]);let g=kh(Igt);Ah(p,m,g[0],g[1],g[1]),++m}{let x=o,g=kh(Cgt),y=kh(Tgt);for(let b=0;b<x;++b){let v=e[b];f.push(this.getLabelText(t,v,this.labelPointAccessor)),d.push(Hl(t,v)),l[m]=v,c[m]=E$,u[m]=x===1?0:1,Ah(h,m,g[0],g[1],g[2]),Ah(p,m,y[0],y[1],y[2]),++m}}{let x=s,g=kh(Egt),y=kh(Agt);for(let b=0;b<x;++b){let v=n[b].index;f.push(this.getLabelText(t,v,this.labelPointAccessor)),d.push(Hl(t,v)),l[m]=v,Ah(h,m,g[0],g[1],g[2]),Ah(p,m,y[0],y[1],y[2]),++m}}return new wb(new Float32Array(l),f,c,u,wgt,h,p,d)}generatePointScaleFactorArray(t,e,n,r){if(t==null)return new Float32Array(0);let o=new Float32Array(t.points.length);o.fill(Pgt);let s=e==null?0:e.length,a=n==null?0:n.length;{let l=s;for(let c=0;c<l;++c){let u=e[c];o[u]=Ngt}}{let l=a;for(let c=0;c<l;++c){let u=n[c].index;o[u]=Lgt}}return r!=null&&(o[r]=Dgt),o}generateLineSegmentColorMap(t,e){let n={};if(t==null)return n;for(let r=0;r<t.sequences.length;r++){let o=t.sequences[r],s=new Float32Array(2*(o.pointIndices.length-1)*3),a=0;if(e)for(let l=0;l<o.pointIndices.length-1;l++){let c=new zt(e(t,o.pointIndices[l])),u=new zt(e(t,o.pointIndices[l+1]));s[a++]=c.r,s[a++]=c.g,s[a++]=c.b,s[a++]=u.r,s[a++]=u.g,s[a++]=u.b}else for(let l=0;l<o.pointIndices.length-1;l++){let c=R$(l,o.pointIndices.length),u=R$(l+1,o.pointIndices.length);s[a++]=c.r,s[a++]=c.g,s[a++]=c.b,s[a++]=u.r,s[a++]=u.g,s[a++]=u.b}n[r]=s}return n}generateLineSegmentOpacityArray(t,e){if(t==null)return new Float32Array(0);let n=new Float32Array(t.sequences.length);if((e==null?0:e.length)>0){n.fill(Ggt);let o=t.points[e[0]].sequenceIndex;n[o]=Ugt}else n.fill(Hgt);return n}generateLineSegmentWidthArray(t,e){if(t==null)return new Float32Array(0);let n=new Float32Array(t.sequences.length);if(n.fill($gt),(e==null?0:e.length)>0){let o=t.points[e[0]].sequenceIndex;n[o]=Wgt}return n}generatePointColorArray(t,e,n,r,o,s,a,l){if(t==null)return new Float32Array(0);let c=r==null?0:r.length,u=o==null?0:o.length,h=new Float32Array(t.points.length*3),p=T$,f=I$;l&&(a?(p=zgt,f=Fgt):(p=T$,f=I$));{let d=t.points.length,m=0;if(c>0){let x=new zt(p);for(let g=0;g<d;++g)h[m++]=x.r,h[m++]=x.g,h[m++]=x.b}else if(e!=null)for(let x=0;x<d;++x){let g=new zt(e(t,x));h[m++]=g.r,h[m++]=g.g,h[m++]=g.b}else{let x=new zt(f);for(let g=0;g<d;++g)h[m++]=x.r,h[m++]=x.g,h[m++]=x.b}}{let d=c,m=new zt(kgt);for(let x=0;x<d;++x){let g=r[x]*3;h[g++]=m.r,h[g++]=m.g,h[g++]=m.b}}{let d=u,m=d>0?o[0].dist:0;for(let x=0;x<d;++x){let g=new zt(ts(n,o[x].dist,m)),y=o[x].index*3;h[y++]=g.r,h[y++]=g.g,h[y++]=g.b}}if(s!=null){let d=new zt(Rgt),m=s*3;h[m++]=d.r,h[m++]=d.g,h[m++]=d.b}return h}generate3DLabelsArray(t,e){if(t==null||e==null)return null;let n=[],r=t.points.length;for(let o=0;o<r;++o)n.push(this.getLabelText(t,o,e));return n}getLabelText(t,e,n){return t.points[e].metadata[n]!==void 0?String(t.points[e].metadata[n]):`Unknown #${e}`}updateScatterPlotWithNewProjection(t){if(t==null){this.createVisualizers(this.renderLabelsIn3D),this.scatterPlot.render();return}this.setDataSet(t.dataSet),this.scatterPlot.setDimensions(t.dimensionality),t.dataSet.projectionCanBeRendered(t.projectionType)&&(this.updateScatterPlotAttributes(),this.notifyProjectionPositionsUpdated()),this.scatterPlot.setCameraParametersForNextCameraCreation(null,!1)}createVisualizers(t){let e=this.projection==null?null:this.projection.dataSet,n=this.scatterPlot;n.removeAllVisualizers(),this.labels3DVisualizer=null,this.canvasLabelsVisualizer=null,this.spriteVisualizer=null,this.polylineVisualizer=null,this.spriteVisualizer=new Nb,n.addVisualizer(this.spriteVisualizer),this.canvasLabelsVisualizer=new kb(this.scatterPlotContainer),this.polylineVisualizer=new Rb,this.setDataSet(e),this.spriteVisualizer&&!t&&this.spriteVisualizer.clearSpriteAtlas(),this.spriteVisualizer&&n.addVisualizer(this.spriteVisualizer),this.labels3DVisualizer&&n.addVisualizer(this.labels3DVisualizer),this.canvasLabelsVisualizer&&n.addVisualizer(this.canvasLabelsVisualizer),n.addVisualizer(this.polylineVisualizer)}getSpriteImageMode(){if(this.projection==null)return!1;let t=this.projection.dataSet;return t==null||t.spriteAndMetadataInfo==null?!1:t.spriteAndMetadataInfo.spriteImage!=null}};function Ah(i,t,e,n,r){i[t*3]=e,i[t*3+1]=n,i[t*3+2]=r}function kh(i){let t=new zt(i);return[t.r*255|0,t.g*255|0,t.b*255|0]}function R$(i,t){let e=A$+(Ogt-A$)*i/t,n=S2(e,Bgt,Vgt).rgb();return new zt(n.r/255,n.g/255,n.b/255)}function Db(i,t,e){return i===bh?e/t:1-t}function ts(i,t,e){return jgt(Db(i,t,e))}var P$=ut`
  <style include="vz-projector-styles"></style>
  <style>
    #title {
      background-color: #fafafa;
      color: black;
      font-weight: 500;
      left: 0;
      line-height: 60px;
      padding-left: 24px;
      position: absolute;
      width: 276px;
    }
    #bookmark-container {
      background-color: #fafafa;
    }
    #icon-container {
      line-height: 60px;
      position: absolute;
      right: 0;
    }
    #header {
      border-top: 1px solid rgba(0, 0, 0, 0.1);
      position: relative;
    }
    #panel {
      background-color: #fafafa;
      position: relative;
      overflow-y: scroll;
      top: 60px;
      max-height: 50vh;
    }

    #save-container {
      text-align: center;
    }

    .state-radio {
      display: table-cell;
      vertical-align: middle;
      padding-top: 16px;
    }

    .state-label {
      display: table-cell;
      vertical-align: middle;
      top: 14px;
    }

    .state-label-input {
      width: 194px;
    }

    .state-clear {
      display: table-cell;
      vertical-align: middle;
      padding-top: 20px;
    }
    #state-file {
      display: none;
    }
    #no-bookmarks {
      padding: 0 24px;
    }
    #action-buttons-container .add-icon-button {
      background-color: #03a9f4;
      color: white;
      margin: 0 4px 4px auto;
      right: 7px;
      top: -4px;
    }
    .upload-download-icon-button {
      padding: 0;
    }
    #action-buttons-container {
      display: flex;
      margin-left: 34px;
      margin-top: 6px;
    }
    .ink-fab {
      border-radius: 50%;
      background: white;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    }
    paper-textarea {
      --paper-input-container-input: {
        font-size: 12px;
      }
      --paper-font-caption: {
        display: none;
      }
    }
  </style>

  <!-- Bookmarking controls -->
  <div id="bookmark-container">
    <div id="header">
      <div id="title">
        EXPLANABILITY ([[savedStates.length]])
        <paper-icon-button icon="help" class="help-icon"></paper-icon-button>
        <paper-tooltip animation-delay="0" position="top" offset="0">
          Open this drawer to save a set of views of the projection, including
          selected points. A file containing the bookmarks can then be saved and
          later loaded to view them.
        </paper-tooltip>
      </div>
      <div id="icon-container">
        <!-- Icons and event handlers are inverted because the tray expands upwards. -->
        <paper-icon-button
          id="expand-more"
          icon="expand-less"
          on-tap="_expandMore"
        ></paper-icon-button>
        <paper-icon-button
          id="expand-less"
          style="display: none"
          icon="expand-more"
          on-tap="_expandLess"
        ></paper-icon-button>
      </div>
    </div>
    <iron-collapse id="panel">
      <!-- Saving state section -->
      <div id="state-section">
        <template is="dom-if" if="[[!savedStates.length]]">
          <p id="no-bookmarks">
            No bookmarks yet, upload a bookmarks file or add a new bookmark by
            clicking the "+" below.
          </p>
        </template>

        <template is="dom-repeat" items="{{savedStates}}">
          <div class="state-row">
            <div class="state-radio">
              <template is="dom-if" if="{{item.isSelected}}">
                <paper-icon-button
                  icon="radio-button-checked"
                ></paper-icon-button>
              </template>
              <template is="dom-if" if="{{!item.isSelected}}">
                <paper-icon-button
                  icon="radio-button-unchecked"
                  data-index$="{{index}}"
                  on-tap="_radioButtonHandler"
                ></paper-icon-button>
              </template>
            </div>
            <div class="state-label">
              <paper-textarea
                value="[[item.label]]"
                class="state-label-input"
                on-keyup="_labelChange"
                data-index$="[[index]]"
                autoresizing
              ></paper-textarea>
            </div>
            <div class="state-clear">
              <paper-icon-button
                icon="clear"
                data-index$="{{index}}"
                on-tap="_clearButtonHandler"
              ></paper-icon-button>
            </div>
          </div>
        </template>

        <div id="action-buttons-container">
          <paper-icon-button
            class="upload-download-icon-button"
            icon="save"
            title="Save bookmarks"
            disabled="[[!hasStates]]"
            on-tap="_downloadFile"
          ></paper-icon-button>
          <paper-icon-button
            class="upload-download-icon-button"
            icon="file-upload"
            title="Load bookmarks"
            on-tap="_uploadFile"
          ></paper-icon-button>
          <paper-icon-button
            class="add-icon-button ink-fab"
            icon="add"
            title="Add bookmark"
            on-tap="_addBookmark"
          ></paper-icon-button>
          <input type="file" id="state-file" name="state-file" />
        </div>
      </div>
    </iron-collapse>
  </div>
`;var Rh=class extends Oe(ve){constructor(){super(...arguments),this.hasStates=!1}ready(){super.ready(),this.savedStates=[],this.setupUploadButton(),this.ignoreNextProjectionEvent=!1,this.expandLessButton=this.$$("#expand-less"),this.expandMoreButton=this.$$("#expand-more")}initialize(t,e){this.projector=t,e.registerProjectionChangedListener(()=>{this.ignoreNextProjectionEvent?this.ignoreNextProjectionEvent=!1:this.clearStateSelection()})}setSelectedTensor(t,e,n){this.addStates(),e&&e.bookmarksPath?n.getBookmarks(t,e.tensorName,r=>{this.addStates(r),this._expandMore()}):this._expandLess()}_expandMore(){this.$.panel.show(),this.expandMoreButton.style.display="none",this.expandLessButton.style.display=""}_expandLess(){this.$.panel.hide(),this.expandMoreButton.style.display="",this.expandLessButton.style.display="none"}_addBookmark(){let t=this.projector.getCurrentState();t.label="State "+this.savedStates.length,t.isSelected=!0,this.selectedState=this.savedStates.length;for(let e=0;e<this.savedStates.length;e++)this.savedStates[e].isSelected=!1,this.notifyPath("savedStates."+e+".isSelected",!1);this.push("savedStates",t),this.updateHasStates()}_downloadFile(){let t=this.serializeAllSavedStates(),e=new Blob([t],{type:"text/plain"}),n=window.URL.createObjectURL(e),r=document.createElement("a");document.body.appendChild(r),r.style.display="none",Object.assign(r,{href:n}),r.download="state",r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}_uploadFile(){this.$$("#state-file").click()}setupUploadButton(){let t=this.$$("#state-file");t.onchange=()=>{var r;let e=(r=t.files)==null?void 0:r[0];t.value="";let n=new FileReader;n.onload=o=>{let s=n.result,a=JSON.parse(s);this.savedStatesValid(a)?(this.addStates(a),this.loadSavedState(0)):yu(`Unable to load bookmarks: wrong dataset, expected dataset with shape (${a[0].dataSetDimensions}).`)},n.readAsText(e)}}addStates(t){if(t==null)this.savedStates=[];else for(let e=0;e<t.length;e++)t[e].isSelected=!1,this.push("savedStates",t[e]);this.updateHasStates()}clearStateSelection(){for(let t=0;t<this.savedStates.length;t++)this.setSelectionState(t,!1)}_radioButtonHandler(t){let e=this.getBookmarkIndex(t);this.loadSavedState(e),this.setSelectionState(e,!0)}loadSavedState(t){for(let e=0;e<this.savedStates.length;e++)this.savedStates[e].isSelected?this.setSelectionState(e,!1):t===e&&(this.setSelectionState(e,!0),this.ignoreNextProjectionEvent=!0,this.projector.loadState(this.savedStates[e]))}setSelectionState(t,e){this.savedStates[t].isSelected=e;let n="savedStates."+t+".isSelected";this.notifyPath(n,e)}getBookmarkIndex(t){return t.model.__data.index}_clearButtonHandler(t){let e=this.getBookmarkIndex(t);this.splice("savedStates",e,1),this.updateHasStates()}_labelChange(t){let e=this.getBookmarkIndex(t);this.savedStates[e].label=t.target.value}_isSelectedState(t){return t===this.selectedState}_isNotSelectedState(t){return t!==this.selectedState}serializeAllSavedStates(){return JSON.stringify(this.savedStates)}loadSavedStates(t){this.savedStates=JSON.parse(t),this.updateHasStates()}updateHasStates(){this.hasStates=this.savedStates.length!==0}savedStatesValid(t){for(let e=0;e<t.length;e++)if(t[e].dataSetDimensions[0]!==this.projector.dataSet.dim[0]||t[e].dataSetDimensions[1]!==this.projector.dataSet.dim[1])return!1;return!0}};Rh.template=P$;wt([Rt({type:Object}),ht("design:type",Array)],Rh.prototype,"savedStates",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],Rh.prototype,"hasStates",void 0);wt([Rt({type:Number}),ht("design:type",Number)],Rh.prototype,"selectedState",void 0);Rh=wt([Fe("vz-projector-bookmark-panel")],Rh);var Ph=class extends ve{get _parts(){var t=this.value,e=this.delimiterPattern;let n=[];for(;;){let r=new RegExp(e,"g");if(r.test(t),r.lastIndex===0){n.push(t);break}else n.push(t.slice(0,r.lastIndex)),t=t.slice(r.lastIndex)}return n}};Ph.template=ut`
    <!--
      This ugly formatting is required to prevent spaces from slipping
      into the HTML.
    -->
    <template is="dom-repeat" items="[[_parts]]" as="part"
      >[[part]]<wbr
    /></template>
  `;wt([Rt({type:String}),ht("design:type",String)],Ph.prototype,"value",void 0);wt([Rt({type:String}),ht("design:type",String)],Ph.prototype,"delimiterPattern",void 0);wt([R5("value","delimiterPattern"),ht("design:type",Array),ht("design:paramtypes",[])],Ph.prototype,"_parts",null);Ph=wt([Fe("tf-wbr-string")],Ph);var N$=ut`
  <style include="vz-projector-styles"></style>
  <style>
    .container {
      padding: 5px 20px 20px 20px;
    }

    input[type='file'] {
      display: none;
    }

    .file-name {
      margin-right: 10px;
    }

    .dirs {
      color: rgba(0, 0, 0, 0.7);
      font-size: 12px;
    }

    .dirs table tr {
      vertical-align: top;
    }

    .dirs table tr td {
      padding-bottom: 10px;
    }

    paper-item {
      --paper-item-disabled: {
        border-bottom: 1px solid black;
        justify-content: center;
        font-size: 12px;
        line-height: normal;
        min-height: 0px;
      }
    }

    .item-details {
      margin-left: 5px;
      color: gray;
      font-size: 12px;
    }

    paper-input {
      font-size: 15px;
      --paper-input-container: {
        padding: 5px 0;
      }
      --paper-input-container-label-floating: {
        white-space: normal;
        line-height: normal;
      }
    }

    paper-dropdown-menu {
      width: 100%;
      --paper-input-container: {
        padding: 5px 0;
      }
      --paper-input-container-input: {
        font-size: 15px;
      }
      --paper-input-container-label-floating: {
        white-space: normal;
        line-height: normal;
      }
    }

    paper-dropdown-menu paper-item {
      justify-content: space-between;
    }

    .title {
      align-items: center;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      color: black;
      display: flex;
      font-weight: 500;
      height: 59px;
      padding-left: 20px;
    }

    #normalize-data-checkbox {
      margin: 10px 0;
    }

    #projector-config-template {
      --paper-input-container-input: {
        line-height: 13px;
        font-family: monospace;
        font-size: 12px;
      }
    }

    #generate-share-url {
      padding: 16px;
      margin-left: 24px;
    }

    #projector-share-button-container {
      margin: 10px 0;
    }

    .metadata-editor,
    .supervise-settings,
    .colorlabel-container {
      display: flex;
    }

    #labelby {
      width: 100px;
      margin-right: 10px;
    }

    #colorby {
      width: calc(100% - 110px);
    }

    [hidden] {
      display: none;
    }

    .supervise-settings paper-dropdown-menu {
      width: 100px;
      margin-right: 10px;
    }

    .supervise-settings paper-input {
      width: calc(100% - 110px);
    }

    .citation-container {
      width: calc(100% - 10px);
      margin-bottom: 10px;
    }

    .metadata-editor paper-dropdown-menu {
      width: 100px;
      margin-right: 10px;
    }

    .metadata-editor paper-input {
      width: calc(100% - 110px);
    }

    .config-checkbox {
      display: inline-block;
      font-size: 11px;
      margin-left: 10px;
    }

    .projector-config-options {
      margin-top: 12px;
    }

    .projector-config-dialog-container {
      padding: 24px;
    }

    .code {
      background-color: #f7f7f7;
      display: table;
      font-family: monospace;
      margin-top: 7px;
      padding: 15px;
    }

    .delimiter {
      color: #b71c1c;
    }

    .button-container {
      flex: 1 100%;
      margin-right: 5px;
    }

    .button-container paper-button {
      min-width: 50px;
      width: 100%;
    }

    #label-button {
      margin-right: 0px;
    }

    .upload-step {
      display: flex;
      justify-content: space-between;
      margin-bottom: 6px;
    }

    .upload-step paper-button {
      margin-left: 30px;
    }

    .step-label {
      color: rgb(38, 180, 226);
    }

    .scrollable-container {
      margin-top: 0;
      min-width: 400px;
    }

    #projectorConfigDialog p {
      margin: 8px 0 8px;
    }

    .data-step {
      margin-top: 40px;
    }

    .data-step-contents {
      display: table;
      width: 100%;
    }

    .data-step-contents-contents {
      display: table-cell;
      margin-top: 6px;
    }

    .data-step-contents-upload {
      display: table-cell;
      text-align: right;
      vertical-align: bottom;
    }

    #demo-data-buttons-container {
      display: none;
      margin-top: 10px;
    }

    .scrollable-text {
      display: block; /* Make the span behave like a block element */
      white-space: nowrap; /* Prevent line breaks within the text */
      overflow-x: scroll; /* Enable horizontal scroll for overflow */
      max-width: fit-content; /* Limit the width to content size (optional) */
    }

    #scrollable-text {
      display: block;
      white-space: nowrap;
      overflow-x: hidden; /* Initially hide the scrollbar */
      transition: overflow 0.2s ease-in-out; /* Add smooth transition */
    }
    
    #scrollable-text:hover {
      overflow-x: scroll; /* Show scrollbar on hover */
    }

    .horizontal-line {
      border-top: 1px solid #ccc; /* Change these values to customize the line */
      width: 100%; /* Adjust the width as needed */
      margin: 10px 0; /* Add spacing above and below the line (optional) */
    }

    .toggle-button-container {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
  
    .toggle-button-container paper-button {
      margin-right: 10px;
    }
    
  </style>
  <div class="title">DATA</div>
  <div class="container">
    <!-- List of runs -->
    <template is="dom-if" if="[[_hasChoices(runNames)]]">
      <paper-dropdown-menu
        no-animations
        label="[[_getNumRunsLabel(runNames)]] found"
      >
        <paper-listbox
          attr-for-selected="value"
          class="dropdown-content"
          selected="{{selectedRun}}"
          slot="dropdown-content"
        >
          <template is="dom-repeat" items="[[runNames]]">
            <paper-item value="[[item]]" label="[[item]]">
              [[item]]
            </paper-item>
          </template>
        </paper-listbox>
      </paper-dropdown-menu>
    </template>

    <template is="dom-if" if="[[tensorNames]]">
      <!-- List of tensors in checkpoint -->
      <paper-dropdown-menu
        no-animations
        label="[[_getNumTensorsLabel(tensorNames)]] found"
        id='datasets_dropdown'
      >
        <paper-listbox
          attr-for-selected="value"
          class="dropdown-content"
          selected="{{selectedTensor}}"
          slot="dropdown-content"
        >
          <template is="dom-repeat" items="[[tensorNames]]">
            <paper-item value="[[item.name]]" label="[[item.name]]">
              [[item.name]]
              <span class="item-details">
                [[item.shape.0]]x[[item.shape.1]]
              </span>
            </paper-item>
          </template>
        </paper-listbox>
      </paper-dropdown-menu>
    </template>

    <div hidden$="[[!_hasChoices(colorOptions)]]">
      <div class="colorlabel-container">
        <!-- Label by -->
        <paper-dropdown-menu id="labelby" no-animations label="Tag by">
          <paper-listbox
            attr-for-selected="value"
            class="dropdown-content"
            selected="{{selectedLabelOption}}"
            slot="dropdown-content"
          >
            <template is="dom-repeat" items="[[labelOptions]]">
              <paper-item value="[[item]]" label="[[item]]">
                [[item]]
              </paper-item>
            </template>
          </paper-listbox>
        </paper-dropdown-menu>
        <!-- Color by -->
        <paper-dropdown-menu id="colorby" no-animations label="Color by">
          <paper-listbox
            attr-for-selected="value"
            class="dropdown-content"
            selected="{{selectedColorOptionName}}"
            slot="dropdown-content"
          >
            <template is="dom-repeat" items="[[colorOptions]]">
              <paper-item
                class$="[[getSeparatorClass(item.isSeparator)]]"
                value="[[item.name]]"
                label="[[item.name]]"
                disabled="[[item.isSeparator]]"
              >
                [[item.name]]
                <span class="item-details">[[item.desc]]</span>
              </paper-item>
            </template>
          </paper-listbox>
        </paper-dropdown-menu>
      </div>
      <div hidden$="[[!showForceCategoricalColorsCheckbox]]">
        <paper-checkbox id="force-categorical-checkbox"
          >Use categorical coloring</paper-checkbox
        >
        <paper-icon-button icon="help" class="help-icon"></paper-icon-button>
        <paper-tooltip
          position="bottom"
          animation-delay="0"
          fit-to-visible-bounds
        >
          For metadata fields that have many unique values we use a gradient
          color map by default. This checkbox allows you to force categorical
          coloring by a given metadata field.
        </paper-tooltip>
      </div>
      <template is="dom-if" if="[[colorLegendRenderInfo]]">
        <vz-projector-legend
          render-info="[[colorLegendRenderInfo]]"
        ></vz-projector-legend>
      </template>
    </div>
    <div style="display: none">
      <paper-checkbox id="normalize-data-checkbox" checked="{{normalizeData}}">
        Spherize data
      </paper-checkbox>
      <paper-icon-button
        id="normalize-data-help"
        icon="help"
        class="help-icon"
      ></paper-icon-button>
      <paper-tooltip
        for="normalize-data-help"
        position="bottom"
        animation-delay="0"
        fit-to-visible-bounds
      >
        The data is normalized by shifting each point by the centroid and making
        it unit norm.
      </paper-tooltip>
    </div>
    <div>
      <template is="dom-if" if="[[dataCitation]]">
        <span id="scrollable-text">Data Source: [[dataCitation]]</span><br>
      </template>
    </div>
    <div id="demo-data-buttons-container">
      <span class="button-container">
        <paper-tooltip
          position="bottom"
          animation-delay="0"
          fit-to-visible-bounds
        >
          Load data from your computer
        </paper-tooltip>
        <paper-button id="upload" class="ink-button" on-tap="_openDataDialog"
          >Load</paper-button
        >
      </span>
      <span id="publish-container" class="button-container">
        <paper-tooltip
          position="bottom"
          animation-delay="0"
          fit-to-visible-bounds
        >
          Publish your embedding visualization and data
        </paper-tooltip>
        <paper-button
          id="host-embedding"
          class="ink-button"
          on-tap="_openConfigDialog"
          >Publish</paper-button
        >
      </span>
      <span class="button-container">
        <paper-tooltip
          position="bottom"
          animation-delay="0"
          fit-to-visible-bounds
        >
          Download the metadata with applied modifications
        </paper-tooltip>
        <paper-button class="ink-button" on-click="downloadMetadataClicked"
          >Download</paper-button
        >
        <a href="#" id="downloadMetadataLink" hidden></a>
      </span>
      <span id="label-button" class="button-container">
        <paper-tooltip
          position="bottom"
          animation-delay="0"
          fit-to-visible-bounds
        >
          Label selected metadata
        </paper-tooltip>
        <paper-button
          class="ink-button"
          on-click="metadataEditorButtonClicked"
          disabled="[[metadataEditorButtonDisabled]]"
          >Label</paper-button
        >
      </span>
    </div>
    <template is="dom-if" if="[[_hasChoice(labelOptions)]]">
      <!-- Supervise by -->
      <div hidden$="[[!showSuperviseSettings]]" class="supervise-settings">
        <paper-dropdown-menu no-animations label="Supervise with">
          <paper-listbox
            attr-for-selected="value"
            class="dropdown-content"
            on-selected-item-changed="superviseColumnChanged"
            selected="{{superviseColumn}}"
            slot="dropdown-content"
          >
            <template is="dom-repeat" items="[[metadataFields]]">
              <paper-item value="[[item]]" label="[[item]]">
                [[item]]
              </paper-item>
            </template>
          </paper-listbox>
        </paper-dropdown-menu>
        <paper-input
          value="{{superviseInput}}"
          label="{{superviseInputLabel}}"
          on-change="superviseInputChange"
          on-input="superviseInputTyping"
        >
        </paper-input>
      </div>
      <!-- Edit by -->
      <div class="metadata-editor" style="display: none">
        <paper-dropdown-menu no-animations label="Edit label by">
       
        
          <paper-listbox
            attr-for-selected="value"
            class="dropdown-content"
            slot="dropdown-content"
            on-selected-item-changed="metadataEditorColumnChange"
            selected="{{metadataEditorColumn}}"
          >
            <template is="dom-repeat" items="[[metadataFields]]">
              <paper-item value="[[item]]" label="[[item]]">
                [[item]]
              </paper-item>
            </template>
          </paper-listbox>
        </paper-dropdown-menu>
        <paper-input
          value="{{metadataEditorInput}}"
          label="{{metadataEditorInputLabel}}"
          on-input="metadataEditorInputChange"
          on-keydown="metadataEditorInputKeydown"
        >
        </paper-input>
      </div>
    </template>
    <div hidden$="[[!_hasChoices(colorOptions)]]">
      <hr class="horizontal-line">
      <vz-projector-self-consistency-panel id="self-consistency-panel"></vz-projector-self-consistency-panel>
      <span id="score-button" class="button-container">
        <paper-tooltip
          position="bottom"
          animation-delay="0"
          fit-to-visible-bounds
        >
          Calculate self-consistent score for all labels
        </paper-tooltip>
        <paper-button
          class="ink-button"
          on-click="selfConsistencyButtonClicked"
          >Run
        </paper-button>
      </span>
    </div>
    <div>
    <hr class="horizontal-line">
    <p> Principle Projection Map </p>
    <template is="dom-repeat" items="[[projectionButtonList]]">
      <div class="toggle-button-container">
        <paper-toggle-button checked="{{item.checked}}" on-change="handleToggleProjectionChange" data-index="{{index}}"></paper-toggle-button>
        <paper-button raised on-tap="toggleProjectionButton" data-index="{{index}}">{{item.label}}</paper-button>
      </div>
    </template>
    </div>
    <div>
      <paper-dialog id="dataDialog" with-backdrop>
        <h2>Load data from your computer</h2>
        <paper-dialog-scrollable class="scrollable-container">
          <div class="data-step" id="upload-tensors-step-container">
            <div class="upload-step">
              <div>
                <b
                  ><span class="step-label">Step 1:</span> Load a TSV file of
                  vectors.</b
                >
              </div>
            </div>
            <div class="data-step-contents">
              <div class="data-step-contents-contents">
                Example of 3 vectors with dimension 4:
                <div class="code">
                  0.1<span class="delimiter">&#92;t</span>0.2<span
                    class="delimiter"
                    >&#92;t</span
                  >0.5<span class="delimiter">&#92;t</span>0.9<br />
                  0.2<span class="delimiter">&#92;t</span>0.1<span
                    class="delimiter"
                    >&#92;t</span
                  >5.0<span class="delimiter">&#92;t</span>0.2<br />
                  0.4<span class="delimiter">&#92;t</span>0.1<span
                    class="delimiter"
                    >&#92;t</span
                  >7.0<span class="delimiter">&#92;t</span>0.8
                </div>
              </div>
              <div class="data-step-contents-upload">
                <paper-button
                  id="upload-tensors"
                  title="Choose a TSV tensor file"
                  >Choose file</paper-button
                >
                <input type="file" id="file" name="file" />
              </div>
            </div>
          </div>
          <div class="data-step">
            <div class="upload-step">
              <div>
                <span class="step-label" id="upload-metadata-label"
                  ><b>Step 2</b> (optional):</span
                >
                <b>Load a TSV file of metadata.</b>
              </div>
            </div>
            <div class="data-step-contents">
              <div class="data-step-contents-contents">
                Example of 3 data points and 2 columns.<br />
                <i
                  >Note: If there is more than one column, the first row will be
                  parsed as column labels.</i
                >
                <div class="code">
                  <b>Pokmon<span class="delimiter">&#92;t</span>Species</b
                  ><br />
                  Wartortle<span class="delimiter">&#92;t</span>Turtle<br />
                  Venusaur<span class="delimiter">&#92;t</span>Seed<br />
                  Charmeleon<span class="delimiter">&#92;t</span>Flame
                </div>
              </div>
              <div class="data-step-contents-upload">
                <paper-button
                  id="upload-metadata"
                  title="Choose a TSV metadata file"
                  class="ink-button"
                  >Choose file</paper-button
                >
                <input type="file" id="file-metadata" name="file-metadata" />
              </div>
            </div>
          </div>
        </paper-dialog-scrollable>
        <div class="dismiss-dialog-note">Click outside to dismiss.</div>
      </paper-dialog>
      <paper-dialog id="projectorConfigDialog" with-backdrop>
        <h2>Publish your embedding visualization and data</h2>
        <paper-dialog-scrollable class="scrollable-container">
          <div>
            <p>
              If you'd like to share your visualization with the world, follow
              these simple steps. See
              <a
                target="_blank"
                rel="noopener noreferrer"
                href="https://www.tensorflow.org/get_started/embedding_viz"
                >this tutorial</a
              >
              for more.
            </p>
            <h4><span class="step-label">Step 1:</span> Make data public</h4>
            <p>
              Host tensors, metadata, sprite image, and bookmarks TSV files
              <i>publicly</i> on the web.
            </p>
            <p>
              One option is using a
              <a
                target="_blank"
                href="https://gist.github.com/"
                rel="noopener noreferrer"
                >github gist</a
              >. If you choose this approach, make sure to link directly to the
              raw file.
            </p>
          </div>
          <div>
            <h4><span class="step-label">Step 2:</span> Projector config</h4>
            <div class="projector-config-options">
              <i>Optional:</i>
              <div class="config-checkbox">
                <paper-checkbox id="config-metadata-checkbox" checked
                  >Metadata</paper-checkbox
                >
              </div>
              <div class="config-checkbox">
                <paper-checkbox id="config-sprite-checkbox"
                  >Sprite</paper-checkbox
                >
              </div>
              <div class="config-checkbox">
                <paper-checkbox id="config-bookmarks-checkbox"
                  >Bookmarks</paper-checkbox
                >
              </div>
            </div>
          </div>
          <paper-textarea
            id="projector-config-template"
            label="template_projector_config.json"
          ></paper-textarea>
          <div>
            <h4>
              <span class="step-label">Step 3:</span> Host projector config
            </h4>
            After you have hosted the projector config JSON file you built
            above, paste the URL to the config below.
          </div>
          <paper-input
            id="projector-config-url"
            label="Path to projector config"
          ></paper-input>
          <paper-input
            id="projector-share-url"
            label="Your shareable URL"
            readonly
          ></paper-input>
          <div id="projector-share-button-container">
            <a
              target="_blank"
              id="projector-share-url-link"
              rel="noopener noreferrer"
            >
              <paper-button title="Test your shareable URL" class="ink-button"
                >Test your shareable URL</paper-button
              >
            </a>
          </div>
        </paper-dialog-scrollable>
        <div class="dismiss-dialog-note">Click outside to dismiss.</div>
      </paper-dialog>
    </div>
  </div>
`;var wm=class extends Oe(ve){_renderInfoChanged(){var t;this.renderInfo!=null&&(t=this.renderInfo.thresholds)!=null&&t.length&&this.async(()=>this.setupLinearGradient(),150)}_getLastThreshold(){var t;if(!(this.renderInfo==null||!((t=this.renderInfo.thresholds)!=null&&t.length)))return this.renderInfo.thresholds[this.renderInfo.thresholds.length-1].value}getOffset(t){let e=this.renderInfo.thresholds[0].value,n=this.renderInfo.thresholds[this.renderInfo.thresholds.length-1].value;return(100*(t-e)/(n-e)).toFixed(2)+"%"}setupLinearGradient(){let t=this.$$("#gradient"),e=this.$$("svg.gradient").clientWidth;this.$$("svg.gradient rect").style.width=e+"px",t.textContent="",this.renderInfo.thresholds.forEach(n=>{let r=document.createElementNS("http://www.w3.org/2000/svg","stop");r.setAttribute("offset",this.getOffset(n.value)),r.setAttribute("stop-color",n.color),t.appendChild(r)})}};wm.template=ut`
    <style include="vz-projector-styles"></style>
    <style>
      .item {
        display: flex;
        align-items: flex-start;
        margin-bottom: 10px;
      }

      .shape {
        width: 10px;
        height: 10px;
        margin-right: 10px;
        margin-top: 5px;
        border-radius: 50%;
      }

      .label {
        flex-grow: 1;
      }

      .gradient {
        width: 100%;
        height: 10px;
      }

      .gradient-boundaries {
        display: flex;
        justify-content: space-between;
      }
    </style>

    <template is="dom-repeat" items="[[renderInfo.items]]">
      <div class="item">
        <div class="shape" style="background-color: [[item.color]];"></div>
        <div class="label">[[item.label]]</div>
        <div class="info" style="color: [[item.color]];">[[item.count]]</div>
      </div>
    </template>

    <template is="dom-if" if="[[renderInfo.thresholds?.length]]">
      <svg class="gradient">
        <defs>
          <linearGradient
            id="gradient"
            x1="0%"
            y1="100%"
            x2="100%"
            y2="100%"
          ></linearGradient>
        </defs>
        <rect height="10" style="fill: url('#gradient');"></rect>
      </svg>
      <div class="gradient-boundaries">
        <div>[[renderInfo.thresholds.0.value]]</div>
        <div>[[_getLastThreshold(renderInfo.thresholds)]]</div>
      </div>
    </template>
  `;wt([Rt({type:Object}),ht("design:type",Object)],wm.prototype,"renderInfo",void 0);wt([Nn("renderInfo"),ht("design:type",Function),ht("design:paramtypes",[]),ht("design:returntype",void 0)],wm.prototype,"_renderInfoChanged",null);wm=wt([Fe("vz-projector-legend")],wm);var L$=ut`
  <style include="vz-projector-styles"></style>
  <style>
    :host {
      display: flex;
      flex-direction: column;
    }

    .stage {
      position: relative;
      flex-grow: 2;
    }
    
    .container {
      width: 100%;
      min-height: 0px;
      padding: 5px 0px 0px 0px;
      font-size: 15px;
    }

    .buttons {
      display: flex;
    }

    .button {
      margin-right: 10px;
      border: none;
      border-radius: 7px;
      font-size: 13px;
      padding: 10px;
      background: #e3e3e3;
    }

    .button:last-child {
      margin-right: 0;
    }

    .label-control {
      width: 100%;
      padding: 2px;
      margin-right: 5px;
      display: flex;
      flex-directon: row;
    }
    
    .binary-selected, .label-control input:not(:placeholder-shown) {
      background: #ADD8E6;
    }

    .label-and-value {
      display: flex;
      justify-content: space-between;
      padding: 10px;
    }

    .label {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .value {
      color: #666;
      float: right;
      font-weight: 500;
      margin-left: 8px;
    }

    .bar {
      position: relative;
      border-top: 1px solid rgba(0, 0, 0, 0.15);
      margin: 2px 0;
    }

    .bar .fill {
      position: absolute;
      top: -1px;
      border-top: 1px solid white;
    }

    .tick {
      position: absolute;
      top: 0px;
      height: 3px;
      border-left: 1px solid rgba(0, 0, 0, 0.15);
    }

    .label-link:hover {
      cursor: pointer;
    }

    .scrollable-container {
      margin-top: 0;
      min-width: 400px;
    }

  </style>
  <div id="dialog" class="container">
    <p>Self-consistency label score <paper-icon-button icon="help" class="help-icon"> </paper-icon-button><paper-tooltip
          position="bottom"
          animation-delay="0"
          fit-to-visible-bounds
        >The probability of a pair of most similar traces having the same label value. For further details, please refer to [citation].
    </paper-tooltip></p>
    <div id="stats"></div>
    <div class="buttons">
    </div>
  </div>
`;var qgt=1e4,Xgt=1,Fb=class extends Oe(ve){ready(){super.ready()}initialize(t){this.projector=t}open(){return $t(this,null,function*(){let t=he("Analyzing label self-consistency...");yield this.runAnalysis(),yield this.setupUI(this.projector).then(()=>{he(null,t)})})}clean(){let t=this.$$("#stats");t.innerHTML=""}getTraceFromIndex(t){let e=this.projector.dataSet.points[t].metadata.donor,n=e!==void 0?e:[],r=this.projector.dataSet.points[t].metadata.acceptor,o=r!==void 0?r:[];return n.map((a,l)=>({time:l,donor:n[l],acceptor:o[l]}))}traceRenderer(t){let e=document.createElement("div"),n=this.getTraceFromIndex(t);return es(e,n,{width:600}),e}runAnalysis(){let t=this.$$("#trace-list")}setupUI(t){return $t(this,null,function*(){this.numTraces=Math.min(this.projector.dataSet.points.length,qgt);let e=this.$$("#stats");e.innerHTML="";let n=bh;console.log(this.projector.dataSet.spriteAndMetadataInfo.stats);for(let r=0;r<this.projector.dataSet.spriteAndMetadataInfo.stats.length;r++){let o=this.projector.dataSet.spriteAndMetadataInfo.stats[r];if(o.tooManyUniqueValues)continue;let s=yield this.projector.dataSet.computeSelfConsistency(Xgt,o.name),a=document.createElement("div"),l=document.createElement("p");l.innerText=`${o.name}:`,a.appendChild(l);for(let[c,u]of s){let h=u.consistentNN/u.totalNN,p=document.createElement("a");p.className="label-link";let f=document.createElement("div");f.className="label-and-value";let d=document.createElement("div");d.className="label";let m=o.uniqueEntries.find(v=>v.label==c);d.innerText="label="+c+`, n=${m==null?void 0:m.count}`;let x=document.createElement("div");x.className="value",x.style.color=ts(n,1,h),x.innerText="score="+h.toFixed(3),f.appendChild(d),f.appendChild(x);let g=document.createElement("div");g.className="bar";let y=document.createElement("div");y.className="fill",y.style.borderTopColor=ts(n,1,h),y.style.width=h*100+"%",g.appendChild(y);for(let v=1;v<4;v++){let _=document.createElement("div");_.className="tick",_.style.left=v*100/4+"%",g.appendChild(_)}p.appendChild(f),a.appendChild(p),a.appendChild(g);let b=this.projector.dataSet.query(`${c}`,!1,`${o.name}`);p.onclick=()=>{this.projector.notifySelectionChanged(b)}}e.appendChild(a)}})}};Fb.template=L$;wt([Rt({type:Number}),ht("design:type",Number)],Fb.prototype,"numTraces",void 0);Fb=wt([Fe("vz-projector-self-consistency-panel")],Fb);var en=class extends Oe(ve){constructor(){super(...arguments),this.metadataEditorInputLabel="Tag selection as",this.superviseInputLabel="Ignored label",this.showSuperviseSettings=!1,this._wordDelimiter="[/=_,-]",this.forceCategoricalColoring=!1}ready(){super.ready(),this.normalizeData=!0,this.superviseInputSelected=""}initialize(t,e){var r;this.projector=t,this.dataProvider=e,this.setupUploadButtons(),(r=this.$$("#normalize-data-checkbox"))==null||r.addEventListener("change",()=>{this.projector.setNormalizeData(this.normalizeData),this.updatePrincipleProjection()});let n=this.$$("#force-categorical-checkbox");n==null||n.addEventListener("change",()=>{this.setForceCategoricalColoring(n.checked)}),this.dataProvider.retrieveRuns(o=>{this.runNames=o,this.runNames.length>0&&(this.selectedRun!=o[0]?this.selectedRun=o[0]:this._generateUiForNewCheckpointForRun(this.selectedRun))}),this.dataProvider.retrievePrincipleMatrices(o=>{this.projector.principleMatrices=o,this.projectionButtonList=[];for(let s of o.names)this.projectionButtonList.push({label:s,checked:!0})}),this.selfConsistencyPanel=this.$["self-consistency-panel"],this.selfConsistencyPanel.initialize(this.projector)}setForceCategoricalColoring(t){this.forceCategoricalColoring=t,this.$$("#force-categorical-checkbox").checked=this.forceCategoricalColoring,this.updateMetadataUI(this.spriteAndMetadata.stats,this.metadataFile),this._selectedColorOptionNameChanged()}getSeparatorClass(t){return t?"separator":null}metadataChanged(t,e){this.spriteAndMetadata=t,e!=null&&(this.metadataFile=e),this.updateMetadataUI(this.spriteAndMetadata.stats,this.metadataFile),(this.selectedColorOptionName==null||this.colorOptions.filter(r=>r.name===this.selectedColorOptionName).length===0)&&(this.selectedColorOptionName=this.colorOptions[0].name);let n=-1;t.stats&&(this.metadataFields=t.stats.map((r,o)=>(!r.isNumeric&&n===-1&&(n=o),r.name))),(this.metadataEditorColumn==null||this.metadataFields.filter(r=>r===this.metadataEditorColumn).length===0)&&(this.metadataEditorColumn=this.metadataFields[Math.max(0,n)]),(this.superviseColumn==null||this.metadataFields.filter(r=>r===this.superviseColumn).length===0)&&(this.superviseColumn=this.metadataFields[Math.max(0,n)],this.superviseInput=""),this.superviseInputChange(),this.selfConsistencyPanel.clean()}projectionChanged(t){if(t)switch(t.projectionType){case"tsne":this.set("showSuperviseSettings",!0);break;default:this.set("showSuperviseSettings",!1)}}onProjectorSelectionChanged(t,e){this.selectedPointIndices=t,this.neighborsOfFirstPoint=e,this.metadataEditorInputChange()}updateMetadataUI(t,e){let n=-1;this.labelOptions=t.map((s,a)=>(!s.isNumeric&&n===-1&&(n=a),s.name)),(this.selectedLabelOption==null||this.labelOptions.filter(s=>s===this.selectedLabelOption).length===0)&&(this.selectedLabelOption=this.labelOptions[Math.max(0,n)]),(this.metadataEditorColumn==null||this.labelOptions.filter(s=>s===this.metadataEditorColumn).length===0)&&(this.metadataEditorColumn=this.labelOptions[Math.max(0,n)]);let r=[{name:"No color map"}],o=t.filter(s=>!s.tooManyUniqueValues||s.isNumeric).map(s=>{var p;let a,l=[],c=[],u=this.forceCategoricalColoring||!s.tooManyUniqueValues,h;if(u){let f=mh(dE),d=f.range(),m=d.map((g,y)=>{let b=y*3%d.length;return d[b]});l=s.uniqueEntries,s.isNumeric&&(l.forEach(g=>g.label=parseFloat(g.label).toString()),l.sort((g,y)=>parseFloat(g.label)-parseFloat(y.label))),f.range(m).domain(l.map(g=>g.label)),a=f;let x=(p=s.uniqueEntries)==null?void 0:p.length;h=`${x} ${x>d.length?" non-unique":""} colors`}else c=[{color:"#ffffdd",value:s.min},{color:"#1f2d86",value:s.max}],a=mi().domain(c.map(f=>f.value)).range(c.map(f=>f.color)),h="gradient";return{name:s.name,desc:h,map:a,items:l,thresholds:c,tooManyUniqueValues:s.tooManyUniqueValues}});o.length>0&&r.push({name:"Metadata",isSeparator:!0}),this.colorOptions=r.concat(o)}metadataEditorContext(t){this.metadataEditorButtonDisabled=!t,this.projector&&this.projector.metadataEditorContext(t,this.metadataEditorColumn)}metadataEditorInputChange(){var r;let t=this.metadataEditorColumn,e=this.metadataEditorInput,n=this.selectedPointIndices.length+this.neighborsOfFirstPoint.length;n>0?e!=null&&e.trim()!==""?((r=this.spriteAndMetadata.stats)==null?void 0:r.filter(o=>o.name===t)[0].isNumeric)&&isNaN(+e)?(this.metadataEditorInputLabel="Label must be numeric",this.metadataEditorContext(!1)):(this.projector.dataSet.points.filter(s=>s.metadata[t].toString()===e.trim()).length===0?this.metadataEditorInputLabel=`Tag ${n} with new label`:this.metadataEditorInputLabel=`Tag ${n} points as`,this.metadataEditorContext(!0)):(this.metadataEditorInputLabel="Tag selection as",this.metadataEditorContext(!1)):(this.metadataEditorContext(!1),e!=null&&e.trim()!==""?this.metadataEditorInputLabel="Select points to tag":this.metadataEditorInputLabel="Tag selection as")}metadataEditorInputKeydown(t){t.keyCode===13&&this.metadataEditorButtonClicked(),t.stopPropagation()}metadataEditorColumnChange(){this.metadataEditorInputChange()}metadataEditorButtonClicked(){if(!this.metadataEditorButtonDisabled){let t=this.metadataEditorInput.trim(),e=this.selectedPointIndices.length+this.neighborsOfFirstPoint.length;this.projector.metadataEdit(this.metadataEditorColumn,t),this.projector.metadataEditorContext(!0,this.metadataEditorColumn),this.metadataEditorInputLabel=`${e} labeled as '${t}'`}}downloadMetadataClicked(){if(this.projector&&this.projector.dataSet&&this.projector.dataSet.spriteAndMetadataInfo){let t="";this.projector.dataSet.spriteAndMetadataInfo.pointsInfo.forEach((r,o)=>{if(o===0){let a=[];for(let l in r)a.push(l);t+=a.join("	")}let s=[];for(let a in r)a==="donor"||a==="acceptor"?s.push(JSON.stringify(r[a])):s.push(r[a]);t+=`
`+s.join("	")});let e=new Blob([t],{type:"text/plain"}),n=this.$.downloadMetadataLink;n.download="metadata-edited.tsv",Object.assign(n,{href:window.URL.createObjectURL(e)}),n.click()}}selfConsistencyButtonClicked(){this.selfConsistencyPanel.open()}superviseInputTyping(){let t=this.superviseInput.trim();if(t==null||t.trim()===""){this.superviseInputSelected===""?this.superviseInputLabel="No ignored label":this.superviseInputLabel=`Supervising without '${this.superviseInputSelected}'`;return}if(this.projector&&this.projector.dataSet){let e=this.projector.dataSet.points.filter(n=>n.metadata[this.superviseColumn].toString().trim()===t).length;e===0?this.superviseInputLabel="Label not found":this.projector.dataSet.superviseInput!=t&&(this.superviseInputLabel=`Supervise without '${t}' [${e} points]`)}}superviseInputChange(){let t=this.superviseInput.trim();if(t==null||t.trim()===""){this.superviseInputSelected="",this.superviseInputLabel="No ignored label",this.setSupervision(this.superviseColumn,"");return}if(this.projector&&this.projector.dataSet){let e=this.projector.dataSet.points.filter(n=>n.metadata[this.superviseColumn].toString().trim()===t).length;e===0?this.superviseInputLabel=`Supervising without '${this.superviseInputSelected}'`:(this.superviseInputSelected=t,this.superviseInputLabel=`Supervising without '${t}' [${e} points]`,this.setSupervision(this.superviseColumn,t))}}superviseColumnChanged(){this.superviseInput="",this.superviseInputChange()}setSupervision(t,e){this.projector&&this.projector.dataSet&&this.projector.dataSet.setSupervision(t,e)}setNormalizeData(t){this.normalizeData=t}_selectedTensorChanged(){if(this.projector.updateDataSet(null,null,null),this.selfConsistencyPanel.clean(),this.selectedTensor!=null&&(this.dataProvider.retrieveTensor(this.selectedRun,this.selectedTensor,t=>{var n;let e=(n=this.getEmbeddingInfoByName(this.selectedTensor))==null?void 0:n.metadataPath;this.dataProvider.retrieveSpriteAndMetadata(this.selectedRun,this.selectedTensor,r=>{var o;this.projector.updateDataSet(t,r,e),this.dataCitation=(o=this.getEmbeddingInfoByName(this.selectedTensor))==null?void 0:o.dataCitation,this._selectedColorOptionNameChanged()})}),this.projector.setSelectedTensor(this.selectedRun,this.getEmbeddingInfoByName(this.selectedTensor)),this.projector.principleMatrices)){this.projectionButtonList=[];for(let t of this.projector.principleMatrices.names)this.projectionButtonList.push({label:t,checked:!0})}}_generateUiForNewCheckpointForRun(t){this.dataProvider.retrieveProjectorConfig(t,e=>{this.projectorConfig=e;let n=this.projectorConfig.embeddings.map(o=>o.tensorName).filter(o=>{var a;let s=(a=this.getEmbeddingInfoByName(o))==null?void 0:a.tensorShape;return(s==null?void 0:s.length)===2&&s[1]>1}).sort((o,s)=>{let a=this.getEmbeddingInfoByName(o),l=this.getEmbeddingInfoByName(s);if(x4(!!(a!=null&&a.metadataPath),!!(l!=null&&l.metadataPath)))return a!=null&&a.metadataPath?-1:1;let c=g4(o),u=g4(s);if(x4(c,u))return u?-1:1;let h=a==null?void 0:a.tensorShape[0],p=l==null?void 0:l.tensorShape[0];return h!==p?p-h:o<=s?-1:1});this.tensorNames=n.map(o=>{var s;return{name:o,shape:(s=this.getEmbeddingInfoByName(o))==null?void 0:s.tensorShape}});let r=this.projector.servingMode==="demo"?this.projectorConfig.embeddings[0].tensorName:n[0];this.selectedTensor===r?this._selectedTensorChanged():this.selectedTensor=r})}_selectedLabelOptionChanged(){this.projector.setSelectedLabelOption(this.selectedLabelOption)}_selectedColorOptionNameChanged(){var e;let t=null;for(let n=0;n<this.colorOptions.length;n++)if(this.colorOptions[n].name===this.selectedColorOptionName){t=this.colorOptions[n];break}if(!!t){if(this.showForceCategoricalColorsCheckbox=!!t.tooManyUniqueValues,t.map==null)this.colorLegendRenderInfo=null;else if((e=t.items)!=null&&e.length){let n=t.items.map(r=>{var o;return{color:(o=t==null?void 0:t.map)==null?void 0:o.call(t,r.label),label:r.label,count:r.count}});this.colorLegendRenderInfo={items:n,thresholds:[]}}else this.colorLegendRenderInfo={items:[],thresholds:t.thresholds};this.projector.setSelectedColorOption(t)}}tensorWasReadFromFile(t,e){i$(t,n=>{this.projector.updateDataSet(n);let r=this.$$("#datasets_dropdown");r.hidden=!0,this.dataCitation=e})}metadataWasReadFromFile(t,e){r$(t,n=>{this.projector.updateDataSet(this.projector.dataSet,n,e)})}getEmbeddingInfoByName(t){for(let e=0;e<this.projectorConfig.embeddings.length;e++){let n=this.projectorConfig.embeddings[e];if(n.tensorName===t)return n}}setupUploadButtons(){let t=this.$$("#file");t.onchange=()=>{var m;let f=(m=t.files)==null?void 0:m[0];t.value="";let d=new FileReader;d.onload=x=>{let g=d.result;this.tensorWasReadFromFile(g,f.name)},d.readAsArrayBuffer(f)};let e=this.$$("#upload-tensors");e.onclick=()=>{t.click()};let n=this.$$("#file-metadata");n.onchange=()=>{var m;let f=(m=n.files)==null?void 0:m[0];n.value="";let d=new FileReader;d.onload=x=>{let g=d.result;this.metadataWasReadFromFile(g,f.name)},d.readAsArrayBuffer(f)};let r=this.$$("#upload-metadata");r.onclick=()=>{n.click()},this.projector.servingMode!=="demo"&&(this.$$("#publish-container").style.display="none",this.$$("#upload-tensors-step-container").style.display="none",this.$$("#upload-metadata-label").style.display="none"),this.$$("#demo-data-buttons-container").style.display="flex";let o=this.$$("#projector-config-template"),s={embeddings:[{tensorName:"My tensor",tensorShape:[1e3,50],tensorPath:"https://raw.githubusercontent.com/.../tensors.tsv",metadataPath:"https://raw.githubusercontent.com/.../optional.metadata.tsv"}]};this.setProjectorConfigTemplateJson(o,s);let a=this.$$("#config-sprite-checkbox");a.onchange=()=>{a.checked?s.embeddings[0].sprite={imagePath:"https://github.com/.../optional.sprite.png",singleImageDim:[32,32]}:delete s.embeddings[0].sprite,this.setProjectorConfigTemplateJson(o,s)};let l=this.$$("#config-bookmarks-checkbox");l.onchange=()=>{l.checked?s.embeddings[0].bookmarksPath="https://raw.githubusercontent.com/.../bookmarks.txt":delete s.embeddings[0].bookmarksPath,this.setProjectorConfigTemplateJson(o,s)};let c=this.$$("#config-metadata-checkbox");c.onchange=()=>{c.checked?s.embeddings[0].metadataPath="https://raw.githubusercontent.com/.../optional.metadata.tsv":delete s.embeddings[0].metadataPath,this.setProjectorConfigTemplateJson(o,s)};let u=this.$$("#projector-config-url"),h=this.$$("#projector-share-url"),p=this.$$("#projector-share-url-link");u.onchange=()=>{let f=location.protocol+"//"+location.host+location.pathname+"?config="+u.value;h.value=f,Object.assign(p,{href:f})}}setProjectorConfigTemplateJson(t,e){t.value=JSON.stringify(e,null,2)}toggleProjectionButton(t){let e=t.model.index;for(let n=0;n<this.projectionButtonList.length;n++)this.set(["projectionButtonList",n,"checked"],!1);this.set(["projectionButtonList",e,"checked"],!0),this.updatePrincipleProjection()}handleToggleProjectionChange(t){let e=t.model.index;this.set(["projectionButtonList",e,"checked"],t.target.checked),this.updatePrincipleProjection()}updatePrincipleProjection(){if(this.projector.principleMatrices.kernels){let e=!0,n=[];for(let f=0;f<this.projector.principleMatrices.kernels.length;f++)this.projectionButtonList[f].checked?n.push(new ym(this.projector.principleMatrices.kernels[f])):e=!1;if(e){this.projector.setPrincipleProjection();return}let r=[];for(let f of n)for(let d=0;d<f.columns;d++)r.push(f.getColumn(d));let o=new ym(r).transpose(),s=new QH(o),a=s.diagonal,l=a.reduce((f,d)=>f+Math.pow(d,2),0),c=a.length,u=0;for(let f=0;f<=a.length;f++){if(u>=(1-.05)*l){c=f;break}u+=Math.pow(a[f],2)}let h=Array.from({length:c},(f,d)=>d),p=s.leftSingularVectors.subMatrixColumn(h);this.projector.setPrincipleProjection(p)}}_getNumTensorsLabel(){return this.tensorNames.length===1?"1 dataset":this.tensorNames.length+" datasets"}_getNumRunsLabel(){return this.runNames.length===1?"1 run":this.runNames.length+" runs"}_hasChoice(t){return t.length>0}_hasChoices(t){return t.length>1}_openDataDialog(){this.$.dataDialog.open()}_openConfigDialog(){this.$.projectorConfigDialog.open()}};en.template=N$;wt([Rt({type:String}),ht("design:type",String)],en.prototype,"selectedTensor",void 0);wt([Rt({type:String}),ht("design:type",String)],en.prototype,"selectedRun",void 0);wt([Rt({type:String,notify:!0}),ht("design:type",String)],en.prototype,"selectedColorOptionName",void 0);wt([Rt({type:String,notify:!0}),ht("design:type",String)],en.prototype,"selectedLabelOption",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],en.prototype,"normalizeData",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],en.prototype,"showForceCategoricalColorsCheckbox",void 0);wt([Rt({type:String}),ht("design:type",String)],en.prototype,"metadataEditorInput",void 0);wt([Rt({type:String}),ht("design:type",String)],en.prototype,"metadataEditorInputLabel",void 0);wt([Rt({type:String}),ht("design:type",String)],en.prototype,"metadataEditorColumn",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],en.prototype,"metadataEditorButtonDisabled",void 0);wt([Rt({type:String}),ht("design:type",String)],en.prototype,"superviseInput",void 0);wt([Rt({type:String}),ht("design:type",String)],en.prototype,"superviseInputLabel",void 0);wt([Rt({type:String}),ht("design:type",String)],en.prototype,"superviseColumn",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],en.prototype,"showSuperviseSettings",void 0);wt([Rt({type:Array}),ht("design:type",Array)],en.prototype,"projectionButtonList",void 0);wt([Rt({type:String}),ht("design:type",Object)],en.prototype,"_wordDelimiter",void 0);wt([Nn("selectedTensor"),ht("design:type",Function),ht("design:paramtypes",[]),ht("design:returntype",void 0)],en.prototype,"_selectedTensorChanged",null);wt([Nn("selectedRun"),ht("design:type",Function),ht("design:paramtypes",[Object]),ht("design:returntype",void 0)],en.prototype,"_generateUiForNewCheckpointForRun",null);wt([Nn("selectedLabelOption"),ht("design:type",Function),ht("design:paramtypes",[]),ht("design:returntype",void 0)],en.prototype,"_selectedLabelOptionChanged",null);wt([Nn("selectedColorOptionName"),ht("design:type",Function),ht("design:paramtypes",[]),ht("design:returntype",void 0)],en.prototype,"_selectedColorOptionNameChanged",null);en=wt([Fe("vz-projector-data-panel")],en);var fo=class extends Oe(ve){constructor(){super(...arguments),this.hasMetadata=!0,this.isCollapsed=!1,this.collapseIcon="expand-less"}_computeInnerHTML(t){return t?t.innerHTML:""}initialize(t){this.projector=t}_toggleMetadataContainer(){this.$$("#metadata-container").toggle(),this.isCollapsed=!this.isCollapsed,this.set("collapseIcon",this.isCollapsed?"expand-more":"expand-less")}_downloadTrace(){M$(this.svgNode,this.label)}updateMetadata(t){if(this.hasMetadata=t!=null,t){this.pointMetadata=t;let e=[],n=!1;for(let r in t)!t.hasOwnProperty(r)||(r=="donor"||r=="acceptor"?n=!0:e.push({key:r,value:t[r]}));if(this.metadata=e,this.label=""+this.pointMetadata[this.labelOption],n){let r=t.donor,o=t.acceptor,s=r!==void 0?r:[],a=o!==void 0?o:[],l=s.map((p,f)=>({time:f,donor:s[f],acceptor:a[f]})),c=document.createElement("div");this.svgNode=es(c,l);let u=$l(this.projector,this.projector.selectedPointIndices[0]);u.addEventListener("input",()=>{this.updateMetadata(t)}),u.addEventListener("click",()=>{this.updateMetadata(t)}),this.plotElement=c;let h=this.$$("#trace-plot");h&&h.querySelector("paper-button")==null&&h.appendChild(u)}}}setLabelOption(t){this.labelOption=t,this.pointMetadata&&(this.label=""+this.pointMetadata[this.labelOption])}};fo.template=ut`
    <style>
      #metadata-card {
        background-color: rgba(255, 255, 255, 0.9);
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
          0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
        width: 270px;
      }

      #header {
        background: #e9e9e9;
      }

      #icon-container {
        position: absolute;
        right: 0;
        top: 4px;
      }

      #metadata-label {
        font-weight: 400;
        font-size: 14px;
        line-height: 24px;
        padding: 12px 12px 8px;
        width: 230px;
        overflow-wrap: break-word;
      }

      #metadata-table {
        display: table;
        padding: 8px 12px 4px;
      }

      .metadata-row {
        display: table-row;
      }

      .metadata-key {
        font-weight: bold;
      }

      .metadata-key,
      .metadata-value {
        display: table-cell;
        font-size: 12px;
        padding: 3px 3px;
      }

      .metadata-value {
        word-wrap: anywhere; /* Firefox only -- word-wrap DNE in Chrome. anywhere DNE in Chrome */
        word-break: break-word; /* break-word DNE in Firefox */
      }

     .button {
        margin-right: 10px;
        border: none;
        border-radius: 7px;
        font-size: 13px;
        padding: 10px;
        background: #e3e3e3;
      }

      .label-control {
        width: 100%;
        padding: 2px;
        margin-right: 5px;
        display: flex;
        flex-directon: row;
      }
      
      .binary-selected, .label-control input:not(:placeholder-shown) {
        background: #ADD8E6;
      }

      .download-button {
        position: absolute;
        right: 20px;
        top: 120px;
      }
      
    </style>

    <template is="dom-if" if="[[hasMetadata]]">
      <div id="metadata-card">
        <div id="icon-container">
          <paper-icon-button
            icon="[[collapseIcon]]"
            on-tap="_toggleMetadataContainer"
          >
          </paper-icon-button>
        </div>
        <div id="header">
          <div id="metadata-label">[[label]]</div>
        </div>
        <iron-collapse id="metadata-container" opened>
          <div id="metadata-table">
            <template is="dom-repeat" items="[[metadata]]">
              <div class="metadata-row">
                <div class="metadata-key">[[item.key]]</div>
                <div class="metadata-value">[[item.value]]</div>
              </div>
            </template>
            </div>
          <div>
          <div>
            <paper-icon-button
              icon="save"
              id="download-button"
              on-tap="_downloadTrace"
              class="download-button"
            >
          </div>
          <div width="100%" id="trace-plot" inner-h-t-m-l="[[plotElementInnerHTML]]"/>
          </div>
        </iron-collapse>
      </div>
    </template>
  `;wt([Rt({type:Boolean}),ht("design:type",Boolean)],fo.prototype,"hasMetadata",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],fo.prototype,"isCollapsed",void 0);wt([Rt({type:String}),ht("design:type",String)],fo.prototype,"collapseIcon",void 0);wt([Rt({type:Array}),ht("design:type",Array)],fo.prototype,"metadata",void 0);wt([Rt({type:String}),ht("design:type",String)],fo.prototype,"label",void 0);wt([Rt({type:Object}),ht("design:type",HTMLElement)],fo.prototype,"plotElement",void 0);wt([Rt({type:String,computed:"_computeInnerHTML(plotElement)"}),ht("design:type",String)],fo.prototype,"plotElementInnerHTML",void 0);fo=wt([Fe("vz-projector-metadata-card")],fo);var D$=ut`
    <style include="vz-projector-styles"></style>
    <style>
      :host {
        transition: height 0.2s;
      }

      .ink-button {
        border: none;
        border-radius: 2px;
        font-size: 13px;
        padding: 10px;
        min-width: 88px;
        flex-shrink: 0;
        background: #e3e3e3;
      }

      .ink-panel-buttons {
        margin-bottom: 10px;
      }

      .two-way-toggle {
        display: flex;
        flex-direction: row;
      }

      .two-way-toggle span {
        padding-right: 7px;
      }

      .has-border {
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .toggle {
        min-width: 0px;
        font-size: 12px;
        width: 17px;
        min-height: 0px;
        height: 21px;
        padding: 0;
        margin: 0px;
      }

      .toggle[active] {
        background-color: #880e4f;
        color: white;
      }

      .two-columns {
        display: flex;
        justify-content: space-between;
      }

      .two-columns > :first-child {
        margin-right: 15px;
      }

      .two-columns > div {
        width: 50%;
      }

      .dropdown-item {
        justify-content: space-between;
        min-height: 35px;
      }

      .tsne-supervise-factor {
        margin-bottom: -8px;
      }

      #z-container {
        display: flex;
        align-items: center;
        width: 50%;
      }

      #z-checkbox {
        margin: 27px 0 0 5px;
        width: 18px;
      }

      #z-dropdown {
        flex-grow: 1;
      }

      .notice {
        color: #880e4f;
      }

      .container {
        padding: 20px;
      }

      .book-icon {
        height: 20px;
        color: rgba(0, 0, 0, 0.7);
      }

      .item-details {
        color: gray;
        font-size: 12px;
        margin-left: 5px;
      }

      .pca-dropdown {
        width: 100%;
      }

      .pca-dropdown paper-listbox {
        width: 135px;
      }

      .dropdown-item.header {
        border-bottom: 1px solid #aaa;
        color: #333;
        font-weight: bold;
      }

      #total-variance {
        color: rgba(0, 0, 0, 0.7);
      }
    </style>
    <div id="main">
      <div class="ink-panel-header">
        <div class="ink-tab-group">
          <div
            data-tab="umap"
            id="umap-tab"
            class="ink-tab projection-tab"
            title="Uniform manifold approximation and projection"
          >
            UMAP
          </div>
          <div
            data-tab="tsne"
            id="tsne-tab"
            class="ink-tab projection-tab"
            title="t-distributed stochastic neighbor embedding"
          >
            t-SNE
          </div>
          <div
            data-tab="pca"
            id="pca-tab"
            class="ink-tab projection-tab"
            title="Principal component analysis"
          >
            PCA
          </div>
          <div
            data-tab="custom"
            id="custom-tab"
            class="ink-tab projection-tab"
            title="Linear projection of two custom vectors"
          >
            Custom
          </div>
        </div>
      </div>
      <div class="container">
        <!-- UMAP Controls -->
        <div data-panel="umap" class="ink-panel-content">
          <div class="slider">
            <label>Dimension</label>
            <div class="two-way-toggle">
              <span>2D</span>
              <paper-toggle-button id="umap-toggle" checked="{{umapIs3d}}"
                >3D</paper-toggle-button
              >
            </div>
          </div>
          <div class="slider umap-neighbors">
            <label>
              Neighbors
              <paper-icon-button
                icon="help"
                class="help-icon"
              ></paper-icon-button>
              <paper-tooltip
                position="right"
                animation-delay="0"
                fit-to-visible-bounds
              >
                The number of nearest neighbors used to compute the fuzzy
                simplicial set, which is used to approximate the overall shape
                of the manifold. The default value is 15.
              </paper-tooltip>
            </label>
            <paper-slider
              id="umap-neighbors-slider"
              value="{{umapNeighbors}}"
              pin
              min="10"
              max="100"
            ></paper-slider>
            <span>[[umapNeighbors]]</span>
          </div>
          <div class="slider umap-min-dist">
            <label>
              MinDist
              <paper-icon-button
                icon="help"
                class="help-icon"
              ></paper-icon-button>
              <paper-tooltip
                position="right"
                animation-delay="0"
                fit-to-visible-bounds
              >
                Controls how tightly UMAP is allowed to pack points together.
                Provides the minimum distance apart that points are allowed to
                be in the low dimensional representation. The default value is
                0.1.
              </paper-tooltip>
            </label>
            <paper-slider
              id="umap-mindist-slider"
              value="{{umapMinDist}}"
              pin
              min="0"
              max="0.99"
              step="0.01"
            ></paper-slider>
            <span>[[umapMinDist]]</span>
          </div>
          <p>
            <button
              id="run-umap"
              class="ink-button"
              title="Run UMAP"
              on-tap="runUmap"
            >
              Run
            </button>
          </p>
          <p id="umap-sampling" class="notice">
            For faster results, the data will be sampled down to
            [[getUmapSampleSizeText()]] points.
          </p>
          <p>
            <iron-icon icon="book" class="book-icon"></iron-icon>
            <a
              target="_blank"
              rel="noopener"
              href="https://umap-learn.readthedocs.io/en/latest/how_umap_works.html"
            >
              Learn more about UMAP.
            </a>
          </p>
        </div>
        <!-- TSNE Controls -->
        <div data-panel="tsne" class="ink-panel-content">
          <div class="slider">
            <label>Dimension</label>
            <div class="two-way-toggle">
              <span>2D</span>
              <paper-toggle-button id="tsne-toggle" checked="{{tSNEis3d}}"
                >3D</paper-toggle-button
              >
            </div>
          </div>
          <div class="slider tsne-perplexity">
            <label>
              Perplexity
              <paper-icon-button
                icon="help"
                class="help-icon"
              ></paper-icon-button>
              <paper-tooltip
                position="right"
                animation-delay="0"
                fit-to-visible-bounds
              >
                The most appropriate perplexity value depends on the density of
                the data. Loosely speaking, a larger / denser dataset requires a
                larger perplexity. Typical values for perplexity range between 5
                and 50.
              </paper-tooltip>
            </label>
            <paper-slider
              id="perplexity-slider"
              pin
              min="2"
              max="100"
              value="30"
            ></paper-slider>
            <span></span>
          </div>
          <div class="slider tsne-learning-rate">
            <label>
              Learning rate
              <paper-icon-button
                icon="help"
                class="help-icon"
              ></paper-icon-button>
              <paper-tooltip
                position="right"
                animation-delay="0"
                fit-to-visible-bounds
              >
                The ideal learning rate often depends on the size of the data,
                with smaller datasets requiring smaller learning rates.
              </paper-tooltip>
            </label>
            <paper-slider
              id="learning-rate-slider"
              snaps
              min="-3"
              max="2"
              step="1"
              value="1"
              max-markers="6"
            >
            </paper-slider>
            <span></span>
          </div>
          <div class="slider tsne-supervise-factor">
            <label>
              Supervise
              <paper-icon-button
                icon="help"
                class="help-icon"
              ></paper-icon-button>
              <paper-tooltip
                position="right"
                animation-delay="0"
                fit-to-visible-bounds
              >
                The label importance used for supervision, from 0 (disabled) to
                100 (full importance).
              </paper-tooltip>
            </label>
            <paper-slider
              id="supervise-factor-slider"
              min="0"
              max="100"
              pin
              value="{{superviseFactor}}"
            >
            </paper-slider>
            <span></span>
          </div>
          <p>
            <button class="run-tsne ink-button" title="Re-run t-SNE">
              Run
            </button>
            <button class="pause-tsne ink-button" title="Pause t-SNE">
              Pause
            </button>
            <button class="perturb-tsne ink-button" title="Perturb t-SNE">
              Perturb
            </button>
          </p>
          <p>Iteration: <span class="run-tsne-iter">0</span></p>
          <p id="tsne-sampling" class="notice">
            For faster results, the data will be sampled down to
            [[getTsneSampleSizeText()]] points.
          </p>
          <p>
            <iron-icon icon="book" class="book-icon"></iron-icon>
            <a
              target="_blank"
              href="http://distill.pub/2016/misread-tsne/"
              rel="noopener noreferrer"
            >
              How to use t-SNE effectively.
            </a>
          </p>
        </div>
        <!-- PCA Controls -->
        <div data-panel="pca" class="ink-panel-content">
          <div class="two-columns">
            <div>
              <!-- Left column -->
              <paper-dropdown-menu
                class="pca-dropdown"
                vertical-align="bottom"
                no-animations
                label="X"
              >
                <paper-listbox
                  attr-for-selected="value"
                  class="dropdown-content"
                  selected="{{pcaX}}"
                  slot="dropdown-content"
                >
                  <paper-item disabled class="dropdown-item header">
                    <div>#</div>
                    <div>Variance (%)</div>
                  </paper-item>
                  <template is="dom-repeat" items="[[pcaComponents]]">
                    <paper-item
                      class="dropdown-item"
                      value="[[item.id]]"
                      label="Component #[[item.componentNumber]]"
                    >
                      <div>[[item.componentNumber]]</div>
                      <div class="item-details">[[item.percVariance]]</div>
                    </paper-item>
                  </template>
                </paper-listbox>
              </paper-dropdown-menu>
              <paper-dropdown-menu
                class="pca-dropdown"
                no-animations
                vertical-align="bottom"
                label="Z"
                disabled="[[!hasPcaZ]]"
                id="z-dropdown"
              >
                <paper-listbox
                  attr-for-selected="value"
                  class="dropdown-content"
                  selected="{{pcaZ}}"
                  slot="dropdown-content"
                >
                  <paper-item disabled class="dropdown-item header">
                    <div>#</div>
                    <div>Variance (%)</div>
                  </paper-item>
                  <template is="dom-repeat" items="[[pcaComponents]]">
                    <paper-item
                      class="dropdown-item"
                      value="[[item.id]]"
                      label="Component #[[item.componentNumber]]"
                    >
                      <div>[[item.componentNumber]]</div>
                      <div class="item-details">[[item.percVariance]]</div>
                    </paper-item>
                  </template>
                </paper-listbox>
              </paper-dropdown-menu>
            </div>
            <div>
              <!-- Right column -->
              <paper-dropdown-menu
                class="pca-dropdown"
                vertical-align="bottom"
                no-animations
                label="Y"
              >
                <paper-listbox
                  attr-for-selected="value"
                  class="dropdown-content"
                  selected="{{pcaY}}"
                  slot="dropdown-content"
                >
                  <paper-item disabled class="dropdown-item header">
                    <div>#</div>
                    <div>Variance (%)</div>
                  </paper-item>
                  <template is="dom-repeat" items="[[pcaComponents]]">
                    <paper-item
                      class="dropdown-item"
                      value="[[item.id]]"
                      label="Component #[[item.componentNumber]]"
                    >
                      <div>[[item.componentNumber]]</div>
                      <div class="item-details">[[item.percVariance]]</div>
                    </paper-item>
                  </template>
                </paper-listbox>
              </paper-dropdown-menu>
              <paper-checkbox
                id="z-checkbox"
                checked="{{pcaIs3d}}"
              ></paper-checkbox>
            </div>
          </div>
          <p id="pca-sampling" class="notice">
            PCA is approximate.
            <paper-icon-button
              icon="help"
              class="help-icon"
            ></paper-icon-button>
          </p>
          <div id="total-variance">Total variance</div>
          <paper-tooltip
            for="pca-sampling"
            position="top"
            animation-delay="0"
            fit-to-visible-bounds
          >
            For fast results, the data was sampled to [[getPcaSampleSizeText()]]
            points and randomly projected down to [[getPcaSampledDimText()]]
            dimensions.
          </paper-tooltip>
        </div>
        <!-- Custom Controls -->
        <div data-panel="custom" class="ink-panel-content">
          <paper-dropdown-menu
            style="width: 100%"
            no-animations
            label="Search by"
          >
            <paper-listbox
              attr-for-selected="value"
              class="dropdown-content"
              selected="{{customSelectedSearchByMetadataOption}}"
              slot="dropdown-content"
            >
              <template is="dom-repeat" items="[[searchByMetadataOptions]]">
                <paper-item
                  class="dropdown-item"
                  value="[[item]]"
                  label="[[item]]"
                >
                  [[item]]
                </paper-item>
              </template>
            </paper-listbox>
          </paper-dropdown-menu>
          <div class="two-columns">
            <vz-projector-input id="xLeft" label="Left"></vz-projector-input>
            <vz-projector-input id="xRight" label="Right"></vz-projector-input>
          </div>
          <div class="two-columns">
            <vz-projector-input id="yUp" label="Up"></vz-projector-input>
            <vz-projector-input id="yDown" label="Down"></vz-projector-input>
          </div>
        </div>
      </div>
    </div>
  </template>
</dom-module>
`;var Kgt=10,Pn=class extends Oe(ve){constructor(){super(...arguments),this.pcaIs3d=!0,this.tSNEis3d=!0,this.superviseFactor=0,this.umapIs3d=!0,this.umapNeighbors=15,this.umapMinDist=.1,this.pcaX=0,this.pcaY=1,this.pcaZ=2}initialize(t){this.polymerChangesTriggerReprojection=!0,this.projector=t,this.perplexity=30,this.learningRate=10,this.centroidValues={xLeft:null,xRight:null,yUp:null,yDown:null},this.clearCentroids(),this.setupUIControls()}ready(){super.ready(),this.zDropdown=this.$$("#z-dropdown"),this.runTsneButton=this.$$(".run-tsne"),this.pauseTsneButton=this.$$(".pause-tsne"),this.perturbTsneButton=this.$$(".perturb-tsne"),this.perplexitySlider=this.$$("#perplexity-slider"),this.learningRateInput=this.$$("#learning-rate-slider"),this.superviseFactorInput=this.$$("#supervise-factor-slider"),this.iterationLabelTsne=this.$$(".run-tsne-iter"),this.runUmapButton=this.$$("#run-umap")}disablePolymerChangesTriggerReprojection(){this.polymerChangesTriggerReprojection=!1}enablePolymerChangesTriggerReprojection(){this.polymerChangesTriggerReprojection=!0}updateTSNEPerplexityFromSliderChange(){var t;this.perplexitySlider&&(this.perplexity=+this.perplexitySlider.value,(t=this.dataSet)!=null&&t.hasTSNERun&&(this.dataSet.hasTSNERun=!1,this.beginProjection(this.currentProjection))),this.$$(".tsne-perplexity span").innerText=""+this.perplexity}updateTSNELearningRateFromUIChange(){this.learningRateInput&&(this.learningRate=Math.pow(10,+this.learningRateInput.value),this.dataSet&&this.dataSet.setTsneLearningRate(this.learningRate)),this.$$(".tsne-learning-rate span").innerText=""+this.learningRate}updateTSNESuperviseFactorFromUIChange(){this.$$(".tsne-supervise-factor span").innerText=""+this.superviseFactor,this.dataSet&&this.dataSet.setSuperviseFactor(this.superviseFactor)}setupUIControls(){var e,n;{let r=this,o=(e=this.root)==null?void 0:e.querySelectorAll(".ink-tab");if(o)for(let s=0;s<o.length;s++)o[s].addEventListener("click",function(){let a=this.getAttribute("data-tab");r.showTab(a)})}this.runTsneButton.addEventListener("click",()=>{this.dataSet.hasTSNERun?this.dataSet.stopTSNE():this.runTSNE()}),this.pauseTsneButton.addEventListener("click",()=>{this.dataSet.tSNEShouldPause?(this.dataSet.tSNEShouldPause=!1,this.pauseTsneButton.innerText="Pause"):(this.dataSet.tSNEShouldPause=!0,this.pauseTsneButton.innerText="Resume")}),this.perturbTsneButton.addEventListener("mousedown",()=>{this.dataSet&&this.projector&&(this.dataSet.perturbTsne(),this.projector.notifyProjectionPositionsUpdated(),this.perturbInterval=window.setInterval(()=>{this.dataSet.perturbTsne(),this.projector.notifyProjectionPositionsUpdated()},100))}),this.perturbTsneButton.addEventListener("mouseup",()=>{clearInterval(this.perturbInterval)}),this.perplexitySlider.value=this.perplexity.toString(),this.perplexitySlider.addEventListener("change",()=>this.updateTSNEPerplexityFromSliderChange()),this.updateTSNEPerplexityFromSliderChange(),this.learningRateInput.addEventListener("change",()=>this.updateTSNELearningRateFromUIChange()),this.updateTSNELearningRateFromUIChange(),this.superviseFactorInput.addEventListener("change",()=>this.updateTSNESuperviseFactorFromUIChange()),this.updateTSNESuperviseFactorFromUIChange(),this.setupCustomProjectionInputFields();let t=(n=this.root)==null?void 0:n.querySelectorAll("paper-dropdown-menu paper-input input");if(t)for(let r=0;r<t.length;r++)t[r].style.fontSize="14px"}restoreUIFromBookmark(t){this.disablePolymerChangesTriggerReprojection(),this.pcaX=t.pcaComponentDimensions[0],this.pcaY=t.pcaComponentDimensions[1],t.pcaComponentDimensions.length===3&&(this.pcaZ=t.pcaComponentDimensions[2]),this.pcaIs3d=t.pcaComponentDimensions.length===3,this.perplexitySlider&&(this.perplexitySlider.value=t.tSNEPerplexity.toString()),this.learningRateInput&&(this.learningRateInput.value=t.tSNELearningRate.toString()),this.tSNEis3d=t.tSNEis3d,this.umapIs3d=t.umapIs3d,this.umapNeighbors=t.umapNeighbors,this.umapMinDist=t.umapMinDist,this.customSelectedSearchByMetadataOption=t.customSelectedSearchByMetadataOption,this.customProjectionXLeftInput&&this.customProjectionXLeftInput.set(t.customXLeftText,t.customXLeftRegex),this.customProjectionXRightInput&&this.customProjectionXRightInput.set(t.customXRightText,t.customXRightRegex),this.customProjectionYUpInput&&this.customProjectionYUpInput.set(t.customYUpText,t.customYUpRegex),this.customProjectionYDownInput&&this.customProjectionYDownInput.set(t.customYDownText,t.customYDownRegex),this.computeAllCentroids(),this.setZDropdownEnabled(this.pcaIs3d),this.updateTSNEPerplexityFromSliderChange(),this.updateTSNELearningRateFromUIChange(),this.iterationLabelTsne&&(this.iterationLabelTsne.innerText=t.tSNEIteration.toString()),t.selectedProjection!=null&&(this.showTab(t.selectedProjection),this.currentProjection==="tsne"&&(this.runTSNE(),this.dataSet.initTsneSolutionFromCurrentProjection())),this.enablePolymerChangesTriggerReprojection()}populateBookmarkFromUI(t){this.disablePolymerChangesTriggerReprojection(),t.pcaComponentDimensions=[this.pcaX,this.pcaY],this.pcaIs3d&&t.pcaComponentDimensions.push(this.pcaZ),this.perplexitySlider!=null&&(t.tSNEPerplexity=+this.perplexitySlider.value),this.learningRateInput!=null&&(t.tSNELearningRate=+this.learningRateInput.value),t.tSNEis3d=this.tSNEis3d,t.umapIs3d=this.umapIs3d,t.umapNeighbors=this.umapNeighbors,t.umapMinDist=this.umapMinDist,t.customSelectedSearchByMetadataOption=this.customSelectedSearchByMetadataOption,this.customProjectionXLeftInput!=null&&(t.customXLeftText=this.customProjectionXLeftInput.getValue(),t.customXLeftRegex=this.customProjectionXLeftInput.getInRegexMode()),this.customProjectionXRightInput!=null&&(t.customXRightText=this.customProjectionXRightInput.getValue(),t.customXRightRegex=this.customProjectionXRightInput.getInRegexMode()),this.customProjectionYUpInput!=null&&(t.customYUpText=this.customProjectionYUpInput.getValue(),t.customYUpRegex=this.customProjectionYUpInput.getInRegexMode()),this.customProjectionYDownInput!=null&&(t.customYDownText=this.customProjectionYDownInput.getValue(),t.customYDownRegex=this.customProjectionYDownInput.getInRegexMode()),this.enablePolymerChangesTriggerReprojection()}setZDropdownEnabled(t){this.zDropdown&&(t?this.zDropdown.removeAttribute("disabled"):this.zDropdown.setAttribute("disabled","true"))}dataSetUpdated(t,e,n){var a;this.dataSet=t,this.originalDataSet=e,this.dim=n;let r=t==null?0:t.points.length,o=Math.max(5,Math.ceil(Math.sqrt(r)/4));this.perplexitySlider.value=o.toString(),this.updateTSNEPerplexityFromSliderChange(),this.clearCentroids(),this.$$("#tsne-sampling").style.display=r>Ol?null:"none",this.$$("#umap-sampling").style.display=r>pb?null:"none";let s=t==null?!1:t.dim[0]>fb||t.dim[1]>vm;this.$$("#pca-sampling").style.display=s?null:"none",this.showTab((a=this.currentProjection)!=null?a:"umap")}_pcaDimensionToggleObserver(){this.setZDropdownEnabled(this.pcaIs3d),this.beginProjection(this.currentProjection)}_tsneDimensionToggleObserver(){var t;(t=this.dataSet)!=null&&t.hasTSNERun&&(this.dataSet.hasTSNERun=!1),this.beginProjection(this.currentProjection)}_umapDimensionToggleObserver(){this.beginProjection(this.currentProjection)}metadataChanged(t){var n;let e=-1;this.searchByMetadataOptions=(n=t.stats)==null?void 0:n.map((r,o)=>(!r.isNumeric&&e===-1&&(e=o),r.name)),this.customSelectedSearchByMetadataOption=this.searchByMetadataOptions[Math.max(0,e)]}showTab(t){var o,s;this.currentProjection=t;let e=this.$$('.ink-tab[data-tab="'+t+'"]'),n=(o=this.root)==null?void 0:o.querySelectorAll(".ink-tab");if(n)for(let a=0;a<n.length;a++)ao(n[a],"active",!1);ao(e,"active",!0);let r=(s=this.root)==null?void 0:s.querySelectorAll(".ink-panel-content");if(r)for(let a=0;a<r.length;a++)ao(r[a],"active",!1);if(ao(this.$$('.ink-panel-content[data-panel="'+t+'"]'),"active",!0),this.$!=null){let a=this.$.main;requestAnimationFrame(()=>{this.style.height=a.clientHeight+"px"})}this.beginProjection(t)}beginProjection(t){this.polymerChangesTriggerReprojection!==!1&&(t==="pca"?(this.dataSet!=null&&this.dataSet.stopTSNE(),this.showPCA()):t==="tsne"?this.showTSNE():t==="umap"?this.showUmap():t==="custom"&&(this.dataSet!=null&&this.dataSet.stopTSNE(),this.computeAllCentroids(),this.reprojectCustom()))}showTSNE(){let t=this.dataSet;if(t==null)return;let e=Bl("tsne",[0,1,this.tSNEis3d?2:null]),n=this.tSNEis3d?3:2,r=new Yo("tsne",e,n,t);this.projector.setProjection(r),this.dataSet.hasTSNERun?this.projector.notifyProjectionPositionsUpdated():this.runTSNE()}runTSNE(){let t=!1;this.runTsneButton.innerText="Stop",this.runTsneButton.disabled=!0,this.pauseTsneButton.innerText="Pause",this.pauseTsneButton.disabled=!0,this.perturbTsneButton.disabled=!1,this.dataSet.projectTSNE(this.perplexity,this.learningRate,this.tSNEis3d?3:2,e=>{e!=null?(this.runTsneButton.disabled=!1,this.pauseTsneButton.disabled=!1,this.iterationLabelTsne.innerText=""+e,this.projector.notifyProjectionPositionsUpdated(),!t&&this.dataSet.projections.tsne&&(this.projector.onProjectionChanged(),t=!0)):(this.runTsneButton.innerText="Re-run",this.runTsneButton.disabled=!1,this.pauseTsneButton.innerText="Pause",this.pauseTsneButton.disabled=!0,this.perturbTsneButton.disabled=!0,this.projector.onProjectionChanged())})}showUmap(){let t=this.dataSet;if(t==null)return;let e=Bl("umap",[0,1,this.umapIs3d?2:null]),n=this.umapIs3d?3:2,r=new Yo("umap",e,n,t);this.projector.setProjection(r),this.dataSet.hasUmapRun?this.projector.notifyProjectionPositionsUpdated():this.runUmap()}runUmap(){let t=!1;this.runUmapButton.disabled=!0;let e=this.umapIs3d?3:2,n=this.umapNeighbors,r=this.umapMinDist;this.dataSet.projectUmap(e,n,r,o=>{o!=null?(this.runUmapButton.disabled=!1,this.projector.notifyProjectionPositionsUpdated(),!t&&this.dataSet.projections.umap&&(this.projector.onProjectionChanged(),t=!0)):(this.runUmapButton.innerText="Re-run",this.runUmapButton.disabled=!1,this.projector.onProjectionChanged())})}showPCAIfEnabled(){this.polymerChangesTriggerReprojection&&this.showPCA()}updateTotalVarianceMessage(){let t=this.dataSet.fracVariancesExplained,e=t[this.pcaX]+t[this.pcaY],n="Total variance described: ";this.pcaIs3d&&(e+=t[this.pcaZ]),n+=(e*100).toFixed(1)+"%.",this.$$("#total-variance").textContent=n}showPCA(){this.dataSet!=null&&this.dataSet.projectPCA().then(()=>{let t=Bl("pca",[this.pcaX,this.pcaY,this.pcaZ]),e=this.pcaIs3d?3:2,n=new Yo("pca",t,e,this.dataSet);this.projector.setProjection(n);let r=Math.min(Kgt,this.dataSet.dim[1]);this.updateTotalVarianceMessage(),this.pcaComponents=c2(r).map(o=>{let s=this.dataSet.fracVariancesExplained[o];return{id:o,componentNumber:o+1,percVariance:(s*100).toFixed(1)}})})}reprojectCustom(){if(this.centroids==null||this.centroids.xLeft==null||this.centroids.xRight==null||this.centroids.yUp==null||this.centroids.yDown==null)return;let t=dm(this.centroids.xRight,this.centroids.xLeft);this.dataSet.projectLinear(t,"linear-x");let e=dm(this.centroids.yUp,this.centroids.yDown);this.dataSet.projectLinear(e,"linear-y");let n=Bl("custom",["x","y"]),r=new Yo("custom",n,2,this.dataSet);this.projector.setProjection(r)}clearCentroids(){this.centroids={xLeft:[],xRight:[],yUp:[],yDown:[]},this.allCentroid=[]}_customSelectedSearchByMetadataOptionChanged(t,e){this.polymerChangesTriggerReprojection!==!1&&this.currentProjection==="custom"&&(this.computeAllCentroids(),this.reprojectCustom())}setupCustomProjectionInputFields(){this.customProjectionXLeftInput=this.setupCustomProjectionInputField("xLeft"),this.customProjectionXRightInput=this.setupCustomProjectionInputField("xRight"),this.customProjectionYUpInput=this.setupCustomProjectionInputField("yUp"),this.customProjectionYDownInput=this.setupCustomProjectionInputField("yDown")}computeAllCentroids(){this.computeCentroid("xLeft"),this.computeCentroid("xRight"),this.computeCentroid("yUp"),this.computeCentroid("yDown")}computeCentroid(t){let e=this.$$("#"+t);if(e==null)return;let n=e.getValue();if(n==null)return;let r=e.getInRegexMode(),o=this.getCentroid(n,r);o.numMatches===0?(e.message="0 matches. Using a random vector.",o.centroid=_E(this.dim)):e.message=`${o.numMatches} matches.`,this.centroids[t]=o.centroid,this.centroidValues[t]=n}setupCustomProjectionInputField(t){let e=this.$$("#"+t);return e.registerInputChangedListener((n,r)=>{this.polymerChangesTriggerReprojection&&(this.computeCentroid(t),this.reprojectCustom())}),e}getCentroid(t,e){if(t==null||t==="")return{numMatches:0};let n=o=>this.originalDataSet.points[o].vector,r=this.originalDataSet.query(t,e,this.customSelectedSearchByMetadataOption);return{centroid:Y2(r,n),numMatches:r.length}}getPcaSampledDimText(){return vm.toLocaleString()}getPcaSampleSizeText(){return fb.toLocaleString()}getTsneSampleSizeText(){return Ol.toLocaleString()}getUmapSampleSizeText(){return pb.toLocaleString()}};Pn.template=D$;wt([Rt({type:Boolean}),ht("design:type",Boolean)],Pn.prototype,"pcaIs3d",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],Pn.prototype,"tSNEis3d",void 0);wt([Rt({type:Number}),ht("design:type",Number)],Pn.prototype,"superviseFactor",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],Pn.prototype,"umapIs3d",void 0);wt([Rt({type:Number}),ht("design:type",Number)],Pn.prototype,"umapNeighbors",void 0);wt([Rt({type:Number}),ht("design:type",Number)],Pn.prototype,"umapMinDist",void 0);wt([Rt({type:Array}),ht("design:type",Array)],Pn.prototype,"pcaComponents",void 0);wt([Rt({type:Number}),ht("design:type",Number)],Pn.prototype,"pcaX",void 0);wt([Rt({type:Number}),ht("design:type",Number)],Pn.prototype,"pcaY",void 0);wt([Rt({type:Number}),ht("design:type",Number)],Pn.prototype,"pcaZ",void 0);wt([Rt({type:String}),ht("design:type",String)],Pn.prototype,"customSelectedSearchByMetadataOption",void 0);wt([Nn("pcaIs3d"),ht("design:type",Function),ht("design:paramtypes",[]),ht("design:returntype",void 0)],Pn.prototype,"_pcaDimensionToggleObserver",null);wt([Nn("tSNEis3d"),ht("design:type",Function),ht("design:paramtypes",[]),ht("design:returntype",void 0)],Pn.prototype,"_tsneDimensionToggleObserver",null);wt([Nn("umapIs3d"),ht("design:type",Function),ht("design:paramtypes",[]),ht("design:returntype",void 0)],Pn.prototype,"_umapDimensionToggleObserver",null);wt([Nn("pcaX","pcaY","pcaZ"),ht("design:type",Function),ht("design:paramtypes",[]),ht("design:returntype",void 0)],Pn.prototype,"showPCAIfEnabled",null);wt([Nn("customSelectedSearchByMetadataOption"),ht("design:type",Function),ht("design:paramtypes",[String,String]),ht("design:returntype",void 0)],Pn.prototype,"_customSelectedSearchByMetadataOptionChanged",null);Pn=wt([Fe("vz-projector-projections-panel")],Pn);var z$=ut`
  <style include="vz-projector-styles"></style>
  <style>
    :host {
      display: flex;
      flex-direction: column;
      /* Account for the bookmark pane at the bottom */
      height: calc(100% - 0px);
    }

    .stage {
      position: relative;
      flex-grow: 2;
    }
    
    .container {
      display: block;
      padding: 10px 20px 0 20px;
    }

    .buttons {
      display: flex;
    }

    .button {
      margin-right: 10px;
      border: none;
      border-radius: 7px;
      font-size: 13px;
      padding: 10px;
      background: #e3e3e3;
    }

    .button:last-child {
      margin-right: 0;
    }

    .label-control {
      width: 100%;
      padding: 2px;
      margin-right: 5px;
      display: flex;
      flex-directon: row;
    }
    
    .binary-selected, .label-control input:not(:placeholder-shown) {
      background: #ADD8E6;
    }

    .scrollable-container {
      margin-top: 0;
      min-width: 400px;
    }
    

  </style>
  <paper-dialog id="trace-dialog" with-backdrop>
    <h2>Here are all <b>{{numTraces}}</b> traces:</h2>
    <paper-dialog-scrollable id="trace-list" class="nn scrollable-container"></paper-dialog-scrollable>
    <div class="buttons">
      <paper-button dialog-dismiss class="button">Close</paper-button>
    </div>
  </paper-dialog>
`;var Ygt=1e4,Ob=class extends Oe(ve){ready(){super.ready()}initialize(t){this.projector=t}open(){return $t(this,null,function*(){let t=he("Rendering traces...");yield this.setupUI(this.projector).then(()=>{this.$$("#trace-dialog").open(),he(null,t)})})}getTraceFromIndex(t){let e=this.projector.dataSet.points[t].metadata.donor,n=e!==void 0?e:[],r=this.projector.dataSet.points[t].metadata.acceptor,o=r!==void 0?r:[];return n.map((a,l)=>({time:l,donor:n[l],acceptor:o[l]}))}traceRenderer(t){let e=document.createElement("div"),n=this.getTraceFromIndex(t);return es(e,n,{width:600}),e}setupUI(t){return $t(this,null,function*(){let e=this.$$("#trace-list");e.innerHTML="";let n=Ygt,r=document.createElement("table"),o=16;this.numTraces=Math.min(this.projector.dataSet.points.length,n);for(let s=0;s<this.projector.dataSet.points.length&&s<n;s+=o){yield new Promise(a=>setTimeout(a,0));for(let a=s;a<s+o&&a<this.projector.dataSet.points.length;a++){let l=document.createElement("tr"),c=document.createElement("td");if(this.projector.dataPanel.selectedLabelOption){let d=this.projector.dataPanel.selectedLabelOption;c.textContent=this.projector.dataSet.points[a].metadata[d]}else c.textContent=`Trace ${a}`;let u=document.createElement("td"),h=this.traceRenderer(a);u.appendChild(h);let p=document.createElement("td"),f=$l(this.projector,a);p.appendChild(f),l.appendChild(c),l.appendChild(u),l.appendChild(p),r.appendChild(l)}}e.appendChild(r)})}};Ob.template=z$;wt([Rt({type:Number}),ht("design:type",Number)],Ob.prototype,"numTraces",void 0);Ob=wt([Fe("vz-projector-trace-panel")],Ob);var F$=ut`
<style include="vz-projector-styles"></style>
    <style>
      :host {
        display: flex;
        width: 100%;
        height: 100%;
      }

      #container {
        display: flex;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }

      .hidden {
        display: none !important;
      }

      /* Main */

      #main {
        position: relative;
        flex-grow: 2;
      }

      #main .stage {
        position: relative;
        flex-grow: 2;
      }

      #scatter {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
      }

      #selector {
        display: none;
        height: 100%;
        position: absolute;
        width: 100%;
      }

      #left-pane {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        min-width: 312px;
        width: 312px;
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        background: #fafafa;
      }

      #right-pane {
        border-left: 1px solid rgba(0, 0, 0, 0.1);
        background: #fafafa;
        display: flex;
        height: 100%;
        min-width: 300px;
        width: 300px;
      }

      .file-name {
        margin-right: 5px;
      }

      .control input[type='text']:focus {
        outline: none;
        border-bottom: 1px solid rgba(0, 0, 0, 1);
      }

      .control {
        display: inline-block;
        width: 45%;
        vertical-align: top;
        margin-right: 10px;
        overflow-x: hidden;
      }

      .control.last {
        margin-right: 0;
      }

      #notification-dialog {
        width: 400px;
        padding-bottom: 20px;
      }

      #notification-dialog paper-button {
        background: none;
        text-transform: uppercase;
      }

      #notification-dialog .progress {
        --paper-spinner-color: #880e4f;
        --paper-spinner-stroke-width: 2px;
      }

      #notify-msgs {
        text-align: center;
        display: block;
      }

      .notify-msg {
        font-weight: 500;
        margin: 0;
        padding: 0;
      }

      .notify-msg.error {
        text-align: left;
      }

      .brush .extent {
        stroke: #fff;
        fill-opacity: 0.125;
        shape-rendering: crispEdges;
      }

      .origin text {
        font-size: 12px;
        font-weight: 500;
      }

      .origin line {
        stroke: black;
        stroke-opacity: 0.2;
      }

      /* Ink Framework */

      /* - Buttons */
      .ink-button,
      ::shadow .ink-button {
        border: none;
        border-radius: 2px;
        font-size: 13px;
        padding: 10px;
        min-width: 100px;
        flex-shrink: 0;
        background: #e3e3e3;
      }

      .status-bar-panel {
        display: flex;
        align-items: center;
      }

      .status-bar-entry {
        border-left: 1px solid rgba(0, 0, 0, 0.5);
        margin-left: 5px;
        padding-left: 5px;
        font-weight: 200;
      }

      /* - Menubar */

      .ink-panel-menubar {
        align-items: center;
        position: relative;
        height: 60px;
        border-bottom: solid 1px #eee;
        padding: 0 24px;
        display: flex;
      }

      .ink-panel-menubar .ink-fabs {
        position: absolute;
        right: 12px;
        top: 40px;
        z-index: 1;
      }

      #bookmark-panel {
        bottom: 0;
        position: absolute;
        width: 300px;
      }
      #bookmark-panel-container {
        bottom: 60px;
        position: absolute;
      }

      .ink-fab {
        margin-left: 8px;
        border: 1px solid rgba(0, 0, 0, 0.02);
        background: white;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
      }

      #metadata-card {
        position: absolute;
        right: 5px;
        top: 25px;
      }

      #help-3d-icon {
        position: absolute;
        top: 20px;
        left: 20px;
        background: white;
      }

      #help3dDialog .main {
        margin: 0;
        padding: 20px;
      }

      #help3dDialog h3 {
        margin-top: 20px;
        margin-bottom: 5px;
      }

      #help3dDialog h3:first-child {
        margin-top: 0;
      }

      #data-panel {
        border-top: 1px solid rgba(0, 0, 0, 0.1);
        overflow-y: auto;
      }

      #toast {
        display: flex;
        align-items: center;
        --paper-toast-color: #eeff41;
      }

      .label-control {
        width: 100%;
        padding: 2px;
        display: flex;
        flex-directon: row;
      }
      
      .binary-selected, .label-control input:not(:placeholder-shown) {
        background: #ADD8E6;
      }
    </style>
    <paper-dialog id="notification-dialog" modal>
      <h2 id="notification-title"></h2>
      <paper-dialog-scrollable>
        <div id="notify-msgs"></div>
      </paper-dialog-scrollable>
      <div style="text-align: center;">
        <paper-spinner-lite active class="progress"></paper-spinner-lite>
      </div>
      <div class="buttons">
        <paper-button class="close-button" dialog-confirm autofocus
          >Close</paper-button
        >
      </div>
    </paper-dialog>
    <div id="container">
      <div id="left-pane" class="ink-panel">
        <vz-projector-data-panel id="data-panel"></vz-projector-data-panel>
        <vz-projector-projections-panel
          id="projections-panel"
        ></vz-projector-projections-panel>
      </div>
      <div id="main" class="ink-panel">
        <div class="ink-panel-menubar">
          <paper-icon-button
            id="selectMode"
            alt="Bounding box selection"
            toggles
            icon="image:photo-size-select-small"
          ></paper-icon-button>
          <paper-tooltip
            for="selectMode"
            position="bottom"
            animation-delay="0"
            fit-to-visible-bounds
            >Bounding box selection</paper-tooltip
          >

          <paper-icon-button
            id="editMode"
            alt="Edit current selection"
            toggles
            icon="image:exposure"
          ></paper-icon-button>
          <paper-tooltip
            for="editMode"
            position="bottom"
            animation-delay="0"
            fit-to-visible-bounds
            >Edit current selection</paper-tooltip
          >

          <paper-icon-button
            id="nightDayMode"
            alt="Enable/disable night mode"
            toggles
            icon="image:brightness-2"
          ></paper-icon-button>
          <paper-tooltip
            for="nightDayMode"
            position="bottom"
            animation-delay="0"
            fit-to-visible-bounds
            >Enable/disable night mode</paper-tooltip
          >
          <paper-icon-button
            id="labels3DMode"
            alt="Enable/disable trace display mode"
            toggles
            icon="timeline"
            hidden
          ></paper-icon-button>
          <paper-tooltip
            for="labels3DMode"
            position="bottom"
            animation-delay="0"
            fit-to-visible-bounds
            >Enable/disable trace display mode</paper-tooltip
          >
          <paper-icon-button
            id="traceListMode"
            alt="Display trace list"
            icon="list"
            hidden
          ></paper-icon-button>
          <paper-tooltip
            for="traceListMode"
            position="bottom"
            animation-delay="0"
            fit-to-visible-bounds
            >Display trace list</paper-tooltip
          >
          <paper-icon-button
            id="selfConsistencyMode"
            alt="Display label self-consistency analysis"
            icon="track-changes"
            hidden
          ></paper-icon-button>
          <paper-tooltip
            for="selfConsistencyMode"
            position="bottom"
            animation-delay="0"
            fit-to-visible-bounds
            >Display label self-consistency analysis</paper-tooltip
          >
          <div class="status-bar-panel">
            <div class="status-bar-entry">
              Points: <span class="numDataPoints">Loading...</span>
            </div>
            <div class="status-bar-entry">
              Dimension: <span class="dim">Loading...</span>
            </div>
            <div
              id="status-bar"
              class="status-bar-entry"
              style="display: none;"
            ></div>
          </div>
          <div class="ink-fabs">
            <paper-icon-button
              id="search"
              class="ink-fab"
              alt="Search"
              icon="search"
            ></paper-icon-button>
            <paper-tooltip for="search" position="bottom" animation-delay="0"
              >Search across all traces</paper-tooltip
            >
            <paper-icon-button
              id="screenshot"
              class="ink-fab"
              alt="Take screenshot"
              icon="camera-enhance"
            ></paper-icon-button>
            <paper-tooltip for="screenshot" position="bottom" animation-delay="0"
              >Take screenshot of current projection</paper-tooltip
            >
            <paper-icon-button
              id="reset-zoom"
              class="ink-fab"
              alt="Reset zoom to fit all points"
              icon="home"
            ></paper-icon-button>
            <paper-tooltip for="reset-zoom" position="bottom" animation-delay="0"
              >Reset zoom to fit all points</paper-tooltip
            >
          </div>
        </div>
        <div class="stage">
          <div id="scatter">
            <svg id="selector"></svg>
          </div>
          <vz-projector-trace-panel id="trace-panel"></vz-projector-trace-panel>
          <vz-projector-self-consistency-panel id="self-consistency-panel"></vz-projector-self-consistency-panel>
          <div style='display: none'>
          <vz-projector-metadata-card
            id="metadata-card"
          ></vz-projector-metadata-card>
          </div>
          <paper-icon-button
            raised
            on-click="_toggleHelp3dDialog"
            icon="help-outline"
            id="help-3d-icon"
          ></paper-icon-button>
          <paper-tooltip animation-delay="0" for="help-3d-icon"
            >Help with interaction controls.</paper-tooltip
          >
          <paper-dialog id="help3dDialog" with-backdrop>
            <div class="main" dialog-confirm autofocus>
              <h3>3D controls</h3>
              <b>Rotate</b> Mouse left click.<br />
              <b>Pan</b> Mouse right click.<br />
              <b>Zoom</b> Mouse wheel.<br />
              Holding <b>ctrl</b> reverses the mouse clicks.
              <h3>2D controls</h3>
              <b>Pan</b> Mouse left click.<br />
              <b>Zoom</b> Mouse wheel.
              <div class="dismiss-dialog-note">Click anywhere to dismiss.</div>
            </div>
          </paper-dialog>
        </div>
      </div>
      <div id="right-pane" class="ink-panel">
        <div class="ink-panel-content active">
          <vz-projector-inspector-panel
            id="inspector-panel"
          ></vz-projector-inspector-panel>
        </div>
        <div id="bookmark-panel-container">
          <vz-projector-bookmark-panel
            id="bookmark-panel"
          ></vz-projector-bookmark-panel>
        </div>
      </div>
    </div>
    <paper-toast id="toast" always-on-top></paper-toast>
  </template>
`;var Zgt=1,Jgt="black",O$="__index__",Qgt=window.location.search,Ar=class B$ extends Oe(ve){ready(){return $t(this,null,function*(){if(WE(B$.prototype,this,"ready").call(this),G8(this),this.analyticsLogger=new Ug(this.pageViewLogging,this.eventLogging),this.analyticsLogger.logPageView("embeddings"),!(yield u2())){this.analyticsLogger.logWebGLDisabled(),Ye("Your browser or device does not have WebGL enabled. Please enable hardware acceleration, or use a browser that supports WebGL.");return}this.selectionChangedListeners=[],this.hoverListeners=[],this.projectionChangedListeners=[],this.distanceMetricChangedListeners=[],this.selectedPointIndices=[],this.neighborsOfFirstPoint=[],this.editMode=!1,this.dataPanel=this.$["data-panel"],this.inspectorPanel=this.$["inspector-panel"],this.projectionsPanel=this.$["projections-panel"],this.bookmarkPanel=this.$["bookmark-panel"],this.metadataCard=this.$["metadata-card"],this.tracePanel=this.$["trace-panel"],this.selfConsistencyPanel=this.$["self-consistency-panel"],this.statusBar=this.$$("#status-bar"),this.inspectorPanel.initialize(this,this),this.projectionsPanel.initialize(this),this.bookmarkPanel.initialize(this,this),this.metadataCard.initialize(this),this.tracePanel.initialize(this),this.selfConsistencyPanel.initialize(this),this.setupUIControls(),this.initializeDataProvider(),this.initializeWalkThrough()})}initializeWalkThrough(){let t=new os.Tour({useModalOverlay:!0,defaultStepOptions:{classes:"shadow-md bg-purple-dark",scrollTo:!1}});t.addStep({id:"initial-step",text:"Welcome to META-SiM Projector!<br>Take a quick tour for the basics?",classes:"example-step-extra-class",buttons:[{text:"Start",action:t.next},{text:"Skip Tutorial",action:t.cancel}]}),t.addStep({id:"upload-step",text:"Start by choosing one of the demo datasets, or upload your own dataset.",classes:"example-step-extra-class",attachTo:{element:this.dataPanel,on:"bottom"},buttons:[{text:"Change Color-by",action:()=>{var e;this.dataPanel.selectedColorOptionName=(e=this.dataPanel.colorOptions[2])==null?void 0:e.name}},{text:"Next",action:t.next}]}),t.addStep({id:"projection-step",text:"Choose your method of low-dimensional projection.",classes:"example-step-extra-class",attachTo:{element:this.projectionsPanel,on:"top"},buttons:[{text:"Run UMAP",action:()=>{this.projectionsPanel.showTab("umap")}},{text:"Next",action:t.next}]}),t.addStep({id:"stage-step",text:"This is the main stage where you can interact with the projection. <b>Click on any point</b> to show richer information.",classes:"example-step-extra-class",attachTo:{element:this.$$("#scatter"),on:"top"},buttons:[{text:"Select a point",action:()=>{this.notifySelectionChanged([0])}},{text:"Next",action:t.next}]}),t.addStep({id:"neighbour-step",text:"This panel will show nearest neighbour traces in the <b>original</b> embedding space.",classes:"example-step-extra-class",attachTo:{element:this.inspectorPanel,on:"left"},buttons:[{text:"Next",action:t.next}]}),t.addStep({id:"trace-list-step",text:"Click here to display all traces for quick <b>inspection</b> and <b>labeling</b>.",classes:"example-step-extra-class",attachTo:{element:this.$$("#traceListMode"),on:"right"},buttons:[{text:"Next",action:t.next}]}),t.addStep({id:"screenshot-step",text:"Click here to take a screenshot.",classes:"example-step-extra-class",attachTo:{element:this.$$("#screenshot"),on:"left"},buttons:[{text:"Next",action:t.next}]}),t.addStep({id:"final-step",text:"That's it for the basics! Enjoy exploring!",classes:"example-step-extra-class",buttons:[{text:"Finish",action:t.complete}]}),t.start()}setSelectedLabelOption(t){this.selectedLabelOption=t,this.metadataCard.setLabelOption(this.selectedLabelOption),this.projectorScatterPlotAdapter.setLabelPointAccessor(t),this.projectorScatterPlotAdapter.updateScatterPlotAttributes(),this.projectorScatterPlotAdapter.render()}setSelectedColorOption(t){this.selectedColorOption=t,this.projectorScatterPlotAdapter.setLegendPointColorer(this.getLegendPointColorer(t)),this.projectorScatterPlotAdapter.updateScatterPlotAttributes(),this.projectorScatterPlotAdapter.render()}setNormalizeData(t){this.normalizeData=t,this.setCurrentDataSet(this.originalDataSet.getSubset())}setPrincipleProjection(t){let e=this.dataSet.points.map(r=>r.index),n=this.originalDataSet.getSubset();t&&n.projectMatrix(t);{let r=n.spriteAndMetadataInfo,o=this.metadataFile;if(r=r||{},r.pointsInfo==null){let[a,l]=this.makeDefaultPointsInfoAndStats(n.points);r.pointsInfo=a,r.stats=l}if(!n.mergeMetadata(r))return;this.projectorScatterPlotAdapter!=null&&(this.projectorScatterPlotAdapter.updateScatterPlotPositions(),this.projectorScatterPlotAdapter.updateScatterPlotAttributes(),this.projectorScatterPlotAdapter.resize(),this.projectorScatterPlotAdapter.render()),this.dataPanel.setNormalizeData(this.normalizeData),this.projectorScatterPlotAdapter.setLabelPointAccessor(this.selectedLabelOption),this.inspectorPanel.metadataChanged(r),this.projectionsPanel.metadataChanged(r),this.dataPanel.metadataChanged(r,o),this.setCurrentDataSet(n.getSubset(e))}}updateDataSet(t,e,n,r){if(this.dataSetFilterIndices=null,this.dataSetBeforeFilter=null,this.originalDataSetFilterIndices=null,r||(this.originalDataSet=t),t!=null){if(this.normalizeData=this.originalDataSet.dim[1]>=Zgt,e=e||{},e.pointsInfo==null){let[s,a]=this.makeDefaultPointsInfoAndStats(t.points);e.pointsInfo=s,e.stats=a}if(!t.mergeMetadata(e))return}this.projectorScatterPlotAdapter!=null&&(t==null?(this.projectorScatterPlotAdapter.setLabelPointAccessor(null),this.setProjection(null)):(this.projectorScatterPlotAdapter.updateScatterPlotPositions(),this.projectorScatterPlotAdapter.updateScatterPlotAttributes(),this.projectorScatterPlotAdapter.resize(),this.projectorScatterPlotAdapter.render())),t!=null?(this.dataPanel.setNormalizeData(this.normalizeData),this.setCurrentDataSet(t.getSubset()),this.projectorScatterPlotAdapter.setLabelPointAccessor(this.selectedLabelOption),this.inspectorPanel.datasetChanged(),this.inspectorPanel.metadataChanged(e),this.projectionsPanel.metadataChanged(e),this.dataPanel.metadataChanged(e,n)):this.setCurrentDataSet(null)}metadataEdit(t,e){var n;this.selectedPointIndices.forEach(r=>this.dataSet.points[r].metadata[t]=e),this.neighborsOfFirstPoint.forEach(r=>this.dataSet.points[r.index].metadata[t]=e),this.dataSet.spriteAndMetadataInfo.stats=Zo((n=this.dataSet.spriteAndMetadataInfo.stats)==null?void 0:n.map(r=>r.name),this.dataSet.points.map(r=>r.metadata)),this.metadataChanged(this.dataSet.spriteAndMetadataInfo),this.metadataEditorContext(!0,t),this.dataPanel._selectedColorOptionNameChanged()}metadataChanged(t,e){e!=null&&(this.metadataFile=e),this.dataSet.spriteAndMetadataInfo=t,this.projectionsPanel.metadataChanged(t),this.inspectorPanel.metadataChanged(t),this.dataPanel.metadataChanged(t,this.metadataFile),this.selectedPointIndices.length>0?this.metadataCard.updateMetadata(this.dataSet.points[this.selectedPointIndices[0]].metadata):this.metadataCard.updateMetadata(null),this.setSelectedLabelOption(this.selectedLabelOption)}metadataEditorContext(t,e){this.inspectorPanel&&this.inspectorPanel.metadataEditorContext(t,e)}setSelectedTensor(t,e){this.bookmarkPanel.setSelectedTensor(t,e,this.dataProvider)}registerSelectionChangedListener(t){this.selectionChangedListeners.push(t)}filterDataset(t){var n;let e=this.selectedPointIndices.length;this.dataSetBeforeFilter==null&&(this.dataSetBeforeFilter=this.dataSet),this.setCurrentDataSet(this.dataSet.getSubset(t)),this.dataSetFilterIndices=t,this.projectorScatterPlotAdapter.updateScatterPlotPositions(),this.projectorScatterPlotAdapter.updateScatterPlotAttributes(),this.dataSet.spriteAndMetadataInfo.stats=Zo((n=this.dataSet.spriteAndMetadataInfo.stats)==null?void 0:n.map(r=>r.name),this.dataSet.points.map(r=>r.metadata)),this.dataPanel.metadataChanged(this.dataSet.spriteAndMetadataInfo,this.metadataFile),this.dataPanel._selectedColorOptionNameChanged()}resetFilterDataset(){var e;let t=this.selectedPointIndices.map(n=>this.dataSet.points[n].index);this.setCurrentDataSet(this.dataSetBeforeFilter),this.projection!=null&&(this.projection.dataSet=this.dataSetBeforeFilter),this.dataSetBeforeFilter=null,this.projectorScatterPlotAdapter.updateScatterPlotPositions(),this.projectorScatterPlotAdapter.updateScatterPlotAttributes(),this.dataSetFilterIndices=[],this.adjustSelectionAndHover(t),this.dataSet.spriteAndMetadataInfo.stats=Zo((e=this.dataSet.spriteAndMetadataInfo.stats)==null?void 0:e.map(n=>n.name),this.dataSet.points.map(n=>n.metadata)),this.dataPanel.metadataChanged(this.dataSet.spriteAndMetadataInfo,this.metadataFile),this.dataPanel._selectedColorOptionNameChanged(),this.dataPanel.updatePrincipleProjection()}notifySelectionChanged(t){let e=[];if(this.editMode&&t.length>0)if(this.selectedPointIndices.length===1){let n=this.dataSet.points[this.selectedPointIndices[0]].vector;e=this.neighborsOfFirstPoint.filter(r=>t.filter(o=>o==r.index).length==0),t.forEach(r=>{if(r!=this.selectedPointIndices[0]&&this.neighborsOfFirstPoint.filter(o=>o.index==r).length==0){let o=this.dataSet.points[r].vector,s=this.inspectorPanel.distFunc(n,o),a=0;for(;a<e.length&&e[a].dist<s;)a=a+1;e.splice(a,0,{index:r,dist:s})}})}else{let n=this.selectedPointIndices.filter(r=>t.filter(o=>o==r).length==0);t.forEach(r=>{this.selectedPointIndices.filter(o=>o==r).length==0&&n.push(r)}),this.selectedPointIndices=n,this.selectedPointIndices.length>0?this.metadataCard.updateMetadata(this.dataSet.points[this.selectedPointIndices[0]].metadata):this.metadataCard.updateMetadata(null)}else this.selectedPointIndices=t,t.length===1?(e=this.dataSet.findNeighbors(t[0],this.inspectorPanel.distFunc,this.inspectorPanel.numNN),this.metadataCard.updateMetadata(this.dataSet.points[t[0]].metadata)):this.metadataCard.updateMetadata(null);this.selectionChangedListeners.forEach(n=>n(this.selectedPointIndices,e))}registerHoverListener(t){this.hoverListeners.push(t)}notifyHoverOverPoint(t){this.hoverListeners.forEach(e=>e(t))}registerProjectionChangedListener(t){this.projectionChangedListeners.push(t)}notifyProjectionChanged(t){this.projectionChangedListeners.forEach(e=>e(t))}registerDistanceMetricChangedListener(t){this.distanceMetricChangedListeners.push(t)}notifyDistanceMetricChanged(t){this.distanceMetricChangedListeners.forEach(e=>e(t))}_dataProtoChanged(t){let e=t?JSON.parse(t):null;this.initializeDataProvider(e)}makeDefaultPointsInfoAndStats(t){let e=[];t.forEach(r=>{let o={};o[O$]=r.index,e.push(o)});let n=[{name:O$,isNumeric:!1,tooManyUniqueValues:!0,min:0,max:e.length-1}];return[e,n]}initializeDataProvider(t){if(this.servingMode==="demo"){let e,n=iB(Qgt);"config"in n?e=n.config:e=this.projectorConfigJsonPath,this.dataProvider=new vb(e,this.principleMatricesJsonPath)}else if(this.servingMode==="server"){if(!this.routePrefix)throw"route-prefix is a required parameter";this.dataProvider=new _b(this.routePrefix)}else if(this.servingMode==="proto"&&t!=null)this.dataProvider=new bb(t);else return;this.dataPanel.initialize(this,this.dataProvider)}getLegendPointColorer(t){return t==null||t.map==null?null:(n,r)=>{var s;let o=n.points[r].metadata[this.selectedColorOption.name];return o==null?Jgt:(s=t.map)==null?void 0:s.call(t,o)}}get3DLabelModeButton(){return this.$$("#labels3DMode")}get3DLabelMode(){return this.get3DLabelModeButton().active}adjustSelectionAndHover(t,e){this.notifySelectionChanged(t),this.notifyHoverOverPoint(e),this.setMouseMode(Qo.CAMERA_AND_CLICK_SELECT)}setMouseMode(t){let e=this.$$("#selectMode");e.active=t===Qo.AREA_SELECT,this.projectorScatterPlotAdapter.scatterPlot.setMouseMode(t)}setCurrentDataSet(t){this.adjustSelectionAndHover([]),this.dataSet!=null&&this.dataSet.stopTSNE(),t!=null&&this.normalizeData&&t.normalize(),this.dim=t==null?0:t.dim[1],this.$$("span.numDataPoints").innerText=t==null?"0":""+t.dim[0],this.$$("span.dim").innerText=t==null?"0":""+t.dim[1],this.dataSet=t,this.projectionsPanel.dataSetUpdated(this.dataSet,this.originalDataSet,this.dim),this.projectorScatterPlotAdapter.setDataSet(this.dataSet),this.projectorScatterPlotAdapter.scatterPlot.setCameraParametersForNextCameraCreation(null,!0)}combineCanvases(t,e){var n,r;for(let c of t)n=e*c.width,r=e*c.height;let o=document.createElement("canvas");o.width=n,o.height=r;let s=o.getContext("2d"),a=0,l=0;for(let c of t)s.drawImage(c,0,0,c.width,c.height,0,0,n,r);return o}setupUIControls(){var a,l;(a=this.$$("#reset-zoom"))==null||a.addEventListener("click",()=>{this.projectorScatterPlotAdapter.scatterPlot.resetZoom(),this.projectorScatterPlotAdapter.scatterPlot.startOrbitAnimation()}),(l=this.$$("#screenshot"))==null||l.addEventListener("click",()=>{this.projectorScatterPlotAdapter.updateScatterPlotAttributes(),this.projectorScatterPlotAdapter.scatterPlot.render();let c=this.projectorScatterPlotAdapter.scatterPlot.container.querySelectorAll("canvas"),h=this.combineCanvases(c,4).toDataURL("image/png"),p=document.createElement("a");p.href=h,p.download="embedding-projection-screenshot.png",p.click()});let t=this.$$("#selectMode");t==null||t.addEventListener("click",c=>{this.setMouseMode(t.active?Qo.AREA_SELECT:Qo.CAMERA_AND_CLICK_SELECT)});let e=this.$$("#nightDayMode");e==null||e.addEventListener("click",()=>{this.projectorScatterPlotAdapter.scatterPlot.setDayNightMode(e.active)});let n=this.$$("#editMode");n==null||n.addEventListener("click",c=>{this.editMode=n.active}),this.get3DLabelModeButton().addEventListener("click",()=>{this.projectorScatterPlotAdapter.set3DLabelMode(this.get3DLabelMode())});let o=this.$$("#traceListMode");o==null||o.addEventListener("click",()=>{this.tracePanel.open()});let s=this.$$("#selfConsistencyMode");s==null||s.addEventListener("click",()=>{this.selfConsistencyPanel.open()}),window.addEventListener("resize",()=>{this.projectorScatterPlotAdapter.resize()}),this.projectorScatterPlotAdapter=new zb(this.getScatterContainer(),this),this.projectorScatterPlotAdapter.setLabelPointAccessor(this.selectedLabelOption),this.projectorScatterPlotAdapter.scatterPlot.onCameraMove((c,u)=>this.bookmarkPanel.clearStateSelection()),this.registerHoverListener(c=>this.onHover(c)),this.registerProjectionChangedListener(c=>this.onProjectionChanged(c)),this.registerSelectionChangedListener((c,u)=>this.onSelectionChanged(c,u))}onHover(t){this.hoverPointIndex=t;let e=null;if(t!=null){let n=this.dataSet.points[t];n.metadata[this.selectedLabelOption]&&(e=n.metadata[this.selectedLabelOption].toString())}this.selectedPointIndices.length===0&&(e?(this.statusBar.innerText=e,this.statusBar.style.display=null):this.statusBar.style.display="none")}getScatterContainer(){return this.$$("#scatter")}onSelectionChanged(t,e){this.selectedPointIndices=t,this.neighborsOfFirstPoint=e,this.dataPanel.onProjectorSelectionChanged(t,e);let n=this.selectedPointIndices.length+e.length;this.statusBar.innerText=`Selected ${n} points`,n>0?this.statusBar.style.display=null:this.statusBar.style.display="none"}onProjectionChanged(t){this.dataPanel.projectionChanged(t)}setProjection(t){this.projection=t,t!=null&&this.analyticsLogger.logProjectionChanged(t.projectionType),this.notifyProjectionChanged(t)}notifyProjectionPositionsUpdated(){this.projectorScatterPlotAdapter.notifyProjectionPositionsUpdated()}getCurrentState(){var e;let t=new hb;t.projections=[];for(let n=0;n<this.dataSet.points.length;n++){let r=this.dataSet.points[n],o={},s=Object.keys(r.projections);for(let a=0;a<s.length;++a)o[s[a]]=r.projections[s[a]];t.projections.push(o)}return t.selectedProjection=(e=this.projection)==null?void 0:e.projectionType,t.dataSetDimensions=this.dataSet.dim,t.tSNEIteration=this.dataSet.tSNEIteration,t.selectedPoints=this.selectedPointIndices,t.filteredPoints=this.dataSetFilterIndices,t.shuffledDataIndices=this.dataSet.shuffledDataIndices,this.projectorScatterPlotAdapter.populateBookmarkFromUI(t),t.selectedColorOptionName=this.dataPanel.selectedColorOptionName,t.forceCategoricalColoring=this.dataPanel.forceCategoricalColoring,t.selectedLabelOption=this.selectedLabelOption,this.projectionsPanel.populateBookmarkFromUI(t),t}loadState(t){this.setProjection(null),this.projectionsPanel.disablePolymerChangesTriggerReprojection(),this.dataSetBeforeFilter!=null&&this.resetFilterDataset(),t.filteredPoints!=null&&this.filterDataset(t.filteredPoints),this.projectionsPanel.enablePolymerChangesTriggerReprojection();for(let e=0;e<t.projections.length;e++){let n=this.dataSet.points[e],r=t.projections[e],o=Object.keys(r);n.projections={};for(let s=0;s<o.length;++s)n.projections[o[s]]=r[o[s]]}t.shuffledDataIndices&&(this.dataSet.shuffledDataIndices=t.shuffledDataIndices),this.dataSet.hasTSNERun=t.selectedProjection==="tsne",this.dataSet.tSNEIteration=t.tSNEIteration,this.projectionsPanel.restoreUIFromBookmark(t),this.inspectorPanel.restoreUIFromBookmark(t),this.dataPanel.selectedColorOptionName=t.selectedColorOptionName,this.dataPanel.setForceCategoricalColoring(!!t.forceCategoricalColoring),this.selectedLabelOption=t.selectedLabelOption,this.projectorScatterPlotAdapter.restoreUIFromBookmark(t);{let e=n$(t),n=Bl(t.selectedProjection,e),r=new Yo(t.selectedProjection,n,e.length,this.dataSet);this.setProjection(r)}this.notifySelectionChanged(t.selectedPoints)}_toggleHelp3dDialog(t){t.preventDefault(),this.$$("#help3dDialog").open()}};Ar.template=F$;wt([Rt({type:String}),ht("design:type",String)],Ar.prototype,"routePrefix",void 0);wt([Rt({type:String}),ht("design:type",String)],Ar.prototype,"dataProto",void 0);wt([Rt({type:String}),ht("design:type",String)],Ar.prototype,"servingMode",void 0);wt([Rt({type:String}),ht("design:type",String)],Ar.prototype,"projectorConfigJsonPath",void 0);wt([Rt({type:String}),ht("design:type",String)],Ar.prototype,"principleMatricesJsonPath",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],Ar.prototype,"pageViewLogging",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],Ar.prototype,"eventLogging",void 0);wt([Nn("dataProto"),ht("design:type",Function),ht("design:paramtypes",[String]),ht("design:returntype",void 0)],Ar.prototype,"_dataProtoChanged",null);Ar=wt([Fe("vz-projector")],Ar);var kr=class extends ve{constructor(){super(...arguments),this.pageViewLogging=!1,this.eventLogging=!1,this.projectorConfigJsonPath="",this.principleMatricesJsonPath="",this.routePrefix="",this.servingMode="",this.documentationLink="",this.bugReportLink=""}};kr.template=ut`
    <style include="vz-projector-styles"></style>
    <style>
      #appbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 24px;
        height: 60px;
        color: white;
        background: #43A6C6;
      }

      #appbar .logo {
        font-size: 18px;
        font-weight: 300;
      }

      .icons {
        display: flex;
      }

      .icons a {
        color: white;
      }

      .smalltext {
        font-size: 10px;
        font-weight: 300;
      }

      vz-projector {
        height: calc(100% - 60px);
      }

      #container {
        height: 100%;
      }


    </style>

    <div id="container">
      <div id="appbar">
        <div>META-SiM Projector <span class="smalltext">Multitask Enabled Tranferrable Attention Single Molecule Embedding Projection</span></div>
        <div class="icons">
          <a
            title="Documentation"
            target="_blank"
            href="[[documentationLink]]"
            rel="noopener noreferrer"
          >
            <paper-icon-button icon="help-outline"></paper-icon-button>
            <paper-tooltip
              position="bottom"
              animation-delay="0"
              fit-to-visible-bounds=""
            >
              Open documentation
            </paper-tooltip>
          </a>
          <a
            title="Report bug"
            target="_blank"
            href="[[bugReportLink]]"
            rel="noopener noreferrer"
          >
            <paper-icon-button icon="bug-report"></paper-icon-button>
            <paper-tooltip
              position="bottom"
              animation-delay="0"
              fit-to-visible-bounds=""
            >
              Report a bug
            </paper-tooltip>
          </a>
        </div>
      </div>
      <vz-projector
        route-prefix="[[routePrefix]]"
        serving-mode="[[servingMode]]"
        projector-config-json-path="[[projectorConfigJsonPath]]"
        page-view-logging="[[pageViewLogging]]"
        event-logging="[[eventLogging]]"
        principle-matrices-json-path="[[principleMatricesJsonPath]]"
      >
      </vz-projector>
    </div>
  `;wt([Rt({type:Boolean}),ht("design:type",Boolean)],kr.prototype,"pageViewLogging",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],kr.prototype,"eventLogging",void 0);wt([Rt({type:String}),ht("design:type",String)],kr.prototype,"projectorConfigJsonPath",void 0);wt([Rt({type:String}),ht("design:type",String)],kr.prototype,"principleMatricesJsonPath",void 0);wt([Rt({type:String}),ht("design:type",String)],kr.prototype,"routePrefix",void 0);wt([Rt({type:String}),ht("design:type",String)],kr.prototype,"servingMode",void 0);wt([Rt({type:String}),ht("design:type",String)],kr.prototype,"documentationLink",void 0);wt([Rt({type:String}),ht("design:type",String)],kr.prototype,"bugReportLink",void 0);kr=wt([Fe("vz-projector-app")],kr);var Nh=class extends ve{constructor(){super(...arguments),this._routePrefix="."}reload(){}connectedCallback(){if(super.connectedCallback(),this._initialized)return;let t=new XMLHttpRequest;t.open("GET",this._routePrefix+"/runs"),t.onload=()=>{this._initialized=!0;let e=JSON.parse(t.responseText);this.set("dataNotFound",e.length===0)},t.onerror=()=>{this.set("dataNotFound",!1)},t.send()}};Nh.template=ut`
    <template is="dom-if" if="[[dataNotFound]]">
      <div style="max-width: 540px; margin: 0 auto; padding: 80px 0 0">
        <h3>No checkpoint was found.</h3>
        <p>Probable causes:</p>
        <ul>
          <li>
            No checkpoint has been saved yet. Please refresh the page
            periodically.
          </li>

          <li>
            You are not saving any checkpoint. To save your model, create a
            <a
              href="https://www.tensorflow.org/api_docs/python/tf/compat/v1/train/Saver"
              ><code>tf.train.Saver</code></a
            >
            and save your model periodically by calling
            <code>saver.save(session, LOG_DIR/model.ckpt, step)</code>.
          </li>
        </ul>

        <p>
          If youre new to using TensorBoard, and want to find out how to add
          data and set up your event files, check out the
          <a
            href="https://github.com/tensorflow/tensorboard/blob/master/README.md"
            >README</a
          >
          and perhaps the
          <a
            href="https://www.tensorflow.org/get_started/summaries_and_tensorboard"
            >TensorBoard tutorial</a
          >.
        </p>

        <p>
          If you think TensorBoard is configured properly, please see
          <a
            href="https://github.com/tensorflow/tensorboard/blob/master/README.md#my-tensorboard-isnt-showing-any-data-whats-wrong"
            >the section of the README devoted to missing data problems</a
          >
          and consider filing an issue on GitHub.
        </p>
      </div>
    </template>
    <template is="dom-if" if="[[!dataNotFound]]">
      <vz-projector
        id="projector"
        route-prefix="[[_routePrefix]]"
        serving-mode="server"
        page-view-logging=""
        event-logging=""
      ></vz-projector>
    </template>
  `;wt([Rt({type:Boolean}),ht("design:type",Boolean)],Nh.prototype,"dataNotFound",void 0);wt([Rt({type:String}),ht("design:type",String)],Nh.prototype,"_routePrefix",void 0);wt([Rt({type:Boolean}),ht("design:type",Boolean)],Nh.prototype,"_initialized",void 0);Nh=wt([Fe("vz-projector-dashboard")],Nh);})();
/*! shepherd.js 11.2.0 */
/**
 * @fileoverview
 * @suppress {checkPrototypalTypes}
 * @license Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
 * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
 * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
 * Google as part of the polymer project is also subject to an additional IP
 * rights grant found at http://polymer.github.io/PATENTS.txt
 */
/**
 * @license
 * Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
 * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
 * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
 * Google as part of the polymer project is also subject to an additional IP
 * rights grant found at http://polymer.github.io/PATENTS.txt
 */
/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
@license
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
/**
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
/**
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
//# sourceMappingURL=standalone_bundle_no_vendor.js.map
